"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[3322],{22480:(e,t,i)=>{i.d(t,{f:()=>m});var n=i(30758),a=i(97500),o=i.n(a),r=i(4882),s=i(21349);const c="main-genericButton-button",l="main-genericButton-buttonActive",u="main-genericButton-buttonActiveDot";var d=i(86070);const m=(0,n.forwardRef)(((e,t)=>{const i=e.isActive??!1,n=o()(c,{[l]:i||e.isActiveNoIndicator,[u]:i},e.className);return(0,d.jsx)(s.Zp,{label:e.label,children:(0,d.jsx)(r.H,{ref:t,style:e.style,"aria-label":e.label,size:"small",className:n,disabled:e.disabled,iconOnly:e.icon,onClick:e.onToggle,"data-testid":e.testId,"data-active":i.toString(),"aria-pressed":i,"data-restore-focus-key":e.restoreFocusKey})})}))},34541:(e,t,i)=>{i.d(t,{$:()=>o});var n=i(85387);const a="/lyrics",o=()=>{const e=(0,n.zy)(),t=e.pathname.startsWith(a);return{isActive:t,isActiveNotCinemaMode:t&&(!e.state.cinemaState||"closed"===e.state.cinemaState),routeDestination:a}}},34613:(e,t,i)=>{i.d(t,{D:()=>u});var n=i(30758),a=i(29462);var o=i(31925),r=i(87033),s=i(1997),c=i(76035),l=i(85105);const u=({item:e,onClick:t})=>{const i=(0,s.W)(),{capabilities:{isEnabled:u},isOpen:d,close:m,open:g,canOpen:p}=(0,c.H)(),{videoPlayerMode:v}=(0,o.d)(),{spec:y,logger:b}=(0,l.r)(a.h9,{data:{identifier:v===r.Kz.cinemaLegacy?a.gw.CINEMA:a.gw.DESKTOP}}),h=(0,n.useCallback)((()=>{let n;u&&(d?(m(),e?.uri&&b.logInteraction(y.pipButtonFactory({uri:e.uri}).hitUiHide()),n="close-picture-in-picture"):(g(),e?.uri&&(({spec:e,logger:t,uri:i})=>{const n=window.documentPictureInPicture;if(!n)return;const a=o=>{setTimeout((()=>{const n=o.window?.innerWidth,a=o.window?.innerHeight;if(!n||!a)return;const r=e.pipButtonFactory({uri:i}).hitUiOpenWindow({widthPx:n,heightPx:a});t.logInteraction(r)}),100),n.removeEventListener("enter",a)};n.addEventListener("enter",a)})({spec:y,logger:b,uri:e.uri}),n="show-picture-in-picture"),t?.(!d,e?.uri),i({type:"click",intent:n,targetUri:e?.uri,itemIdSuffix:"picture-in-picture-toggle"}))}),[m,u,d,e?.uri,b,t,i,g,y]);return{showButton:p,isActive:d,onClick:h}}},47425:(e,t,i)=>{i.d(t,{w:()=>u});var n=i(30758),a=i(94703),o=i(87579),r=i(11273),s=i(1540),c=i(59197),l=i(85105);const u=({uri:e,isBook:t})=>{const{add:i,remove:u}=(0,c.p)("prerelease"),d=(0,s.o)("prerelease",[e]).at(0),{enqueueSnackbar:m}=(0,r.d)(),{spec:g,logger:p}=(0,l.r)(a.k,{data:{uri:e}});return{isPreSaved:d,addPresave:(0,n.useCallback)((async()=>{p.logInteraction(g.actionBarFactory().preSaveButtonFactory().hitPresave({prereleaseId:e,itemToBePresaved:e,contextUri:e})),await i(e),m(t?o.Ru.get("web-player.prerelease.audiobook_feedback_presaved"):o.Ru.get("web-player.prerelease.album_feedback_presaved"))}),[i,m,t,p,g,e]),removePresave:(0,n.useCallback)((async()=>{p.logInteraction(g.actionBarFactory().preSaveButtonFactory().hitRemovePresave({prereleaseId:e,itemToBeRemovedFromPresaved:e,contextUri:e})),await u(e)}),[p,u,g,e])}}},55299:(e,t,i)=>{i.d(t,{NowPlayingBar:()=>ua});var n=i(30758),a=i(97500),o=i.n(a),r=i(62411),s=i(94079),c=i(55183),l=i(39629),u=i(60992),d=i(87579);const m="dz_h98rH9nZCwfPdnKgr",g="rAfV2jB_HMM9Xtr0Rqvn",p="XkXPpDRWozMF6G8_GlLQ";var v=i(86070);const y=n.memo((function(e){const{handleClick:t}=e,i=d.Ru.get("pta.bottom-bar.title"),n=d.Ru.get("fta.bottom-bar.subtitle"),a=d.Ru.get("fta.sign-up-free");return(0,v.jsxs)("div",{className:m,onClick:t,"data-testid":"signup-bar",children:[(0,v.jsxs)("div",{className:g,children:[(0,v.jsx)(l.E,{as:"p",variant:"bodySmallBold",children:i}),(0,v.jsx)(l.E,{as:"p",variant:"bodyMedium",dangerouslySetInnerHTML:{__html:n}})]}),(0,v.jsx)(u.$,{colorSet:"invertedLight",onClick:t,className:p,children:a})]})}));var b=i(59227),h=i(1829),k=i(30934),x=i(23760),C=i(66911),N=i(12604),f=i(51862),I=i(85105);const j="gqYYMz8DkhaT3e44LcHQ",A="VX33mI2V_jRA7hRBI9_0",S=({remoteDeviceName:e,remoteDeviceType:t,connectionStatus:i,omitConnectionStateText:n=!1})=>{const{spec:a,logger:o}=(0,I.r)(k.s,{}),{triggerRef:r,toggleDevicePicker:s,isPickerOpen:c}=(0,C.z)(),u=(0,N.$A)(t,i),m=i===f.zP.CONNECTED?d.Ru.get("web-player.connect.bar.connected-state",{device_name:e}):d.Ru.get("web-player.connect.bar.connecting-state",{device_name:e});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(u,{size:"small",className:A,role:"presentation",semanticColor:"essentialBase"}),(0,v.jsx)(h.Y,{component:"button",onClick:()=>{const e=a.activeDeviceButtonFactory(),{interactionId:t}=o.logInteraction(c?e.hitUiHide():e.hitUiReveal()),i=c;s(t),i||(0,x.I)("DEVICE-PICKER")},ref:r,className:j,children:(0,v.jsx)(l.E,{variant:"bodySmallBold","aria-live":"polite",semanticColor:"textBase",children:n&&i===f.zP.CONNECTED?e:m})})]})},P="nQSM_BrSHJ4Cp3XSuLOF",w=()=>(0,v.jsxs)("svg",{width:"1",height:"16",viewBox:"0 0 1 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",role:"separator",className:P,children:[(0,v.jsx)("g",{id:"separator",clipPath:"url(#clip0_491_88335)",children:(0,v.jsx)("rect",{id:"Rectangle 111112858",width:"1",height:"16",rx:"0.5",fill:"var(--essential-base)"})}),(0,v.jsx)("defs",{children:(0,v.jsx)("clipPath",{id:"clip0_491_88335",children:(0,v.jsx)("rect",{width:"1",height:"16",fill:"white"})})})]});var D=i(7352),T=i(3537),E=i(18425),B=i(23481),R=i(41678);const L="main-connectBar-connectBar",O="main-connectBar-connected",_="main-connectBar-connecting",F=function(){const{isPlayingRemotely:e,connectionStatus:t,remoteDeviceName:i,remoteDeviceType:n}=(0,E.v)((e=>{const t=(0,T.V)(e);return{isPlayingRemotely:t.isPlayingRemotely,connectionStatus:t.connectionStatus,remoteDeviceName:t.remoteDevice?.name,remoteDeviceType:t.remoteDevice?.type}}),R.a),{currentSession:a}=(0,B.D)(),r=Boolean(a?.active),s=e&&i&&n;if(!s&&!r)return null;const c=t===f.zP.CONNECTED||r,l=t===f.zP.CONNECTING&&!r;return(0,v.jsxs)("div",{className:o()(L,{"encore-bright-accent-set":c,[O]:c,[_]:l}),children:[r&&(0,v.jsx)(D.K,{}),r&&s&&(0,v.jsx)(w,{}),s&&(0,v.jsx)(S,{connectionStatus:t,remoteDeviceName:i,remoteDeviceType:n,omitConnectionStateText:r})]})},U=()=>(0,v.jsx)(n.Suspense,{fallback:null,children:(0,v.jsx)(F,{})});var M=i(11165),z=i(92977),V=i(66521),G=i(55392),Q=i(36550),K=i(15817),H=i(60848),W=i(26945);var Y=i(40638),q=i(33100),Z=i(29462),X=i(85197),J=i(42993),$=i(40391),ee=i(61431),te=i(22480),ie=i(15380),ne=i(60690),ae=i(94487),oe=i(74929),re=i(50905);const se=({className:e="",disabledClassName:t="",onClick:i})=>{const a=(0,ee.lZ)(),s=(0,n.useContext)($.s),c=(0,W.o)((e=>e?.hasContext??!1)),l=(0,r.wA)(),u=(0,q.NC)(oe.mzn),m=(0,z.l)(),g=!c,{toggleFullScreen:p,isInFullScreen:y}=(0,ae.H)({refOrElement:document.body,shouldWakeLockScreen:!0}),b=(0,n.useCallback)((()=>{const e=y?M.z.CLOSED:M.z.NOW_PLAYING_VIEW;p(),setTimeout((()=>{m(e)}),1)}),[y,m,p]),h=(0,n.useCallback)((()=>{s?.current&&(l((0,J.f)()),(0,re.X8)(s.current))}),[l,s]),k=(0,n.useCallback)((async()=>{c&&(i?.(!0),u?b():h())}),[c,i,u,b,h]),x=y?ie.z:ne.T,C=y?d.Ru.get("web-player.cinema-mode.fullscreen.exit"):d.Ru.get("web-player.cinema-mode.fullscreen.enter"),N=o()(e,{[t]:g});return a?(0,v.jsx)(te.f,{onToggle:k,className:N,icon:u?x:X.L,label:u?C:d.Ru.get("npv.full-screen"),disabled:g,testId:"fullscreen-mode-button"}):null},ce=(0,n.memo)(se);var le=i(35188),ue=i(36445),de=i(34441);var me=i(68133),ge=i(4882),pe=i(45592);const ve="xP7v0EBcbJMj1xIJxywg",ye="zJU_lLLzQL6oKvMA0c5b",be=({onClose:e,onMouseEnter:t,onMouseLeave:i,onClick:n,impressionCallback:a,message:o})=>(0,v.jsxs)("div",{className:ve,onMouseEnter:t,onMouseLeave:i,ref:a,onClick:n,children:[(0,v.jsx)(l.E,{id:"nudgeBody",as:"p",variant:"bodyMedium",semanticColor:"textBase",children:o}),(0,v.jsx)(ge.H,{iconOnly:pe.M,size:"small",semanticColor:"textBase",onClick:t=>{t.stopPropagation(),e?.()},"aria-label":d.Ru.get("close"),className:ye})]});var he=i(14692),ke=i(78759);const xe=(e=he.C)=>{const t=(0,r.Pj)(),{isActive:i}=e(),n=(0,ke.h)();return document.hasFocus()&&!i&&!(({ui:e,ads:t},i)=>e.blockUserDialog.isOpen||e.connectDevicePicker.isOpen||e.deleteFolderDialog.isOpen||e.deletePlaylistDialog.isOpen||e.fullscreenMode.isOpen||e.improvedSignupPromptDialog.isOpen||e.keyboardShortcutsHelpModal.isOpen||e.leavePlaylistDialog.isOpen||e.offlineDeviceLimitReachedDialog.isOpen||e.playbackNotSupportedErrorDialog.isOpen||e.premiumDialog.isOpen||!0===t.billboard?.isOpen&&!t.billboard.isMinimized||!1===t.vto?.isHidden&&!1===t.vto?.isMinimized||i)(t.getState(),n.current.length>0)};var Ce=i(44314);var Ne=i(36036),fe=i(10309),Ie=i(76282),je=i(26732),Ae=i(40354),Se=i(9282),Pe=i(50031),we=i(35401);const De=e=>{const t=(0,n.useRef)(),i=(0,n.useRef)(),a=(0,n.useRef)(!1),o=(0,Ae.z)(),r=(0,fe.Z)(),{spec:s,logger:c}=(0,I.r)(Ce.w,{}),l=(0,n.useRef)(null),u=(0,n.useCallback)((()=>{c.logInteraction(s.djVoiceUnsupportedNudgeFactory().closeButtonFactory().hitUiHide())}),[s,c]),m=(0,n.useCallback)((e=>{e&&l.current!==e&&c.logImpression(s.djVoiceUnsupportedNudgeFactory().impression()),l.current=e}),[s,c]),g=(0,n.useCallback)((()=>{const e=o.getState(),t=r.getActiveDevice();return!(e=>e?.isLocal??!1)(t)&&(0,we.yc)(e,"spotify:playlist:37i9dQZF1EYkqdzj48dyYq")!==Pe.i.NOT_ACTIVE&&!(e=>Boolean(e?.supportsDJNarration))(t??void 0)}),[o,r]),p=(0,n.useCallback)((()=>{g()&&e({nudgeType:"message-only-nudge",message:d.Ru.get("web-player.connect.nudge.dj-voice-unavailable"),onClose:u,impressionCallback:m})}),[e,g,u,m]),v=(0,n.useCallback)((e=>{e.data.action===je.Ik.PLAY&&(a.current=!0)}),[]);(0,Se.p)(je.gd.ACTION,v);const y=(0,n.useCallback)((e=>{a.current&&(0,we.uW)(e.data)===Pe.i.PLAYING&&(t.current=e.data?.context.uri,p(),t.current=void 0,a.current=!1)}),[p]);(0,Se.p)(je.gd.UPDATE,y);const b=(0,n.useCallback)((e=>{const t=e.data?.activeDevice;t&&!t.isLocal&&i.current!==t.connectStateId&&p(),i.current=t?.connectStateId}),[p]);(0,Ie.W)(Ne.P.UPDATE,b)};var Te=i(23023);const Ee=e=>{switch(e.type){case f.bq.AUDIO_DONGLE:case f.bq.AVR:case f.bq.CAST_AUDIO:case f.bq.CAST_VIDEO:case f.bq.GAME_CONSOLE:case f.bq.SPEAKER:case f.bq.STB:case f.bq.TV:return!0;default:return!1}};var Be=i(11810),Re=i(59020),Le=i(58337);const Oe=new Date(0).toISOString(),_e=["shift+alt+f10"],Fe=e=>{const t=(0,n.useRef)(),i=(0,n.useRef)(!1),a=(0,n.useRef)(!1),o=(0,r.Pj)(),s=(0,Ae.z)(),c=(0,fe.Z)(),l=(0,Re.V)(),[u,m]=(0,Le.x)("connect-nudge-triggered-at",Oe),g=(0,n.useRef)(null),{spec:p,logger:v}=(0,I.r)(Ce.w,{}),y=(0,n.useCallback)((()=>{v.logInteraction(p.connectFromDevicePickerNudgeFactory().hitNoAction())}),[p,v]),b=(0,n.useCallback)((()=>{v.logInteraction(p.connectFromDevicePickerNudgeFactory().closeButtonFactory().hitUiHide())}),[p,v]),h=(0,n.useCallback)((e=>{e&&g.current!==e&&v.logImpression(p.connectFromDevicePickerNudgeFactory().impression()),g.current=e}),[p,v]);(0,Be.f)(_e,(async()=>{const{platform:{isDeveloperMode:e}}=o.getState();if(e){const e=new Date;e.setHours(e.getHours()-8),m(e.toISOString())}}));const k=(0,n.useCallback)((()=>{const e=s.getState(),t=c.getActiveDevice(),i=c.getDevices(),n=l.getDefaultDevice(),a=new Date(u);a.setHours(a.getHours()+8);return a<=new Date&&(e=>e?.isLocal??!1)(t)&&!(0,we.A3)(e)&&(e=>e.some((e=>e.isLocalNetwork&&!e.isDisabled&&Ee(e))))(i)&&(e=>!e||!(e.terminalType===Te.FI.HEADPHONES||e.terminalType===Te.FI.SPEAKERS&&(e.transportType===Te.Yg.BLUETOOTH||e.transportType===Te.Yg.USB)))(n)}),[s,l,u,c]),x=(0,n.useCallback)((()=>{if(k()){e({nudgeType:"message-only-nudge",message:d.Ru.get("web-player.connect.nudge.listen-to-speaker"),impressionCallback:h,onClick:y,onClose:b});const t=(new Date).toISOString();m(t)}}),[e,k,m,y,b,h]),C=(0,n.useCallback)((e=>{e.data.action===je.Ik.PLAY?i.current=!0:e.data.action===je.Ik.RESUME&&(a.current=!0)}),[]);(0,Se.p)(je.gd.ACTION,C);const N=(0,n.useCallback)((e=>{i.current&&(0,we.uW)(e.data)===Pe.i.PLAYING?(t.current=e.data?.context.uri,x(),t.current=void 0,i.current=!1):a.current&&!1===e.data?.isPaused&&(t.current=e.data?.context.uri,x(),t.current=void 0,a.current=!1)}),[x]);(0,Se.p)(je.gd.UPDATE,N)},Ue=e=>{Fe(e),De(e)},Me=()=>{const e=(0,n.useRef)(),t=(0,n.useRef)(!1),i=(0,n.useRef)(!1),a=(0,r.wA)(),o=(0,r.d4)((e=>e.ui.connectNudge.isOpen)),s=(0,r.d4)((e=>e.ui.connectDevicePicker.isOpen)),c=(0,n.useCallback)((()=>{i.current&&(clearTimeout(e.current),i.current=!1),a((0,J.Yp)())}),[a]),l=(0,n.useCallback)((()=>{i.current=!1,t.current||c()}),[c]),u=(0,n.useCallback)((()=>{e.current=window.setTimeout(l,8e3),a((0,J.dK)()),i.current=!0}),[a,l]),d=(0,n.useCallback)((e=>{t.current=e,e||i.current||c()}),[c]);return(0,n.useEffect)((()=>{s&&c()}),[s,c]),(0,n.useMemo)((()=>({hideNudge:c,showNudge:u,setShouldKeepShowingNudge:d,isNudgeVisible:o})),[c,u,d,o])},ze=({children:e,useNudgeTriggers:t=Ue,useToggleNudgeWithTimer:i=Me,useCanShowNudge:a=xe,disabled:o=!1})=>{const{showNudge:r,hideNudge:s,setShouldKeepShowingNudge:c,isNudgeVisible:l}=i(),[u,d]=(0,n.useState)(null),m=a();(0,n.useEffect)((()=>{l&&!m&&s()}),[m,s,l]),t((e=>!(l||!m)&&(d(e),r(),!0)));const g=(0,n.useCallback)((e=>{if(!e)return(0,v.jsx)(v.Fragment,{});return(0,v.jsx)(be,{onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),...e,onClose:()=>{e?.onClose?.(),s()}})}),[s,c]);return(0,v.jsx)(me.W,{placement:"top",visible:Boolean(u?.message)&&l&&!o,overlay:g(u),popperOptions:{modifiers:[{name:"preventOverflow",options:{rootBoundary:"viewport",altAxis:!0,padding:24,tether:!1}}]},onHide:()=>{},fadeOut:!0,useLazyMounting:!0,children:e})};var Ve=i(52057),Ge=i(58176),Qe=i(93);const Ke=()=>{const{remoteDeviceType:e,remoteDeviceIsGroup:t,connectionStatus:i}=(0,E.v)((e=>{const t=(0,T.V)(e);return{remoteDeviceType:t.remoteDevice?.type,remoteDeviceIsGroup:t.remoteDevice?.isGroup,connectionStatus:t.connectionStatus}}),R.a),a=(0,ue.g)(),{isActive:o}=(0,Ve.AI)(Ge.Z.DevicePickerOverlay),{canTogglePanel:r,isActive:s,togglePanel:c}=(0,de.C)(),{spec:l,logger:u}=(0,I.r)(le.p,{}),m=(0,n.useCallback)((()=>{const{interactionId:e}=u.logInteraction(function(e,t,i){return {interactionId:null,pageInstanceId:null};let n;return n=t===f.zP.CONNECTING?e.connectingButtonFactory():t===f.zP.CONNECTED?e.connectedButtonFactory():e.notConnectedButtonFactory(),i?n.hitUiHide():n.hitUiReveal()}(l,i,s));c(e)}),[i,c,s,l,u]),{currentDevice:g}=(0,Qe.l)(),{isLocal:p}=g,y=(0,n.useMemo)((()=>(0,N.tf)(e,t,p?a:null)),[a,p,t,e]);return(0,v.jsx)(ze,{children:(0,v.jsx)(te.f,{isActive:s,disabled:!r,onToggle:m,label:d.Ru.get("playback-control.connect-picker"),icon:y,restoreFocusKey:o?Ge.Z.DevicePickerOverlay:Ge.Z.DevicePicker})})};var He=i(67508),We=i(31876),Ye=i(44544),qe=i(14165);const Ze=We.$S.PUFFIN_BUTTON_CLICK,Xe=We.$S.DEVICE_PICKER_BUTTON_CLICK,Je=()=>{const{isPuffinPanelActive:e}=(0,qe.c)(),{isActive:t,panelSend:i}=(0,Ve.AI)(Ge.Z.DevicePicker,Ge.Z.DevicePickerOverlay),a=(0,Ve.Ev)(Ze),{remoteDeviceType:o,remoteDeviceisGroup:r}=(0,E.v)((e=>{const t=(0,T.V)(e);return{remoteDeviceType:t.remoteDevice?.type,remoteDeviceisGroup:t.remoteDevice?.isGroup}}),R.a),s=(0,ue.g)(),c=s?.audioDevice.terminalType===Te.FI.HEADPHONES,l=(0,Ye.K)(),u=t||e,m=l||c,{currentDevice:g}=(0,Qe.l)(),{isLocal:p}=g,y=(0,n.useMemo)((()=>l?He.C:(0,N.tf)(o,r,p?s:null)),[s,l,r,o,p]);return(0,v.jsx)(te.f,{isActive:u,isActiveNoIndicator:m,onToggle:()=>{const e=t;i(Xe),e||(0,x.I)("DEVICE-PICKER")},label:d.Ru.get("playback-control.connect-picker"),icon:y,disabled:!a,restoreFocusKey:e?Ge.Z.Puffin:Ge.Z.DevicePicker})};var $e=i(95896);const et=()=>{const{isAnonymous:e}=(0,r.d4)(K.Ht),t=(0,$e.v)();return e?null:t?(0,v.jsx)(n.Suspense,{fallback:null,children:(0,v.jsx)(Je,{})}):(0,v.jsx)(Ke,{})};var tt=i(94435),it=i(83246),nt=i(76082),at=i(34541),ot=i(99845),rt=i(18177);const st=n.memo((({onClick:e,className:t,isActive:i,isEnabled:n})=>{const a=n?d.Ru.get("web-player.lyrics.title"):d.Ru.get("web-player.lyrics.noLyrics1"),o=n?e:void 0;return(0,v.jsx)(te.f,{className:t,isActive:i,onToggle:o,disabled:!n,label:a,testId:"lyrics-button",icon:it.q})})),ct=n.memo((e=>{const t=Boolean((0,rt.J)().data?.hasLyrics);return(0,v.jsx)(st,{...e,isEnabled:t,isActive:!1})})),lt=n.memo((e=>{const t=(0,W.o)((e=>e?.item?.uri)),i=Boolean((0,ot.f)(t).hasLyrics);return(0,v.jsx)(st,{...e,isEnabled:i,isActive:!1})})),ut=n.memo((e=>{const t=(0,V.S)(),{currentVariant:i}=(0,G.r)(),{isActiveNotCinemaMode:n}=(0,at.$)(),{isAnonymous:a}=(0,r.d4)(K.Ht),o=(0,q.NC)(oe.khs),s=(0,W.o)((e=>{if(e?.item?.uri&&(0,nt.U_m)(e?.item?.uri)){return!Boolean(e?.item?.metadata?.["segment.index"])}return!1}));if(a||!s)return null;const c=t===M.z.NOW_PLAYING_VIEW&&"lyrics"===i,l=n||c;return l?(0,v.jsx)(st,{...e,isActive:l,isEnabled:!0}):o?(0,v.jsx)(ct,{...e}):(0,v.jsx)(lt,{...e})}));var dt=i(92176);const mt=({onClick:e,className:t})=>{const i=(0,V.S)(),{currentVariant:n,previousVariant:a}=(0,G.r)(),o=(0,tt.F)(),{toggleLyrics:r}=(0,dt.A)({onChange:e,referrer:"now_playing_bar"}),s=i===M.z.NOW_PLAYING_VIEW;return(0,v.jsx)(ut,{onClick:s?()=>{o("lyrics"===n?a??"artwork":"lyrics")}:r,className:t})};var gt=i(3975);const pt=We.$S.NPV_BUTTON_CLICK,vt=({onClick:e})=>{const{isActive:t,panelSend:i}=(0,Ve.AI)(Ge.Z.NowPlayingView),n=(0,Ve.Ev)(pt),{mode:a,setMode:o}=(0,Q.r)(),r=(0,q.NC)(oe.ZDY),s=(0,V.S)(),c=(0,z.l)(),{item:l}=(0,W.o)((e=>({item:e?.item})),((e,t)=>e.item?.uri===t.item?.uri)),u=!l||!n,m=s===M.z.NOW_PLAYING_VIEW;if(r)return null;const g=t&&!m;return(0,v.jsx)(te.f,{isActive:g,disabled:u,onToggle:()=>{e?.(!t),m?((0,x.I)("NPV_OPEN_CINEMA_MODE_BUTTON"),c(M.z.CLOSED),t||i(pt)):i(pt),a===H.YU.cinema&&o(H.YU.npv)},icon:gt.d,label:d.Ru.get("web-player.now-playing-view.label"),testId:"control-button-npv",restoreFocusKey:Ge.Z.NowPlayingView})};var yt=i(81181),bt=i(94767),ht=i(29415),kt=i(63663),xt=i(20924),Ct=i(31236),Nt=i(53382);const ft=({uri:e,to:t,children:i,onDrop:a,onNavigate:o,className:s})=>{const[c,l]=(0,n.useState)(!1),u=(0,n.useRef)(null),d=(0,xt.g)(),m=(0,r.wA)(),g=(0,Ct.f)(),p=(0,Nt.g)(),y=(0,Ae.z)(),b=function(e){const t=(0,nt.o_h)(e),i=(0,r.d4)(K.F6);switch(t?.type){case nt.NQG.PLAYLIST:case nt.NQG.PLAYLIST_V2:{let e;if((0,nt.iwx)(t)&&(e=t.username),i&&e===i)return[kt.Ay[nt.NQG.TRACK],kt.Ay[nt.NQG.LOCAL],kt.Ay[nt.NQG.ALBUM]];break}case nt.NQG.COLLECTION:return[kt.Ay[nt.NQG.TRACK],kt.Ay[nt.NQG.ALBUM],kt.Ay[nt.NQG.ARTIST],kt.Ay[nt.NQG.PLAYLIST],kt.Ay[nt.NQG.PLAYLIST_V2],kt.Ay[nt.NQG.SHOW]];case nt.NQG.QUEUE:return[kt.Ay[nt.NQG.TRACK],kt.Ay[nt.NQG.LOCAL],kt.Ay[nt.NQG.EPISODE]];default:return[]}return[]}(e),h=!!b.length;return(0,n.useEffect)((()=>(c?u.current=window.setTimeout((()=>{(0,nt.U_m)(e)||(o?.(),d(t||(0,nt.o_h)(e).toURLPath(!0)))}),1e3):!c&&u.current&&clearTimeout(u.current),()=>{u.current&&clearTimeout(u.current)})),[c,e,t,o,d]),h?(0,v.jsx)(ht.A,{types:b,onDrop:t=>{const i=(0,nt.o_h)(e),n=Array.from(t.dataTransfer.types).find((e=>b.includes(e))),o=n&&t.dataTransfer.getData(n),r=o&&o.split("\n")[0],s=(0,nt.o_h)(r);if(s&&i)switch(a?.(s.toURI()),i.type){case nt.NQG.PLAYLIST:case nt.NQG.PLAYLIST_V2:m((0,bt.io)(e,[s.toURI()]));break;case nt.NQG.COLLECTION:(0,nt._Tv)(s)||(0,nt.ecE)(s)||(0,nt.U_m)(s)?g.add({uris:[s.toURI()]}):(0,nt.tbX)(s)?p.add([s.toURI()],{before:"start"}):(0,nt.WB1)(s)&&g.add({uris:[s.toURI()]});break;case nt.NQG.QUEUE:y.addToQueue([{uri:s.toURI(),uid:null}])}},onDragEnter:()=>{l(!0)},onDragLeave:()=>{l(!1)},className:s,children:i}):(0,v.jsx)("div",{children:i})};var It=i(8778),jt=i(31925),At=i(87033);const St=We.$S.QUEUE_BUTTON_CLICK,Pt=({onClick:e})=>{const{isEnabled:t,isVisible:i}=(()=>{const{isAnonymous:e}=(0,r.d4)(K.Ht),{videoPlayerMode:t}=(0,jt.d)();return e||t===At.Kz.cinemaLegacy?{isVisible:!1}:{isVisible:!0,isEnabled:!0}})(),a=(0,Ve.Ev)(St),{isActive:o}=(0,Ve.AI)(Ge.Z.Queue,Ge.Z.QueueOverlay),{toggleQueue:s}=(0,It.R)(),c=(0,n.useCallback)((()=>{t&&(e({mode:"panel",aboutToShow:!o}),s())}),[t,e,o,s]);return i?(0,v.jsx)(ft,{uri:"spotify:queue",children:(0,v.jsx)(te.f,{icon:yt.j,label:d.Ru.get("playback-control.queue"),onToggle:c,isActive:o,disabled:!t||!a,testId:"control-button-queue",restoreFocusKey:Ge.Z.Queue})}):null};var wt=i(71013),Dt=i(8585),Tt=i(34613);const Et=({onClick:e})=>{const{item:t}=(0,Dt.L)()??{},{isActive:i,onClick:n,showButton:a}=(0,Tt.D)({item:t,onClick:e});return t&&a?(0,v.jsx)(te.f,{isActive:i,onToggle:n,label:i?d.Ru.get("miniplayer.close"):d.Ru.get("miniplayer.open"),icon:wt.F,testId:"pip-toggle-button"}):null};var Bt=i(81199),Rt=i(74885);const Lt="main-nowPlayingBar-extraControls",Ot="main-nowPlayingBar-lyricsButton",_t="main-nowPlayingBar-volumeBar",Ft=()=>{const e=(0,q.NC)(oe.L$q),{setVideoPlayerUIFlag:t,videoPlayerMode:i}=(0,jt.d)(),{spec:a,logger:o,UBIFragment:r}=(0,I.r)(Z.h9,{data:{identifier:i===At.Kz.cinemaLegacy?Z.gw.CINEMA:Z.gw.DESKTOP}}),s=(0,Y.YQ)((e=>{o.logInteraction(a.volumeBarFactory().dragSetVolume({newVolumePercentage:Math.floor(100*e)}))}),500,{leading:!1,trailing:!0}),c=(0,n.useCallback)((e=>{e&&t(At.nP.cinemaLegacy,!1)}),[t]);return(0,v.jsx)(r,{spec:a,children:(0,v.jsxs)("div",{className:Lt,children:[(0,v.jsx)(Rt.mA,{onClick:()=>{o.logInteraction(a.djJumpButtonFactory().hitRefreshContent())}}),(0,v.jsx)(vt,{onClick:e=>{e?o.logInteraction(a.npvButtonFactory().hitUiReveal()):o.logInteraction(a.npvButtonFactory().hitUiHide())}}),e===oe.vkU.CONTROL&&(0,v.jsx)(mt,{className:Ot,onClick:e=>{e?o.logInteraction(a.lyricsButtonFactory().hitUiNavigate({destination:e})):o.logInteraction(a.lyricsButtonFactory().hitUiNavigateBack())}}),(0,v.jsx)(Pt,{onClick:e=>{"main"===e.mode?e.route?o.logInteraction(a.queueButtonFactory().hitUiNavigate({destination:e.route})):o.logInteraction(a.queueButtonFactory().hitUiNavigateBack()):e.aboutToShow?o.logInteraction(a.queueButtonFactory().hitUiReveal()):o.logInteraction(a.queueButtonFactory().hitUiHide())}}),(0,v.jsx)(et,{}),(0,v.jsx)(Bt.M,{className:_t,onVolumeBarClick:e=>{o.logInteraction(a.volumeBarFactory().hitSetVolume({newVolumePercentage:Math.floor(100*e)}))},onToggleMuteClick:e=>{"muted"===e?o.logInteraction(a.volumeMuteButtonFactory().hitMutePlayback()):"not_muted"===e&&o.logInteraction(a.volumeMuteButtonFactory().hitUnmutePlayback())},onVolumeBarDrag:s}),(0,v.jsx)(Et,{onClick:c}),(0,v.jsx)(ce,{className:"control-button",disabledClassName:"control-button--disabled",onClick:e=>{e&&o.logInteraction(a.fullscreenButtonFactory().hitUiReveal())}})]})})};var Ut=i(39708),Mt=i(23353),zt=i(69479);const Vt="yyrJTUPMeLS8qs1a0YJr",Gt=({logoUrl:e})=>e?(0,v.jsx)("div",{className:Vt,"data-testid":"context-ad-logo",children:(0,v.jsx)(Mt.N,{loading:"eager",imgSrc:e,width:56,height:56,type:zt.c.AD})}):null;var Qt=i(78008),Kt=i(21e3),Ht=i(30626);const Wt=({item:e,context:t,index:i})=>{const{logoImage:n}=(0,Qt.b)(e);return(0,v.jsx)(Ht.e,{item:e,context:t,index:i,"aria-label":d.Ru.get("ad-formats.advertisement"),adEventReason:Kt.c.AD_LOGO,isVisible:!1,children:(0,v.jsx)(Gt,{logoUrl:n})})};var Yt=i(86994),qt=i(1997),Zt=i(73737);const Xt=n.memo((function({uri:e,className:t,onClick:i,size:a=Yt.t.xs}){const[o,r]=(0,Zt.A)(e),s=(0,qt.W)(),c=(0,n.useCallback)((t=>{t.preventDefault(),s({targetUri:e,intent:o?"remove-from-library":"add-to-library",type:"click"}),i&&i(!o),r(!o)}),[s,e,o,i,r]);return(0,v.jsx)(Yt.M,{className:t,size:a,onClick:c,isAdded:!!o,condensed:!0})}));var Jt=i(67954),$t=i(28356),ei=i(47425);const ti=({uri:e,isBook:t=!1,size:i=Yt.t.xs,className:a,onClick:o})=>{const{isPreSaved:r,addPresave:s,removePresave:c}=(0,ei.w)({uri:e,isBook:t}),l=(0,n.useCallback)((()=>{r?c():s(),o?.(!r)}),[r,o,c,s]);return(0,v.jsx)(Yt.M,{className:a,size:i,onClick:l,isAdded:!!r,condensed:!0})};var ii=i(38976),ni=i(6550),ai=i(48286),oi=i(58200),ri=i(42738),si=i(11057),ci=i(9997),li=i(45755),ui=i(14575),di=i(94287),mi=i(87977);function gi(e){return(0,mi.v)(e)||(0,di.p)(e)}const pi=We.$S.NPV_BUTTON_CLICK,vi=()=>{const e=(0,z.l)(),t=(0,q.NC)(oe.mzn),i=(0,q.NC)(oe.wZE),a=(0,V.S)(),o=(0,Ve._Y)();return(0,n.useCallback)((()=>{t?a===M.z.CLOSED?i?e(M.z.NOW_PLAYING_VIEW):o(pi):e(M.z.CLOSED):o(pi)}),[i,a,t,o,e])};var yi=i(85222),bi=i(29398),hi=i(97485);const ki="main-nowPlayingWidget-nowPlaying",xi="ZbFkATBbLkWh2SHMXDt6",Ci="main-coverSlotCollapsed-navAltContainer",Ni="main-nowPlayingWidget-coverArt",fi="main-nowPlayingWidget-trackInfo",Ii="HD9s7U5E1RLSWKpXmrqx",ji=({spec:e})=>{const t=(0,hi.s)(),i=(0,Dt.L)(),{draggable:a,onDragStart:o}=(0,bi.P)(),r=(0,V.S)(),{isActive:s}=(0,Ve.AI)(Ge.Z.NowPlayingView),c=(0,q.NC)(oe.mzn),l=vi(),{images:u}=(0,yi.u)(i?.item),m=c?r===M.z.NOW_PLAYING_VIEW:s,g=(0,n.useCallback)((()=>{l();const i=m?e.hitUiHide():e.hitUiReveal();t.logInteraction(i)}),[m,t,e,l]);if(null===i)return null;const{context:p,item:y}=i;return(0,v.jsx)(ri.h,{menu:(0,v.jsx)(ci.W,{context:p,item:y}),children:(0,v.jsx)("div",{draggable:a&&gi(y),onDragStart:e=>{o(e,{itemUris:[y.uri],dragLabelText:(0,ui.r)(y)})},children:(0,v.jsx)(li.R,{uri:p.uri,owner:p.metadata?.context_owner,children:(0,v.jsx)("button",{type:"button","data-testid":"cover-art-button",className:Ii,"aria-label":d.Ru.get("web-player.now-playing-view.label"),onClick:g,children:(0,v.jsx)(si.b,{images:u,type:y.type,size:56,maxSize:56,className:Ni})})})})})};var Ai=i(7162),Si=i(68761),Pi=i(50074),wi=i(21349);const Di="main-coverSlotCollapsed-container",Ti="main-coverSlotCollapsed-expandButton",Ei=We.$S.NPV_BUTTON_CLICK,Bi=({children:e,className:t,spec:i})=>{const a=(0,hi.s)(),r=(0,Ve.Ev)(Ei),s=(0,V.S)(),{isActive:c}=(0,Ve.AI)(Ge.Z.NowPlayingView),l=(0,q.NC)(oe.mzn),u=(0,q.NC)(oe.wZE),m=vi(),g=(0,n.useMemo)((()=>{if(l&&u){const e=s===M.z.NOW_PLAYING_VIEW;return{label:e?d.Ru.get("web-player.cinema-mode.minimize"):d.Ru.get("web-player.now-playing-view.cinema-mode.expand"),Icon:e?Ai.b:X.L,isActive:e,isDisabled:!1}}return{label:c?d.Ru.get("npb.collapseCoverArt"):d.Ru.get("npb.expandCoverArt"),Icon:c?Si.r:Pi.o,isActive:c,isDisabled:!r}}),[u,r,s,l,c]),p=(0,n.useCallback)((()=>{m();const e=i.coverartArrowFactory(),t=g.isActive?e.hitUiHide():e.hitUiReveal();a.logInteraction(t)}),[a,i,g.isActive,m]);return(0,v.jsxs)("div",{"data-testid":"CoverSlotCollapsed__container",className:o()(Di,t),children:[e,(0,v.jsx)(wi.Zp,{label:g.label,children:(0,v.jsx)("button",{className:o()(Ti),disabled:g.isDisabled,onClick:p,"aria-label":g.label,"aria-pressed":g.isActive,children:(0,v.jsx)(g.Icon,{iconSize:16})})})]})};var Ri=i(90269),Li=i(58863),Oi=i(68388);var _i=i(31352),Fi=i(89429),Ui=i(89945),Mi=i(56189),zi=i(15823),Vi=i(26249),Gi=i(86851),Qi=i(99983);const Ki=({context:e,item:t,onLike:i})=>{const n=(0,Ui.X)(),a=(0,ni.v)(t);if(n&&(0,Fi.N)(t))return(0,v.jsx)(_i.o,{contextUri:t.metadata?.context_uri??e.uri,id:t.uid??void 0,uri:t.uri,isActive:!0});if(a)return(0,v.jsx)(ii.g,{uri:t.uri,condensed:!0});if((0,mi.v)(t))return t.isLocal?null:(0,v.jsx)($t.b,{uri:t.uri,className:"control-button control-button-heart",onClick:i});if((0,di.p)(t))return(0,v.jsx)(Jt.b,{condensed:!0,uri:t.uri,className:"control-button control-button-heart",onClick:i});if((0,zi.d)(t)){return"trailer"===t?.metadata?.type&&"true"===t?.metadata?.is_pre_release?(0,v.jsx)(ti,{uri:t.book.uri,isBook:!0,className:"control-button control-button-heart",onClick:i}):(0,v.jsx)(Xt,{uri:t.book.uri,className:"control-button control-button-heart",onClick:i})}return(0,Mi.N)(t)||(0,Vi.v)(t)?null:(0,Qi.d)(t)},Hi=({state:{item:e,context:t,index:i}})=>{!function(e){const t=(0,Oi.i)(),i=(0,Li.X)(e);(0,n.useEffect)((()=>{i&&t.say(i)}),[i,t])}(e);const{videoPlayerMode:a,setVideoPlayerUIFlag:o}=(0,jt.d)(),{spec:r,logger:s}=(0,I.r)(Ut.p6,{data:{identifier:a===At.Kz.cinemaLegacy?Ut.gw.CINEMA:Ut.gw.DESKTOP}}),c=(0,Li.P)(e),l=(0,q.NC)(oe.WAA);(0,n.useEffect)((()=>{o(At.nP.nowPlayingBar,l)}),[l,o]);const u=a===At.Kz.nowPlayingBar&&l,d=(0,n.useMemo)((()=>r.coverartFactory({uri:e.uri})),[e.uri,r]);return(0,v.jsx)(n.Suspense,{fallback:null,children:(0,v.jsx)("div",{"data-testid":"now-playing-widget",className:ki,role:"contentinfo","aria-label":c,children:(0,v.jsxs)(Gi.r,{spec:r,children:[(0,Mi.N)(e)?(0,v.jsx)(Wt,{item:e,context:t,index:i}):(0,v.jsxs)(Bi,{className:Ci,spec:d,children:[!u&&(0,v.jsx)(ji,{spec:d}),l&&(0,v.jsx)("div",{id:"VideoPlayerNpb_ReactPortal"})]}),(0,v.jsx)(ai.d,{context:t,className:fi,item:e,size:"xsmall",enableVideoButton:!0,onTitleClick:t=>{s.logInteraction(r.titleFactory({uri:e.uri}).hitUiNavigate({destination:t||""}))},onSubtitleClick:t=>{s.logInteraction(r.subtitleFactory({uri:e.uri}).hitUiNavigate({destination:t||""}))},referrer:oi.G.NPB}),(0,v.jsxs)("div",{className:xi,children:[(0,v.jsx)(Ri.a,{context:t,item:e,onClick:()=>{s.logInteraction(r.hideButtonFactory().hitRemoveRecommendation({recommendedItemUri:e.uri,contextUri:t.uri}))}}),(0,v.jsx)(Ki,{item:e,onLike:t=>{s.logInteraction(t?r.likeButtonFactory({uri:e.uri}).hitLike({itemToBeLiked:e.uri}):r.likeButtonFactory({uri:e.uri}).hitRemoveLike({itemNoLongerLiked:e.uri}))},context:t})]})]})})})},Wi=()=>{const e=(0,Dt.L)();return null===e?(0,v.jsx)("div",{className:o()("now-playing")}):(0,v.jsx)(Hi,{state:e})};var Yi=i(76066);const qi="aguQsGoZR9wZeawKGdDh",Zi="ieqOSqJb6kk3bG5XDOHk",Xi=({paused:e,fromSeconds:t})=>{const[i,a]=(0,n.useState)(t);return(0,Yi.$)((t=>{a((i=>e?i:i>0?i-1:(t(),i)))}),1e3),(0,v.jsxs)("div",{className:qi,children:[d.Ru.get("ad-formats.skippable_ads.skip_countdown"),(0,v.jsx)("span",{className:Zi,children:i})]})};var Ji=i(91335);const $i=({children:e})=>{const t=(0,W.o)((e=>e),((e,t)=>(0,R.a)(e?.restrictions,t?.restrictions)&&e?.item?.uri===t?.item?.uri&&e?.isPaused===t?.isPaused)),i=t?.restrictions.disallowSkippingNextReasons.includes("ad_disallow"),n=t?.isPaused??!1,a=(0,Ji.qc)(t),o=(0,Ji.Tv)(t),s=(0,r.d4)((e=>a?e?.ads?.audio?.info?.skippableAdDelaySeconds:o?e?.ads?.vto?.info?.skippableAdDelaySeconds:void 0));return i&&s?(0,v.jsx)(Xi,{paused:!!n,fromSeconds:s}):(0,v.jsx)(v.Fragment,{children:e})};var en=i(90238),tn=i(1916);var nn=i(19157),an=i(30767);const on=e=>{const[t,i]=(0,n.useState)(new Map),[a,o]=(0,n.useState)(),r=(0,nn.L)(),s=(0,tn.mr)(),{currentDevice:c}=(0,Qe.l)(),l=(0,an.vh)(),u=(0,n.useCallback)((()=>{if(!e)return;const n=(({lastRecordedItem:e,setLastRecordedItem:t,recentAds:i,setRecentAds:n,playerStateItem:a,currentDevice:o})=>{let r={isMissingAdData:!1};if(a&&a.uri!==e?.uri){if(e?.type===zt.c.AD){const t=e?.uri.split(":")[2];i.has(t)?n((e=>{const i=new Map(e);return i.delete(t),i})):r={isMissingAdData:!0,errorMessage:o.isLocal?"primary_device":"secondary_device",adId:t}}t((()=>a))}return r})({lastRecordedItem:a,setLastRecordedItem:o,recentAds:t,setRecentAds:i,playerStateItem:r?.item,currentDevice:c});if(n.isMissingAdData){const{errorMessage:e,adId:t}=n;l.send((0,en.G)({error_type:"missing_ad_data",error_message:e,slot:"stream",ad_id:t}))}}),[r,a,t,l,c,e]),d=(0,n.useCallback)((()=>{e&&s&&i((e=>{let i=e;return t.has(s.adId)||(i=new Map(e).set(s.adId,s)),i}))}),[t,s,e]);(0,n.useEffect)((()=>{u()}),[u]),(0,n.useEffect)((()=>{d()}),[d])};var rn=i(40267),sn=i(14655),cn=i(71791),ln=i(98019),un=i(19175),dn=i(76297),mn=i(10627),gn=i(96915),pn=i(66655),vn=i(45093);const yn="player-controls",bn="player-controls__buttons",hn="player-controls__left",kn="player-controls__right",xn=(0,n.memo)((function({item:e}){const t=ln.Q.isPodcastAd(e),i=ln.Q.isSurveyAd(e);return(0,v.jsxs)("div",{"data-testid":"ad-controls",className:bn,children:[(0,v.jsxs)("div",{className:hn,children:[t&&(0,v.jsx)(vn.w,{}),(0,v.jsx)(cn.T,{item:e,isDisabled:i}),t?(0,v.jsx)(dn.h,{}):(0,v.jsx)(gn.d,{})]}),(0,v.jsx)(un.x,{}),(0,v.jsxs)("div",{className:kn,children:[t?(0,v.jsx)(mn.v,{}):(0,v.jsx)($i,{children:(0,v.jsx)(pn.$,{})}),(0,v.jsx)(sn.t,{item:e,isDisabled:i})]})]})}));var Cn=i(52286),Nn=i(63722),fn=i(82489),In=i(26145),jn=i(93345),An=i(32576);var Sn=i(36517),Pn=i(8454),wn=i(67847);const Dn="JbGNL7qsnWz6EP_3hGvf",Tn="mkROcxw9LM6F2uuwQYjN",En=e=>{const{className:t,...i}=e;return(0,v.jsx)("span",{className:Tn,children:(0,v.jsx)(wn.x,{className:o()(t),...i})})};var Bn=i(55046),Rn=i(46470),Ln=i(75332),On=i(50085),_n=i(20513),Fn=i(91538),Un=i(34958);const Mn=function({setSleepTimer:e,state:t}){const i=t.type===_n.k.Off?On.X:On.X.concat(_n.k.Off);return(0,v.jsxs)(Bn.W,{children:[(0,v.jsx)(Rn.y,{children:d.Ru.get("web-player.sleep-timer.player-controls.popover.title")}),(0,v.jsx)("div",{children:i.map((i=>(0,v.jsx)(Ln.D,{onClick:()=>{e(i)},"data-testid":`playback-sleep-timer-option-${i}`,role:"menuitemradio","aria-label":`${i}`,"aria-checked":t.type===i,children:t.type===i?(0,Un.J)(i,t.endsAt,zt.c.EPISODE):(0,Fn.p)(i,zt.c.EPISODE)},i)))})]})};var zn=i(16467);const Vn=e=>e-Date.now(),Gn=({endsAt:e})=>{const[t,i]=(0,n.useState)(Vn(e));return(0,n.useEffect)((()=>{i(Vn(e));const t=setInterval((()=>{i(Vn(e))}),1e3);return()=>{clearInterval(t)}}),[e]),(0,v.jsx)(l.E,{variant:"marginal",semanticColor:"textBrightAccent",children:(0,zn.f)(t)})};var Qn=i(62348);const Kn=({onClick:e})=>{const t=(0,q.NC)(oe.GhO),[i,n]=(0,Qn.y)(),a=i.type!==_n.k.Off,{endsAt:o}=i;return t?(0,v.jsx)(Pn.t,{placement:"top-start",menu:(0,v.jsx)(Mn,{state:i,setSleepTimer:t=>{n(t),e?.(t)}}),children:(e,t,i)=>(0,v.jsx)(wi.Zp,{label:d.Ru.get("web-player.sleep-timer.player-controls.button.tooltip"),children:(0,v.jsx)(ge.H,{ref:i,className:Dn,iconLeading:a?En:Sn.l,size:"small",onClick:t,role:"checkbox","aria-label":d.Ru.get("web-player.sleep-timer.player-controls.button.tooltip"),"data-testid":"control-button-sleep-timer","aria-checked":a,semanticColor:a?"textBrightAccent":void 0,children:a&&o&&(0,v.jsx)(Gn,{endsAt:o})})})}):null};var Hn=i(92763),Wn=i(84155);const Yn=(0,n.memo)((function({isPreview:e}){const{logChangePlaybackSpeed:t,logChangeRepeatMode:i,logChangeShuffleMode:a,logSeekForward:o,logSeekBack:r,logSkipForward:s,logSkipBack:c,logPlayPause:l,logProgressChanged:u,spec:m}=(()=>{const e=(0,Ae.z)(),{videoPlayerMode:t}=(0,jt.d)(),{spec:i,logger:a}=(0,I.r)(In.kD,{data:{identifier:t===At.Kz.cinemaLegacy?In.gw.CINEMA:In.gw.DESKTOP}});return{logChangePlaybackSpeed:(0,n.useCallback)((t=>{const n=e.getState();n?.item&&a.logInteraction(i.speedControlButtonFactory().hitSetPlaybackSpeed({currentlyPlayedItem:n.item.uri,playbackSpeed:t}))}),[a,e,i]),logChangeShuffleMode:(0,n.useCallback)((e=>{a.logInteraction(e?i.shuffleButtonFactory().hitShuffleEnable():i.shuffleButtonFactory().hitShuffleDisable())}),[a,i]),logChangeRepeatMode:(0,n.useCallback)((e=>{const t={[jn.p.REPEAT_NONE]:i.repeatButtonFactory().hitRepeatDisable(),[jn.p.REPEAT_TRACK]:i.repeatButtonFactory().hitRepeatOneEnable(),[jn.p.REPEAT_CONTEXT]:i.repeatButtonFactory().hitRepeatEnable()};a.logInteraction(t[e])}),[a,i]),logSeekBack:(0,n.useCallback)((e=>{a.logInteraction(i.seekBackButtonFactory().hitSeekByTime({msSeekedOffset:e}))}),[a,i]),logSeekForward:(0,n.useCallback)((e=>{a.logInteraction(i.seekForwardButtonFactory().hitSeekByTime({msSeekedOffset:e}))}),[a,i]),logSkipBack:(0,n.useCallback)((()=>{const t=e.getState();t&&a.logInteraction(i.previousButtonFactory().hitSkipToPrevious({itemToBeSkipped:t.item?.uri||"",positionMs:(0,An.s)(t)??-1,totalContentMs:t.duration??-1}))}),[a,e,i]),logSkipForward:(0,n.useCallback)((()=>{const t=e.getState();t?.item&&a.logInteraction(i.nextButtonFactory().hitSkipToNext({itemToBeSkipped:t.item.uri,positionMs:(0,An.s)(t)??-1,totalContentMs:t.duration??-1}))}),[a,e,i]),logPlayPause:(0,n.useCallback)((t=>{const n=e.getState();n?.item&&("resume"===t?a.logInteraction(i?.playPauseButtonFactory().hitResume({itemToBeResumed:n.item.uri})):"pause"===t&&a.logInteraction(i?.playPauseButtonFactory().hitPause({itemToBePaused:n.item.uri})))}),[a,e,i]),logProgressChanged:(0,n.useCallback)(((e,t)=>{switch(t){case"drag":return a.logInteraction(i.progressBarFactory().dragSeekToTime({msToSeekTo:e}));case"hit":return a.logInteraction(i.progressBarFactory().hitSeekToTime({msToSeekTo:e}));default:return(0,Qi.k)(t)}}),[a,i]),spec:i}})();on((0,q.NC)(oe.KYh));const g=(0,W.o)((e=>e?.item??void 0),((e,t)=>e?.uri===t?.uri)),p=(0,fn.p)();return(0,v.jsx)("div",{className:yn,"data-testid":"player-controls",dir:"ltr","aria-label":d.Ru.get("playback-control.a11y.landmark-label"),children:(0,v.jsxs)(Gi.r,{spec:m,children:[(0,Mi.N)(g)?(0,v.jsx)(xn,{item:g}):(0,v.jsxs)("div",{className:bn,"data-testid":"general-controls",children:[(0,v.jsxs)("div",{className:hn,children:[p?(0,v.jsx)(vn.w,{onClick:t}):(0,v.jsx)(Wn.w,{renderEnabled:()=>(0,v.jsx)(Hn.a,{size:"small"}),renderDisabled:()=>(0,v.jsx)(Nn.u,{onClick:a})}),p&&(0,v.jsx)(dn.h,{onClick:r}),(0,v.jsx)(gn.d,{onClick:c})]}),(0,v.jsx)(un.x,{onClick:l}),(0,v.jsxs)("div",{className:kn,children:[(0,v.jsx)($i,{children:(0,v.jsx)(pn.$,{onClick:s})}),p?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(mn.v,{onClick:o}),(0,v.jsx)(Kn,{})]}):(0,v.jsx)(Cn.s,{onClick:i})]})]}),(0,v.jsx)(rn.x,{isPreview:e,onChange:u})]})})}));var qn=i(18940),Zn=i(84575),Xn=i(56616),Jn=i(11643);const $n="main-nowPlayingBar-container",ea="main-nowPlayingBar-nowPlayingBar",ta="MWD1i_CSJ5N9wRBDpZmX",ia="k3NVrHXkbfflNdAxpT1_",na="m8UPWsNtWbdkvBNvqgBN",aa="aepuRyT82biv_XmkH1eS",oa="main-nowPlayingBar-left",ra="main-nowPlayingBar-center",sa="main-nowPlayingBar-right",ca="K7b2iysmIbvKo8RqRbc5",la="adzMqeRxU0__wQcuju5q",ua=(0,n.memo)((()=>{const{isAnonymous:e}=(0,r.d4)(K.Ht),t=(0,r.wA)(),i=(0,W.o)((e=>e),((e,t)=>e?.hasContext===t?.hasContext&&e?.item?.uri===t?.item?.uri)),a=(0,b.h)();(()=>{const e=(0,r.d4)(K.Yb),{mode:t,setMode:i}=(0,Q.r)(),a=(0,W.o)((e=>e?.item?.uri),((e,t)=>e!==t)),o=(0,V.S)(),s=(0,G.r)(),c=(0,z.l)(),l=o===M.z.NOW_PLAYING_VIEW&&"lyrics"===s.currentVariant;(0,n.useEffect)((()=>{t!==H.YU.none&&e&&t===H.YU.npv&&(i(H.YU.static),l&&c(M.z.CLOSED))}),[e,l,t,c,i,a])})();const l=(0,W.o)((e=>(0,Mi.N)(e?.item??void 0))),u=(0,n.useCallback)((e=>{e.stopPropagation(),t((0,c.Ai)())}),[t]),d=()=>(0,v.jsx)(Zn.ql.Provider,{value:"now_playing_bar",children:(0,v.jsxs)("div",{className:e?ta:ea,children:[(0,v.jsx)("div",{className:oa,children:(0,v.jsx)(Wi,{})}),(0,v.jsx)("div",{className:ra,children:(0,v.jsx)(n.Suspense,{fallback:null,children:(0,v.jsx)(Yn,{isPreview:e})})}),(0,v.jsx)("div",{className:sa,children:(0,v.jsx)(Ft,{})})]})});return(0,v.jsx)(Jn.P,{surface:Xn.u.NOW_PLAYING,children:(0,v.jsx)(qn.pZ,{value:"now-playing-bar",children:(0,v.jsxs)("footer",{className:o()($n,ca,{[la]:a}),"data-testid":"now-playing-bar","data-testadtype":"ad-type-"+(l?"ad":"none"),children:[e?(0,v.jsx)(qn.pZ,{value:"preview-bar",children:(0,v.jsx)(y,{handleClick:u})}):null,e?(0,v.jsx)(s.A,{in:i?.hasContext??!1,timeout:200,classNames:{enter:ia,enterActive:na,enterDone:aa},children:d()}):d(),(0,v.jsx)(U,{})]})})})}))},66911:(e,t,i)=>{i.d(t,{z:()=>a});var n=i(34441);const a=()=>{const{togglePanel:e,isActive:t}=(0,n.C)();return{isPickerOpen:t,triggerRef:{current:null},toggleDevicePicker(t){e(t)}}}},82489:(e,t,i)=>{i.d(t,{p:()=>s});var n=i(26945),a=i(56189),o=i(15823),r=i(94287);function s(){const e=(0,n.o)((e=>e?.item??void 0),((e,t)=>e?.uri===t?.uri));return(0,r.p)(e)||(0,o.d)(e)?"audio"===e.mediaType||"mixed"===e.mediaType:!!(0,a.N)(e)&&e.isPodcastAd}},92176:(e,t,i)=>{i.d(t,{A:()=>l});var n=i(85387),a=i(76082),o=i(34541),r=i(31925),s=i(87033),c=i(49708);function l({referrer:e,onChange:t}){const i=(0,n.Zp)(),{isActive:l,routeDestination:u}=(0,o.$)(),{setVideoPlayerUIFlag:d}=(0,r.d)(),m=(0,c.f)(),g=()=>{l||(d(s.nP.cinemaLegacy,!1),i(u,{state:{referrer:e}}),t?.(u))},p=()=>{if(l){const e=(0,a.o_h)(m.uri)?.toURLPath(!0)??"/";i(e),t?.(null)}};return{isActive:l,showLyrics:g,hideLyrics:p,toggleLyrics:()=>{l?p():g()}}}}}]);
//# sourceMappingURL=dwp-now-playing-bar.js.map