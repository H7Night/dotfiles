"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[319],{2441:(e,t,i)=>{i.d(t,{F:()=>d});var n=i(30758),a=i(53177),s=i(52057),r=i(58176),l=i(31925),o=i(87033);const c="KrBYgWLGb5aRHjoD_prX";var u=i(86070);const d=(0,a.mc)((()=>{const{setVideoPlayerUIFlag:e}=(0,l.d)(),t=(0,s.XB)();return(0,n.useEffect)((()=>(t===r.Z.NowPlayingView&&e(o.nP.npv,!0),()=>{e(o.nP.npv,!1)})),[t,e]),(0,u.jsx)("div",{id:"VideoPlayerNpv_ReactPortal",className:c})}),{name:"NPVVideoContainer"})},5065:(e,t,i)=>{i.d(t,{R:()=>m});var n=i(30758),a=i(16573),s=i(7161);function r(e,t,i=!1){if(!e)return void console.error("No list element found. Canceling moving focus");if(!(0,s.fk)(e))return;const n=e.querySelector('[tabindex="0"]');t===a.O.UP&&(0,s.MS)(n,l(e,n,a.O.UP,i)),t===a.O.DOWN&&(0,s.MS)(n,l(e,n,a.O.DOWN,i)),t===a.O.RIGHT&&(0,s.MS)(n,o(n,a.O.RIGHT,i)),t===a.O.LEFT&&(0,s.MS)(n,o(n,a.O.LEFT,i)),t===a.O.HOME&&(0,s.MS)(n,c(a.O.HOME,i)??n),t===a.O.END&&(0,s.MS)(n,c(a.O.END,i)??n)}function l(e,t,i,n=!1){const r=t.closest('li[role="row"]');if(!r)return t;let l=r;const c=Array.from(e.querySelectorAll('li[role="row"]')),u=Array.from(r.querySelectorAll(s.nu)),d=c.indexOf(r);if(d<0)return t;const p=(n&&t!==u[0]||!n&&t!==r)&&!(t instanceof HTMLLIElement);if(i===a.O.UP){if(document.activeElement===e){l=c[c.length-1];return(n?l.querySelector(s.nu):l)??t}if(p)return o(t,a.O.LEFT,n);let i=d-1;if(-1===i)return t;l=c[i],i-=1}else if(i===a.O.DOWN){if(document.activeElement===e){l=c[0];return(n?l.querySelector(s.nu):l)??t}if(p)return o(t,a.O.RIGHT,n);let i=d+1;if(i===c.length)return t;l=c[i],i+=1}return(n?l.querySelector(s.nu):l)??t}function o(e,t,i=!1){const n=e.closest('li[role="row"]');if(!n)return e;let r=e;const l=Array.from(n.querySelectorAll(s.nu)),o=l.indexOf(e);let c=0;if(t===a.O.RIGHT&&o-1!==l.length)c=o+1;else{if(t===a.O.LEFT&&-1===o)return n;if(t===a.O.LEFT&&0!==o)c=o-1;else if(t===a.O.LEFT&&0===o){return(i?n.querySelector(s.nu):n)??n}}return r=l.at(c),r??e}function c(e,t=!1){const{currentFocus:i,listEl:n}=function(){const e=document.activeElement,t=e?.closest("ul");return((0,a.I)(e)||e instanceof HTMLLIElement)&&t?{currentFocus:e,listEl:t}:{currentFocus:null,listEl:null}}();if(null===i||null===n)return null;const r=i.closest('li[role="row"]');if(!r)return i;const l=Array.from(n.querySelectorAll('li[role="row"]')),o=Array.from(r.querySelectorAll(s.nu));if(l.indexOf(r)<0)return i;const c=t&&i===o[0]||!t&&i===r;if(e===a.O.HOME){if(c){return(t?l[0].querySelector(s.nu):l[0])??i}return(t?o[1]:o[0])??i}if(e===a.O.END){if(c){return(t?l[l.length-1].querySelector(s.nu):l[l.length-1])??i}return o[o.length-1]??i}return i}var u=i(82912),d=i(11202),p=i(86070);const m=(0,n.forwardRef)((({onKeyDown:e,children:t,firstInteractiveIsWrapper:i=!1,...l},o)=>{const c=(0,d.N)(o);(0,u.R)(c);const m=(0,n.useCallback)((t=>{c.current?.contains(t.target)&&("ArrowUp"!==t.key&&"ArrowDown"!==t.key&&"Home"!==t.key&&"End"!==t.key||t.preventDefault(),"ArrowUp"!==t.key&&"ArrowDown"!==t.key||document.documentElement.classList.remove("no-focus-outline"),"ArrowUp"===t.key&&r(c.current,a.O.UP,i),"ArrowDown"===t.key&&r(c.current,a.O.DOWN,i),"ArrowRight"===t.key&&r(c.current,a.O.RIGHT,i),"ArrowLeft"===t.key&&r(c.current,a.O.LEFT,i),"Home"===t.key&&r(c.current,a.O.HOME,i),"End"===t.key&&r(c.current,a.O.END,i),e?.(t))}),[i,c,e]),g=(0,n.useCallback)((e=>{if(!c.current)return;const t=e.target,i=c.current.querySelector('[tabindex="0"]');t.closest('li[role="row"]')&&t!==i&&(0,s.MS)(i,t,{preventScroll:!0})}),[c]);return(0,p.jsx)("ul",{role:"treegrid",ref:c,onKeyDown:m,onFocus:g,tabIndex:0,...l,children:t})}))},5171:(e,t,i)=>{i.d(t,{$:()=>a});var n=i(30758);const a=()=>{const[e,t]=(0,n.useState)(document.hasFocus());return(0,n.useEffect)((()=>{function e(){t(!0)}function i(){t(!1)}return window.addEventListener("focus",e),window.addEventListener("blur",i),()=>{window.removeEventListener("focus",e),window.removeEventListener("blur",i)}}),[]),e}},5710:(e,t,i)=>{i.d(t,{o:()=>s});var n=i(35987),a=i(63112);function s(){return(0,a.N)(n.g)}},6787:(e,t,i)=>{i.d(t,{L:()=>l});var n=i(30758),a=i(3192),s=i(26945),r=i(32576);function l({episodeUri:e,start:t,stop:i}){const{togglePlay:l,triggerPlay:o,isPlaying:c,isActive:u}=(0,a.P)({uri:e},{featureIdentifier:"episode"}),d=(0,s.o)((e=>(0,r.s)(e)??0)),p=u&&function(e,t,i){return i>=e&&i<t}(t,i,d),m=c&&p;return{onClick:(0,n.useCallback)((e=>{p?l({seekTo:t,loggingParams:e}):o({seekTo:t,loggingParams:e})}),[p,t,l,o]),isPlaying:m,isActive:p}}},9413:(e,t,i)=>{i.d(t,{x:()=>s});var n=i(22640),a=i(55421);function s(){const e=(0,a.t)();return(0,n.I)({queryKey:["settings-formats"],queryFn:()=>e.quality.getFormats(),gcTime:36e5,staleTime:6e5}).data}},9503:(e,t,i)=>{i.d(t,{t:()=>s});var n=i(63112),a=i(11254);function s(){return(0,n.N)(a.Z)}},11052:(e,t,i)=>{i.d(t,{J:()=>n.J});var n=i(18177)},12839:(e,t,i)=>{i.d(t,{p:()=>b});var n=i(30758),a=i(39629),s=i(4882),r=i(45592),l=i(87579),o=i(11273),c=i(27396),u=i(56443),d=i(58337);const p="pIxPdfuNasUDLbEDmuK_",m="T5TwrUTf23N311rgrEAc",g="BTwQUS5iBiiOBgdda2Zi",v="lu2OTpzgQ6hv6AYWXMNQ";var x=i(86070);const b=({localStorageKey:e,onDismiss:t})=>{const[i,b]=(0,d.x)(e,!1),{logStartJam:h}=(0,u.O)(),{enqueueSnackbar:y}=(0,o.d)(),j=(0,n.useCallback)((()=>{b(!0),t&&t(),y(l.Ru.get("web-player.social-connect.promotion.how-to-start-a-jam-reminder"),{autoHideDuration:5e3})}),[y,t,b]);return i?(0,x.jsx)(x.Fragment,{}):(0,x.jsxs)("div",{className:p,children:[(0,x.jsxs)("div",{className:m,children:[(0,x.jsx)(a.E,{as:"p",variant:"bodySmall",semanticColor:"textSubdued",children:l.Ru.get("web-player.social-connect.invitation-modal.subtitle")}),(0,x.jsx)(s.H,{iconOnly:r.M,className:g,"aria-label":l.Ru.get("close"),onClick:j,size:"small"})]}),(0,x.jsx)("div",{className:v,children:(0,x.jsx)(c.$,{onClick:h})})]})}},13333:(e,t,i)=>{i.d(t,{w:()=>b});var n=i(30758),a=i(97500),s=i.n(a),r=i(66740),l=i(40829),o=i(98574),c=i(84575);const u="AAdBM1nhG73supMfnYX7",d="W3E0IT3_STcazjTeyOJa",p="mdMUqcSHFw1lZIcYEblu",m="cZCuJDjrGA2QMXja_Sua",g="zduvaX0Ioxqd5ypeWoAf";var v=i(86070);const x=({fixedHeader:e,scrollNodeRef:t,children:i,scrolledClassName:n})=>{const a=(0,o.y)(t);return(0,v.jsxs)("div",{className:s()(u),children:[(0,v.jsx)("div",{className:s()(d,{[n??p]:a}),children:e}),i]})},b=n.forwardRef((({children:e,className:t,fixedHeader:i,scrolledClassName:a},o)=>{const d=(0,n.useRef)(null);(0,l.g)(d);const p=(0,n.useMemo)((()=>({scrollNodeRef:d})),[d]),b=(0,v.jsx)(c.bi.Provider,{value:p,children:(0,v.jsx)(r.a,{className:m,scrollNodeRef:d,children:(0,v.jsx)("div",{ref:o,className:s()(u,g,t),children:e})})});return i?(0,v.jsx)(x,{fixedHeader:i,scrollNodeRef:d,scrolledClassName:a,children:b}):b}))},17577:(e,t,i)=>{i.d(t,{l:()=>d});var n=i(97500),a=i.n(n);const s="x-toggle-wrapper",r="x-toggle-indicator",l="JCFCfOY_6UEZZSOO2xrl",o="x-toggle-indicatorWrapper",c="x-toggle-input";var u=i(86070);const d=({value:e,disabled:t,onSelected:i,onClick:n,id:d,className:p,condensed:m=!1,inputRef:g})=>(0,u.jsxs)("label",{className:a()(s,p),onClick:n,children:[(0,u.jsx)("input",{id:d,className:c,type:"checkbox",disabled:t,checked:e,onChange:e=>{const t=e.target.checked;i(t)},ref:g}),(0,u.jsx)("span",{className:a()(o,{[l]:m}),children:(0,u.jsx)("span",{className:a()(r,{[l]:m})})})]})},27396:(e,t,i)=>{i.d(t,{$:()=>p});var n=i(30758),a=i(62411),s=i(60992),r=i(78585),l=i(87579),o=i(42993),c=i(68452),u=i(60848),d=i(86070);const p=({onClick:e})=>{const t=(0,a.wA)(),i=(0,c.Y)(),p=(0,n.useCallback)((async()=>{try{e(),await i()}catch(e){t((0,o.A9)(u.EL.ERROR))}}),[i,t,e]);return(0,d.jsx)(s.$,{iconLeading:r.V,size:"small",onClick:p,children:l.Ru.get("web-player.social-connect.menu-action.title")})}},28198:(e,t,i)=>{i.d(t,{P:()=>n});const n=()=>!1},41748:(e,t,i)=>{i.d(t,{e:()=>c});var n=i(74910),a=i(8065),s=i(15652),r=i(73211),l=i(69479),o=i(86070);const c=({images:e,breakpoint:t,type:i,name:c,...u})=>{const d=(0,r._)(),p=i===l.c.ARTIST||i===l.c.USER?a.u.CIRCLE:a.u.ROUNDED_CORNERS,m=t===n.e.SMALL?s.Qe.SIZE_64:s.Qe.SIZE_112;return(0,o.jsx)(a.b,{fadeIn:!0,images:d(e,s.BZ[m]),shape:p,size:m,iconSize:t===n.e.SMALL?"medium":"xlarge",type:i,title:c,loadingMode:"eager",...u})}},43649:(e,t,i)=>{i.d(t,{R:()=>n.R});var n=i(45755)},51047:(e,t,i)=>{function n(e){return e}i.d(t,{v:()=>n})},56443:(e,t,i)=>{i.d(t,{O:()=>c});var n=i(30758),a=i(50556),s=i(20013),r=i(49708),l=i(85105),o=i(86070);const c=()=>{const{spec:e,logger:t,UBIFragment:i}=(0,l.r)(a.J,{}),{uri:c}=(0,r.f)(),u=(0,n.useCallback)(((i,n)=>{const a=e.inviteButtonFactory().hitShare({entityToBeShared:i,shareId:n});t.logInteraction(a)}),[t,e]),d=(0,n.useCallback)((()=>{const i=e.endButtonFactory().hitUiReveal();t.logInteraction(i)}),[t,e]),p=(0,n.useCallback)((()=>{const i=e.leaveButtonFactory().hitUiReveal();t.logInteraction(i)}),[t,e]),m=(0,n.useCallback)((()=>{const i=e.facepileButtonFactory().hitUiNavigate({destination:s.S.PARTICIPANTS_PAGE});t.logInteraction(i)}),[t,e]),g=(0,n.useCallback)((t=>(0,o.jsx)(i,{spec:e,...t})),[i,e]);return{logInviteClick:u,logEndClick:d,logLeaveClick:p,logFacePileClick:m,logStartJam:(0,n.useCallback)((()=>{const i=e.createJamButtonFactory().hitUiNavigate({destination:c??""});t.logInteraction(i)}),[t,e,c]),UBIFragmentWithSpec:g}}},61424:(e,t,i)=>{i.d(t,{S:()=>o});var n=i(22640),a=i(1983),s=i(38379),r=i(96535),l=i(9503);function o(e){const t=(0,l.t)();return(0,n.I)({queryKey:["author",e],queryFn:async()=>t.fetch([e??""],[s.UH.IDENTITY_TRAIT,s.UH.VISUAL_IDENTITY_TRAIT,s.UH.AVAILABLE_RELEASES]).then((([e])=>function({uri:e,extensions:{[s.UH.IDENTITY_TRAIT]:t,[s.UH.VISUAL_IDENTITY_TRAIT]:i,[s.UH.AVAILABLE_RELEASES]:n}}){return t?{uri:e,name:t.name,description:t.description,images:(i?.sixteenByNineCoverImage?.instances??i?.squareCoverImage?.instances)?.map((({size:e,flatFile:t})=>({url:t?.cdnUrl??"",label:c[e]}))).filter((e=>!!e.url))??[],availableBooksUris:n?.availableReleases.map((e=>e.uri))??[],dynamicColors:(0,a.V)(i?.squareCoverImage?.extractedColorSet)}:null}(e))),staleTime:0,gcTime:36e5,enabled:!!e})}const c={[r.hJ.IMAGE_SIZE_UNSPECIFIED]:"standard",[r.hJ.IMAGE_SIZE_SMALL]:"small",[r.hJ.IMAGE_SIZE_DEFAULT]:"standard",[r.hJ.IMAGE_SIZE_LARGE]:"large",[r.hJ.IMAGE_SIZE_XLARGE]:"xlarge",[r.hJ.IMAGE_SIZE_XXLARGE]:"xlarge",[r.hJ.UNRECOGNIZED]:"standard"}},63637:(e,t,i)=>{i.d(t,{A:()=>n});const n={entityRow:"ci11tAmTK1LnxThQkXPy",actions:"_2sJPwAAp1wY1Ftke6iFe",visibleAction:"yuNzasMLs7hvemHI4d8Q",active:"dNymWGRudMrTI6ot9FBg",title:"luWcW9hkbLdFxRQB0yGb",body:"abYR6tZoE7BdzThmWTb0",footer:"GOcKQxqNMhGzbGiAXBig",separator:"yFQjuDAhri_egM1pwn70",badges:"tykXaR_9v2wPQNrdPkK6"}},65313:(e,t,i)=>{i.d(t,{a:()=>V,k:()=>M});var n=i(30758),a=i(97500),s=i.n(a),r=i(39629),l=i(65402),o=i(60489),c=i(45592),u=i(33100),d=i(52227),p=i(76082),m=i(87579),g=i(32173),v=i(42738),x=i(77558),b=i(21349),h=i(79462),y=i(35532),j=i(59227),f=i(52057),S=i(31876),C=i(58176),w=i(29398),N=i(74929),k=i(56189),E=i(85105);const R="eTT681T6oUKXsIMiP8pT",I="gwmgu53xszgwAXxqLT0h",L="fNXmHtlrj4UVWmhQrJ_5",A="XOSSUjLDKk9RRmiX_UWa",T="KILnOHUdx4pspVEoJ7kq",O="XNFZdOLgMlx491fEWdYJ",D="icNf66tgG3uxDMbCCIaN",B="NmIQ4hxBcXT8Bd7Abwdi",_="rkIl3GXeAGoK2gIX2zuj",F="j9Ey7DzF10wbxpBIVtcb";var U=i(86070);const P=({title:e,variant:t,semanticColor:i})=>(0,U.jsx)(y.z,{title:e,children:(0,U.jsx)(r.E,{as:"h1",dir:"auto",variant:t,semanticColor:i,children:e||""})},e||""),M=({link:e,title:t,item:i,panelLinkRef:n,variant:a,semanticColor:r,className:l,hasNPVCloseButton:o})=>{const{spec:c,logger:u}=(0,E.r)(d.J,{}),m=(0,p.o_h)(e),g=m?.toURI(),b=!(!g||!t),y=b?[g]:[],j=(0,x.H)(g),{draggable:f,onDragStart:S}=(0,w.P)({itemUris:y,dragLabelText:t??""});return(0,U.jsx)(v.h,{menu:j,children:(0,U.jsx)("div",{className:s()(R,l,{[F]:o}),children:e&&t?(0,U.jsx)(h.N,{ref:n,draggable:f&&b,onDragStart:b?S:void 0,to:e,search:i?`?uid=${i.uid}&uri=${i.uri}`:void 0,className:I,onClick:()=>{u.logInteraction(c.contextLinkFactory().hitUiNavigate({destination:e||""}))},children:(0,U.jsx)(P,{title:t,variant:a,semanticColor:r})}):(0,U.jsx)(P,{title:t,variant:a,semanticColor:r})})})},H=S.$S.PANEL_CLOSE_CLICK,V=({link:e,title:t,titleSlot:i,actions:a,onClose:r,className:d,panelLinkRef:p,preventDefaultClose:v=!1,onBack:x,item:h,titleVariant:y="bodyMediumBold",titleSemanticColor:S="textBase"})=>{const w=(0,f._Y)(),E=(0,f.Ev)(H),R=(0,u.NC)(N.mzn),I=(0,f.XB)()===C.Z.NowPlayingView&&R,F=(0,j.h)(),P=(0,n.useDeferredValue)(I),V=(0,n.useCallback)((()=>{r?.(),v||w(H)}),[r,v,w]),q=null!==h&&(0,k.N)(h);return(0,U.jsx)(n.Suspense,{fallback:null,children:(0,U.jsxs)("div",{className:s()(L,d,{[T]:I}),children:[x&&(0,U.jsx)("span",{className:s()(D,B),children:(0,U.jsx)(b.Zp,{label:m.Ru.get("desktop.login.Back"),children:(0,U.jsx)(g.a,{ariaLabel:m.Ru.get("desktop.login.Back"),size:"sm",onClick:x,icon:l.g})})}),P&&(0,U.jsx)(g.a,{icon:o.t,size:"sm",onClick:V,ariaLabel:m.Ru.get("web-player.now-playing-view.hide"),className:_}),i||(0,U.jsx)(M,{title:t,panelLinkRef:p,item:h,link:e,variant:y,semanticColor:S}),(0,U.jsxs)("span",{className:s()(D,A),children:[a,!q&&!I&&!F&&(0,U.jsx)("div",{"data-testid":"PanelHeader_CloseButton",children:(0,U.jsx)(b.Zp,{label:m.Ru.get("close"),children:(0,U.jsx)(g.a,{ariaLabel:m.Ru.get("close"),className:O,size:"sm",onClick:V,icon:c.M,disabled:!E})})})]})]})})}},65685:(e,t,i)=>{i.d(t,{_:()=>j,s:()=>y});var n=i(30758),a=i(97500),s=i.n(a),r=i(62411),l=i(23760),o=i(11165),c=i(59227),u=i(66521),d=i(52057),p=i(58176);const m="ffFwfKcPDbmAPLXzxzKq",g="jD_TVjbjclUwewP7P9e8",v="nZaXB942idDuiFv4bKNk",x="Fwe5dGEAgs_VFp4SPrzv",b="gchSBzolAjaPDHD1q0rA";var h=i(86070);const y=(0,n.createContext)(null),j=({label:e,style:t,focusTransferId:i,children:a,className:j,nodeRef:f})=>{const S=(0,n.useRef)(null),C=f??S,w=(0,u.S)(),N=(0,c.h)(),k=(0,r.d4)((e=>e.ui?.fullscreenMode?.isOpen??!1)),E=(0,d.XB)(),R=w===o.z.NOW_PLAYING_VIEW;return(0,l.X)(i??null,C),(0,h.jsx)(y.Provider,{value:C,children:(0,h.jsx)("aside",{"aria-label":e,className:s()(m,j,{[v]:R,[b]:k,[x]:N,[g]:E!==p.Z.Disabled&&E!==p.Z.NowPlayingView}),style:t,id:"Desktop_PanelContainer_Id",ref:C,tabIndex:-1,children:a})})}},71942:(e,t,i)=>{i.d(t,{c:()=>l});var n=i(30758),a=i(36102),s=i(43721),r=i(25476);function l(e,t){const i=(0,s.d)(),l=(0,r.J)(t),o=(0,a.a)();(0,n.useEffect)((()=>i.getBroadcastingEvents().addListener(e,(e=>{o()&&l(e)}))),[i,l,e,o])}},72496:(e,t,i)=>{i.d(t,{k:()=>u});var n=i(30758),a=i(97500),s=i.n(a),r=i(24732),l=i(74910),o=i(63637),c=i(86070);const u=(0,n.memo)((function({breakpoint:e,className:t,showSeparator:i=!1,isActive:n,...a}){return(0,c.jsx)(r.v,{"data-entity-row":!0,className:s()(t,o.A.entityRow,{[o.A.separator]:i,[o.A.active]:n}),hoverBackgroundColor:"backgroundTintedHighlight",activeBackgroundColor:"backgroundTintedBase",layout:e===l.e.SMALL?"regular":"wide",hoverAnimationDuration:"0ms",horizontalGap:e===l.e.SMALL?"12px":"16px",paddingBlockStart:"12px",paddingBlockEnd:"12px",...a})}))},74910:(e,t,i)=>{i.d(t,{$:()=>r,e:()=>s});var n=i(35524),a=i(64254);const s={SMALL:"small",LARGE:"large"},r=()=>(0,a.y)()===n.E.SMALL?"small":"large"},75015:(e,t,i)=>{i.d(t,{PanelSection:()=>bv});var n=i(30758),a=i(94079),s=i(33100),r=i(57826),l=i(39629),o=(i(29323),i(19739)),c=i(60992),u=i(97500),d=i.n(u);let p=function(e){return e.Overview="overview",e.ActivationIntro="activationIntro",e.ActivationDetection="activationDetection",e.ActivationSignifiers="activationSignifiers",e.Error="error",e.ManualSelection="manualSelection",e.AirpodsSelection="airpodsSelection",e.AudioQualitySettings="audioQualitySettings",e.AudioQualityDetails="audioQualityDetails",e.DiscoverLossless="discoverLossless",e.IncompatibleHeadphones="incompatibleHeadphones",e}({}),m=function(e){return e.GetStarted="getStarted",e.OnError="onError",e.SelectManually="selectManually",e.Continue="continue",e.Close="close",e.Activate="activate",e.SetupNewDevice="setupNewDevice",e.NotFound="notFound",e.Settings="settings",e.OnboardLossless="onboardLossless",e.Details="details",e.Airpods="airpods",e}({});var g=i(52057),v=i(58176),x=i(40354);const b=[p.ActivationIntro,p.ActivationDetection,p.ActivationSignifiers,p.ManualSelection,p.AirpodsSelection],h=e=>{const t=(0,n.useRef)(!1),i=(0,x.z)(),a=(0,g.XB)();(0,n.useEffect)((()=>{const n=i.getState()?.isPaused,s=(r=e,l=a,b.includes(r)&&(l===v.Z.PuffinActivation||l===v.Z.PuffinActivationOverlay));var r,l;!s||n||t.current?!s&&n&&t.current&&(i.resume({featureIdentifier:"birdhouse"}),t.current=!1):(i.pause({featureIdentifier:"birdhouse"}),t.current=!0)}),[a,e,i])};var y=i(86070);const j={[p.Overview]:{[m.GetStarted]:p.ActivationIntro,[m.OnError]:p.Error,[m.SelectManually]:p.ManualSelection,[m.Settings]:p.AudioQualitySettings,[m.OnboardLossless]:p.DiscoverLossless,[m.Details]:p.AudioQualityDetails},[p.ActivationIntro]:{[m.Close]:p.Overview,[m.OnError]:p.Error,[m.Continue]:p.ActivationDetection,[m.SelectManually]:p.ManualSelection,[m.Activate]:p.Overview},[p.ActivationDetection]:{[m.SelectManually]:p.ManualSelection,[m.Airpods]:p.AirpodsSelection,[m.Close]:p.Overview,[m.OnError]:p.Error,[m.Continue]:p.ActivationSignifiers},[p.ActivationSignifiers]:{[m.Close]:p.Overview,[m.OnError]:p.Error,[m.Activate]:p.Overview},[p.ManualSelection]:{[m.Continue]:p.ActivationSignifiers,[m.Close]:p.Overview,[m.OnError]:p.Error,[m.NotFound]:p.IncompatibleHeadphones},[p.AirpodsSelection]:{[m.Continue]:p.ActivationSignifiers,[m.Close]:p.Overview,[m.OnError]:p.Error,[m.NotFound]:p.Error},[p.DiscoverLossless]:{[m.Continue]:p.Overview},[p.AudioQualitySettings]:{},[p.AudioQualityDetails]:{},[p.Error]:{},[p.IncompatibleHeadphones]:{[m.Close]:p.Overview,[m.OnError]:p.Error,[m.Continue]:p.Overview}},f=(0,n.createContext)({currentView:p.Overview,viewTransitions:j,setCurrentView:()=>{},toPreviousView:()=>{},viewOptions:null}),S=({children:e})=>{const t=(0,g.XB)(),[i,a]=(0,n.useState)((()=>(e=>[{view:e===v.Z.PuffinActivation||e===v.Z.PuffinActivationOverlay?p.ActivationDetection:p.Overview,options:{}}])(t))),s=(0,n.useCallback)(((e,t)=>{e===p.Overview?a([{view:e,options:t??{}}]):a((i=>[...i,{view:e,options:t??{}}]))}),[]),r=(0,n.useCallback)((()=>{a((e=>e.slice(0,-1)))}),[]);if(0===i.length)throw new Error("Puffin view state stack should never be empty");const{view:l,options:o}=i.at(-1);h(l);const c=(0,n.useMemo)((()=>({currentView:l,viewOptions:o,setCurrentView:s,toPreviousView:r,viewTransitions:j})),[l,s,r,o]);return(0,y.jsx)(f.Provider,{value:c,children:e})};var C=i(13333),w=i(65313),N=i(35524),k=i(64254),E=i(61715);const R="Xq5xnpTOsoPxFR95BkTU",I="N7OMJte9T4Lv7DDX16ky",L="NJATxQbY2o4sl0BHxU3T",A=({children:e,className:t,...i})=>{const a=(0,n.useRef)(null),{currentView:s}=(0,n.useContext)(f),r=[p.ActivationIntro,p.ActivationDetection,p.ActivationSignifiers,p.DiscoverLossless,p.ManualSelection,p.AirpodsSelection,p.IncompatibleHeadphones].includes(s),{breakpoint:l}=(0,E.c)({[N.E.SMALL]:0,[N.E.MEDIUM]:448,[N.E.LARGE]:780},a);return(0,y.jsxs)("div",{className:d()({[L]:r}),children:[(0,y.jsx)(w.a,{panel:v.Z.Puffin,className:d()(I,t),...i}),(0,y.jsx)(C.w,{ref:a,children:(0,y.jsx)(k.o.Provider,{value:l,children:e})})]})},T="EqLKhgGIINyN_LINFjl1",O="OyIY0v1_h3UWgLlxyPHL",D=({resetError:e})=>{const{toPreviousView:t,setCurrentView:i}=(0,n.useContext)(f);return(0,y.jsx)(A,{onBack:()=>{t()},children:(0,y.jsxs)("div",{className:T,children:[(0,y.jsx)(o.b,{size:"xlarge",semanticColor:"textBase"}),(0,y.jsxs)("div",{className:O,children:[(0,y.jsx)(l.E,{variant:"titleSmall",semanticColor:"textBase",children:"Something went wrong"}),(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:"We couldn’t turn on your headphone tools."})]}),(0,y.jsx)(c.$,{colorSet:"invertedLight",size:"medium",onClick:()=>{e?.(),i(p.Overview)},children:"Retry"})]})})},B=({resetError:e})=>(0,y.jsx)(D,{resetError:e});var _=i(96931),F=i(62411),U=i(87579),P=i(23023),M=i(29253),H=i(3537),V=i(18425),q=i(51862),z=i(41678);const Y=()=>{const e=(0,F.d4)((e=>e.platform.isDesktop)),t=(0,M.b)(),i=(0,P.lS)(t),{isPlayingRemotely:a,remoteDeviceName:s,isConnected:r}=(0,V.v)((e=>{const t=(0,H.V)(e);return{isPlayingRemotely:t.isPlayingRemotely,remoteDeviceName:t.remoteDevice?.name,isConnected:t.connectionStatus===q.zP.CONNECTED}}),z.a),l=(0,n.useMemo)((()=>e?U.Ru.get("web-player.connect.device-picker.this-computer"):U.Ru.get("web-player.connect.device-picker.this-web-browser")),[e]),o=(0,n.useMemo)((()=>{if(t)return e?U.Ru.get("web-player.connect.device-picker.from-this-computer",{device_name:t.name}):U.Ru.get("web-player.connect.device-picker.from-this-web-browser",{device_name:t.name})}),[e,t]);if(s&&a&&r)return{deviceName:s,playingFrom:s};if(t?.transportType===P.Yg.AIRPLAY||t?.transportType===P.Yg.BLUETOOTH&&t?.terminalType===P.FI.SPEAKERS)return{deviceName:t?.name,playingFrom:l,formattedDeviceName:o};if(i){if(t?.transportType===P.Yg.BUILT_IN||t?.transportType===P.Yg.USB)return{deviceName:U.Ru.get("web-player.puffin.wired-connection"),playingFrom:l};if(t?.name&&t?.terminalType===P.FI.HEADPHONES)return{deviceName:t?.name,playingFrom:l,formattedDeviceName:o}}return{deviceName:l,playingFrom:l}},G=()=>{const{deviceName:e}=Y();return(0,y.jsx)(l.E,{variant:"titleSmall",semanticColor:"textBase",children:e})};var Q=i(28198),W=i(24732),Z=i(2308),K=i(55421),J=i(6519);const X=({onClick:e})=>{const{playingFrom:t}=Y(),i=(0,K.t)(),[{data:n}]=(0,J.K)(i.quality.streamingQuality);return void 0===n?null:(0,y.jsx)(W.v,{id:"qualitySetting",variant:"naked",title:U.Ru.get("desktop.settings.streamingQuality"),leading:(0,y.jsx)(Z.s,{size:"small"}),subtitle:t,onClick:e,padding:"0px 12px"})};var $=i(12691),ee=i(23760),te=i(67684),ie=i(31876);const ne=({title:e,description:t,confirmButtonText:i="OK",cancelButtonText:a="Cancel",onConfirm:s,onClose:r})=>{const{setCurrentView:l}=(0,n.useContext)(f),o=(0,g._Y)(),[c,u]=(0,n.useState)(!1),d=(0,n.useRef)(!1);return{dialog:c?(0,y.jsx)(te.T,{onClose:()=>{u(!1),r?.()},onConfirm:()=>{s(),d.current?o(ie.$S.PUFFIN_BUTTON_CLICK):l(p.Overview)},titleText:e,"aria-label":e,descriptionText:t,cancelText:a,confirmText:i}):null,triggerDialog:(e=!1)=>{d.current=e,u(!0)}}};var ae=i(77893),se=i(55121);const re=()=>{const e=(0,se.N)();return{setCurrentDevice:(0,n.useCallback)(((t,i)=>{e.setCurrentDevice(t,i)}),[e]),removeCurrentDevice:(0,n.useCallback)((t=>{e.removeCurrentDevice(t)}),[e])}};var le=i(97485);const oe=({spec:e})=>{const t=(0,le.s)(),i=(0,n.useRef)(null),{removeCurrentDevice:a}=re(),{deviceFilterState:s}=(0,ae.j)();(0,ee.X)("RESET_HEADPHONES_BUTTON",i);const{triggerDialog:r,dialog:l}=ne({title:U.Ru.get("web-player.puffin.reset-headphones.dialog.title"),description:U.Ru.get("web-player.puffin.reset-headphones.dialog.subtitle"),confirmButtonText:U.Ru.get("web-player.puffin.reset-headphones.dialog.confirm"),onConfirm:()=>{a(!0),(0,ee.I)("SETUP_HEADPHONES_BUTTON")},onClose:()=>{(0,ee.I)("RESET_HEADPHONES_BUTTON")}});return s.isOnboarded?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(W.v,{id:"resetHeadphonesButton",ref:i,variant:"naked",title:U.Ru.get("web-player.puffin.reset-headphones.menu-item"),leading:(0,y.jsx)($.x,{size:"small"}),onClick:i=>{t.logInteraction(e.resetHeadphonesButtonFactory().hitUiReveal()),i.preventDefault(),r(!1)},padding:"0px 12px"}),l]}):null};var ce=i(78040);const ue=({isPlayingRemotely:e,spec:t})=>{const i=(0,le.s)(),{setCurrentView:a,viewTransitions:s}=(0,n.useContext)(f),r=s[p.Overview],l=(0,Q.P)(),o=(0,ce.j)();return(0,y.jsxs)("div",{children:[o&&(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(X,{onClick:()=>{i.logInteraction(t.qualitySettingsButtonFactory().hitUiReveal()),a(r.settings)}})}),!e&&!l&&(0,y.jsx)(oe,{spec:t})]})},de=()=>null;var pe=i(69568),me=i(4882);const ge="k4f1o0jOMnxv6OS8dC7p",ve="PYLIWbzDyJA6Mbh2EQQg",xe="r3oTh3jKov0cW3m5qF1N",be=({title:e,subtitle:t,buttonLabel:i,onClick:a,dismissButtonLabel:s,onDismissClick:r,focusTransferKey:o=null})=>{const c=(0,n.useRef)(null);return(0,ee.X)(o,c),(0,y.jsx)(W.v,{variant:"naked",size:"lg",id:"getStarted",className:ge,title:e,subtitle:t,paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,y.jsxs)("div",{className:ve,children:[(0,y.jsx)(pe.n,{size:"small",onClick:a,ref:c,children:(0,y.jsx)(l.E,{variant:"bodySmallBold",children:i})}),s&&r&&(0,y.jsx)(me.H,{className:xe,size:"small",onClick:r,children:(0,y.jsx)(l.E,{variant:"bodySmallBold",children:s})})]})})};var he=i(11104),ye=i(67380),je=i(82455);const fe=e=>{switch(e){case je.Yn.LOSSLESS_24:return{title:U.Ru.get("web-player.pigeon.audio-quality.lossless"),titleFull:U.Ru.get("web-player.pigeon.audio-quality.lossless-24.label"),bitrateLabel:U.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate"),bitrateDetails:[U.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-1"),U.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-2")]};case je.Yn.LOSSLESS:return{title:U.Ru.get("web-player.pigeon.audio-quality.lossless"),titleFull:U.Ru.get("web-player.pigeon.audio-quality.lossless-16.label"),bitrateLabel:U.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate"),bitrateDetails:[U.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate-details-1"),U.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate-details-2")]};case je.Yn.VERY_HIGH:return{title:U.Ru.get("web-player.pigeon.audio-quality.very-high.label"),bitrateLabel:U.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate"),bitrateDetails:[U.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate-details")]};case je.Yn.HIGH:return{title:U.Ru.get("web-player.pigeon.audio-quality.high.label"),bitrateLabel:U.Ru.get("web-player.pigeon.audio-quality.high.bitrate"),bitrateDetails:[U.Ru.get("web-player.pigeon.audio-quality.high.bitrate-details")]};case je.Yn.NORMAL:return{title:U.Ru.get("web-player.pigeon.audio-quality.normal.label"),bitrateLabel:U.Ru.get("web-player.pigeon.audio-quality.normal.bitrate"),bitrateDetails:[U.Ru.get("web-player.pigeon.audio-quality.normal.bitrate-details")]};case je.Yn.LOW:return{title:U.Ru.get("web-player.pigeon.audio-quality.low.label"),bitrateLabel:U.Ru.get("web-player.pigeon.audio-quality.low.bitrate"),bitrateDetails:[U.Ru.get("web-player.pigeon.audio-quality.low.bitrate-details")]};case je.Yn.UNKNOWN:default:return{title:U.Ru.get("web-player.pigeon.audio-quality.unknown.label"),bitrateLabel:null}}},Se="SsVVyvM7DIniTIOjJFuM",Ce="dHDe0DUG4UkEeM8p5PEa",we="T49oF8shvnsadykMrogA",Ne=({quality:e,onClick:t})=>{const i=fe(e),n=[je.Yn.VERY_HIGH,je.Yn.HIGH,je.Yn.NORMAL,je.Yn.LOW];e===je.Yn.LOSSLESS_24?n.unshift(je.Yn.LOSSLESS_24):n.unshift(je.Yn.LOSSLESS);const a=e===je.Yn.UNKNOWN?"textBase":"textBrightAccent";return(0,y.jsxs)(he.a,{as:"button",variant:"tinted",className:Se,onClick:t,children:[(0,y.jsx)(W.v,{id:"quality",size:"lg",pretitle:U.Ru.get("web-player.pigeon.overview-card.title"),titleGap:ye.v4,title:(0,y.jsx)(l.E,{variant:"titleSmall",semanticColor:a,children:i.titleFull||i.title}),paddingInlineStart:"0px",paddingInlineEnd:"0px",variant:"naked"}),(0,y.jsx)("div",{children:n.map(((t,i)=>{const n=fe(t),a=t===e,s=a?"textBrightAccent":"textSubdued";return(0,y.jsx)(W.v,{id:n.title,size:"sm",paddingInlineStart:"0px",paddingInlineEnd:"0px",media:(0,y.jsx)("div",{className:d()(Ce,{[we]:a})}),title:(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:s,children:n.title}),trailing:(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:s,children:n.bitrateLabel}),variant:"naked"},i)}))})]})};var ke=i(59082),Ee=i(84948),Re=i(51047);const Ie="DkXvfK4ARoLCRa6fJghA",Le=({quality:e,onClick:t})=>{const i=fe(e);return(0,y.jsx)(W.v,{id:"qualityV2",variant:"tinted",verticalGap:"2px",paddingInlineStart:"16px",paddingInlineEnd:"16px",pretitle:(0,Re.v)("File quality in"),title:null,footer:(0,y.jsx)(W.v,{id:"qualityV2Settings",paddingBlockStart:"0px",paddingBlockEnd:"0px",paddingInlineStart:"0px",paddingInlineEnd:"0px",variant:"naked",size:"md",title:(0,y.jsx)(ke.d,{lineClamp:2,variant:"titleSmall",children:(0,y.jsxs)("span",{className:Ie,children:[(0,y.jsx)(Ee.A,{size:"medium"}),(0,y.jsx)(l.E,{variant:"titleSmall",children:i.titleFull||i.title})]})}),subtitle:(0,y.jsx)(y.Fragment,{children:i.bitrateDetails?.map(((e,t)=>(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:e},`bitrate-details-${t}`)))}),trailing:(0,y.jsx)(me.H,{size:"small",iconOnly:Z.s,onClick:t,label:U.Ru.get("keyboard.shortcuts.description.goToPreferences")})})})};var Ae=i(58337);const Te=()=>(0,Ae.x)("onboarding-dismissed:lossless",!1);var Oe=i(20924),De=i(8253);const Be=({spec:e})=>{const t=(0,le.s)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(f),s=a[p.Overview],r=(0,ce.j)(),l=(0,De.A)(),o=(0,Oe.g)(),c=(0,Q.P)(),[u]=Te();return r?(0,y.jsxs)(y.Fragment,{children:[!u&&(0,y.jsx)(be,{title:U.Ru.get("web-player.pigeon.get-started.title"),subtitle:U.Ru.get("web-player.pigeon.get-started.subtitle"),buttonLabel:U.Ru.get("web-player.pigeon.get-started.button"),onClick:()=>{t.logInteraction(e.losslessOnboardingButtonFactory().hitUiReveal()),i(s.onboardLossless)}}),c?(0,y.jsx)(Le,{quality:l,onClick:()=>{o("/preferences?highlight=audio-quality")}}):(0,y.jsx)(Ne,{quality:l,onClick:()=>{t.logInteraction(e.audioQualityCardFactory().hitUiReveal()),i(s.details)}})]}):null},_e=({isError:e})=>e?(0,y.jsx)(W.v,{id:"filterError",variant:"tinted",paddingBlockStart:"12px",paddingBlockEnd:"12px",paddingInlineStart:"16px",paddingInlineEnd:"16px",leading:(0,y.jsx)(o.b,{semanticColor:"textSubdued",size:"small"}),title:U.Ru.get("web-player.puffin.error-troubleshooting")}):null;var Fe=i(17577);const Ue="jvVll3Ia4Nrq9Fsd78Fo",Pe="d_HhOkLKxYpYKpP2gQy7",Me="fLp9X9keK84drMHcmOFW",He=({currentDeviceState:e,spec:t})=>{const i=(0,le.s)(),a=(0,n.useCallback)((()=>{i.logInteraction(t.optimizeToggleFactory().hitUiElementToggle()),e.toggleTuneHeadphones?.()}),[e,i,t]),s=null!==e.toggleTuneHeadphones,{specificRestricted:r,processingCapabilitiesRestricted:l}=e.contentRestrictions,o=(0,n.useMemo)((()=>r||l?U.Ru.get("web-player.puffin.enhancement-unavailable.content-restriction"):(s||U.Ru.get("web-player.puffin.listening-with.filters.specific-subtitle-unavailable"),U.Ru.get("web-player.puffin.listening-with.filters.specific-subtitle"))),[s,l,r]);return(0,y.jsx)("div",{className:Ue,children:(0,y.jsx)(W.v,{variant:"naked",size:"md",id:"headphones",className:Pe,disabled:r||l||!s,title:(0,y.jsx)(ke.d,{className:Me,children:U.Ru.get("web-player.puffin.listening-with.filters.specific-title")}),subtitle:o,trailing:(0,y.jsx)(Fe.l,{id:"headphoneTunes",onSelected:a,disabled:r||l,value:e.currentState.specificEnabled,condensed:!0})})})},Ve="bLEXMWOER6nmfeLfBRIN",qe=({spec:e})=>{const t=(0,le.s)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(f),s=a[p.Overview],{deviceFilterState:r}=(0,ae.j)(),o=r.isOnboarded;return(0,y.jsx)(W.v,{id:"listeningWith",variant:"tinted",pretitle:U.Ru.get("web-player.puffin.listening-with.model"),horizontalGap:"0px",paddingBlockStart:"12px",paddingBlockEnd:"12px",paddingInlineStart:"16px",paddingInlineEnd:"16px",className:Ve,trailing:(0,y.jsx)(pe.n,{size:"small",onClick:()=>{t.logInteraction(e.changeModelButtonFactory().hitUiReveal()),i(s.selectManually)},children:(0,y.jsx)(l.E,{variant:"bodySmallBold",children:U.Ru.get("web-player.puffin.listening-with.change-model")})}),footer:o&&(0,y.jsx)(He,{currentDeviceState:r,spec:e}),title:(0,y.jsx)(ke.d,{lineClamp:2,children:r.headphoneDevice?.deviceName??U.Ru.get("web-player.puffin.listening-with.placeholder-model")})})};var ze=i(67508),Ye=i(57595);const Ge="r2vYR6suFxgB5_dQhF_5",Qe="u1TzXrhJQWI79pWRWFVG",We=({spec:e})=>{const t=(0,le.s)(),i=(0,n.useRef)(null),{removeCurrentDevice:a}=re(),{deviceFilterState:s}=(0,ae.j)();(0,ee.X)("RESET_HEADPHONES_BUTTON",i);const{triggerDialog:r,dialog:o}=ne({title:U.Ru.get("web-player.puffin.reset-headphones.dialog.title"),description:U.Ru.get("web-player.puffin.reset-headphones.dialog.subtitle"),confirmButtonText:U.Ru.get("web-player.puffin.reset-headphones.dialog.confirm"),onConfirm:()=>{a(!0),(0,ee.I)("SETUP_HEADPHONES_BUTTON")},onClose:()=>{(0,ee.I)("RESET_HEADPHONES_BUTTON")}});return s.isOnboarded?(0,y.jsxs)("div",{className:Ge,children:[(0,y.jsx)("div",{className:Qe,children:(0,y.jsx)(me.H,{onClick:i=>{t.logInteraction(e.resetHeadphonesButtonFactory().hitUiReveal()),i.preventDefault(),r(!1)},iconLeading:$.x,size:"small",children:(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textBase",children:(0,Re.v)("Remove headphones")})})}),o]}):null},Ze="zGQ0s1caxUyi77kMOS_z",Ke="Ea60f3xHEWIFAM3mTuq2",Je=({spec:e})=>{const t=(0,le.s)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(f),s=a[p.Overview],{deviceFilterState:r}=(0,ae.j)(),o=r.isOnboarded,c=r.currentState.externalizationEnabled||r.currentState.specificEnabled;return(0,y.jsx)(W.v,{id:"listeningWith",variant:"tinted",horizontalGap:"0px",paddingBlockStart:"12px",paddingBlockEnd:"12px",paddingInlineStart:"16px",paddingInlineEnd:"16px",className:Ze,pretitle:(0,Re.v)("Selected model"),title:(0,y.jsx)(ke.d,{lineClamp:2,children:(0,y.jsxs)("div",{className:Ke,children:[c?(0,y.jsx)(ze.C,{size:"medium"}):(0,y.jsx)(Ye.r,{size:"medium"}),(0,y.jsx)(l.E,{variant:"titleSmall",children:r.headphoneDevice?.deviceName??U.Ru.get("web-player.puffin.listening-with.placeholder-model")})]})}),trailing:(0,y.jsx)(me.H,{size:"small",onClick:()=>{t.logInteraction(e.changeModelButtonFactory().hitUiReveal()),i(s.selectManually)},iconOnly:Z.s}),footer:o&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(He,{currentDeviceState:r,spec:e}),(0,y.jsx)(We,{spec:e})]})})},Xe=({spec:e})=>{const{setCurrentView:t,viewTransitions:i}=(0,n.useContext)(f),a=i[p.Overview],{deviceFilterState:s,isMaybeHeadphoneDevice:r,isError:l,isLoading:o}=(0,ae.j)(),c=(0,le.s)(),{triggerDialog:u,dialog:d,isHiddenByUser:m}=(()=>{const{deviceFilterState:e}=(0,ae.j)(),t=e.audioDevice?.id,[i,a]=(0,Ae.x)("puffin-hide-get-started",[]),s=(0,n.useMemo)((()=>!!t&&i.includes(t)),[t,i]),r=(0,n.useCallback)((()=>{if(t){const e=[...i,t].slice(-50);a(e)}}),[t,a,i]);return{...ne({title:U.Ru.get("web-player.puffin.dismiss-get-started.title"),description:U.Ru.get("web-player.puffin.dismiss-get-started.body"),confirmButtonText:U.Ru.get("hifi.yes"),cancelButtonText:U.Ru.get("web-player.puffin.dismiss-get-started.cancel"),onConfirm:()=>{r()}}),isHiddenByUser:s}})(),g=(0,Q.P)(),v=s.isOnboarded,x=r&&!v&&!m,b=(0,n.useCallback)((()=>{c.logInteraction(e.setupHeadphonesButtonFactory().hitUiReveal()),s.audioDevice?t(a.getStarted):t(a.selectManually,{showDialogOnBack:!0})}),[c,e,s.audioDevice,t,a.getStarted,a.selectManually]);return r?l||o?(0,y.jsx)(_e,{isError:l}):(0,y.jsxs)(y.Fragment,{children:[d,v&&(g?(0,y.jsx)(Je,{spec:e}):(0,y.jsx)(qe,{spec:e})),x&&(0,y.jsx)(be,{title:U.Ru.get("web-player.puffin.get-started.title"),subtitle:U.Ru.get("web-player.puffin.get-started.subtitle"),buttonLabel:U.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm"),onClick:b,dismissButtonLabel:U.Ru.get("web-player.puffin.upsell.enhance-headphones.not-headphones"),onDismissClick:u,focusTransferKey:"SETUP_HEADPHONES_BUTTON"})]}):null};var $e=i(95896),et=i(85105);const tt="TJAbLKl8aSWZqWk4EFkk",it=ie.$S.DEVICE_PICKER_BUTTON_CLICK,nt=()=>{const e=(0,H.l)(),{panelSend:t}=(0,g.AI)(v.Z.DevicePicker,v.Z.DevicePickerOverlay),i=(0,Q.P)(),a=(0,ce.j)(),s=(0,$e.v)(),{spec:r,logger:l}=(0,et.r)(_.R,{}),o=!e&&s,c=(0,n.useCallback)((()=>{l.logInteraction(r.backButtonFactory().hitUiReveal()),t(it)}),[l,t,r]);return(0,y.jsx)(A,{onBack:c,onClose:()=>{l.logInteraction(r.closeButtonFactory().hitUiHide())},children:(0,y.jsxs)("div",{className:tt,children:[(0,y.jsx)(G,{}),i&&(0,y.jsx)(n.Suspense,{fallback:null,children:(0,y.jsx)(de,{})}),a&&(0,y.jsx)(Be,{spec:r}),o&&(0,y.jsx)(Xe,{spec:r}),(0,y.jsx)(ue,{isPlayingRemotely:e,spec:r})]})})};var at=i(65685),st=i(74973),rt=i(79462);let lt=function(e){return e.INFO="INFO",e.ERROR="ERROR",e}({});function ot(e){return e.type===lt.ERROR}function ct(e){return e.type===lt.INFO}var ut=i(35783);const dt="UPAv6TbmqM79jDLYgiad",pt=({card:{type:e,id:t,title:i,text:n}})=>(0,y.jsx)(W.v,{id:t,className:dt,variant:"tinted",leading:e===lt.ERROR?(0,y.jsx)(st.Z,{size:"small",semanticColor:"textWarning"}):null,title:(0,y.jsx)(ke.d,{variant:"bodyMedium",children:i}),body:"string"==typeof n?(0,y.jsx)(ut.y,{LinkComponent:rt.N,source:n,splitter:/\|/g,semanticColor:"textSubdued",variant:"mesto"}):n});var mt=i(96828),gt=i(40591);const vt="GdqxZ88oz8MtwHaBnwgb",xt="Q4TWj1C8EEkH_beo9jI8",bt="slKZiyNh_zlnTSEo8VG7",ht="ichtbB4QY2SKusRio97a",yt="xTMuOBwhiZlpUZtnm0M6";let jt=function(e){return e[e.PASSING=0]="PASSING",e[e.NEEDS_ATTENTION=1]="NEEDS_ATTENTION",e[e.UNKNOWN=2]="UNKNOWN",e}({});const ft=({metric:e,label:t,severity:i})=>(0,y.jsxs)("div",{className:d()(vt,{[ht]:i===jt.UNKNOWN}),children:[(()=>{switch(i){case jt.PASSING:return(0,y.jsx)(mt.k,{size:"large",className:xt,semanticColor:"textBase"});case jt.NEEDS_ATTENTION:return(0,y.jsx)(st.Z,{size:"large",className:bt,semanticColor:"textWarning"});case jt.UNKNOWN:return(0,y.jsx)(gt.N,{size:"large",className:bt,semanticColor:"textBase"});default:return null}})(),(0,y.jsxs)("div",{className:yt,children:[(0,y.jsx)(l.E,{as:"p",variant:"bodyMedium",semanticColor:"textBase",children:e}),(0,y.jsx)(l.E,{as:"p",semanticColor:"textSubdued",variant:"bodySmall",children:t})]})]});let St=function(e){return e.bitrateLevel="bitrateLevel",e.targetBitrateLevel="targetBitrateLevel",e.targetBitrateAvailable="targetBitrateAvailable",e.strategy="strategy",e.isLocal="isLocal",e.autoAdjust="autoAdjust",e.deviceSupported="deviceSupported",e}({}),Ct=function(e){return e.Bluetooth_Degrades_Lossless="Bluetooth_Degrades_Lossless",e.Connect_Explanation="Connect_Explanation",e.Default_To_Very_High="Default_To_Very_High",e.Need_To_Redownload="Need_To_Redownload",e.Opt_Out_Of_Downgrade="Opt_Out_Of_Downgrade",e.Poor_Bandwidth_Interferes="Poor_Bandwidth_Interferes",e.Lossless_Unavailable="Lossless_Unavailable",e.Listen_Offline="Listen_Offline",e.Update_Setting="Update_Setting",e}({}),wt=function(e){return e[e.Internet=0]="Internet",e[e.Spotify_Connect=1]="Spotify_Connect",e[e.Downloads=2]="Downloads",e}({}),Nt=function(e){return e.Good="good",e.Poor="poor",e.Unknown="unknown",e.Unavailable="unavailable",e}({});const kt=[{criteria:{online:!0,autoAdjust:!1,trackLosslessAvailable:!0},result:Ct.Opt_Out_Of_Downgrade},{criteria:{online:!0,streamingLossless:!1,targetingLossless:!0,deviceCompatible:!0,internetBandwidth:Nt.Poor,trackLosslessAvailable:!0},result:Ct.Poor_Bandwidth_Interferes},{criteria:{online:!0,autoAdjust:!0,streamingLossless:!1,targetingLossless:!1,deviceCompatible:!0,internetBandwidth:Nt.Poor,trackLosslessAvailable:!0},result:Ct.Default_To_Very_High},{criteria:{online:!0,streamingLossless:!1,bitrateStrategy:[je.ZT.OFFLINED_FILE],trackLosslessAvailable:!0},result:Ct.Need_To_Redownload},{criteria:{online:!0,targetingLossless:!0,trackLosslessAvailable:!1},result:Ct.Lossless_Unavailable},{criteria:{online:!0,isSetStreamingQualityLessThanLossless:!0},result:Ct.Update_Setting}];const Et=[{criteria:{bitrateLevel:[je.Yn.LOSSLESS],strategy:[je.ZT.BEST_MATCHING,je.ZT.BACKEND_ADVISED,je.ZT.CACHED_FILE],deviceSupported:!0,autoAdjust:!0},result:Nt.Good},{criteria:{bitrateLevel:[je.Yn.LOW,je.Yn.NORMAL,je.Yn.HIGH,je.Yn.VERY_HIGH],targetBitrateLevel:[je.Yn.LOW,je.Yn.NORMAL,je.Yn.HIGH,je.Yn.VERY_HIGH],strategy:[je.ZT.BEST_MATCHING,je.ZT.CACHED_FILE],deviceSupported:!0,autoAdjust:!0},result:Nt.Good},{criteria:{bitrateLevel:[je.Yn.LOW,je.Yn.NORMAL,je.Yn.HIGH,je.Yn.VERY_HIGH],targetBitrateLevel:[je.Yn.LOSSLESS],strategy:[je.ZT.BEST_MATCHING,je.ZT.BACKEND_ADVISED,je.ZT.CACHED_FILE],targetBitrateAvailable:!0,deviceSupported:!0,autoAdjust:!0},result:Nt.Poor},{criteria:{bitrateLevel:[je.Yn.LOW,je.Yn.NORMAL,je.Yn.HIGH,je.Yn.VERY_HIGH],targetBitrateLevel:[je.Yn.LOW,je.Yn.NORMAL,je.Yn.HIGH,je.Yn.VERY_HIGH],strategy:[je.ZT.BACKEND_ADVISED],deviceSupported:!0,autoAdjust:!0},result:Nt.Poor},{criteria:{bitrateLevel:[je.Yn.LOW,je.Yn.NORMAL,je.Yn.HIGH,je.Yn.VERY_HIGH],targetBitrateLevel:[je.Yn.LOSSLESS],targetBitrateAvailable:!1,deviceSupported:!0,autoAdjust:!0},result:Nt.Unavailable},{criteria:{autoAdjust:!1},result:Nt.Unknown},{criteria:{deviceSupported:!1},result:Nt.Unknown}],Rt=[{criteria:{bitrateLevel:[je.Yn.LOSSLESS,je.Yn.LOSSLESS_24],deviceSupported:!0},result:!0},{criteria:{bitrateLevel:[je.Yn.UNKNOWN,je.Yn.LOW,je.Yn.NORMAL,je.Yn.HIGH,je.Yn.VERY_HIGH],strategy:[je.ZT.BEST_MATCHING,je.ZT.BACKEND_ADVISED,je.ZT.CACHED_FILE],targetBitrateLevel:[je.Yn.LOSSLESS,je.Yn.LOSSLESS_24],targetBitrateAvailable:!0,deviceSupported:!0},result:!0},{criteria:{bitrateLevel:[je.Yn.UNKNOWN,je.Yn.LOW,je.Yn.NORMAL,je.Yn.HIGH,je.Yn.VERY_HIGH],strategy:[je.ZT.OFFLINED_FILE],targetBitrateLevel:[je.Yn.LOSSLESS,je.Yn.LOSSLESS_24],targetBitrateAvailable:!0,deviceSupported:!0},result:!1},{criteria:{strategy:[je.ZT.BEST_MATCHING,je.ZT.BACKEND_ADVISED,je.ZT.CACHED_FILE],targetBitrateAvailable:!0,deviceSupported:!0},result:!1},{criteria:{deviceSupported:!1},result:!0},{criteria:{bitrateLevel:[je.Yn.UNKNOWN,je.Yn.LOW,je.Yn.NORMAL,je.Yn.HIGH,je.Yn.VERY_HIGH],targetBitrateLevel:[je.Yn.LOSSLESS,je.Yn.LOSSLESS_24],targetBitrateAvailable:!1,deviceSupported:!0},result:!0},{criteria:{targetBitrateLevel:[je.Yn.LOSSLESS,je.Yn.LOSSLESS_24]},result:!0}],It=(e,t)=>{for(const[i,n]of Object.entries(t.criteria))if(i===St.bitrateLevel){if(!n.includes(e[St.bitrateLevel]))return!1}else if(i===St.targetBitrateLevel){if(!n.includes(e[St.targetBitrateLevel]))return!1}else if(i===St.strategy){if(!n.includes(e[St.strategy]))return!1}else{if(!n===e[i])return!1}return!0},Lt=e=>[je.Yn.LOSSLESS,je.Yn.LOSSLESS_24].includes(e);var At=i(12862),Tt=i(36962),Ot=i(26945);const Dt={losslessStatus:je.p4.NONE,bitrateLevel:je.Yn.UNKNOWN,targetBitrateLevel:je.Yn.UNKNOWN,targetBitrateAvailable:!1,strategy:je.ZT.UNKNOWN};function Bt(){const{losslessStatus:e,bitrateLevel:t,targetBitrateLevel:i,targetBitrateAvailable:a,strategy:s}=(0,Ot.o)((e=>({...Dt,...e?.playbackQuality??null})),z.a),r=(0,H.l)(),l=(0,K.t)(),[{data:o}]=(0,J.K)(l.quality.streamingQuality),[{data:c}]=(0,J.K)(l.quality.remoteQuality),[{data:u}]=(0,J.K)(l.quality.autoAdjustQuality),d=(0,V.v)((e=>e.activeDevice)),p=(0,n.useMemo)((()=>null!==d&&d.losslessSupport?d.losslessSupport:{fullySupported:!1,deviceSupported:!1,userEligible:!1}),[d]).deviceSupported,m=d?.isLocal||!1;let g;g=m?s===je.ZT.CACHED_FILE||s===je.ZT.OFFLINED_FILE?wt.Downloads:wt.Internet:wt.Spotify_Connect;const v={bitrateLevel:t,targetBitrateLevel:i,targetBitrateAvailable:a,strategy:s,isLocal:m,deviceSupported:p,autoAdjust:!!u},x=(e=>{for(const t of Rt)if(It(e,t))return t.result;return!(!Lt(e[St.bitrateLevel])&&!Lt(e[St.targetBitrateLevel]))})(v),b=(e=>{for(const t of Et)if(It(e,t))return t.result;return e[St.strategy]===je.ZT.BACKEND_ADVISED?Nt.Poor:Nt.Good})(v),h=(0,Tt.n)(),y=Lt(i)&&a,j=Lt(t),f=Lt(i),S=r?c?.streamingQuality:o,C=function({online:e,streamingLossless:t,targetingLossless:i,strategy:n,trackLosslessAvailable:a,autoAdjust:s,internetBandwidth:r,losslessCompatibleDevice:l,isLocal:o,isSetStreamingQualityLessThanLossless:c}){const u=[Ct.Listen_Offline,Ct.Connect_Explanation,Ct.Bluetooth_Degrades_Lossless];for(const d of kt){const{criteria:p,result:m}=d;p.online===e&&(void 0!==p.autoAdjust&&p.autoAdjust!==s||void 0!==p.streamingLossless&&p.streamingLossless!==t||void 0!==p.targetingLossless&&p.targetingLossless!==i||void 0!==p.deviceCompatible&&p.deviceCompatible!==l||void 0!==p.bitrateStrategy&&!1===o||(void 0===p.bitrateStrategy||void 0!==n&&p.bitrateStrategy.includes(n))&&(void 0!==p.internetBandwidth&&p.internetBandwidth!==r||void 0!==p.trackLosslessAvailable&&p.trackLosslessAvailable!==a||void 0!==p.isSetStreamingQualityLessThanLossless&&p.isSetStreamingQualityLessThanLossless!==c||u.push(m)))}return u}({online:h,streamingLossless:j,targetingLossless:f,strategy:s,trackLosslessAvailable:y,autoAdjust:u,internetBandwidth:b,losslessCompatibleDevice:p,isLocal:m,isSetStreamingQualityLessThanLossless:!!S&&S<At.a1.LOSSLESS&&S>At.a1.AUTOMATIC});return{losslessStatus:e,bitrateLevel:t,flags:C,internetBandwidth:b,playingVia:{channelIsLossless:x,channel:g},losslessCompatibleDevice:p}}const _t=()=>{const{losslessCompatibleDevice:e,playingVia:t,internetBandwidth:i}=Bt();return(0,y.jsxs)("div",{children:[(0,y.jsx)(ft,{metric:U.Ru.get("web-player.pigeon.audio-quality.lossless-compatible-device"),label:e?U.Ru.get("hifi.yes"):U.Ru.get("hifi.no"),severity:e?jt.PASSING:jt.NEEDS_ATTENTION}),(0,y.jsx)(ft,{metric:U.Ru.get("hifi.playingVia"),label:(()=>{const{channel:e}=t;switch(e){case wt.Downloads:return U.Ru.get("local-files.source.downloads");case wt.Internet:return U.Ru.get("hifi.networkConnection");case wt.Spotify_Connect:return U.Ru.get("spotify-connect");default:return""}})(),severity:t.channelIsLossless?jt.PASSING:jt.NEEDS_ATTENTION}),(0,y.jsx)(ft,{metric:U.Ru.get("hifi.internetBandwidth"),label:(()=>{switch(i){case Nt.Good:return U.Ru.get("hifi.good");case Nt.Poor:return U.Ru.get("hifi.poor");case Nt.Unknown:default:return U.Ru.get("hifi.unknown")}})(),severity:(()=>{switch(i){case Nt.Good:return jt.PASSING;case Nt.Poor:return jt.NEEDS_ATTENTION;case Nt.Unknown:default:return jt.UNKNOWN}})()})]})};var Ft=i(15972);const Ut={[Ct.Listen_Offline]:()=>({type:"info",title:U.Ru.get("web-player.pigeon.help-cards.listen-offline.title"),message:U.Ru.get("web-player.pigeon.help-cards.listen-offline.body")}),[Ct.Connect_Explanation]:()=>({type:"info",title:U.Ru.get("web-player.pigeon.help-cards.connect-explanation.title"),message:(0,y.jsx)(l.E,{as:"p",variant:"bodySmall",semanticColor:"textSubdued",children:U.Ru.get("web-player.pigeon.help-cards.connect-explanation.body",(0,y.jsx)(Ft.g,{size:"xsmall",alignmentBaseline:"baseline"}))})}),[Ct.Bluetooth_Degrades_Lossless]:()=>({type:"info",title:U.Ru.get("web-player.pigeon.help-cards.bluetooth-degrades-lossless.title"),message:U.Ru.get("web-player.pigeon.help-cards.bluetooth-degrades-lossless.body")}),[Ct.Opt_Out_Of_Downgrade]:()=>({type:"error",title:U.Ru.get("web-player.pigeon.help-cards.opt-out-of-downgrade.title"),message:U.Ru.get("web-player.pigeon.help-cards.opt-out-of-downgrade.body")}),[Ct.Poor_Bandwidth_Interferes]:()=>({type:"error",title:U.Ru.get("web-player.pigeon.help-cards.poor-bandwidth-interferes.title"),message:U.Ru.get("web-player.pigeon.help-cards.poor-bandwidth-interferes.body")}),[Ct.Default_To_Very_High]:()=>({type:"error",title:U.Ru.get("web-player.pigeon.help-cards.default-to-very-high.title"),message:U.Ru.get("web-player.pigeon.help-cards.default-to-very-high.body")}),[Ct.Need_To_Redownload]:()=>({type:"error",title:U.Ru.get("web-player.pigeon.help-cards.need-to-redownload.title"),message:U.Ru.get("web-player.pigeon.help-cards.need-to-redownload.body")}),[Ct.Lossless_Unavailable]:()=>({type:"error",title:U.Ru.get("web-player.pigeon.help-cards.lossless-unavailable.title"),message:U.Ru.get("web-player.pigeon.help-cards.lossless-unavailable.body")}),[Ct.Update_Setting]:()=>({type:"error",title:U.Ru.get("web-player.pigeon.help-cards.update-settings.title"),message:U.Ru.get("web-player.pigeon.help-cards.update-settings.body")})},Pt="BFsg6KnXzCo_ZKKekrFC",Mt="OIOUgecXCtVCX_DzOsR4",Ht="qcU9Wt2Ly1y44H_lC327",Vt=()=>{const{toPreviousView:e}=(0,n.useContext)(f),t=(0,De.A)(),i=fe(t),a=(()=>{const{flags:e}=Bt(),t=[];return e.forEach((e=>{if(Ut[e]){const{type:i,message:n,title:a}=Ut[e]();"info"===i?t.push({id:e,text:n,title:a,type:lt.INFO}):t.push({id:e,text:n,title:a??"",type:lt.ERROR})}})),t})(),s=a.some(ot),r=a.filter(s?ot:ct);return(0,y.jsx)(A,{onBack:e,children:(0,y.jsxs)("div",{className:Pt,children:[(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:U.Ru.get("web-player.pigeon.overview-card.title")}),(0,y.jsx)(l.E,{variant:"titleMedium",semanticColor:"textBrightAccent",children:i.titleFull||i.title}),(0,y.jsx)("div",{className:Mt,children:i.bitrateDetails?.map(((e,t)=>(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textBrightAccent",children:e},`bitrate-details-${t}`)))}),(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textBrightAccent"}),(0,y.jsx)("div",{className:Ht,children:(0,y.jsx)(_t,{})}),r.map((e=>(0,y.jsx)(pt,{card:e},e.id)))]})})};var qt=i(95740);const zt=({subtitles:e})=>(0,y.jsx)(y.Fragment,{children:e.map(((e,t)=>(0,y.jsx)(l.E,{semanticColor:"textSubdued",variant:"bodySmall",children:e},`subtitle-${t}`)))}),Yt="ZExuZhVAKsqOBfFdR6Js",Gt="G5KBejq8q3GSZxhHs9be",Qt="WG0sT27gl2zSvisQcgHS",Wt="iUbPCgoUSkOoOVEo5wnr",Zt="NCUCNjFgGqpox8ttJKch",Kt=({title:e,isLossless:t})=>(0,y.jsxs)("div",{className:Gt,children:[(0,y.jsx)(l.E,{variant:"bodyMedium",semanticColor:"textBase",children:e}),t&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(l.E,{variant:"bodyMedium",semanticColor:"textBase",children:"•"}),(0,y.jsx)(l.E,{variant:"bodyMedium",semanticColor:"textBrightAccent",children:U.Ru.get("web-player.pigeon.audio-quality.lossless.highest")})]})]});var Jt=i(9413);const Xt=({onClick:e,quality:t,playQuality:i,maxQuality:n})=>{const{title:a,subtitles:s}=(e=>{switch(e){case At.a1.LOSSLESS:return{title:U.Ru.get("web-player.pigeon.audio-quality.lossless"),subtitles:[U.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-1"),U.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-2")]};case At.a1.VERY_HIGH:return{title:U.Ru.get("web-player.pigeon.audio-quality.very-high.label"),subtitles:[U.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate-details.subtitle")]};case At.a1.HIGH:return{title:U.Ru.get("web-player.pigeon.audio-quality.high.label"),subtitles:[U.Ru.get("web-player.pigeon.audio-quality.high.bitrate-details.subtitle")]};case At.a1.MEDIUM:return{title:U.Ru.get("web-player.pigeon.audio-quality.normal.label"),subtitles:[U.Ru.get("web-player.pigeon.audio-quality.normal.bitrate-details.subtitle")]};case At.a1.LOW:return{title:U.Ru.get("web-player.pigeon.audio-quality.low.label"),subtitles:[U.Ru.get("web-player.pigeon.audio-quality.low.bitrate-details.subtitle")]};default:return{title:U.Ru.get("web-player.pigeon.audio-quality.unknown.label"),subtitles:null}}})(t);if(null===a||null===s)return null;const r=i===t,l=t===At.a1.LOSSLESS,o=null===n||t<=n;return(0,y.jsx)(W.v,{id:"title",variant:"naked",verticalGap:"2px","aria-disabled":!o,onClick:e,onClickHint:U.Ru.get("web-player.pigeon.quality-settings.option-hint",a),title:(0,y.jsx)(Kt,{title:a,isLossless:l}),subtitle:(0,y.jsx)(zt,{subtitles:s}),trailing:r?(0,y.jsx)(qt.i,{semanticColor:"textBrightAccent"}):void 0})},$t=()=>{const{toPreviousView:e}=(0,n.useContext)(f),t=(0,H.l)(),{playingFrom:i}=Y(),a=(0,K.t)(),[{data:s},{mutate:r}]=(0,J.K)(a.quality.streamingQuality),[{data:o},{mutate:c}]=(0,J.K)(a.quality.autoAdjustQuality),[{data:u},{mutate:d}]=(0,J.K)(a.quality.remoteQuality),p=(0,Jt.x)();if(void 0===p||void 0===o||void 0===s)return null;let m=s,g=r,v=null;return t&&u&&(m=u.streamingQuality,v=u.maxSupportedQuality,g=e=>d({...u,streamingQuality:e})),(0,y.jsxs)(A,{onBack:e,children:[(0,y.jsxs)("div",{className:Zt,children:[(0,y.jsx)(l.E,{as:"h2",variant:"titleSmall",semanticColor:"textBase",children:U.Ru.get("web-player.pigeon.quality-settings.title")}),(0,y.jsx)(l.E,{semanticColor:"textSubdued",variant:"bodySmall",children:i})]}),(0,y.jsx)("div",{className:Yt,children:p.sort(((e,t)=>e.quality-t.quality)).map(((e,t)=>(0,y.jsx)(Xt,{quality:e.quality,playQuality:m,maxQuality:v,onClick:()=>g(e.quality)},t)))}),(0,y.jsx)(l.E,{children:U.Ru.get("web-player.pigeon.quality-settings.disclaimer")}),(0,y.jsxs)("div",{className:Qt,children:[(0,y.jsx)(l.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:U.Ru.get("web-player.pigeon.quality-settings.listening-preferences")}),(0,y.jsx)(W.v,{className:Wt,variant:"naked",size:"sm",id:"auto-adjust-quality",horizontalGap:"0px",title:(0,y.jsx)(l.E,{variant:"bodyMedium",semanticColor:"textBase",children:U.Ru.get("web-player.pigeon.quality-settings.auto-adjust-quality")}),trailing:(0,y.jsx)(Fe.l,{id:"desktop.settings.automatic-downgrade",value:o,onSelected:c,condensed:!0})}),(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:U.Ru.get("web-player.pigeon.quality-settings.auto-adjust-quality.subtitle-1")}),(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:U.Ru.get("web-player.pigeon.quality-settings.auto-adjust-quality.subtitle-2")})]})]})};var ei=i(38618),ti=i(48330);const ii="GYa976HrK40QHF7ZZvwM",ni="MHROZzo24FoePahYMEFJ",ai="qQ5CfbxUDYyLgy_O6Gah",si=({nrSteps:e,currentStep:t,onClick:i})=>(0,y.jsx)("div",{className:ii,children:Array.from({length:e}).map(((e,n)=>(0,y.jsx)("button",{"aria-label":(0,Re.v)(`Go to Step ${n+1}`),className:d()(ni,{[ai]:t===n}),onClick:()=>i(n)},n)))});var ri=i(24818),li=i(40251),oi=i(80652),ci=i(73211);const ui="Vpnd2l8y0SgEYWxGIRzB",di="cUTxS9VrHd466oEAGs7_",pi="JvZLieWRZZQjIU2ElJ2Y",mi="ub90kjJH_P8M2r1QL_jL",gi="U3xgLhEWHrv2mb_ZSesP",vi="ZiS7XuaKSNH6O814jzTW",xi="W8RJgFmuCgvRsxpnXMWG",bi="pAYPkrJQFNaLczxADAGc",hi="nBOyGCpnbwg691MCewBj",yi="hr6LueujvRuzxi6lBlVZ",ji="zwfOn0Sx4qfhn2imHyQ9",fi="UcHPiDY6dLRbaeY65j16",Si="KsS00iz9PKUXYN0PHhno",Ci="h66wSXbM4f8lkj4EppJQ",wi=({imageUrl:e,max:t,alt:i=""})=>{const n=(0,ci.dZ)();return(0,y.jsx)(oi._,{className:gi,src:n(e,t),loading:"eager",alt:i})};var Ni=i(2150);const ki=({path:e,loop:t=!0})=>(0,y.jsx)(n.Suspense,{fallback:null,children:(0,y.jsx)(Ni.o,{loop:t,autoplay:!0,path:e,className:mi,style:{width:"auto",height:"100%"}})});var Ei=i(90435);function Ri({children:e,variant:t}){const i=(0,n.useRef)(null);return(0,Ei.i)({ref:i}),(0,y.jsx)(l.E,{variant:t,semanticColor:"textBase",className:hi,tabIndex:-1,ref:i,children:e})}const Ii={[N.E.SMALL]:{titleVariant:"bodyMediumBold",subtitleVariant:"marginalBold",bodyVariant:"bodySmall",containerGap:0,headerGap:0,assetGap:8,subtitleGap:4,titleGap:4,buttonGap:12,assetMaxHeight:165},[N.E.MEDIUM]:{titleVariant:"titleSmall",subtitleVariant:"marginalBold",bodyVariant:"bodySmall",containerGap:16,headerGap:24,assetGap:24,subtitleGap:12,titleGap:8,buttonGap:24,assetMaxHeight:240},[N.E.LARGE]:{titleVariant:"titleMedium",subtitleVariant:"bodySmall",bodyVariant:"bodyMedium",containerGap:32,headerGap:32,assetGap:48,subtitleGap:16,titleGap:8,buttonGap:32,assetMaxHeight:320}},Li="AOGvMtDLQNbo94n8r8mu",Ai="gf6sr0Z5UAyf7ULRfSFA",Ti=({icon:e,text:t,highlighted:i,condensed:n=!1,className:a})=>(0,y.jsxs)("div",{className:d()(Li,a),children:[(0,y.jsx)(e,{size:n?"xsmall":"small",semanticColor:"textBase",className:d()({[Ai]:i})}),(0,y.jsx)(l.E,{variant:n?"marginalBold":"bodySmallBold",semanticColor:"textBase",className:d()({[Ai]:i}),children:t})]});var Oi=i(4002);const Di=({onboardingContent:e,onNext:t,onTertiaryClick:i,layout:s="vertical",showLoader:r=!1})=>{const{bodyTitle:o,bodySubtitle:u,bodyText:p,imageUrl:m,lottiePath:g,loopAnimation:v=!0,subtitleIcon:x,buttonText:b,tertiaryButtonText:h}=e,j=(0,k.y)(),{titleVariant:f,subtitleVariant:S,bodyVariant:C,containerGap:w,headerGap:E,assetGap:R,subtitleGap:I,titleGap:L,buttonGap:A,assetMaxHeight:T}=(0,n.useMemo)((()=>{let e=N.E.MEDIUM;switch(j){case N.E.SMALL:e=N.E.SMALL;break;case N.E.MEDIUM:e=N.E.MEDIUM;break;case N.E.LARGE:e=N.E.LARGE}return Ii[e]}),[j]),O=(0,n.useRef)(null),D=(0,Oi.j)();return(0,y.jsx)(ri.A,{mode:"out-in",children:(0,y.jsx)(a.A,{timeout:D?0:800,classNames:{enter:ji,enterActive:fi,exit:Si,exitActive:Ci},nodeRef:O,children:(0,y.jsx)("div",{className:ui,style:{"--onboarding-container-gap":`${w}px`,"--onboarding-asset-gap":`${R}px`,"--onboarding-subtitle-gap":`${I}px`,"--onboarding-title-gap":`${L}px`,"--onboarding-button-gap":`${A}px`,"--onboarding-asset-max-height":`${T}px`,"--onboarding-header-gap":`${E}px`},ref:O,children:(0,y.jsxs)("div",{className:d()(di,{[vi]:"horizontal"===s}),children:[(0,y.jsxs)("div",{className:pi,children:[m?(0,y.jsx)(wi,{imageUrl:m,max:T}):null,g?(0,y.jsx)(ki,{path:g,loop:v}):null]}),(0,y.jsxs)("div",{className:xi,children:[(0,y.jsx)(Ti,{icon:x,text:u,condensed:j!==N.E.LARGE,highlighted:!0,className:bi,variant:S}),(0,y.jsx)(Ri,{variant:f,children:o}),(0,y.jsx)(l.E,{variant:C,children:p}),(0,y.jsx)("div",{className:yi,children:r?(0,y.jsx)(li.m,{}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(c.$,{colorSet:"invertedLight",size:j===N.E.LARGE?"medium":"small",onClick:t,children:b}),i&&h?(0,y.jsx)(me.H,{size:j===N.E.LARGE?"medium":"small",onClick:i,condensed:!0,children:e.tertiaryButtonText}):null]})})]})]})})},o)})};const Bi=({variant:e})=>(0,y.jsx)(l.E,{variant:e,semanticColor:"textBase",children:"Spotify"}),_i=()=>[{bodyTitle:U.Ru.get("web-player.pigeon.introduction.step-1.title"),bodySubtitle:"Lossless",bodyText:U.Ru.get("web-player.pigeon.introduction.step-1.subtitle"),subtitleIcon:ei.Q,buttonText:U.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc00009256c4d947fba90f6244343446ee"},{bodyTitle:U.Ru.get("web-player.pigeon.introduction.step-2.title"),bodySubtitle:"Lossless",bodyText:U.Ru.get("web-player.pigeon.introduction.step-2.subtitle"),subtitleIcon:ei.Q,buttonText:U.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc00005e4e6fd833f6f5c2cf4f81c1da66"},{bodyTitle:U.Ru.get("web-player.pigeon.introduction.step-3.title"),bodySubtitle:"Lossless",bodyText:U.Ru.get("web-player.pigeon.introduction.step-3.subtitle"),subtitleIcon:ei.Q,buttonText:U.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc000092564a451c0c1fba3acf8fed995f"},{bodyTitle:U.Ru.get("web-player.pigeon.introduction.step-4.title"),bodySubtitle:"Lossless",bodyText:U.Ru.get("web-player.pigeon.introduction.step-4.subtitle"),subtitleIcon:ei.Q,buttonText:U.Ru.get("web-player.pigeon.introduction.button.done"),imageUrl:"spotify:image:ab671fcc000092562f3465b95599cdb50e47604e"}],Fi=()=>{const[e,t]=Te(),{setCurrentView:i,toPreviousView:a,viewTransitions:s}=(0,n.useContext)(f),{spec:r,logger:l}=(0,et.r)(ti.m,{}),o=s[p.DiscoverLossless],{onNext:c,onBack:u,currentStep:d,goTo:m}=function(e){const[t,i]=(0,n.useState)(0),[a,s]=(0,n.useState)(!1),r=(0,n.useCallback)((()=>{t!==e-1?i(t+1):s(!0)}),[t,e]),l=(0,n.useCallback)((()=>{0!==t&&i(t-1),a&&s(!1)}),[t,a]),o=(0,n.useCallback)((t=>{t>=0&&t<e&&i(t),t===e?s(!0):a&&s(!1)}),[e,a]);return{currentStep:t,onNext:r,onBack:l,reachedEnd:a,goTo:o}}(_i().length),g=(0,n.useCallback)((()=>{l.logInteraction(r.closeButtonFactory().hitUiHide()),i(o.continue)}),[l,i,r,o.continue]);return(0,y.jsxs)(A,{titleSlot:(0,y.jsx)(Bi,{variant:"bodySmallBold"}),onBack:()=>{l.logInteraction(r.backButtonFactory().hitUiHide()),d>0?u():a()},onClose:g,preventDefaultClose:!0,children:[(0,y.jsx)(Di,{onboardingContent:_i()[d],onNext:()=>{3===d?(l.logInteraction(r.doneButtonFactory().hitUiHide()),t(!0),i(o.continue)):c()}}),(0,y.jsx)(si,{nrSteps:_i().length,currentStep:d,onClick:m})]})};var Ui=i(92760),Pi=i(53371);const Mi=e=>({bodyTitle:U.Ru.get("web-player.puffin.activation-2.title",e.headphoneDevice?.deviceName),bodySubtitle:U.Ru.get("web-player.puffin.signifier-text"),lottiePath:(0,Pi.b)("animations/puffin-onboarding-tour-2.json"),subtitleIcon:ze.C,buttonText:U.Ru.get("web-player.puffin.activation-2.button-confirm"),tertiaryButtonText:U.Ru.get("web-player.puffin.activation-2.button-cancel"),loopAnimation:!1}),Hi=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(f),{deviceFilterState:i,isMaybeHeadphoneDevice:a,isLoading:s}=(0,ae.j)(),r=t[p.ActivationDetection];(0,n.useLayoutEffect)((()=>{i.headphoneDevice||s||!a||e(p.ManualSelection,{showDialogOnBack:!0})}),[i.headphoneDevice,s,a,e]);const l=(0,n.useMemo)((()=>i?.wasAmbiguous),[i]);return(0,y.jsx)(Di,{onboardingContent:Mi(i),onNext:()=>{e(l?r.airpods:r.continue)},onTertiaryClick:()=>{e(r.selectManually)},showLoader:s||!i.headphoneDevice})},Vi=()=>{const{deviceFilterState:e,isLoading:t}=(0,ae.j)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(f),s=a[p.ActivationIntro],r=(0,n.useCallback)((()=>{e.toggleTuneHeadphones?i(s.continue):i(s.selectManually,{showDialogOnBack:!0})}),[e,i,s.continue,s.selectManually]),l={bodyTitle:U.Ru.get("web-player.puffin.activation-1.title"),bodySubtitle:U.Ru.get("web-player.puffin.signifier-text"),lottiePath:(0,Pi.b)("animations/puffin-onboarding-tour-1.json"),subtitleIcon:ze.C,buttonText:U.Ru.get("web-player.puffin.activation-1.button")};return(0,y.jsx)(Di,{onboardingContent:l,onNext:r,showLoader:t||!e.audioDevice})};var qi=i(30767),zi=i(44335);const Yi=e=>{const{deviceFilterState:t}=(0,ae.j)(),{setCurrentDevice:i}=re(),a=(0,qi.vh)(),{setCurrentView:s}=(0,n.useContext)(f),r=(0,n.useCallback)((async()=>{i(t.headphoneDevice,!0);try{await t.setFilterState({specificEnabled:!!t.toggleTuneHeadphones,externalizationEnabled:!!t.toggleTuneStudio})}catch{return void s(p.Error)}((e,t)=>{e.send((0,zi.d)({has_tuner:!!t.toggleTuneHeadphones,filter_brand:t.headphoneDevice?.brand??null,filter_model:t.headphoneDevice?.model??null,was_predicted:!!t.predictedState,headphone_name_over_bluetooth:t.audioDevice?.transportType===P.Yg.BLUETOOTH?t.audioDevice.name:null,external_accessory_mapping_predicted_brand:t.predictedState?.predictedBrand??null,external_accessory_mapping_predicted_model:t.predictedState?.predictedModel??null,was_matched:(t.predictedState?.wasMatched&&!t.headphoneDevice?.isAmbiguous)??!1,was_ambiguous:t.headphoneDevice?.isAmbiguous??!1,was_manually_selected:(t.headphoneDevice?.isAmbiguous||t.headphoneDevice?.wasSelectedManually)??!1}))})(a,t),e()}),[t,a,e,i,s]);return{handleClick:r}},Gi=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(f),{spec:i,logger:a}=(0,et.r)(Ui.i,{}),s=t[p.ActivationSignifiers],{handleClick:r}=Yi((()=>{a.logInteraction(i.doneButtonFactory().hitUiHide()),e(s.activate)}));return(0,y.jsx)(Di,{onboardingContent:{bodyTitle:U.Ru.get("web-player.puffin.activation-3.title"),bodySubtitle:U.Ru.get("web-player.puffin.signifier-text"),bodyText:U.Ru.get("web-player.puffin.activation-3.subtitle"),imageUrl:"spotify:image:ab671fcc00005e4ed89275c5e4eef1d432ac3fe2",subtitleIcon:ze.C,buttonText:U.Ru.get("web-player.puffin.button.done"),loopAnimation:!0},onNext:r})},Qi="FcycLYpZEbmuEClARSPP",Wi="NSoA0u_DehEmTu_M20Qn",Zi="fGnSEIwIPGid9ALC9ANP",Ki="ZknipG1So_RdKeJ911k3",Ji=({number:e,message:t})=>(0,y.jsxs)("div",{className:Zi,children:[(0,y.jsx)("div",{className:Ki,children:(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textBase",children:e})}),(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:t})]}),Xi=()=>{const{setCurrentView:e}=(0,n.useContext)(f);return(0,y.jsxs)("div",{className:Qi,children:[(0,y.jsx)(l.E,{variant:"titleSmall",semanticColor:"textBase",children:U.Ru.get("web-player.puffin.device-connection-lost.title")}),(0,y.jsxs)("div",{className:Wi,children:[(0,y.jsx)(Ji,{number:1,message:U.Ru.get("web-player.puffin.device-connection-lost.tip-1")}),(0,y.jsx)(Ji,{number:2,message:U.Ru.get("web-player.puffin.device-connection-lost.tip-2")}),(0,y.jsx)(Ji,{number:3,message:U.Ru.get("web-player.puffin.device-connection-lost.tip-3")}),(0,y.jsx)(Ji,{number:4,message:U.Ru.get("web-player.puffin.device-connection-lost.tip-4")})]}),(0,y.jsx)(me.H,{semanticColor:"textSubdued",onClick:()=>{e(p.Overview)},children:"Still not working"})]})},$i=()=>{const{removeCurrentDevice:e}=re();return ne({title:U.Ru.get("web-player.puffin.activation-dialog.title"),description:U.Ru.get("web-player.puffin.activation-dialog.subtitle"),confirmButtonText:U.Ru.get("web-player.puffin.activation-dialog.button-cancel"),cancelButtonText:U.Ru.get("web-player.puffin.activation-dialog.button-confirm"),onConfirm:()=>{e(!0),(0,ee.I)("SETUP_HEADPHONES_BUTTON")}})},en=({type:e})=>{const{isMaybeHeadphoneDevice:t}=(0,ae.j)(),{spec:i,logger:a}=(0,et.r)(Ui.i,{}),{triggerDialog:s,dialog:r}=$i(),l=(0,n.useCallback)((()=>{a.logInteraction(i.closeButtonFactory().hitUiHide()),s(!0)}),[a,i,s]),o=(0,n.useCallback)((()=>{a.logInteraction(i.backButtonFactory().hitUiReveal()),s(!1)}),[a,i,s]);return(0,y.jsx)(A,{titleSlot:(0,y.jsx)(Bi,{variant:"bodySmallBold"}),onClose:l,onBack:o,preventDefaultClose:!0,children:t?(0,y.jsxs)(y.Fragment,{children:[r,"intro"===e&&(0,y.jsx)(Vi,{}),"detection"===e&&(0,y.jsx)(Hi,{}),"signifiers"===e&&(0,y.jsx)(Gi,{})]}):(0,y.jsx)(Xi,{})})};var tn=i(25420),nn=i(89695),an=i(27112),sn=i(8991),rn=i(50428);const ln=({device:e,onClick:t,isAirpodDevice:i})=>{const n=i?`${e.model} (${e.releaseYear})`:e.model,a=i?U.Ru.get("web-player.puffin.manual-selection.models-list",e.modelNumbers.join(U.Ru.getSeparator())):e.brand;return(0,y.jsx)(rn.c,{children:(0,y.jsx)(W.v,{variant:"naked",size:"md",isInteractive:!0,id:e.id,title:(0,y.jsx)(ke.d,{onClick:()=>{t(e)},children:n}),subtitle:a,trailing:(0,y.jsx)(sn.V,{size:"small",semanticColor:"textSubdued"}),onClick:()=>{t(e)},hoverAnimationDuration:"0s"},e.id)})},on="fjltNoIqUMIY7LfgtvCH",cn="WNi2uq00PuqJnOvv6b6a",un="W3HfPxIGTvmPJNItOM5A",dn="T3zyYZ33nGeJfw6NgwwV",pn="fr_QT3qQxce_KdFUhktQ",mn="wMsnDxvKohBJOUguxi8p",gn="O842FkxrdjAlid2byB9c",vn="E6yKOmbA9ekxMnRhJDnA",xn="sm96uN6u5WGLjNfbT6kF",bn="bWJ8TFqqyCV4TqeScz7D",hn="SRl_K6g2YOd8qrpIFij7",yn=({search:e})=>(0,y.jsxs)("div",{className:vn,children:[(0,y.jsx)(l.E,{semanticColor:"textBase",variant:"titleSmall",className:xn,children:U.Ru.get("web-player.puffin.manual-selection.empty.title",(0,y.jsx)("span",{className:bn,children:(0,y.jsx)("span",{className:hn,children:e})}))}),(0,y.jsx)(l.E,{semanticColor:"textSubdued",variant:"bodySmall",children:U.Ru.get("web-player.puffin.manual-selection.empty.subtitle")})]}),jn={id:"unknown_device",brand:"",model:"",deviceName:"Generic",modelNumbers:[],releaseYear:""},fn=({devices:e,isAirpodsList:t=!1})=>{const{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(f),s=t?a[p.AirpodsSelection]:a[p.ManualSelection],{filter:r,setFilter:l}=(0,n.useContext)(nn.g),{setCurrentDevice:o}=re(),c=(0,n.useCallback)((e=>{const n=e?{...e,wasSelectedManually:!0,isAmbiguous:t}:null;o(n,!0),i(e?.id===jn.id?s.notFound:s.continue),l("")}),[t,o,i,s.notFound,s.continue,l]),u=e.filter((({deviceName:e,brand:t,model:i,modelNumbers:n})=>[e,t,i,...n].some((e=>e.toLowerCase().includes(r.toLowerCase())))));return(0,y.jsxs)("div",{className:mn,children:[(0,y.jsx)(an.$,{children:u.map((e=>(0,y.jsx)(ln,{device:e,onClick:c,isAirpodDevice:t},e.id)))}),0===u.length&&(0,y.jsx)(yn,{search:r}),(0,y.jsx)("div",{className:pn,children:(0,y.jsx)(pe.n,{size:"small",onClick:()=>{c(jn)},children:U.Ru.get("web-player.puffin.manual-selection.not-found-button")})})]})};var Sn=i(22640);const Cn=()=>{const e=(0,se.N)(),{data:t,isLoading:i,isError:n}=(0,Sn.I)({queryKey:["puffin-devices"],queryFn:async()=>await e.getDevices(),gcTime:18e5,staleTime:6e5});return{data:t??null,loading:i,error:n}},wn=()=>{const{toPreviousView:e}=(0,n.useContext)(f),{data:t}=Cn(),i=(0,n.useMemo)((()=>t?.filter((e=>"apple"===e.brand.toLowerCase()&&e.model.toLowerCase().includes("airpods")))),[t]);return(0,y.jsx)(A,{onBack:()=>{e()},children:(0,y.jsxs)(nn.s,{uri:"spotify:internal:bettersound",children:[(0,y.jsxs)("div",{className:cn,children:[(0,y.jsx)("div",{className:un}),(0,y.jsxs)("div",{className:dn,children:[(0,y.jsx)(l.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:U.Ru.get("web-player.puffin.manual-selection.airpods.title")}),(0,y.jsx)(l.E,{variant:"bodySmall",children:U.Ru.get("web-player.puffin.manual-selection.airpods.subtitle")})]}),(0,y.jsx)(tn.S,{placeholder:U.Ru.get("web-player.puffin.manual-selection.airpods.search-placeholder"),alwaysExpanded:!0,fullWidth:!0,debounceFilterChangeTimeout:0})]}),i?(0,y.jsx)("div",{className:on,children:(0,y.jsx)(fn,{devices:i,isAirpodsList:!0})}):(0,y.jsx)("div",{className:gn,children:(0,y.jsx)(li.m,{})})]})})},Nn=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(f),i=t[p.IncompatibleHeadphones],{handleClick:a}=Yi((()=>e(i.continue))),{toPreviousView:s}=(0,n.useContext)(f);return(0,y.jsx)(A,{onBack:()=>{s()},titleSlot:(0,y.jsx)(Bi,{variant:"bodySmallBold"}),children:(0,y.jsx)(Di,{onboardingContent:{bodyTitle:(0,Re.v)("These headphones are not compatible with Optimize yet."),bodySubtitle:(0,Re.v)("Optimize"),bodyText:(0,Re.v)("Only some devices work with Optimize. We're expanding our compatible devices to support a wider range of headphones."),imageUrl:"spotify:image:ab671fcc000092562c122d1cc442ac4f3c8dbab4",subtitleIcon:ze.C,buttonText:(0,Re.v)("Close")},onNext:a})})},kn=()=>{const{toPreviousView:e,viewOptions:t}=(0,n.useContext)(f),{data:i}=Cn(),{triggerDialog:a,dialog:s}=$i();return(0,y.jsxs)(A,{onBack:()=>{t?.showDialogOnBack?a():e()},titleSlot:(0,y.jsx)(Bi,{variant:"bodySmallBold"}),children:[s,(0,y.jsxs)(nn.s,{uri:"spotify:internal:bettersound",children:[(0,y.jsxs)("div",{className:cn,children:[(0,y.jsx)("div",{className:un}),(0,y.jsxs)("div",{className:dn,children:[(0,y.jsx)(l.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:U.Ru.get("web-player.puffin.manual-selection.title")}),(0,y.jsx)(l.E,{variant:"bodySmall",children:U.Ru.get("web-player.puffin.manual-selection.subtitle")})]}),(0,y.jsx)(tn.S,{placeholder:U.Ru.get("web-player.puffin.manual-selection.search-placeholder"),alwaysExpanded:!0,fullWidth:!0,debounceFilterChangeTimeout:0})]}),i?(0,y.jsx)("div",{className:on,children:(0,y.jsx)(fn,{devices:i})}):(0,y.jsx)("div",{className:gn,children:(0,y.jsx)(li.m,{})})]})]})};var En=i(99983);const Rn=()=>{const{currentView:e}=(0,n.useContext)(f);switch(e){case p.ActivationIntro:return(0,y.jsx)(en,{type:"intro"});case p.ActivationDetection:return(0,y.jsx)(en,{type:"detection"});case p.ActivationSignifiers:return(0,y.jsx)(en,{type:"signifiers"});case p.Error:return(0,y.jsx)(D,{});case p.ManualSelection:return(0,y.jsx)(kn,{});case p.AirpodsSelection:return(0,y.jsx)(wn,{});case p.Overview:return(0,y.jsx)(nt,{});case p.AudioQualitySettings:return(0,y.jsx)($t,{});case p.AudioQualityDetails:return(0,y.jsx)(Vt,{});case p.DiscoverLossless:return(0,y.jsx)(Fi,{});case p.IncompatibleHeadphones:return(0,y.jsx)(Nn,{});default:return(0,En.k)(e),null}},In=()=>{const{currentView:e}=(0,n.useContext)(f),t=(0,g._Y)(),i=(0,g.XB)(),a=[v.Z.Puffin,v.Z.PuffinActivation,v.Z.PuffinOverlay,v.Z.PuffinActivationOverlay].some((e=>e===i)),s=[p.ActivationIntro,p.ActivationDetection,p.ActivationSignifiers,p.ManualSelection,p.IncompatibleHeadphones].includes(e);return(0,n.useEffect)((()=>{a&&t(s?ie.$S.PUFFIN_START_ACTIVATION:ie.$S.PUFFIN_FINISH_ACTIVATION)}),[t,s,a]),(0,y.jsxs)("div",{className:R,children:[(0,y.jsx)(Rn,{}),false]})},Ln=()=>(0,y.jsx)(at._,{label:"Puffin",focusTransferId:"PUFFIN",children:(0,y.jsx)(r.s,{Fallback:B,children:(0,y.jsx)(S,{children:(0,y.jsx)(In,{})})})});var An=i(83435),Tn=i(72158);function On(e){return e.sort(((e,t)=>t.timestamp-e.timestamp))}function Dn(e,t){return t.some((t=>t.user.uri===e.user.uri))?t:On([...t,e])}function Bn(e,t){return t.filter((t=>t.user.uri!==e))}var _n=i(76082);var Fn=i(60760),Un=i(27086);function Pn(){const e=(0,Tn.C)(),t=(0,An.jE)(),i=["friend-activity"],a=e=>{t.setQueryData(i,((t=[])=>{const i=Array.isArray(e)?e.at(0):e;return i?function(e,t){return On(t.map((t=>t.user.uri===e.user.uri?e:t)))}(i,t):t}))},{subscribeToFriend:s,unSubscribeFromFriend:r,subscribeAndFetchFeed:l}=function(e){const t=(0,Tn.C)(),i=(0,n.useRef)({}),a=(0,n.useRef)(e);a.current=e;const s=(0,n.useCallback)((e=>{const n=(0,_n.o_h)(e)?.username,s=t.subscribeToBuddyActivity(n,(e=>{e&&a.current(e)}));return i.current[e]=s,s}),[t]),r=(0,n.useCallback)((e=>{i.current[e]?.cancel(),delete i.current[e]}),[]),l=(0,n.useCallback)(((e,i,n)=>t.fetchFriendActivityWithSubscriptions(e,i,n)),[t]);return(0,n.useEffect)((()=>{const e=i.current;return()=>{Object.values(e).forEach((e=>{e.cancel()}))}}),[t]),{subscribeToFriend:s,unSubscribeFromFriend:r,subscribeAndFetchFeed:l}}(a),o=(0,n.useRef)();(0,n.useEffect)((()=>()=>o.current?.cancel()),[]);const c=(0,Sn.I)({queryKey:i,queryFn:()=>new Promise(((e,t)=>{o.current=l(a,e,t)})).then((e=>On(e))),staleTime:6e5,gcTime:36e5,refetchInterval:864e5,refetchOnWindowFocus:!1,refetchOnMount:"always",refetchOnReconnect:!0});return(0,Un.N)(Fn.mc.OPERATION_COMPLETE,(async n=>{const a=n.data.uris;if(n.data.operation!==Fn.JK.FOLLOW_USER){if(n.data.operation===Fn.JK.UNFOLLOW_USER)for(const e of a)r(e),t.setQueryData(i,((t=[])=>Bn(e,t)))}else for(const n of a){const a=(await e.fetchFriendActivity([n])).at(0);a&&(t.setQueryData(i,((e=[])=>Dn(a,e))),s(n))}})),c}const Mn=(0,n.lazy)((()=>i.e(7564).then(i.bind(i,39503))));function Hn(){const{data:e,error:t,isLoading:i}=Pn();return!(0,Tt.n)()||i||t?null:(0,y.jsx)(Mn,{friends:e??[]})}var Vn=i(11165),qn=i(66521);const zn="device-picker-section-heading",Yn="device-picker-troubleshooting-list";var Gn=i(61165);const Qn="uqXaqvqZq1oSLhXLYRo9",Wn="YuPZ1nUe5BAH7HJworb6",Zn="aVWZBvlWjLJFYO_GE5qL",Kn="wWalUsrOkGgHa0u8o86Q",Jn="yNttGX9uUxTih93MKEWB",Xn="kD25df_SN_uDB8lhZgQB",$n="szp7gPJjKd4T69SzCEpF",ea="E912cqRfb05FrRPFKDZ_",ta="D7sZlTAybIM02cRvh4sV",ia="xdAVCtEIoo_8z_Ubj7tU",na=({foundDevices:e})=>{const t=(0,s.NC)(Gn.Q5);if(e&&t)return null;let i;return i=e?U.Ru.get("web-player.connect.device-picker.select-another-device"):U.Ru.get("web-player.connect.device-picker.no-devices-found"),(0,y.jsx)("span",{className:Jn,id:zn,"data-testid":zn,children:(0,y.jsx)(l.E,{as:"h2",variant:"bodyMediumBold",semanticColor:"textBase",children:i})})};var aa=i(15001),sa=i(42993),ra=i(40638),la=i(57802),oa=i(59486),ca=i(12686),ua=i(42738),da=i(21349),pa=i(77663),ma=i(61570),ga=i(84760),va=i(25658),xa=i(26445),ba=i(55046),ha=i(46470),ya=i(75332),ja=i(65118),fa=i(63112);var Sa=i(54843);const Ca="mFr6W9mwg0p_c7eJlhc_",wa="lpPBKkIGJcyWu59iOpsS",Na=({deviceId:e,connectStateDeviceId:t,allowForgetDevice:i,incarnation:n})=>{const a=(0,fa.N)(ja.r),s=(0,le.s)(),{spec:r}=(0,et.r)(xa.d,{}),l=(0,Sa.t)(r),o=r.forgetDeviceButtonFactory(),c=(0,Sa.t)(o),u=r.deviceIncarnationContainerFactory(),d=(0,Sa.t)(u);return i||n?(0,y.jsx)("span",{ref:l,className:wa,children:(0,y.jsxs)(ba.W,{children:[i&&(0,y.jsx)(ya.D,{role:"menuitem",leadingIcon:(0,y.jsx)(va.V,{size:"small"}),onClick:()=>{s.logInteraction(o.hitLogoutFromRemoteDevice({remoteDeviceId:t})),a.logout(e)},elementRef:c,children:U.Ru.get("web-player.connect.context-menu.log-out-of-device")}),n&&(0,y.jsxs)("div",{ref:d,children:[(0,y.jsx)(ha.y,{children:U.Ru.get("web-player.connect.context-menu.incarnation-title")}),n.available.map((i=>{const{icon:r,text:l}=(e=>{switch(e){case"connect":return{icon:(0,y.jsx)(oa.E,{size:"small"}),text:U.Ru.get("web-player.connect.context-menu.incarnation-connect")};case"cast":return{icon:(0,y.jsx)(ga.m,{size:"small"}),text:U.Ru.get("web-player.connect.context-menu.incarnation-cast")};default:return{}}})(i);return(0,y.jsx)(ya.D,{role:"menuitemradio",leadingIcon:r,onClick:()=>{let r;switch(i){case"cast":r=u.googleCastButtonFactory();break;case"connect":r=u.spotifyConnectButtonFactory()}n.preferred!==i?(r&&s.logInteraction(r.hitChangeRemoteDeviceIncarnation({remoteDeviceId:t})),a.setPreferredIncarnation(e,i)):r&&s.logInteraction(r.hitNoAction())},"aria-checked":n.preferred===i,CheckedIcon:qt.i,children:l},i)}))]})]})}):null};var ka=i(86851);const Ea=({title:e,deviceId:t,connectStateDeviceId:i,allowForgetDevice:a,incarnation:s,className:r,onHide:l,onShow:o,spec:c})=>{const[u,p]=(0,n.useState)(!1),m=c.contextMenuButtonFactory({identifier:i}),g=(0,le.s)(),v=(0,Sa.t)(m);return(0,y.jsx)(ma.b,{renderInline:!0,menu:(0,y.jsx)(ka.r,{spec:m,children:(0,y.jsx)(Na,{deviceId:t,connectStateDeviceId:i,allowForgetDevice:a,incarnation:s})}),onShow:()=>{p(!0),o?.()},onHide:()=>{p(!1),l?.()},offset:[0,-8],children:(0,y.jsx)(pa.e,{ref:v,size:pa.M.xs,label:U.Ru.get("more.label.context",e),className:d()(Ca,r),onClick:e=>{e.stopPropagation(),g.logInteraction(u?m.hitUiHide():m.hitUiReveal())}})})},Ra=(0,n.createContext)({rowWithMenuOpenIdentifier:null,setRowWithMenuOpenIdentifier:()=>{}}),Ia=({children:e})=>{const[t,i]=(0,n.useState)(null),a=(0,n.useMemo)((()=>({rowWithMenuOpenIdentifier:t,setRowWithMenuOpenIdentifier:i})),[t]);return(0,y.jsx)(Ra.Provider,{value:a,children:e})},La=e=>e instanceof aa.B.ContainerViewEventFactory.DeviceListEventFactory.RemoteDeviceEventFactory||e instanceof aa.B.ContainerViewEventFactory.DeviceListEventFactory.DisabledDeviceEventFactory||e instanceof aa.B.ContainerViewEventFactory.OffNetworkDeviceListEventFactory.RemoteDeviceEventFactory||e instanceof aa.B.ContainerViewEventFactory.OffNetworkDeviceListEventFactory.DisabledDeviceEventFactory||e instanceof aa.B.ContainerViewEventFactory.OnNetworkDeviceListEventFactory.RemoteDeviceEventFactory,Aa=e=>e instanceof aa.B.ContainerViewEventFactory.DeviceListEventFactory.RemoteDeviceEventFactory;var Ta=i(12604),Oa=i(28415);const Da="AWblt0YATqa_XQaPUDMc",Ba="sX7AwqoSzMeT9qhlEViU",_a="jIlVu16bmijzUKG6u5VW",Fa="ZkuPLR9bss2N7f7thixx",Ua="QSZFk1XCj76mVplNmiV1",Pa="O0wmxPM0kfA59paiHqR9",Ma=(0,n.forwardRef)((function({deviceId:e,connectStateDeviceId:t,Icon:i,TechIcon:a,title:s,subtitle:r,canLogout:l,isDisabled:o,incarnation:c,jamSession:u,onClick:p,spec:m},v){const x=(0,g._Y)(),b=(0,Ta.HJ)(c),h=l||b,{rowWithMenuOpenIdentifier:j,setRowWithMenuOpenIdentifier:f}=(0,n.useContext)(Ra),S=(0,Sa.t)(Aa(m)&&u?.token?m.inPersonListeningSessionFactory({identifier:u.sessionId??u.token}):void 0,!!u?.token),C=(0,ra.YQ)((()=>{p(),x(ie.$S.PANEL_CLOSE_CLICK)}),1e3,{leading:!0,trailing:!1}),w=(0,n.useCallback)((e=>{"Enter"===e.key&&C()}),[C]),N=(0,y.jsx)(Na,{deviceId:e,connectStateDeviceId:t,allowForgetDevice:l,incarnation:b?c:void 0}),k=u?.participants.find((e=>e.id===u.sessionOwnerId))?.displayName,E=u?.jamType===Oa.H.NEARBY_JAM?(0,y.jsx)(la.C,{"data-testid":"sub-nearby-jam-icon",semanticColor:"textBrightAccent",size:"small"}):(0,y.jsx)(oa.E,{"data-testid":"sub-jam-icon",semanticColor:"textBrightAccent",size:"small"}),R=k&&!u.isSessionOwner?(0,y.jsxs)("div",{className:Ba,ref:S,children:[E,(0,y.jsx)(ca.j,{semanticColor:"textBrightAccent",lineClamp:1,children:U.Ru.get("web-player.social-connect.broadcasting.bradcasting-device-subtitle",{host:k})})]}):(0,y.jsxs)("div",{className:Ba,children:[a&&(0,y.jsx)(a,{className:_a,semanticColor:"textSubdued","data-testid":"sub-icon",role:"presentation",size:"small"}),r&&(0,y.jsx)(ca.j,{semanticColor:"textSubdued",lineClamp:1,children:r})]});return(0,y.jsx)(ua.h,{menu:N,children:(0,y.jsx)(rn.c,{onKeyDown:w,onClick:C,className:d()(Fa,{[Pa]:j===e}),children:(0,y.jsx)(W.v,{id:e,ref:v,"data-testid":"device-picker-row-sidepanel",media:(0,y.jsx)(i,{semanticColor:o?"textSubdued":"textBase","data-testid":"main-icon",role:"presentation"}),onClick:()=>{},onClickHint:U.Ru.get("web-player.connect.device-picker.connect-to-device"),title:(0,y.jsx)("span",{className:Da,children:(0,y.jsx)(da.Zp,{label:s,renderInline:!0,children:(0,y.jsx)(ke.d,{"data-testid":"list-row-title",lineClamp:1,semanticColor:o?"textSubdued":"textBase",dir:"auto",children:s})})}),subtitle:R,trailing:h&&La(m)&&(0,y.jsx)(Ea,{title:s,deviceId:e,connectStateDeviceId:t,allowForgetDevice:l,incarnation:b?c:void 0,spec:m,className:d()(Ua),onShow:()=>{f(e)},onHide:()=>{f(null)}})})})})})),Ha=({position:e,deviceId:t,connectStateDeviceId:i,deviceName:n,deviceType:a,deviceModelName:s,isGroup:r,disabledReason:l,canLogout:o,spec:c})=>{const u=(0,Ta.tf)(a,r),{helpText:d}=(0,Ta.uY)(l,(0,Ta.p2)(a,s)),p=c.disabledDeviceFactory({identifier:i,position:e,reason:l??"null"}),m=(0,Sa.t)(p),g=(0,F.wA)();return(0,y.jsx)(Ma,{deviceId:t,connectStateDeviceId:i,ref:m,isDisabled:!0,disabledReason:l,Icon:u,title:n,subtitle:d,canLogout:o,onClick:()=>{l===q.bU.RESTRICTED&&g((0,sa.yx)(t))},spec:p})};var Va=i(55413);const qa=({isDisabled:e=!1,spec:t})=>{const i=(0,F.wA)(),n=t.containerViewFactory().deviceListFactory().castPlaceholderFactory(),a=(0,Sa.t)(n),s=(0,Ta.$A)(q.bq.CAST_AUDIO,"disconnected"),r=(0,le.s)();return(0,y.jsx)(Ma,{deviceId:"cast-placeholder",connectStateDeviceId:"cast-placeholder",ref:a,Icon:s,title:U.Ru.get("web-player.connect.device-picker.google-cast-devices"),supportsHiFi:!1,onClick:()=>{r.logInteraction(n.hitUiReveal()),i((0,Va.Ym)())},isDisabled:e,spec:n})};var za=i(87463);const Ya=({deviceId:e,connectStateDeviceId:t,deviceName:i,supportsHiFi:n,spec:a})=>{const s=(0,le.s)(),r=a.localDeviceFactory(),l=(0,Ta.tf)(q.bq.COMPUTER,!1),o=(0,za.D)();return(0,y.jsx)(Ma,{deviceId:e,connectStateDeviceId:t,Icon:l,title:i,supportsHiFi:n,onClick:()=>{const{interactionId:t,pageInstanceId:i}=s.logInteraction(r.hitPullPlaybackToLocalDevice());o.transferPlayback(e,{interactionId:t,pageInstanceId:i})},spec:r})},Ga=()=>{const[e,t]=(0,Ae.x)("connect-picker-recent-transfers",{});return{registerTransferAttempt:(0,n.useCallback)((i=>{t({...e,[i]:(new Date).getTime()})}),[e,t]),recentTransfersMap:e}};var Qa=i(60848),Wa=i(21701),Za=i(6955),Ka=i(31526),Ja=i(43721),Xa=i(71942);const $a=({position:e,deviceId:t,connectStateDeviceId:i,deviceName:n,deviceType:a,isGroup:r,supportsHiFi:l,canLogout:o,incarnation:c,jamSession:u,spec:d})=>{const p=(0,le.s)(),m=d.remoteDeviceFactory({identifier:i,position:e}),g=(0,Ta.tf)(a,r);let v,x;(0,Ta.Mp)(a)&&(v=(0,Ta.$A)(a,"disconnected"),x=U.Ru.get("web-player.connect.device-picker.google-cast"));const b=(0,F.wA)(),{registerTransferAttempt:h}=Ga(),j=(0,za.D)(),f=(0,Sa.t)(m),S=(0,s.NC)(Gn.Yr),C=(0,Wa.Ad)((e=>{const t=(0,Ja.d)(),i=(0,An.jE)(),n=(0,s.NC)(Gn.$4,{loadingValue:!1}),{data:a}=(0,Sn.I)({queryKey:["useResolveJamFromConnectDevice",e],queryFn:()=>t.getJoinTokenFromConnectDeviceId(e),enabled:n}),{data:r}=(0,Sn.I)({queryKey:["useResolveJamFromConnectDevice",a],queryFn:a?()=>t.getSessionInfo(a):Za.hT,enabled:!!a});return(0,Xa.c)(Ka.P.SCAN_UPDATE,(()=>{i.invalidateQueries({queryKey:["useResolveJamFromConnectDevice",e]})})),r??null})(i));let w;w=S?u??null:C;return(0,y.jsx)(Ma,{deviceId:t,connectStateDeviceId:i,ref:f,Icon:g,TechIcon:v,title:n,subtitle:x,supportsHiFi:l,canLogout:o,incarnation:c,jamSession:w,onClick:()=>{if(w?.token&&!w.isSessionOwner){Aa(m)&&p.logInteraction(m.inPersonListeningSessionFactory({identifier:w.sessionId??w.token}).hitUiReveal());let e=Qa.EL.JOIN_LISTENING_SESSION;w.jamType===Oa.H.NEARBY_JAM&&(e=Qa.EL.JOIN_NEARBY_JAM),b((0,sa.A9)(e,w.token,void 0,{id:t,name:n,type:a,isGroup:r}))}else{const{interactionId:e,pageInstanceId:n}=p.logInteraction(m.hitConnectToRemoteDevice({remoteDeviceId:i}));j.transferPlayback(t,{interactionId:e,pageInstanceId:n}),h(i)}},spec:m})},es=()=>(0,Ot.o)((e=>(e?.restrictions?.disallowTransferringPlaybackReasons?.length??0)>0)),ts=({devices:e,areWebPlayerCastDevicesAvailable:t=!1,networkHeadingID:i="",spec:n})=>{const a=(0,s.NC)(Gn.Yr),r=(0,s.NC)(Gn.Q5),l=es(),o=n.containerViewFactory().deviceListFactory(),c=(0,Sa.t)(o),u=(e,t)=>{const i=U.Ru.get("web-player.connect.device-picker.this-computer"),n=(r||!e.isLocalNetwork)&&e.supportsLogout;if(e.isDisabled)return(0,y.jsx)(Ha,{position:e.isLocal?0:t+1,deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:e.isLocal?i:e.name,deviceType:e.isLocal?q.bq.COMPUTER:e.type,deviceModelName:e.modelDisplayName,isGroup:e.isGroup,disabledReason:e.disabledReason,canLogout:n,spec:o},e.id);if(e.isLocal&&(e=>e instanceof aa.B.ContainerViewEventFactory.DeviceListEventFactory||e instanceof aa.B.ContainerViewEventFactory.OnNetworkDeviceListEventFactory)(o))return(0,y.jsx)(Ya,{deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:i,supportsHiFi:e.supportsHiFi,spec:o},e.id);let s=null;return a&&(0,Wa.HV)(e)?s=e.nearbyJamSession:(0,Wa.C7)(e)&&(s=e.jamSession),(0,y.jsx)($a,{position:t+1,deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:e.name,deviceType:e.type,isGroup:e.isGroup,supportsHiFi:e.supportsHiFi,canLogout:n,incarnation:e.incarnation,jamSession:s,spec:o},e.id)};return(0,y.jsxs)(an.$,{circular:!1,ref:c,"aria-labelledby":`${zn} ${i}`,"data-testid":`devices-list-${i}`,allowsMultipleInteractiveChildrenInItem:!0,children:[e.map(((e,t)=>u(e,t))),t&&(0,y.jsx)(qa,{isDisabled:l,spec:n})]})},is="local-network-heading",ns="other-networks-heading",as=({localNetworkDevices:e,otherNetworksDevices:t,spec:i})=>{const n=(0,s.NC)(Gn.Q5),a=e.length>0?U.Ru.get("web-player.connect.device-picker.on-this-network"):U.Ru.get("web-player.connect.device-picker.no-devices-local-network"),r=!n||n&&e.length<=0;return(0,y.jsxs)(y.Fragment,{children:[r&&(0,y.jsx)(l.E,{as:"h3",variant:n?"bodyMedium":"bodySmall",semanticColor:"textSubdued",className:Xn,id:is,children:a}),e.length>0&&(0,y.jsx)(ts,{devices:e,networkHeadingID:is,spec:i}),t.length>0&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(l.E,{as:"h3",variant:n?"bodyMedium":"bodySmall",semanticColor:"textSubdued",className:d()(Xn,$n),id:ns,children:U.Ru.get("web-player.connect.device-picker.on-other-networks")}),(0,y.jsx)(ts,{devices:t,networkHeadingID:ns,spec:i})]})]})};var ss=i(95339);const rs=({url:e,linkText:t,handleClick:i,elementRef:n})=>(0,y.jsx)("a",{className:d()(Fa),href:e,target:"_blank",ref:n,onClick:i,children:(0,y.jsx)(W.v,{title:t,id:t,isRedundantOnClick:!0,onClick:()=>{},"data-testid":"list-row-external-link",trailing:(0,y.jsx)(ss.H,{size:"small","data-testid":"icon-external-link",semanticColor:"textSubdued",role:"presentation",autoMirror:!0,"aria-hidden":"true"})})}),ls=({spec:e})=>{const t="https://www.spotify.com/connect?utm_campaign=connect&utm_medium=app&utm_source=desktop",i=e.containerViewFactory().externalConnectHubLinkFactory(),n=(0,Sa.t)(i),a=(0,le.s)();return(0,y.jsx)(rs,{url:t,linkText:U.Ru.get("web-player.connect.device-picker.connect-hub-external-link"),elementRef:n,handleClick:()=>{a.logInteraction(i.hitNavigateToExternalUri({destination:t}))}})},os="https://support.spotify.com/article/spotify-connect/",cs=({spec:e})=>{const t=e.containerViewFactory().externalHelpLinkFactory(),i=(0,Sa.t)(t),n=(0,le.s)();return(0,y.jsx)(rs,{url:os,linkText:U.Ru.get("web-player.connect.device-picker.help-external-link"),elementRef:i,handleClick:()=>{n.logInteraction(t.hitNavigateToExternalUri({destination:os}))}})};var us=i(89750);const ds=[us.h.en,us.h.enGB],ps=()=>{const e=U.Ru.getLocaleForTranslation();return ds.includes(e)};const ms=({devices:e,areWebPlayerCastDevicesAvailable:t})=>{es();const i=ps(),n=(0,s.NC)(Gn.Q5),a=e,{recentTransfersMap:r}=Ga(),l=function(e,t){const i=[],n=e.find((e=>e.isLocal));n&&i.push(n);const a=e.filter((e=>!e.isLocal)),{usedDevices:s,unusedDevices:r}=function(e,t){const i=[],n=[];for(const a of e)t[a.sortingId]?i.push({device:a,timestamp:t[a.sortingId]}):n.push(a);return{usedDevices:i,unusedDevices:n}}(a,t);s.sort(((e,t)=>t.timestamp-e.timestamp));for(const e of s)i.push(e.device);const l=i.concat(function(e){return e.sort(((e,t)=>e.isLocal?-1:t.isLocal?1:e.name.toLowerCase().localeCompare(t.name.toLowerCase())))}(r));return l}(a,r),{spec:o}=(0,et.r)(aa.p,{}),c=l.filter((e=>e.isLocalNetwork)),u=l.filter((e=>!e.isLocalNetwork));return(0,y.jsxs)("div",{className:d()(Qn,Wn,{[Zn]:n}),children:[(0,y.jsx)("div",{children:u.length>0?(0,y.jsx)(as,{localNetworkDevices:c,otherNetworksDevices:u,spec:o}):(0,y.jsx)(ts,{devices:l,areWebPlayerCastDevicesAvailable:t,spec:o})}),(0,y.jsxs)("div",{className:d()(ea),children:[(0,y.jsx)(cs,{spec:o}),i&&(0,y.jsx)(ls,{spec:o})]})]})};var gs=i(11745),vs=i(67263),xs=i(46014);const bs=(0,n.forwardRef)((function({Icon:e,title:t,subtitle:i,onClick:n},a){return(0,y.jsx)(rn.c,{className:Fa,children:(0,y.jsx)(W.v,{id:t,ref:a,"data-testid":"device-picker-row-sidepanel",media:(0,y.jsx)(e,{semanticColor:"textSubdued"}),title:(0,y.jsx)("span",{className:Da,children:(0,y.jsx)(da.Zp,{label:t,renderInline:!0,children:(0,y.jsx)(ke.d,{"data-testid":"list-row-title",lineClamp:1,semanticColor:"textBase",dir:"auto",onClick:n,children:t})})}),subtitle:(0,y.jsx)("div",{className:Ba,children:(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:i})}),onClick:n})})}));var hs=i(36415);const ys="Bjx5Gw7p3JoiF4qI6eMQ",js=()=>{const{deviceFilterState:e,isMaybeHeadphoneDevice:t}=(0,ae.j)(),i=(0,ce.j)(),n=(0,$e.v)(),a=(0,De.A)(),s=e.currentState.externalizationEnabled||e.currentState.specificEnabled,r=a===je.Yn.LOSSLESS||a===je.Yn.LOSSLESS_24;return(0,y.jsxs)("div",{className:ys,children:[n&&s&&t&&(0,y.jsx)(ze.C,{size:"small",semanticColor:"textBrightAccent"}),(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textBrightAccent",children:i&&r&&U.Ru.get("web-player.pigeon.audio-quality.lossless")})]})},fs="A3PPnVKE5LH9mT5URPB2",Ss="cU0IpwDfJzDgQaY4MSXA",Cs="dlS4nc0WL68C7_8zwfiS",ws="pdLJBD_CNQ_r5Ad4mZZk",Ns="FpmhhFL8lCsiyh3X0fjK",ks="scv87ulfUcibJW8QhCeH",Es="oCa5Np4laJc3s5P2uUqw",Rs=({onClick:e})=>{const{deviceName:t,formattedDeviceName:i}=Y();return(0,y.jsx)("div",{className:Es,children:(0,y.jsx)(da.Zp,{label:i??t,children:(0,y.jsx)(ca.j,{lineClamp:1,onClick:e,children:(0,y.jsx)(l.E,{variant:"bodyMedium",semanticColor:"textBase",children:i??t})})})})};var Is=i(768);const Ls=({size:e="medium",className:t})=>{const i=(0,Oi.j)(),n=(0,Is.k)(e);return(0,y.jsx)(y.Fragment,{children:i?(0,y.jsx)(Ee.A,{size:e,semanticColor:"textBrightAccent",className:t,"data-testid":"now-playing-active"}):(0,y.jsx)("img",{className:t,width:n,height:n,alt:"","aria-hidden":"true",src:(0,Pi.b)("images/device-picker-equaliser-animation.webp"),"data-testid":"animated-now-playing"})})};var As=i(36445);const Ts=({deviceType:e,isGroup:t,isLocalDevice:i,isPlaying:n})=>{const a=(0,As.g)();let s;if(n)s=(0,y.jsx)(Ls,{});else{const n=(0,Ta.tf)(e,t,i?a:null);s=(0,y.jsx)(n,{semanticColor:"textBrightAccent","data-testid":"device-icon",role:"presentation"})}return(0,y.jsxs)("div",{className:ws,children:[(0,y.jsx)("div",{className:Ns,children:s}),(0,y.jsx)(ke.d,{variant:"titleSmall",semanticColor:"textBase",lineClamp:1,children:U.Ru.get("web-player.connect.device-picker.current-device")})]})};var Os=i(65402),Ds=i(51198),Bs=i(93);const _s=()=>{const{currentDevice:e}=(0,Bs.l)(),{id:t,connectStateId:i,isLocalNetwork:n,supportsLogout:a}=e,r=(0,Ds.W)(),l=(0,s.NC)(Gn.Q5),o=!n&&a,c=!l&&o,{spec:u}=(0,et.r)(aa.p,{}),d=(0,$e.v)(),p=(0,ce.j)(),{deviceName:m,formattedDeviceName:g}=Y(),v=r?Os.g:sn.V,x=l?"textSubdued":"textBase";return(0,y.jsx)("div",{className:ks,children:d||p?(0,y.jsx)(v,{"aria-label":U.Ru.get("more.label.context",g??m),size:"small",autoMirror:!1,semanticColor:x}):c&&(0,y.jsx)(Ea,{title:g??m,deviceId:t,connectStateDeviceId:i,allowForgetDevice:o,spec:u.containerViewFactory().headerFactory().activeDeviceFactory()})})};var Fs=i(14165),Us=i(68147),Ps=i(11273),Ms=i(84763);const Hs=()=>{const e=(0,Ja.d)(),{enqueueSnackbar:t}=(0,Ps.d)(),{spec:i,logger:a}=(0,et.r)(hs.g,{}),[s,r]=(0,n.useState)(Ms.ez.BROADCAST_STATUS_UNKNOWN),l=s===Ms.ez.BROADCAST_STATUS_UNKNOWN||s===Ms.ez.BROADCAST_UNAVAILABLE,o=s===Ms.ez.BROADCAST_ON;(0,Xa.c)(Ka.P.BROADCAST_STATUS_UPDATE,(({data:e})=>{r(e??Ms.ez.BROADCAST_STATUS_UNKNOWN)}));const c=(0,n.useCallback)((t=>e.setBroadcastStatus(t?Ms.ez.BROADCAST_ON:Ms.ez.BROADCAST_OFF)),[e]),u=(0,Us.n)({mutationFn:c,onMutate:async e=>{const t=s;return r(e?Ms.ez.BROADCAST_ON:Ms.ez.BROADCAST_OFF),{prevBroadcastingState:t,allowBroadcasting:e}},onError:(e,i,n)=>{r(n?.prevBroadcastingState??Ms.ez.BROADCAST_STATUS_UNKNOWN),t(U.Ru.get("error.generic"))}});return{isHidden:l,toggleIsSwitchedOn:o,setToggleState:(0,n.useCallback)((e=>{const t=e?"device_discoverable_off":"device_discoverable_on",n=e?"device_discoverable_on":"device_discoverable_off";a.logInteraction(i.deviceDiscoverableToggleFactory().hitToggleState({stateBeforeToggle:t,stateAfterToggle:n})),u.mutate(e)}),[a,u,i])}},Vs="k5CAXCZwazRLdTWi5mpN",qs="f2Wgf5OqTaBlTRRKZe9X",zs=()=>{const{isHidden:e,toggleIsSwitchedOn:t,setToggleState:i}=Hs();return e?null:(0,y.jsxs)("div",{className:Vs,children:[(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",as:"label",htmlFor:"jam.broadcasting",className:qs,children:U.Ru.get("web-player.social-connect.broadcasting.toggle-label")}),(0,y.jsx)(Fe.l,{id:"jam.broadcasting",value:t,onSelected:i,condensed:!0})]})};var Ys=i(7352),Gs=i(27396),Qs=i(31416),Ws=i(49708),Zs=i(23481);const Ks="device-picker-header",Js=({isPlaying:e})=>{const{currentDevice:t}=(0,Bs.l)(),{id:i,connectStateId:a,type:r,isLocal:l,isLocalNetwork:o,isGroup:c,incarnation:u,supportsLogout:p}=t,m=(0,$e.v)(),g=(0,ce.j)(),{togglePuffin:v}=(0,Fs.c)(),{currentSession:x}=(0,Zs.D)(),b=(0,Qs.y)(),h=(0,s.NC)(Gn.$4),j=Boolean(x?.active),f=!j&&b,S=(0,Ta.HJ)(u),C=!o&&p,w=C||S,{spec:N,logger:k}=(0,et.r)(hs.g,{}),{uri:E}=(0,Ws.f)(),R=()=>{v(),k.logInteraction(N.hitUiReveal())},I=(0,n.useCallback)((()=>{k.logInteraction(N.createJamButtonFactory().hitUiNavigate({destination:E??""}))}),[k,N,E]),L=(0,y.jsx)(Na,{deviceId:i,connectStateDeviceId:a,allowForgetDevice:C,incarnation:S?u:void 0}),A=m||g,T=(0,y.jsx)(W.v,{className:d()(Ss,{[Cs]:A}),id:Ks,variant:"naked",title:(0,y.jsx)(Ts,{deviceType:r,isGroup:c,isLocalDevice:l,isPlaying:e}),subtitle:(0,y.jsxs)("div",{className:Es,children:[(0,y.jsx)(Rs,{onClick:A?R:void 0}),A&&(0,y.jsx)(js,{})]}),trailing:(0,y.jsx)(_s,{}),"aria-labelledby":Ks,onClick:A?R:void 0,onClickHint:U.Ru.get("web-player.connect.device-picker.current-device"),body:b&&(0,y.jsxs)(y.Fragment,{children:[h&&(0,y.jsx)(zs,{}),(0,y.jsx)("hr",{className:fs})]}),footer:(0,y.jsxs)(y.Fragment,{children:[f&&(0,y.jsx)(Gs.$,{onClick:I}),j&&h&&(0,y.jsx)(Ys.K,{})]})});return w?(0,y.jsx)(ua.h,{menu:L,children:T}):T},Xs=({isDesktop:e})=>{const t=(0,Oe.g)(),i=ps(),{spec:n}=(0,et.r)(aa.p,{}),a=n.containerViewFactory().noDevicesViewFactory(),s=(0,Sa.t)(a);return(0,y.jsxs)("div",{ref:s,className:d()(ta,Wn,Qn),"data-testid":Yn,children:[(0,y.jsxs)("ul",{"aria-labelledby":`${Ks} ${zn}`,className:ia,children:[(0,y.jsx)(bs,{Icon:gs.T,title:U.Ru.get("web-player.connect.device-picker.check-wifi"),subtitle:U.Ru.get("web-player.connect.device-picker.check-wifi-subtitle")}),(0,y.jsx)(bs,{Icon:Ft.g,title:U.Ru.get("web-player.connect.device-picker.play-from-another"),subtitle:U.Ru.get("web-player.connect.device-picker.play-from-another-subtitle")}),e?(0,y.jsx)(bs,{Icon:vs.H,title:U.Ru.get("web-player.connect.device-picker.restart-speaker"),subtitle:U.Ru.get("web-player.connect.device-picker.restart-speaker-subtitle")}):(0,y.jsx)(bs,{Icon:xs.i,title:U.Ru.get("web-player.connect.device-picker.switch-to-app"),subtitle:U.Ru.get("web-player.connect.device-picker.switch-to-app-subtitle"),onClick:()=>t("/download")})]}),(0,y.jsxs)("div",{"aria-describedby":Yn,children:[(0,y.jsx)(cs,{spec:n}),i&&(0,y.jsx)(ls,{spec:n})]})]})},$s=({devices:e,areWebPlayerCastDevicesAvailable:t})=>{const i=Boolean(e.find((e=>!e.isLocal))),n=e.filter((e=>!e.isActive&&e.name.length>0)),a=i||t;return(0,y.jsxs)("div",{className:d()(Kn,Wn),children:[(0,y.jsx)(na,{foundDevices:a}),a?(0,y.jsx)(Ia,{children:(0,y.jsx)(ms,{devices:n,areWebPlayerCastDevicesAvailable:t})}):(0,y.jsx)(Xs,{isDesktop:!0})]})};var er=i(11153);const tr=()=>{const{currentDevice:e}=(0,Bs.l)(),{formattedDeviceName:t}=Y(),i=(0,er.d)(),n=U.Ru.get("web-player.connect.device-picker.this-computer");let a;(0,Ta.Mp)(e.type)&&(a=U.Ru.get("web-player.connect.device-picker.google-cast"));const s=[(t??null)&&n,a??null,i].filter(Boolean).join(" • ");return(0,y.jsx)(ca.j,{semanticColor:"textSubdued",lineClamp:1,children:s})};var ir=i(34144),nr=i(44544);const ar="cuG1_yCuW2Mnw3H6IUYD",sr=()=>{const{currentDevice:e}=(0,Bs.l)(),{type:t,isLocal:i,isGroup:n}=e,a=(0,As.g)(),s=(0,$e.v)(),r=(0,ce.j)(),{togglePuffin:l}=(0,Fs.c)(),{deviceName:o}=Y(),c=s||r,u=(0,nr.K)(),d=s&&u?ze.C:(0,ir.tf)(t,n,i?a:null),{spec:p,logger:m}=(0,et.r)(hs.g,{});return(0,y.jsx)(W.v,{id:"device-picker-header",variant:"naked",size:"md",className:ar,title:o,"data-testid":"device-picker-row-sidepanel",media:(0,y.jsx)(d,{semanticColor:"textBrightAccent","data-testid":"device-icon",role:"presentation"}),onClick:c?()=>{l(),m.logInteraction(p.hitUiReveal())}:void 0,trailing:(0,y.jsx)(_s,{}),subtitle:(0,y.jsx)(tr,{})})},rr="G6For7gcz2GTgCkOeJKc",lr=()=>{const{isHidden:e,toggleIsSwitchedOn:t,setToggleState:i}=Hs();return e?null:(0,y.jsxs)("div",{className:rr,children:[(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textBase",as:"label",htmlFor:"jam.broadcasting",children:U.Ru.get("web-player.connect.device-picker.auto-invite-jam-toggle")}),(0,y.jsx)(Fe.l,{id:"jam.broadcasting",value:t,onSelected:i,condensed:!0})]})};var or=i(78585);const cr="fkBkl4cpmR6fFGNpsPZx",ur="Wv3hgdJTMsji4hS4an1O",dr="uqNT_uoUuNHbne2OA1u0",pr=({openQueue:e})=>{const t=(0,Zs.D)(),{uri:i}=(0,Ws.f)(),{spec:a,logger:s}=(0,et.r)(hs.g,{}),r=(0,n.useCallback)((()=>{s.logInteraction(a.createJamButtonFactory().hitUiNavigate({destination:i??""}))}),[s,a,i]);return(0,y.jsxs)("div",{className:cr,children:[(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",as:"label",htmlFor:"jam.broadcasting",className:ur,children:U.Ru.get("web-player.connect.device-picker.start-jam-description")}),(0,y.jsx)(pe.n,{onClick:()=>{r(),t.createSession(),e()},iconLeading:or.V,size:"small",className:dr,children:U.Ru.get("web-player.connect.device-picker.start-jam")})]})};var mr=i(8778);const gr="rk32VTG0b6NU0RicbiOH",vr=()=>{const e=(0,Zs.D)(),{openQueue:t}=(0,mr.R)(),i=e.currentSession?.active?(0,y.jsx)(Ys.K,{}):(0,y.jsx)(pr,{openQueue:t});return(0,y.jsxs)("div",{className:d()(gr),"aria-label":U.Ru.get("web-player.connect.device-picker.current-device"),role:"group",children:[(0,y.jsx)(sr,{}),(0,y.jsx)(lr,{}),i]})};var xr=i(45592);const br="Y5BWxTfO9OmenxMup_H7",hr="s0kxKAi2bTiuoEJhkYph",yr="Cdlb8uLk1VIkwKmGBViF",jr=({Icon:e,title:t,subtitle:i,buttonText:a,onClick:s,onDismiss:r})=>{const{spec:o}=(0,et.r)(aa.p,{}),c=o.containerViewFactory().messageBoxViewFactory({identifier:t}),u=(0,le.s)(),d=(0,n.useCallback)((()=>{u.logInteraction(c.dismissMessageBoxFactory().hitUiHide()),r()}),[u,c,r]),p=(0,n.useCallback)((()=>{u.logInteraction(c.recommendedActionButtonFactory().hitUiHide()),s()}),[u,c,s]),m=(0,y.jsxs)("div",{className:yr,children:[e&&(0,y.jsx)(e,{semanticColor:"textSubdued",size:"small"}),(0,y.jsx)(l.E,{variant:"bodyMediumBold",color:"baseText",children:t})]});return(0,y.jsx)(W.v,{id:"messageBox",variant:"elevated",size:"lg",className:br,title:m,subtitle:i,paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,y.jsx)(pe.n,{size:"small",onClick:p,children:a}),trailing:(0,y.jsx)(me.H,{className:hr,semanticColor:"textBase",iconOnly:xr.M,size:"small",onClick:d,condensedAll:!0,"aria-label":U.Ru.get("close")})})},fr=e=>{if("object"==typeof e&&"custom"in e)return e.custom;switch(e){case"required":return 1e3;case"high":return 500;case"normal":return 300;case"low":return 100;default:return 0}},Sr=()=>{const{deviceFilterState:e}=(0,ae.j)(),t=(0,n.useMemo)((()=>e.audioDevice?.id),[e.audioDevice?.id]),[i,a]=(0,Ae.x)("onboarding-dismissed:puffin",{}),s=(0,n.useCallback)((()=>{t&&a({...i,[t]:(i[t]??0)+1})}),[t,i,a]);return{isDeviceDismissed:(0,n.useMemo)((()=>!!t&&i[t]>=3),[t,i]),incrementDismissCountForDevice:s}},Cr=()=>[(()=>{const e=(0,g._Y)(),{incrementDismissCountForDevice:t,isDeviceDismissed:i}=Sr(),{deviceFilterState:n,isMaybeHeadphoneDevice:a}=(0,ae.j)(),s=n.isOnboarded,r=a&&!s&&!i;return{id:"puffinDevicePickerUpsell",title:U.Ru.get("web-player.puffin.get-started.title"),subtitle:U.Ru.get("web-player.puffin.get-started.subtitle"),buttonText:U.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm"),onClick:()=>{e(ie.$S.PUFFIN_START_ACTIVATION)},onDismiss:()=>{t()},shouldShow:r,priority:"normal"}})()],wr=e=>{const t=e.filter((e=>e.shouldShow)).sort(((e,t)=>{return i=e.priority,n=t.priority,fr(i)<fr(n)?1:-1;var i,n}));return t[0]?t[0]:null};var Nr=i(36036),kr=i(76282);const Er=()=>{const{currentDevice:e}=(0,Bs.l)(),t=Cr(),i=wr(t),[a,s]=(0,n.useState)(e.isLocal&&null!==i);if((0,kr.W)(Nr.P.UPDATE,(()=>s(e.isLocal&&null!==i))),null===i||!a)return null;return(0,y.jsx)(jr,{...i,onDismiss:()=>{i.onDismiss(),s(!1)}})};var Rr=i(72480);const Ir="hmVfxvHNFzG0vUNl80tU",Lr="TuVVAkUzyLv_yCLzKTqW",Ar=()=>{const[e,t]=(0,n.useState)(!0),{deviceFilterState:i,isMaybeHeadphoneDevice:a}=(0,ae.j)(),s=i.isOnboarded,{incrementDismissCountForDevice:r,isDeviceDismissed:l}=Sr(),o=(0,n.useMemo)((()=>a&&!s&&!l),[l,a,s]),c=(0,g._Y)(),u=(0,n.useCallback)((()=>c(ie.$S.PUFFIN_START_ACTIVATION)),[c]),d=(0,n.useCallback)((()=>{r(),t(!1)}),[r]);return o&&e?(0,y.jsx)(W.v,{id:"puffinDevicePickerUpsell",variant:"tinted",size:"lg",className:Ir,title:U.Ru.get("web-player.puffin.get-started.title"),subtitle:U.Ru.get("web-player.puffin.get-started.subtitle"),paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,y.jsx)(pe.n,{size:"small",onClick:u,children:U.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm")}),trailing:(0,y.jsx)(me.H,{className:Lr,semanticColor:"textSubdued",iconOnly:xr.M,size:"small",onClick:d,condensedAll:!0,"aria-label":U.Ru.get("close")})}):null};var Tr=i(28325),Or=i(21906),Dr=i(67323),Br=i(7545);function _r(){return(0,fa.N)(Br.v)}const Fr=()=>{const e=_r(),{devices:t,currentDevice:i}=(0,Bs.l)(),a=(()=>{const e=_r(),[t,i]=(0,n.useState)([]),a=(0,n.useCallback)((()=>{e.getJamDevices().then((e=>i(e)))}),[e]);return(0,Xa.c)(Ka.P.SCAN_UPDATE,(()=>a())),(0,n.useEffect)((()=>a()),[a]),t})(),[s,r]=(0,n.useState)(t.map((e=>(0,Wa.gS)(e)))),l=(0,ra.dh)((()=>{const n=e.combineJamsWithEntities(t,a,i.connectStateId);r(n)}),100,{leading:!1,trailing:!0});return(0,n.useEffect)((()=>l()),[t,a,i,l]),s},Ur="h0XG5HZ9x0lYV7JNwhoA",Pr="JHlPg4iOkqbXmXjXwVdo",Mr="jEsh5c0FZojBDcUF990w",Hr=()=>{const e=(0,Or.O)(),t=(0,$e.v)(),i=(0,H.l)(),a=(0,Rr.C)(),r=(0,s.NC)(Gn.Yr),l=(0,s.NC)(Gn.Q5),{devices:o}=(0,Bs.l)(),c=Fr(),{isPlaying:u}=(0,Dr.GK)(),[p]=(0,g.sV)(),m=(0,n.useRef)(a),x=(0,n.useRef)(p.context.devicePicker?.interactionId);m.current=a,x.current=p.context.devicePicker?.interactionId;const b=(0,F.d4)((e=>e.playback?.castState??window.cast?.framework.CastState.NO_DEVICES_AVAILABLE)),h=(0,Tr.Or)(b);return(0,n.useEffect)((()=>()=>{m.current(x.current)}),[x]),(0,n.useEffect)((()=>{e.startActiveDiscovery()}),[e]),(0,y.jsx)(at._,{label:U.Ru.get("playback-control.connect-picker"),focusTransferId:"DEVICE-PICKER",children:(0,y.jsx)(C.w,{className:d()(Ur,{[Pr]:l}),fixedHeader:(0,y.jsx)(w.a,{title:l?(0,Re.v)("Connect"):U.Ru.get("playback-control.connect-picker"),panel:v.Z.DevicePicker}),children:(0,y.jsxs)("div",{role:"group",className:Mr,children:[l?(0,y.jsx)(vr,{}):(0,y.jsx)(Js,{isPlaying:u}),l?(0,y.jsx)(Er,{}):t&&!i&&(0,y.jsx)(Ar,{}),(0,y.jsx)($s,{devices:r?c:o.map((e=>(0,Wa.gS)(e))),areWebPlayerCastDevicesAvailable:h})]})})})},Vr=()=>null;var qr=i(53177),zr=i(41205),Yr=i(40767),Gr=i(52227),Qr=i(24051),Wr=i(42551);const Zr=(0,Wr.Mz)([e=>e.ads],(e=>e.embeddedAd)),Kr=(0,Wr.Mz)(Zr,(e=>e?.ad)),Jr=(0,Wr.Mz)(Zr,(e=>e?.isOpen||!1)),Xr=(0,Wr.Mz)(Zr,(e=>e?.canShowAd||!1)),$r=(0,Wr.Mz)(Zr,(e=>e?.lastTimeInView));var el=i(5171),tl=i(30658),il=i(87977);const nl=e=>{const t=(0,tl.Z)(e);return!(!t||e&&!(0,il.v)(e))&&t?.uid!==e?.uid};var al=i(74929);const sl=()=>{const e=(0,F.wA)(),t=(0,el.$)(),i=(0,F.d4)((e=>e.ui.videoPlayer.uiFlags.npv)),a=(0,s.NC)(al.Ym5,{loadingValue:!1}),r=(0,s.NC)(al._TI),l=(0,Ot.o)((e=>e?.item),((e,t)=>e?.uid===t?.uid)),o=(0,F.d4)(Xr),c=!!(0,F.d4)(Kr),u=(0,F.d4)($r),d=(({canShowEmbeddedAd:e,nvpIsActive:t,trackChanged:i,featureEnabled:a,storeHasAd:s,isFocused:r,enoughTimePassedSinceLastRender:l})=>(0,n.useMemo)((()=>!!e&&t&&i&&a&&r&&!s&&l),[e,t,i,a,s,r,l]))({canShowEmbeddedAd:o,nvpIsActive:i,trackChanged:nl(l),featureEnabled:a,storeHasAd:c,isFocused:t,enoughTimePassedSinceLastRender:!u||Date.now()-u>1e3*r});return(0,n.useEffect)((()=>{d&&e((0,Qr.PY)())}),[d,e,l]),null};var rl=i(82172);const ll=({children:e})=>{const[t,i]=(0,n.useState)(null),a=(0,n.useCallback)((()=>{i(rl.j.Errored)}),[]),s=(0,n.useMemo)((()=>({state:t,capturePlaybackError:a})),[t,a]);return(0,y.jsx)(rl.O.Provider,{value:s,children:e})},ol=(0,n.lazy)((()=>Promise.all([i.e(5899),i.e(1897),i.e(7537)]).then(i.bind(i,82152)))),cl=e=>(0,y.jsx)(ll,{children:(0,y.jsx)(ol,{...e})});var ul=i(87681),dl=i(54375),pl=i(19157);const ml=()=>(0,y.jsx)(y.Fragment,{});var gl=i(66605),vl=i(61424),xl=i(11647),bl=i(57999),hl=i(58357),yl=i(99535),jl=i(52563),fl=i(25252),Sl=i(73737);const Cl="ykU0u_RLxGVmkHVI7if7",wl="KpPP2M5NXZAY5NwqT1uf",Nl=({uri:e})=>{const{spec:t,logger:i}=(0,et.r)(gl.t,{}),n=(0,F.wA)(),{data:a}=(0,vl.S)(e),[s,r]=(0,Sl.A)(e);if(!a)return null;const{description:l,name:o,images:c}=a,u=(0,fl.t)({avatarImages:c,preferFullBleed:!1});return(0,y.jsxs)(jl.M,{name:o,openModal:()=>{const e=t.authorAboutModalButtonFactory().hitUiReveal();i.logInteraction(e),n((0,sa.Te)({bio:a.description,images:a.images.slice(0,1),name:a.name}))},children:[(0,y.jsx)(hl.R,{cardVariant:u,avatarImageSources:c,header:U.Ru.get("web-player.now-playing-view.author-about.title"),name:o}),(0,y.jsxs)("div",{className:Cl,children:[(0,y.jsxs)("div",{className:wl,children:[(0,y.jsx)(yl.c,{name:o,uri:e,onLinkClick:()=>i.logInteraction(t.authorNameFactory().hitUiNavigate({destination:e}))}),(0,y.jsx)(bl.T,{toggleFollow:n=>{n.preventDefault(),n.stopPropagation();const a=s?t.followButtonFactory().hitUnfollow({itemToBeUnfollowed:e}):t.followButtonFactory().hitFollow({itemToBeFollowed:e});i.logInteraction(a),r(!s)},isInLibrary:s})]}),(0,y.jsx)(xl._,{text:l})]})]})},kl=({item:e})=>{const t=e.book.authors.at(0)?.uri;return t?(0,y.jsx)(Nl,{uri:t}):null};var El=i(91834),Rl=i(5075),Il=i(97279),Ll=i(90194),Al=i(7394),Tl=i(64840),Ol=i(22841),Dl=i(65861),Bl=i(9800),_l=i(35532),Fl=i(66796),Ul=i(67815),Pl=i(69479);var Ml=i(6787),Hl=i(86296),Vl=i(15407);const ql="_QEMUk5U16U3CQn0wvbD",zl="mbkl2P60JUhDqc9qGvp9",Yl="Xh6dG3pzi2SS7v4cvZzG",Gl="sOdoW26RUwggLToa7xDt",Ql="B_TcBcc1BM2yLgvXbh66",Wl="tRnhyUQiKOxA3z8mUD_U",Zl="_shxqlkLuB52H1iCh_OQ",Kl="hAwePVlxumRNpdOSpwyV";const Jl=n.forwardRef((function({className:e="",segment:t,onClickPlay:i,isPlaying:a},s){const{label:r,Icon:l}=(0,n.useMemo)((()=>function(e){if("TALK"===e.type)return{Icon:Ol.L,label:U.Ru.get("playlist.a11y.play",e.title)};const t=e.track.artists?.map((e=>e.name)).join(U.Ru.getSeparator())||"";return{Icon:Dl.v,label:U.Ru.get("tracklist.a11y.play",e.track.name,t)}}(t)),[t]),o=(0,n.useCallback)((()=>{i()}),[i]);return(0,y.jsxs)("div",{className:d()(Zl,e),children:[a?(0,y.jsx)(Hl.J,{className:Wl,animated:!0}):(0,y.jsx)("span",{className:Wl,children:(0,y.jsx)(l,{iconSize:16,"aria-hidden":"true"})}),(0,y.jsx)(Fl.x,{className:Ql,iconClassName:Kl,onClick:o,isPlaying:a,isLocked:!1,playAriaLabel:r,ref:s})]})})),Xl=({children:e,onTriggerPlay:t,episodeUri:i,index:n})=>{const{spec:a,logger:s}=(0,et.r)(Bl.f,{}),r=(0,ra.YQ)((()=>{const e=s.logInteraction(a.segmentItemFactory({uri:i,position:n||0}).doubleHitPlay({itemToBePlayed:i}));t(e)}),Vl.d,{leading:!0,trailing:!1});return(0,y.jsx)("div",{className:Gl,onDoubleClick:r,children:e})},$l=({segment:e,episodeUri:t,index:i})=>{const{spec:a,logger:s}=(0,et.r)(Bl.f,{}),{isActive:r,isPlaying:l,onClick:o}=(0,Ml.L)({episodeUri:t,start:e.start,stop:e.stop}),c={uri:t},u=function(e){const t=[{url:e.track.album.image}];return{type:Pl.c.TRACK,uri:e.uri,uid:null,provider:null,images:t,name:e.track.name,mediaType:"audio",duration:{milliseconds:0},album:{type:Pl.c.ALBUM,uri:e.track.album.uri,name:e.track.album.name,images:t},artists:e.track.artists.map((e=>({type:Pl.c.ARTIST,name:e.name,uri:e.uri})))}}(e),d=a.segmentItemFactory({uri:t,position:i||0}).playbackButtonFactory(),p=(0,n.useCallback)((()=>{o({}),r&&l?s.logInteraction(d.hitPause({itemToBePaused:t})):r&&!l?s.logInteraction(d.hitResume({itemToBeResumed:t})):s.logInteraction(d.hitPlay({itemToBePlayed:t}))}),[t,r,l,s,o,d]);return(0,y.jsxs)(Xl,{onTriggerPlay:o,episodeUri:t,children:[(0,y.jsx)(Jl,{segment:e,isActive:r,isPlaying:l,onClickPlay:()=>{p()}}),(0,y.jsx)(Ul.d,{context:c,item:u,titleTypeVariant:"bodyMedium",subtitleTypeVariant:"bodySmall",onTitleClick:e=>{s.logInteraction(a.segmentItemFactory({uri:t,position:i||0}).albumLinkFactory({uri:c.uri}).hitUiNavigate({destination:e||""}))},onSubtitleClick:e=>{s.logInteraction(a.segmentItemFactory({uri:t,position:i||0}).artistLinkFactory({uri:e||"",position:0}).hitUiNavigate({destination:e||""}))}})]})},eo=({segment:e,episodeUri:t,index:i})=>{const{spec:a,logger:s}=(0,et.r)(Bl.f,{}),{isActive:r,isPlaying:o,onClick:c}=(0,Ml.L)({episodeUri:t,start:e.start,stop:e.stop}),u=function(e){const t=[];return{type:Pl.c.UNKNOWN,uri:e.uri,uid:null,provider:null,images:t,name:e.title,mediaType:"audio",duration:{milliseconds:0},album:{type:Pl.c.ALBUM,uri:e.show.uri,name:e.show.name,images:t},artists:[]}}(e),d=a.segmentItemFactory({uri:t,position:i||0}).playbackButtonFactory(),p=(0,n.useCallback)((()=>{c({}),r&&o?s.logInteraction(d.hitPause({itemToBePaused:t})):r&&!o?s.logInteraction(d.hitResume({itemToBeResumed:t})):s.logInteraction(d.hitPlay({itemToBePlayed:t}))}),[t,r,o,s,c,d]);return(0,y.jsxs)(Xl,{onTriggerPlay:c,episodeUri:t,children:[(0,y.jsx)(Jl,{segment:e,isActive:r,isPlaying:o,onClickPlay:()=>{p()}}),(0,y.jsx)(_l.z,{title:u.name,children:(0,y.jsx)(l.E,{variant:"bodyMedium",semanticColor:"textBase",children:u.name})},u.name)]})};var to=i(36542),io=i(5710);function no(e){return!!(0,io.o)().getCapabilities().isSupported&&function(e){const t=e.metadata?.["parent_episode.uri"];return!!t&&(0,_n.gHQ)(t)}(e)}var ao=i(51577);const so=(0,qr.mc)((({item:e})=>{const t=e.metadata?.["parent_episode.uri"],i=function(e){const t=(0,io.o)();return(0,n.useCallback)((async(i,n)=>{if(!e)return[];try{return await t.getSegments(e,i,n)}catch(e){return[]}}),[e,t])}(t),[a,s]=(0,n.useState)([]),r=(0,n.useRef)(!1),l=(0,n.useRef)(0),o=(0,n.useCallback)((()=>{const e=l.current;null!==e&&(r.current||(r.current=!0,i(e,10).then((e=>{s((t=>{const i=t.concat(e);return l.current=i.length+1,i})),r.current=!1}))))}),[i]);return(0,n.useEffect)((()=>{s([])}),[e.uri]),t?(0,y.jsxs)(to.w,{className:ql,children:[(0,y.jsx)(to.X,{className:zl,children:U.Ru.get("music_and_talk.in_this_episode")}),(0,y.jsx)("div",{className:Yl,children:(0,y.jsx)(ao._,{onReachBottom:o,triggerOnInitialLoad:!0,children:a.map(((e,i)=>"MUSIC"===e.type?(0,y.jsx)($l,{segment:e,episodeUri:t},`${e.uri}-${i}`):(0,y.jsx)(eo,{segment:e,episodeUri:t},`${e.uri}-${i}`)))})})]}):null}),{name:"NPVInThisEpisode"});var ro=i(9878),lo=i(62825),oo=i(8144),co=i(15044);const uo="f6_Fu_ei4TIJWR0wzvTk",po="TLmzadNIdvV8sYzTuXRg",mo="MT9De6UrCVQ8Qo6o3ikA",go=n.memo((()=>{const{cssStyles:e}=(0,co.Yc)();return(0,y.jsx)("div",{className:uo,style:{"--section-background-base":e?.["--section-background-base"]},"aria-hidden":!0,children:(0,y.jsxs)("div",{className:po,children:[(0,y.jsx)(oo.Y,{as:"div",variant:"bodyMediumBold",className:mo,charCount:8,isLoading:!0}),[20,50,25].map(((e,t)=>(0,y.jsx)(oo.Y,{as:"div",variant:"bodySmall",className:mo,charCount:e,isLoading:!0},t)))]})})}));var vo=i(65572),xo=i(29244),bo=i(48078),ho=i(49911);const yo=(0,n.lazy)((async()=>{const{TopCommentsCard:e}=await Promise.resolve().then(i.bind(i,27106));return{default:e}}));var jo=i(82444),fo=i(67300);const So=({item:e,spec:t})=>{const i=(0,n.useCallback)((()=>{}),[]),a=(0,s.NC)(al.cgF),r=(0,s.NC)(al.xEc),l=(0,jo.d)(),o=(0,fo.d)(e.uri)?.episodeOrChapter,c=no(e),u={uri:e.uri,numberOfChapters:Tl.Kp},{data:d,isLoading:p,error:m}=(0,xo.X)({queryKey:["queryNpvEpisode",u],staleTime:Tl.Ff,gcTime:Tl.CD,variables:u});if(p&&e.uri&&!m)return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(go,{}),(0,y.jsx)(go,{})]});const g=(0,Rl.SB)(d?.episodeUnionV2),v=(0,Rl.lz)(d?.episodeUnionV2);if(!e.uri||!g||p||m)return null;const x=o&&o.type===Pl.c.EPISODE&&o.transcript&&o.transcript.length>0;return(0,y.jsxs)(ka.r,{spec:t,children:[l&&(0,y.jsx)(n.Suspense,{fallback:null,children:(0,y.jsx)(yo,{uri:g.uri})}),(0,y.jsx)(Al.N,{episode:g}),!g.originalEpisode&&(0,y.jsx)(Il.c,{episode:g}),(0,y.jsx)(bo.F,{episode:g}),!c&&(0,y.jsx)(El.I,{episode:g}),r&&v&&(0,y.jsx)(lo.m,{coverArt:v.coverArt||void 0,description:v.htmlDescription||"",name:v.name,publisher:v.publisher?.name,uri:v.uri}),x&&(0,y.jsx)(y.Fragment,{children:a?(0,y.jsx)(ho.n,{episode:e}):(0,y.jsx)(Ll.E,{episodeUri:e.uri})}),c&&(0,y.jsx)(so,{item:e}),(0,y.jsx)(vo.K,{topics:v?.topics.items??[],logTopicNavigation:i}),(0,y.jsx)(ro.A,{})]})},Co=({item:e,spec:t})=>(0,Tt.n)()?(0,y.jsx)(So,{item:e,spec:t}):(0,y.jsx)(y.Fragment,{}),wo=()=>(0,y.jsx)(y.Fragment,{});var No=i(67526),ko=i(35811),Eo=i(70689),Ro=i(23279),Io=i(64022),Lo=i(11052),Ao=i(36550),To=i(66315);const Oo="BwWUH9yjgY_WvN25wDeP",Do="cHBYwKeb2FSgzFWglPRH",Bo="HzNOPORl7WOGyK9UyEQ5",_o="VfpX7TZbPNCABaui6xBp",Fo="Sb2rC16jDkGc9eweOU8g",Uo="DMYN160EH08ptMceRIEz",Po="BO5glvOfX032J6W28Dit",Mo="sTihEgSs3yBFALZdsa2V",Ho="main-nowPlayingView-lyricsGradient",Vo="SjlTHRmuefFiB_RQTR9O",qo="KJK5nyHkgL2CCw1mKMt4",zo=({uri:e})=>{const{spec:t,logger:i}=(0,et.r)(To.X,{}),{mode:n,setMode:a}=(0,Ao.r)();return(0,y.jsxs)("div",{className:Bo,children:[n===Qa.YU.npv&&(0,y.jsx)(c.$,{label:U.Ru.get("web-player.now-playing-view.lyrics.show-less"),colorSet:"invertedLight",size:"small",onClick:()=>{i.logInteraction(t.lyricsModeExpandedFactory({uri:e}).showLessButtonFactory().hitUiHide()),a(Qa.YU.static)},children:U.Ru.get("web-player.now-playing-view.lyrics.show-less")}),n===Qa.YU.static&&(0,y.jsx)(c.$,{label:U.Ru.get("web-player.now-playing-view.lyrics.show-more"),colorSet:"invertedLight",size:"small",onClick:()=>{i.logInteraction(t.lyricsModePreviewFactory({uri:e}).showMoreButtonFactory().hitUiReveal()),a(Qa.YU.npv)},children:U.Ru.get("web-player.now-playing-view.lyrics.show-more")})]})};var Yo=i(85197),Go=i(68761),Qo=i(61431),Wo=i(60690),Zo=i(92977),Ko=i(94435);const Jo=({uri:e})=>{const{spec:t,logger:i}=(0,et.r)(To.X,{}),{setMode:a}=(0,Ao.r)(),s=(0,n.useCallback)((()=>{i.logInteraction(t.lyricsModePreviewFactory({uri:e}).hideLyricsButtonFactory().hitUiHide()),a(Qa.YU.none)}),[a,e,i,t]);return(0,y.jsx)(ya.D,{role:"menuitem",onClick:s,children:U.Ru.get("web-player.now-playing-view.lyrics.hide-option")})},Xo=({uri:e})=>(0,y.jsx)(ba.W,{children:(0,y.jsx)(Jo,{uri:e})});var $o=i(94487);const ec=({label:e,onClick:t,iconOnly:i,nodeRef:n})=>(0,y.jsx)(da.Zp,{label:e,children:(0,y.jsx)(me.H,{ref:n,className:Mo,iconOnly:i,size:"small",onClick:t,"aria-label":e})}),tc=({uri:e})=>{const{spec:t,logger:i}=(0,et.r)(To.X,{}),a=t.lyricsModeExpandedFactory({uri:e}),r=(0,Sa.t)(a),l=(0,Zo.l)(),o=(0,Ko.F)(),c=(0,n.useRef)(null);(0,ee.X)("NPV_OPEN_CINEMA_LYRICS",c,3e3);const u=(0,Qo.lZ)(),d=(0,s.NC)(al.mzn),{isFullScreenSupported:p,toggleFullScreen:m}=(0,$o.H)({refOrElement:document.body}),g=U.Ru.get("web-player.now-playing-view.lyrics.cinema-mode"),v=U.Ru.get("web-player.now-playing-view.lyrics.cinema-mode");return(0,y.jsxs)("div",{ref:r,className:Do,children:[u&&p&&d&&(0,y.jsx)(ec,{label:g,onClick:async()=>{i.logInteraction(a.buttonFullscreenFactory().hitUiReveal());try{await m()}catch(e){}o("lyrics"),l(Vn.z.NOW_PLAYING_VIEW)},iconOnly:Wo.T,nodeRef:c}),(0,y.jsx)(ec,{label:v,onClick:()=>{l(Vn.z.NOW_PLAYING_VIEW),o("lyrics"),i.logInteraction(a.cinemaModeButtonFactory().hitUiReveal())},iconOnly:Yo.L,nodeRef:c})]})},ic=({uri:e})=>{const{spec:t}=(0,et.r)(To.X,{}),i=(0,Sa.t)(t.lyricsModePreviewFactory({uri:e}));return(0,y.jsx)("div",{ref:i,className:Do,children:(0,y.jsx)(ma.b,{placement:"bottom-end",menu:(0,y.jsx)(Xo,{uri:e}),children:(0,y.jsx)(ul.e,{className:Mo,size:"small",condensed:!1,label:U.Ru.get("more")})})})},nc=({uri:e})=>{const{spec:t,logger:i}=(0,et.r)(To.X,{}),n=(0,Sa.t)(t.lyricsModeHiddenFactory({uri:e})),{setMode:a}=(0,Ao.r)(),s=U.Ru.get("web-player.now-playing-view.show.lyrics");return(0,y.jsx)("div",{ref:n,className:d()(Do,Po),children:(0,y.jsx)(ec,{label:s,onClick:()=>{a(Qa.YU.static),i.logInteraction(t.lyricsModeHiddenFactory({uri:e}).showLyricsButtonFactory().hitUiReveal())},iconOnly:Go.r})})};var ac=i(68510),sc=i(40863);const rc=(0,qr.mc)((({item:e})=>{const t=(0,n.useRef)(null),{mode:i}=(0,Ao.r)(),a=(0,n.useRef)(null),s=(0,n.useRef)(0),{data:r}=(0,Lo.J)(),o=(0,Ot.o)((e=>e?.nextItems?.[0]),((e,t)=>e?.uri===t?.uri));(0,Io.I)(o?.uri,o?.images);const c=(0,n.useCallback)((()=>{s.current=Date.now()}),[]),u=(0,n.useCallback)((({lineRef:e,isActiveLine:n,shouldAnimateScroll:r,activeLineIndex:l,isFirstLine:o})=>{if(i!==Qa.YU.npv)return;if(!t.current||!a.current)return;let c;if(e.current&&n?c=e.current?.offsetTop-a.current?.offsetTop-16:o&&l<0&&(c=0),void 0===c)return;const u=a.current?.scrollTop,d=Math.abs(u-c),p=t.current.clientHeight,m=Date.now()-s.current<2e3,g=s.current>0&&d>1*p;if(m||g)return;s.current=0;const v="visible"===document.visibilityState&&r?"smooth":"auto";a.current?.scrollTo({top:c,behavior:v})}),[i]);(0,n.useLayoutEffect)((()=>{s.current=0,a.current?.scrollTo({top:0,behavior:"auto"})}),[e.uri]);const p=r?.hasLyrics?r.dynamicColors?.higherContrast:null;if(!r?.hasLyrics)return null;const m=r?.hasLyrics&&!r.isTimeSynced,g={"--lyrics-color-active":p?.textBase.toCSS(sc.a.RGBA)??(m?Eo.ONy:r.colors.activeText),"--lyrics-color-inactive":p?.textSubdued.toCSS(sc.a.RGBA)??r.colors.text,"--lyrics-color-passed":p?.textBase.toCSS(sc.a.RGBA)??ac.Q.fromCSS(r.colors.activeText,.7).toCSS(sc.a.RGBA),"--lyrics-color-background":p?.backgroundBase.toCSS(sc.a.RGBA)??r.colors.background};return i===Qa.YU.cinema?null:(0,y.jsxs)(to.w,{className:d()(Oo,Ho,{[_o]:i===Qa.YU.static,[Fo]:i===Qa.YU.npv}),style:g,ref:t,children:[(0,y.jsx)(to.X,{action:(()=>{switch(i){case Qa.YU.npv:return(0,y.jsx)(tc,{uri:e.uri});case Qa.YU.static:return(0,y.jsx)(ic,{uri:e.uri});default:return(0,y.jsx)(nc,{uri:e.uri})}})(),className:d()({[Uo]:i===Qa.YU.npv}),children:i===Qa.YU.static?U.Ru.get("web-player.now-playing-view.lyrics.title-preview"):U.Ru.get("web-player.lyrics.title")}),(0,y.jsxs)("div",{className:d()(Vo,{[qo]:i===Qa.YU.npv}),ref:a,onWheel:c,onScroll:c,children:[m&&i===Qa.YU.npv&&(0,y.jsx)(l.E,{as:"p",variant:"bodySmall",dir:"auto",style:{color:r.colors.text},children:U.Ru.get("web-player.lyrics.unsynced")}),(0,y.jsx)(Ro.x,{trackUri:e.uri,data:{...r,isTimeSynced:i!==Qa.YU.static&&r.isTimeSynced},format:"card",onActiveLineChange:u,isSnippet:i===Qa.YU.static})]}),(0,y.jsx)(zo,{uri:e.uri})]})}),{name:"NPVLyrics"});var lc=i(87412),oc=i(1671),cc=i(39963),uc=i(18064),dc=i(35244),pc=i(38281),mc=i(73693),gc=i(72496),vc=i(98254),xc=i(74910),bc=i(41748),hc=i(47939);const yc="Kz3HNT1PWTHOL6wjYXb8",jc="Fip8h1J04RvF8_CRfdwc",fc="WEz9K1UHOS2wrRWQmZBo",Sc="AUxek3jYdcq9XPBwL7N0",Cc=({images:e,breakpoint:t,type:i,name:n,isPlaying:a,onClick:s,...r})=>(0,y.jsxs)("div",{className:jc,children:[(0,y.jsx)("div",{className:fc,children:(0,y.jsx)(bc.e,{images:e,breakpoint:t,type:i,name:n,...r})}),(0,y.jsx)("div",{className:d()(yc,{[Sc]:i===Pl.c.ARTIST||i===Pl.c.USER}),children:(0,y.jsx)(hc.R,{onClick:s,isPlaying:a,version:hc.H.transparent,size:"small"})})]});var wc=i(29761),Nc=i(15652),kc=i(3192);function Ec({uri:e,spec:t,logger:i,images:a}){const{usePlayContextItem:s}=(0,kc.P)({uri:e},{featureIdentifier:"track"}),{isPlaying:r,isActive:l,togglePlay:o}=s({uri:e}),c=(0,n.useCallback)((()=>{const n=(0,wc.$I)({spec:t.playbackButtonFactory(),logger:i,uri:e,isActive:l,isPlaying:r});o({loggingParams:n})}),[t,i,e,l,r,o]);return(0,y.jsx)(Cc,{type:Pl.c.TRACK,size:Nc.Qe.SIZE_48,images:a??[],breakpoint:xc.e.SMALL,name:"",loadingMode:"lazy",isPlaying:r,onClick:c})}var Rc=i(86994),Ic=i(28356);const Lc="xwokxeEfMKnFFg0UPVC7",Ac="mNgLTx6k86JO7fS8CBx5",Tc="k1ZhEUZAYffOk3UxUsYF",Oc="toF4isn16zybsTjDktbg",Dc="pXKTpGpCyvyKgwx858dg",Bc="TGaA9GNwNHNqOI1puGsG",_c="WbAVELAe4MYolhkCc3Fi",Fc="dbxGYAFrGj4AmrkUZUF_",Uc="R9vTZwai2jSPTWVMsiwJ",Pc="jgrHQqqua05ZPua5D9FG",Mc="RuZBN01h_ndf_5HWz8PD",Hc="A80fpjJSB0qHk0hL0C9x",Vc="koRjwkroF5WiR0X2mPtc",qc="KLD8LzZlxKsRrqV4j2EP";function zc({spec:e,logger:t,uri:i}){const a=(0,n.useCallback)((n=>{const a=e.heartButtonFactory().hitLike({itemToBeLiked:i}),s=e.heartButtonFactory().hitRemoveLike({itemNoLongerLiked:i});t.logInteraction(n?a:s)}),[e,i,t]);return(0,y.jsx)(Ic.b,{onClick:a,uri:i,size:Rc.t.sm,className:_c})}var Yc=i(60749),Gc=i(85165),Qc=i(48653),Wc=i(32639),Zc=i(67721),Kc=i(29618);function Jc({spec:e,logger:t,track:i}){const{badges:a,hasBadges:s}=(0,Kc.b)({isExplicit:i.contentRating?.label===Zc.x7.Explicit,isMOGEFRestricted:i.contentRating?.label===Zc.x7.NineteenPlus}),r=(i,n)=>()=>{const a=e.artistLinkFactory({position:n,uri:i}).hitUiNavigate({destination:i});t.logInteraction(a)};return(0,y.jsx)(ca.j,{dir:"auto",children:(0,y.jsxs)(l.E,{semanticColor:"textSubdued",variant:"bodySmall",className:Pc,children:[s&&(0,y.jsxs)("span",{className:Fc,children:[a.explicit&&(0,y.jsx)(Qc.U,{}),a.nineteen&&(0,y.jsx)(Wc.q,{size:16,className:Uc})]}),(0,y.jsx)(l.E,{semanticColor:"textSubdued",variant:"bodySmall",children:U.Ru.get("song")}),(0,y.jsx)(l.E,{semanticColor:"textSubdued",variant:"bodySmall",children:(0,y.jsx)(y.Fragment,{children:"•"})}),(0,y.jsx)("span",{className:Mc,children:i.artists.items.map(((e,t,i)=>(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)(ua.h,{menu:(0,y.jsx)(Gc.t,{uri:e.uri}),children:(0,y.jsx)(Yc.N_,{to:e.uri,onClick:r(e.uri,t),children:(0,y.jsx)(l.E,{variant:"bodySmall",className:Vc,children:e.profile.name})})}),t<i.length-1&&U.Ru.getSeparator()]},`${e.uri}-${t}`)))})]})})}const Xc=(0,qr.mc)((({track:e,position:t})=>{const{spec:i,logger:n}=(0,et.r)(pc.i,{data:{position:t,uri:e.uri,reason:""}}),{isActive:a}=(0,Dr.l_)(e.uri);return(0,y.jsx)("div",{className:Bc,children:(0,y.jsx)(ua.h,{menu:(0,y.jsx)(mc.P,{uri:e.uri}),children:(0,y.jsx)(gc.k,{isActive:a,id:e.uri,size:"lg",onClick:()=>{},isRedundantOnClick:!0,variant:"elevated",hoverBackgroundColor:"backgroundElevatedHighlight",activeBackgroundColor:"backgroundElevatedBase",className:qc,breakpoint:xc.e.SMALL,media:(0,y.jsx)(Ec,{uri:e.uri,spec:i,logger:n,images:e.albumOfTrack?.coverArt?.sources??[]}),title:(0,y.jsx)(vc.U,{lineClamp:1,children:e.name}),subtitle:(0,y.jsx)(Jc,{spec:i,logger:n,track:e}),trailing:(0,y.jsx)(zc,{spec:i,logger:n,uri:e.uri})})})})}),{name:"RelatedAudioTracksChild"}),$c=(0,qr.mc)((({data:e,item:t,position:i=0,fullBleedGap:n=0,carouselCardWidth:a=280})=>{const{spec:s,logger:r}=(0,et.r)(uc.f,{data:{identifier:"related-audio-tracks",position:i,uri:t.uri}}),l=(0,Sa.t)(s),o=U.Ru.get("web-player.now-playing-view.related-audio-tracks-title");if(!t.uri||"Artist"!==e?.artistUnion.__typename||0===e.artistUnion.discography?.topTracks?.items.length)return null;const c=e.artistUnion.discography.topTracks.items;return(0,y.jsx)(to.w,{ref:l,className:Tc,style:{"--full-bleed-gap":`${n}px`,"--carousel-shelf-element-width":`${a}px`},children:(0,y.jsxs)(ka.r,{spec:s,children:[(0,y.jsx)(to.X,{className:d()(Ac),children:o}),(0,y.jsx)(dc.FN,{chevronsClassName:Lc,scrollContentClassName:d()(Dc),scrollerClassName:d()(Oc),scrollingMethod:dc.Hv.BY_RATIO,scrollRatio:.5,wheelScrollEnabled:!1,dragToScrollOptions:{isDisabled:!1},showButtons:dc.C_.ON_HOVER,onNavigationClick:()=>r.logInteraction(s.shelfHeaderFactory().shelfCarouselControlsFactory().shelfCarouselControlsPreviousFactory().hitUiReveal()),edgeGradients:dc.TB.NONE,children:(0,y.jsx)(cc.FK,{className:Hc,"aria-label":o,items:c,layout:"stack",children:e=>(0,y.jsx)(cc.KP,{id:e.track.uri,"aria-label":e.track.name,children:(0,y.jsx)(Xc,{track:e.track,position:c.indexOf(e)})})})})]})})}),{name:"RelatedAudioTracks"});var eu=i(42918),tu=i(1146);const iu=({item:e,spec:t})=>{const i=(0,s.NC)(al.LX5),n=(0,s.NC)(al.RsN),{loading:a,error:r,data:l}=(0,tu.i)(e),o=(0,s.NC)(al.L$q),c=no(e);if(a&&e.uri&&!r)return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(go,{}),(0,y.jsx)(go,{}),(0,y.jsx)(go,{})]});if(!e.uri||"Artist"!==l?.artistUnion.__typename||"Track"!==l?.trackUnion.__typename||a||r)return null;const{profile:u,stats:d,visuals:p,profile:{externalLinks:m}}=l.artistUnion,{credits:g}=l.trackUnion,v=o!==al.vkU.CONTROL;return(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(ka.r,{spec:t,children:[v&&(0,y.jsx)(rc,{item:e}),i&&(0,y.jsx)(eu.a,{data:l,item:e}),n&&(0,y.jsx)($c,{data:l,item:e,position:1+Number(v)+Number(i)}),(0,y.jsx)(No.F,{artistUri:l.artistUnion.uri,artist:u,stats:d,visuals:p,externalLinks:m.items}),g&&(0,y.jsx)(ko.V,{data:g,trackUri:e.uri}),(0,y.jsx)(oc.I,{artistId:l.artistUnion.id,data:l.artistUnion.goods.concerts}),(0,y.jsx)(lc.J,{artistId:l.artistUnion.id,artistUri:l.artistUnion.uri,merch:l.trackUnion.merch.items}),c&&(0,y.jsx)(so,{item:e})]})})},nu=({item:e,spec:t})=>(0,Tt.n)()&&e.artists[0].uri?(0,y.jsx)(iu,{item:e,spec:t}):(0,y.jsx)(y.Fragment,{});var au=i(56189),su=i(15823),ru=i(94287);const lu=({item:e,spec:t})=>(0,il.v)(e)&&!e.isLocal?(0,y.jsx)(nu,{item:e,spec:t}):(0,il.v)(e)&&e.isLocal?(0,y.jsx)(wo,{}):(0,ru.p)(e)?(0,y.jsx)(Co,{item:e,spec:t}):(0,su.d)(e)?(0,y.jsx)(kl,{item:e}):(0,au.N)(e)?(0,y.jsx)(ml,{}):null;var ou=i(46099),cu=i(12068),uu=i(17040),du=i(15625),pu=i(63273);const mu="Ez4qKWmsDLh3iWdsnhKb",gu="ekcURLG5sTWx5S7E_Ul_",vu="_ChTSMj9kopaozdg25FG",xu=(0,n.forwardRef)((({spec:e,logger:t},i)=>{const a=(0,qi.mv)(),s=a.operatingSystem===pu.f.macOS?(0,Pi.b)("images/download-page-image-mac.png"):(0,Pi.b)("images/download-page-image.png");const{downloadUrl:r}=(0,du.z)(),o=(0,n.useCallback)((()=>{t.logInteraction(e.buttonDownloadFactory().hitNavigateToExternalUri({destination:r})),window.open(r,"_blank")}),[r,t,e]);return(0,y.jsxs)("div",{className:mu,ref:i,children:[(0,y.jsx)("div",{className:gu,style:{"--background-image":`url(${s})`}}),(0,y.jsxs)("div",{className:vu,children:[(0,y.jsx)(l.E,{variant:"titleMedium",semanticColor:"textBase",children:U.Ru.get("web-player.now-playing-view.web2desktop-funnel.title",{device:(0,uu.e)(a.operatingSystem)})}),(0,y.jsx)(l.E,{variant:"bodyMedium",semanticColor:"textSubdued",children:U.Ru.get("web-player.now-playing-view.web2desktop-funnel.subtitle")}),(0,y.jsx)(c.$,{size:"medium",colorSet:"brightAccent",onClick:o,style:{alignSelf:"flex-start"},"aria-label":U.Ru.get("web-player.now-playing-view.web2desktop-funnel.button"),children:U.Ru.get("web-player.now-playing-view.web2desktop-funnel.button")})]})]})})),bu="Yl2wNWzQgsRb49UB30No",hu="Ko2eaQC7YRLTy1QsIY4Q";function yu(){const e=(0,cu.K)(),{spec:t,logger:i}=(0,et.r)(ou.l,{}),a=(0,Sa.t)(t),s=(0,n.useCallback)((()=>{i.logInteraction(t.buttonSearchFactory().hitFocusInputField()),document.querySelector("[data-top-bar-search]")?.focus()}),[i,t]);return e?(0,y.jsx)(xu,{spec:t,ref:a,logger:i}):(0,y.jsxs)("div",{className:bu,ref:a,children:[(0,y.jsx)(l.E,{variant:"titleSmall",semanticColor:"textBase",className:hu,children:U.Ru.get("queue.fine-something")}),(0,y.jsx)(c.$,{size:"small",colorSet:"brightAccent",onClick:s,children:U.Ru.get("web-player.now-playing-view.empty-state-cta")})]})}var ju=i(99912),fu=i(8335),Su=i(21e3),Cu=i(72739),wu=i(30626),Nu=i(43649),ku=i(87883),Eu=i(29398);const Ru="KHaAkbA62j5I7pcLsDAx",Iu="Zaorh8_jZ8Vlyn3v2N3B",Lu="jKvr1cqkZZXpH5z92z9b",Au="peN_VMHSmvTVUx9rneyY",Tu=({context:e,item:t,index:i,isVisible:n})=>{const{spec:a,logger:s}=(0,et.r)(Gr.J,{}),{draggable:r,onDragStart:l}=(0,Eu.P)(),{ref:o,inView:c}=(0,fu.Wx)({threshold:.5,initialInView:!0});return(0,y.jsx)("div",{className:d()(Ru,{[Iu]:n}),"data-testid":"minimized-track-visual-enhancement",children:(0,y.jsx)(ua.h,{menu:(0,y.jsx)(dl.W,{context:e,item:t}),children:(0,y.jsx)("div",{draggable:r&&(0,il.v)(t),onDragStart:e=>{l(e,{itemUris:[t.uri],dragLabelText:(0,ku.r)(t)})},ref:o,children:(0,y.jsx)(Nu.R,{uri:e.uri,owner:e.metadata?.context_owner,children:(0,y.jsx)(wu.e,{context:t.type===Pl.c.TRACK?t.album:e,item:t,index:i,isVisible:!0,onClick:()=>{s.logInteraction(a.coverArtFactory({uri:t.uri}).hitUiNavigate({destination:t.type===Pl.c.TRACK?t.album.uri:t.uri}))},adEventReason:Su.c.COVER_ART,children:(0,y.jsx)(Cu.b,{className:d()(Lu,{[Au]:c}),images:t.images??[],type:t.type,maxSize:56,desiredLabel:"small"})})})})})})};var Ou=i(64180),Du=i(1916),Bu=i(68437),_u=i(65271);const Fu="TkDZFBZ0IPbGaHDxeCci",Uu="bBG9E6mmFFC74pSkqU0o",Pu=({ad:e,backgroundColor:t,onClick:i})=>{const a=(0,_u.H)(e.clickthroughUrl),s=e.metadata?.buttonMessage||U.Ru.get("ad-formats.learnMore");return(0,y.jsx)(rt.N,{to:a,"data-testid":"ad-companion-card",onClick:i,className:Fu,children:(0,y.jsx)(W.v,{style:{backgroundColor:t},className:Uu,onClickHint:U.Ru.get("ad-formats.learnMore"),variant:"tinted",horizontalGap:(0,Bu.po)("looser"),id:e.adId,title:(0,y.jsx)(ke.d,{variant:"bodySmallBold",children:e.metadata.advertiser||U.Ru.get("ad-formats.learnMore")}),trailing:(0,y.jsx)(n.Suspense,{fallback:(0,y.jsx)(sn.V,{}),children:e.metadata?.advertiser?(0,y.jsx)(c.$,{colorSet:"invertedLight",size:"small",children:s}):(0,y.jsx)(sn.V,{"data-testid":"embedded-ad-cta-button-fallback",semanticColor:"textBase"})})})})};var Mu=i(86974);const Hu="wibNcSZSkSmE1N7F0QbG",Vu="xIrPThBgWj2hMwWDOcVq",qu=({onDismiss:e})=>(0,y.jsxs)("div",{className:Vu,children:[(0,y.jsx)(Mu.v,{colorSet:"overMedia",className:Hu,children:(0,y.jsx)(l.E,{variant:"marginalBold",semanticColor:"textBase",children:U.Ru.get("ad-formats.advertisement")})}),(0,y.jsx)(c.$,{"aria-label":U.Ru.get("ad-formats.dismissAd"),colorSet:"overMedia",iconOnly:xr.M,onClick:e,size:"small"})]});var zu=i(16467),Yu=i(43392);const Gu="YPTXM8u2OcJuJskm6uwv",Qu="QRqQ5S1T7WIBTZzJ6cAh",Wu=({ad:e,onClick:t,onLoad:i,onError:n})=>{const a=e.display.reduce(((e,t)=>(t.url&&e.push({url:t.url,width:t.width,height:t.height}),e)),[]),s=(0,zu.h)(a??void 0,{desiredSize:384}),r=(0,Yu.m)({imageUriOrUrl:s});return(0,y.jsx)(rt.N,{to:e.clickthroughUrl,onClick:t,className:Gu,"data-testid":"embedded-ad-creative-link",children:(0,y.jsx)(oi._,{loading:"eager",src:r,className:Qu,onLoad:i,onError:n})})};var Zu=i(21688);const Ku="XOqwMsxI9nljlJz4i3za",Ju=({ad:e})=>{const t=(0,F.wA)(),i=(0,n.useRef)(null),{adEventLogger:a,embeddedNPVAdEventLogger:r,embeddedAdErrorLogger:l}=(0,Du.CO)(),o=(0,n.useRef)(!1),c=(0,n.useRef)(!1),u=(0,n.useRef)(!1),{context:d,item:p}=(0,Ot.o)((e=>e),pl.F)||{context:null,item:null},m=(0,n.useCallback)((()=>{a.log("dismissed",e),t((0,Qr.Xo)())}),[e,a,t]),g=(0,n.useCallback)((()=>{o.current||(a.log("viewed",e),r.log("start",e,{context_uri:d?.uri,track_uri:p?.uri}),o.current=!0)}),[e,a,d?.uri,r,p?.uri]),v=(0,n.useCallback)((()=>{u.current||(a.log("errored",e,{event_reason:"creative load error"}),l.log("error",e,{error_message:"creative load error"}),t((0,Qr.Xo)()),u.current=!0)}),[e,a,t,l]),x=(0,n.useCallback)((()=>{a.log("clicked",e),r.log("click",e,{context_uri:d?.uri,track_uri:p?.uri}),t((0,Qr.Xo)())}),[e,a,r,d?.uri,p?.uri,t]),b=(0,s.NC)(al.vDv),h=(0,Zu.z)(e.display[0]?.url,Ou.CpN,"colorDark");return(0,n.useEffect)((()=>{const n=setTimeout((async()=>{if(i.current){const e=i.current.animate([{opacity:1,transform:"translateY(0)"},{opacity:0,transform:"translateY(-100%)"}],{duration:350,fill:"forwards",easing:"ease-out"});await e.finished,t((0,Qr.Xo)())}else t((0,Qr.Xo)())}),1e3*b);return()=>{t((0,Qr.Xo)()),c.current||(a.log("ended",e),r.log("end",e,{context_uri:d?.uri,track_uri:p?.uri}),c.current=!0),clearTimeout(n)}}),[e,a,d?.uri,t,r,p?.uri,b]),(0,y.jsxs)("div",{ref:i,className:Ku,"data-testid":"embedded-ad",children:[(0,y.jsx)(qu,{onDismiss:m}),(0,y.jsx)(Wu,{ad:e,onClick:x,onLoad:g,onError:v}),(0,y.jsx)(Pu,{ad:e,backgroundColor:h,onClick:x})]})};var Xu=i(58200),$u=i(719),ed=i(59877);const td=(0,qr.mc)((()=>{const e=(0,n.useContext)(at.s),t=(0,ed.a)({tryAvoidGraphQLFetching:!1}),i=(0,s.NC)(al.yJ8)===al.NtL.CANVAS_PLAY_ON_HOVER;return t?.canvas&&e?(0,y.jsx)($u.Gg,{fileId:t.canvas.fileId,canvasUrl:t.canvas.url,canvasType:t.canvas.type,canvasUri:t.canvas.uri,playerContainerClass:"canvasVideoContainerNPV",playbackType:i?$u.RT.LoopOnHover:$u.RT.LoopOnPlayback,allowAspectRatioFix:!0,mouseHoverRef:e,useContainerMouseOverEvents:!1}):null}),{name:"NPVCanvas"});var id=i(39708),nd=i(67954),ad=i(58977),sd=i(38976),rd=i(6550),ld=i(82743),od=i(31352),cd=i(89429),ud=i(89945);const dd="main-nowPlayingView-nowPlayingWidget",pd="T5_sYfKJ2efL3n3dFNuN",md="bLX5l9C_iEfonbMKiFD_",gd="sJHheSrjFUt_MAcNrUXQ",vd="hhFdIYRyHsqlCHy7T_8A",xd="main-nowPlayingView-nowPlayingGrid",bd="main-nowPlayingView-contextItemInfo",hd="O5NOY8Xw4NH0IhBZu8tm",yd="DFvRASpHOFAoziM4w7En",jd="main-nowPlayingView-coverArtContainer",fd="ylBRlfNqGnzVa4kjUQGP",Sd="E08D6ucrHuPJYzzGO7HG",Cd="hjyiWzPtKHn_5kCe9vyg",wd="pUIBQ9cykHKYx2A2ZIPA",Nd="_q9LkNJJIpxoOkOFI2Nd",kd="S6W0kreMgaIXYWSEYHya",Ed="hCImOEZCJwYaSy2r1Xgx",Rd="GY_emVGtuRR8FWeKK9je",Id="main-nowPlayingView-trackInfo",Ld="eEiwEPDfVRD0HKjYM_dq",Ad=({item:e,spec:t})=>{const i=(0,le.s)(),a=(0,n.useCallback)((n=>{const a=n?t.heartButtonFactory().hitLike({itemToBeLiked:e.uri}):t.heartButtonFactory().hitRemoveLike({itemNoLongerLiked:e.uri});i.logInteraction(a)}),[e.uri,i,t]),s=(0,rd.v)(e),r=(0,k.y)();return s?(0,y.jsx)(sd.g,{uri:e.uri,size:r===N.E.MEDIUM?"medium":"small",className:vd}):(0,il.v)(e)&&!e.isLocal?(0,y.jsx)(Ic.b,{uri:e.uri,size:r===N.E.MEDIUM?Rc.t.sm:Rc.t.xs,onClick:a,className:vd}):(0,ru.p)(e)?(0,y.jsx)(nd.b,{uri:e.uri,size:r===N.E.MEDIUM?Rc.t.sm:Rc.t.xs,onClick:a,className:vd,condensed:!0}):null},Td=({context:e,item:t})=>{const{spec:i,logger:n}=(0,et.r)(Gr.J,{}),{spec:a}=(0,et.r)(id.p6,{data:{identifier:id.gw.DESKTOP}}),s=(0,ud.X)(),r=(0,k.y)();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(ad.w,{className:d()(yd,gd),uri:t.uri,sharingInfo:null,interactionData:{intent:"share",type:"click"},condensedAll:!0,onClick:()=>{n.logInteraction(i.shareButtonFactory({uri:t.uri}).hitCopyToClipboard())},ariaLabel:(0,_n.gHQ)(t.uri)?U.Ru.get("context-menu.copy-episode-link"):U.Ru.get("context-menu.copy-track-link"),size:r===N.E.MEDIUM?"medium":"small"}),(0,y.jsx)(ld.a,{context:e,item:t,className:d()(hd,pd),onClick:()=>{n.logInteraction(a.hideButtonFactory().hitRemoveRecommendation({recommendedItemUri:t.uri,contextUri:e.uri}))}}),s&&(0,cd.N)(t)?(0,y.jsx)(ka.r,{spec:i,children:(0,y.jsx)("div",{className:hd,children:(0,y.jsx)(od.o,{contextUri:t.metadata?.context_uri??e.uri,id:t.uid??void 0,uri:t.uri,isActive:!0})})}):(0,y.jsx)("div",{className:hd,children:(0,y.jsx)(Ad,{item:t,spec:i})})]})};var Od=i(87078),Dd=i(2441),Bd=i(66736),_d=i(30150),Fd=i(88016),Ud=i(31925),Pd=i(87033);let Md=function(e){return e[e.NONE=0]="NONE",e[e.COVER_ART=1]="COVER_ART",e[e.VIDEO_OVER_PIP_PLACEHOLDER=2]="VIDEO_OVER_PIP_PLACEHOLDER",e[e.VIDEO_OVER_CONNECT_PLACEHOLDER=3]="VIDEO_OVER_CONNECT_PLACEHOLDER",e[e.CANVAS=4]="CANVAS",e}({});const Hd=()=>{const e=(0,pl.L)(),t=(0,H.l)(),{videoPlayerMode:i}=(0,Ud.d)(),{isSongVideo:n,isSongVideoPlayingVideo:a}=(0,Fd.k)(),s=(0,F.d4)((e=>e.ads?.vto)),{showCanvasInNPV:r}=(0,ed.a)({tryAvoidGraphQLFetching:!0});if(!e)return Md.NONE;const{item:l}=e;return i===Pd.Kz.documentPip||i===Pd.Kz.pip?Md.VIDEO_OVER_PIP_PLACEHOLDER:l?.type===Pl.c.AD&&s?.isMinimized&&"audio"!==l?.mediaType?Md.NONE:l?.type!==Pl.c.EPISODE||"video"!==l?.mediaType&&"mixed"!==l?.mediaType?n&&a?t?Md.VIDEO_OVER_CONNECT_PLACEHOLDER:Md.NONE:r?Md.CANVAS:Md.COVER_ART:t?Md.VIDEO_OVER_CONNECT_PLACEHOLDER:Md.NONE};var Vd=i(40904);const qd=(0,qr.mc)((({hideContextItemInfo:e=!1})=>{const t=(0,pl.L)(),i=Hd(),{draggable:a,onDragStart:r}=(0,Eu.P)(),[l,o]=(0,n.useState)(!0),{spec:c,logger:u}=(0,et.r)(Gr.J,{}),{spec:p}=(0,et.r)(ju.E,{data:{uri:t?.item.uri??"",identifier:Pd.Kz.npv}}),{isSongVideo:m}=(0,Fd.k)(),g=i===Md.CANVAS,v=i===Md.COVER_ART,x=(0,F.d4)(Kr),b=((e,t)=>{const[i,a]=(0,n.useState)(!1),r=(0,n.useRef)(),l=(0,s.NC)(al.Ym5,{loadingValue:!1}),o=(0,F.d4)(Jr),c=(0,F.d4)(Kr),u=(0,el.$)(),d=nl(t),p=(0,n.useMemo)((()=>Boolean(o&&l&&e)),[e,l,o]),m=(0,n.useCallback)((()=>{r.current&&(clearTimeout(r.current),r.current=null)}),[]);return(0,n.useEffect)((()=>{d&&(m(),a(!1))}),[d,m]),(0,n.useEffect)((()=>p&&c?(r.current=setTimeout((()=>{a(!0)}),2e3),m):(a(!1),()=>{})),[p,m,c,d]),(0,n.useMemo)((()=>Boolean(p&&c&&o&&i&&u)),[p,c,o,i,u])})(v,t?.item),h=(0,n.useRef)(null),j=(0,n.useRef)(null),f=(0,n.useRef)(null),S=!(0,Oi.j)(),[C,w]=(0,n.useState)(null);if(S&&g&&h.current&&f.current&&(w(f.current),setTimeout((()=>{w(null)}),600)),h.current=v,j.current=g,f.current=t,null===t)return null;const{context:N,item:k,index:E}=t;return(0,y.jsx)("div",{className:d()(dd),children:(0,y.jsxs)("div",{className:xd,children:[(0,y.jsxs)("div",{onClick:()=>g&&o(!l),className:d()(jd,{[Cd]:g,[Ed]:v,[wd]:l,[Rd]:b}),children:[b&&x&&(0,y.jsx)(Ju,{ad:x}),(0,y.jsx)("div",{className:d()(fd,{[Nd]:g||b}),"aria-hidden":g||b,"data-testid":"track-visual-enhancement",children:(0,y.jsx)(Od.h,{context:C?.context||N,item:C?.item||k,index:E,canSwitchVisuals:!0,isMinimized:b})}),i===Md.VIDEO_OVER_PIP_PLACEHOLDER&&(0,y.jsx)(Bd.k,{}),i===Md.VIDEO_OVER_CONNECT_PLACEHOLDER&&(0,y.jsx)(_d.V,{}),(0,y.jsx)("div",{className:d()(Sd,{[kd]:!g}),"aria-hidden":"true",children:(0,y.jsx)(ua.h,{menu:(0,y.jsx)(dl.W,{context:N,item:k,canSwitchVisuals:!0}),children:(0,y.jsx)("div",{draggable:a,onDragStart:e=>{r(e,{itemUris:[k.uri],dragLabelText:(0,ku.r)(k)})},children:g&&(0,y.jsx)(td,{uri:k.uri})})})}),(0,y.jsx)(Dd.F,{})]}),m&&(0,y.jsx)(Vd.L,{className:g?Ld:"",createImpressionSpec:e=>p.toggleAudioVideoButtonFactory({identifier:e?"switch_to_audio":"switch_to_video"}),onClick:e=>{u.logInteraction(p.toggleAudioVideoButtonFactory({identifier:e}).hitPlay({itemToBePlayed:k.uri}))}}),e?null:(0,y.jsxs)("div",{className:d()(bd,{[md]:g}),children:[(0,y.jsx)(Tu,{isVisible:b,context:N,item:k,index:E}),(0,y.jsx)(Ul.d,{className:d()(Id),context:N,item:k,titleTypeVariant:"titleSmall",subtitleTypeVariant:"bodyMedium",onTitleClick:e=>{u.logInteraction(c.titleFactory({uri:k.uri}).hitUiNavigate({destination:e||""}))},onSubtitleClick:e=>{u.logInteraction(c.artistFactory({uri:k.uri}).hitUiNavigate({destination:e||""}))},referrer:Xu.G.NPV}),!(0,au.N)(k)&&(0,y.jsx)(Td,{context:N,item:k})]})]})})}),{name:"NPVHeader"});function zd(){return(0,y.jsx)(qd,{})}const Yd=({className:e})=>{const t=(0,n.useRef)(null);(0,ee.X)("NPV_OPEN_CINEMA_MODE_BUTTON",t);const i=(0,Zo.l)(),{spec:a,logger:s}=(0,et.r)(Gr.J,{}),r=(0,n.useCallback)((()=>{i(Vn.z.NOW_PLAYING_VIEW),s.logInteraction(a.expandNpvButtonFactory().hitUiReveal())}),[s,i,a]);return(0,y.jsx)(da.Zp,{label:U.Ru.get("web-player.now-playing-view.cinema-mode.expand"),children:(0,y.jsx)(me.H,{ref:t,iconOnly:Yo.L,size:"small",onClick:r,"aria-label":U.Ru.get("web-player.now-playing-view.cinema-mode.expand"),className:e})})};var Gd=i(2706),Qd=i(91923),Wd=i(82128);const Zd={context:null,item:null};var Kd=i(74885),Jd=i(91486),Xd=i(97734),$d=i(84575),ep=i(56616),tp=i(11643),ip=i(26249),np=i(50006),ap=i(89929);const sp="yvZooOj0rpfRS__cAUCo",rp="k_ndsg7yz9ZAgEmei1n3",lp="vDev2BqBHloweL24GNHK",op="IkRGajTjItEFQkRMeH6v",cp="f2UE9n5nZcbgZrGYTU3r",up="nw2W4ZMdICuBo08Tzxg9",dp="wPHL366l99aluPsMU8Bl",pp="UAg2mNxhAm_jv0zFjG8z",mp="VjVlpyxDo941sgO2Vc8g";function gp(e){return(0,il.v)(e)||(0,ip.v)(e)||(0,ru.p)(e)||(0,su.d)(e)?e.name:(0,au.N)(e)?"":(0,En.d)(e)}const vp=n.memo((({item:e,spec:t})=>{const{ref:i,breakpoint:n}=(0,E.x)({[N.E.XSMALL]:0,[N.E.SMALL]:280,[N.E.MEDIUM]:320});return(0,y.jsx)("div",{className:up,"data-testid":"NPV_Panel_OpenDiv",ref:i,children:e&&(0,y.jsxs)(k.o.Provider,{value:n,children:[(0,y.jsx)(qd,{}),(0,y.jsx)(lu,{item:e,spec:t}),!(0,ru.p)(e)&&(0,y.jsx)(ro.A,{})]})})})),xp=({context:e,item:t,spec:i})=>{const a=(0,$d.SF)();return(0,n.useEffect)((()=>{a.current&&(a.current.scrollTop=0)}),[t?.uri,a]),(0,Jd.bJ)(e,t)?(0,y.jsx)(Kd.IT,{spec:i}):(0,y.jsx)(vp,{context:e,item:t,spec:i})},bp=({context:e,item:t,spec:i})=>{const n=(0,qn.S)();return sl(),n===Vn.z.NOW_PLAYING_VIEW?null:(0,y.jsx)(xp,{context:e,item:t,spec:i})},hp=()=>Hd()===Md.CANVAS,yp=({item:e})=>{const t=(0,n.useRef)(null),i=(0,pl.L)(),{title:a,link:r}=(0,Xd.$)(),l=hp(),o=(0,s.NC)(al.mzn),{spec:c,logger:u}=(0,et.r)(Gr.J,{}),p=(0,n.useCallback)((()=>{const e=c.closeButtonFactory().hitUiHide();u.logInteraction(e)}),[c,u]);return(0,n.useEffect)((()=>{null!==t.current&&t.current.focus({preventScroll:!0})}),[]),(0,y.jsx)(w.a,{title:a,titleSlot:(0,y.jsx)(w.k,{title:a,panelLinkRef:t,item:e,link:r,variant:"bodyMediumBold",semanticColor:"textBase",className:rp,hasNPVCloseButton:o}),link:r,actions:i&&i.context&&(0,y.jsxs)("div",{className:o?pp:mp,children:[(0,y.jsx)(ma.b,{menu:(0,y.jsx)(dl.W,{context:i.context,item:e,canSwitchVisuals:!0}),children:(0,y.jsx)(ul.e,{size:"small",condensed:!1,label:U.Ru.get("more.label.context",e?gp(e):""),onClick:()=>{u.logInteraction(c.contextMenuButtonFactory().hitUiReveal())},className:dp})}),o&&(0,y.jsx)(Yd,{className:dp})]}),panelLinkRef:t,panel:v.Z.NowPlayingView,onClose:p,item:e,className:d()({[sp]:l})})},jp=({item:e})=>{const t=!!e&&(0,au.N)(e);return(0,n.useMemo)((()=>t?null:(0,y.jsx)(yp,{item:e})),[e,t])},fp=(0,qr.mc)((({nodeRef:e})=>{const t=!(0,Tt.n)(),{context:i,item:n,index:a}=(0,Ot.o)((e=>e),pl.F)||{context:null,item:null,index:null},{spec:r,UBIFragment:l}=(0,ap.$)(Yr.t,{data:{uri:n?n.uri:""}}),o=hp(),c=!!n&&(0,au.N)(n),u=(0,Sa.t)(r),p=(()=>{const{item:e,context:t}=(0,pl.L)()||Zd,{isYourDJNarrator:i,hasYourDJMetadata:n}=(0,Qd.C)(),a=(0,s.NC)(al.yon),r=(0,Zu.z)(e?.images?.[0]?.url,Ou.l0o,"colorDark");return i&&n?(0,Wd.p)(t?.metadata?.["narration.background.color"],Gd.lZ):a?r:void 0})(),m={"--background-base":p};let g=null;g=(0,np.O)(i)&&null!==n?t?(0,y.jsx)(zd,{}):c?(0,y.jsx)(cl,{item:n,context:i,index:a}):(0,y.jsx)(bp,{spec:r,context:i,item:n}):(0,y.jsx)(yu,{});const v={cssStyles:{"--section-background-base":p?"var(--background-tinted-base)":"var(--background-elevated-base)","--section-padding":zr.spacer16,"--section-border-radius":zr.spacer8},headerVariant:"bodyMediumBold"};return(0,y.jsx)(tp.P,{surface:ep.u.NOW_PLAYING,children:(0,y.jsx)($d.ql.Provider,{value:"now_playing_panel",children:(0,y.jsx)(co.Tn,{...v,children:(0,y.jsx)(at._,{nodeRef:e,label:U.Ru.get("web-player.now-playing-view.label"),style:{...m,...v.cssStyles},itemUri:n?.uri?n.uri:"","data-testid":"now-playing-view-container",className:"NowPlayingView",children:(0,y.jsx)(l,{spec:r,children:(0,y.jsx)(C.w,{className:d()(op,{[cp]:void 0!==p}),fixedHeader:(0,y.jsx)(jp,{item:n}),scrolledClassName:o?lp:void 0,ref:u,children:g})})})})})})}),{name:"NPV"}),Sp="vzeIlCPBQJUaqdMZHqHE",Cp="iZgGvu9g2gDlQ1ofJ7rH",wp="FSZKuoSTDgGwCPXO_qel",Np="cPpNQwPTiEn9Zegl5Dwz",kp="p2Yw6bT_O5PW8yGv1R0X",Ep="pK7G3_mtRcuFjbhJzm1s",Rp="gVJxtuXo8lHAw8XLKHfQ",Ip="BR3H6wavkReGa2xeSeaV",Lp="vXYSi4u1nPutJ_ZkC6mq",Ap=e=>{const t=(0,n.useRef)(null);return(0,y.jsx)(a.A,{in:e.isActive,nodeRef:t,timeout:{enter:e.shouldPlayAnimation?200:0,exit:e.shouldPlayAnimation?300:0},classNames:{enter:e.shouldPlayAnimation?Cp:Ep,enterActive:e.shouldPlayAnimation?wp:Rp,exit:e.shouldPlayAnimation?Np:Ip,exitActive:e.shouldPlayAnimation?kp:Rp},unmountOnExit:!0,mountOnEnter:!0,children:(0,y.jsx)("div",{className:Sp,children:(0,y.jsx)("div",{className:Lp,ref:t,children:e.children})})})};var Tp=i(12583),Op=i(74725),Dp=i(14012),Bp=i(54840),_p=i(78730),Fp=i(49750),Up=i(6525),Pp=i(5065),Mp=i(38649),Hp=i(75929),Vp=i(23354);const qp="PddBvUOS0_6f9B21fVGF",zp=({ariaLabel:e,onRemoveItems:t,nrItems:i,columnCount:a,children:s})=>{const r=(0,n.useRef)(null);(0,Mp.g)(r);const l=(0,Hp.d)(t);return(0,y.jsx)(Pp.R,{firstInteractiveIsWrapper:!0,"aria-label":e,"aria-rowcount":i,"aria-colcount":a,className:qp,ref:r,onKeyDown:l,children:s})},Yp=({items:e,renderRow:t,...i})=>{const a=(0,n.useCallback)(((t,i)=>e.slice(t,i+1)),[e]);return(0,y.jsx)(Vp.k,{resolveItem:Gp,getItems:a,nrTracks:e.length,children:(0,y.jsx)(zp,{nrItems:e.length,...i,children:e.map(t)})})};function Gp(e){return{uri:e.uri,uid:e.uid??void 0,type:e.type}}var Qp=i(2135),Wp=i(60881),Zp=i(77024),Kp=i(54500),Jp=i(99332),Xp=i(84495),$p=i(48677);const em=({chapter:e,index:t,showTypeLabel:i,...n})=>{const{uid:a,uri:s,type:r,name:l,images:o,book:c}=e,u=(0,Qp.E)(e,t),d=(0,$p.Y)(n.section),p=(0,y.jsx)(Kp.r,{uri:s,removeFromQueueData:{uid:a??void 0,contextUri:d}}),m=(0,y.jsx)(Xp.n,{item:e,tooltipText:c.name,showTypeLabel:i,subtitle:(0,y.jsx)(ua.h,{menu:(0,y.jsx)(Zp.p,{uri:c.uri}),children:(0,y.jsx)(rt.N,{to:c.uri,stopPropagation:!0,children:c.name})})});return(0,y.jsx)(Jp.b,{uid:a,uri:s,contextUri:d,id:u,index:t,type:r,title:l,subtitle:m,images:o,dragLabel:l,menu:p,moreButtonLabelName:l,ariaPauseLabel:U.Ru.get("playlist.a11y.pause",l),ariaPlayLabel:U.Ru.get("playlist.a11y.play",l),...n})};var tm=i(59935),im=i(87781),nm=i(63663),am=i(36363),sm=i(89615),rm=i(51684),lm=i(63088),om=i(39705),cm=i(58285);function um(e){return"autoplay"===e?.provider}function dm(){const{uri:e,description:t}=(0,Ws.f)(),{current:i,nextUp:n,queued:a}=(0,cm.w)(),s=n.filter((e=>um(e)?e:"autoplay"!==e.provider)),r=!!a?.length,l=!!s?.length;return{uri:e,description:t,current:i,nextUp:s,queued:a,isEmpty:!1===(i||r||l),hasQueuedTracks:r,hasNextTracks:l}}const pm=(0,n.createContext)(null),mm=({children:e})=>{const{uri:t}=dm(),{spec:i,UBIFragment:a}=(0,et.r)(lm.i,{data:{identifier:om.$h.NOWPLAYING_QUEUE,uri:t??""}}),s=(0,n.useMemo)((()=>i.nowPlayingSectionFactory()),[i]),r=(0,n.useMemo)((()=>i.nextInQueueSectionFactory()),[i]),l=(0,n.useMemo)((()=>i.nextFromSectionFactory()),[i]),o=(0,n.useMemo)((()=>({queueSpec:i,nowPlayingSectionSpec:s,nextInQueueSectionSpec:r,nextFromSectionSpec:l})),[i,s,r,l]);return(0,y.jsx)(pm.Provider,{value:o,children:(0,y.jsx)(a,{spec:i,children:e})})};var gm=i(95621);const vm=()=>{const e=(0,n.useContext)(pm);if(!e)throw Error("useQueueUBI must be used within a QueuePanelUBIProvider!");const{queued:t}=dm(),i=(0,le.s)(),{queueSpec:a,nowPlayingSectionSpec:s,nextInQueueSectionSpec:r,nextFromSectionSpec:l}=e;return{logClearQueue:(0,n.useCallback)((()=>{const e=r.clearQueueButtonFactory().hitRemoveItemsFromQueue({numberOfItemsToRemoveFromQueue:t.length});return i.logInteraction(e)}),[i,r,t.length]),logAddToQueue:(0,n.useCallback)(((e,t)=>{let n;switch(e){case sm.$.NowPlaying:n=s;break;case sm.$.NextInQueue:n=r;break;case sm.$.NextUp:n=l;break;default:return}const a=1===t.length?n.dragAddItemToQueue({itemToAddToQueue:t[0]}):n.dragAddItemsToQueue({numberOfItemsToAddToQueue:t.length});return i.logInteraction(a)}),[i,l,r,s]),logSort:(0,n.useCallback)((e=>{let t;switch(e){case sm.$.NextInQueue:t=r;break;case sm.$.NextUp:t=l;break;case sm.$.NowPlaying:default:return}const n=t.dragSort();return i.logInteraction(n)}),[i,l,r]),logQueuePanelTabChange:(0,n.useCallback)((e=>{if(e!==gm.p.PARTICIPANT_LIST){const t=a.queueHistoryTabFactory({identifier:e===gm.p.QUEUE?"queue":"recently_played"}).hitUiReveal();return i.logInteraction(t)}}),[i,a]),logQueueContextLinkNavigate:(0,n.useCallback)((e=>{const t=l.queueContextLinkFactory().hitUiNavigate({destination:e??""});return i.logInteraction(t)}),[i,l])}};var xm=i(71873),bm=i(30118);const hm=(0,n.memo)((function({item:e,...t}){const i=function(e,t){const i=(0,x.z)(),{request:a}=(0,n.useContext)(bm.j),{logAddToQueue:s,logSort:r}=vm();return(0,n.useCallback)((async(n,l,o)=>{const{contextUri:c,sectionId:u,itemIds:d}=o??{},p=t===sm.$.NowPlaying,m=rm.v===c&&!p,g=n[nm.fl.ALBUMS]?.at(0),v=Object.values(n).flat();let x=[];if(g){const{trackUris:e}=await(0,xm.s)(g,0,a);x=e.map((e=>({uri:e,uid:null})))}else x=m&&d?.length?d.map((e=>({uri:"",uid:e}))):Object.values(n).flat().map((e=>({uri:e,uid:null})))??[];const b=m&&u===sm.$.NowPlaying;let h;if(h=l===am.Nz.BEFORE?{before:{uri:e.uri,uid:e.uid??null}}:{after:{uri:e.uri,uid:e.uid??null}},m&&!b)t&&r(t),i.reorderQueue(x,h);else{let e;t&&(e=s(t,v)),p?i.addToQueue(x,{interactionId:e?.interactionId}):i.insertIntoQueue(x,h,{interactionId:e?.interactionId})}}),[e.uid,e.uri,s,r,i,a,t])}(e,t.section);switch(e.type){case Pl.c.TRACK:return(0,y.jsx)(im.e,{track:e,onDrop:i,...t});case Pl.c.EPISODE:return(0,y.jsx)(tm.I,{episode:e,onDrop:i,...t});case Pl.c.CHAPTER:return(0,y.jsx)(em,{chapter:e,onDrop:i,...t});case Pl.c.AD:return(0,y.jsx)(Wp.Y,{ad:e,onDrop:i,...t});case Pl.c.UNKNOWN:return null;default:return(0,En.k)(e),null}})),ym=(0,n.memo)((function({item:e,...t}){const{usePlayContextItem:i}=(0,kc.P)({uri:e.uri,pages:[{items:[e]}]},{featureIdentifier:"history"});return(0,y.jsx)(hm,{item:e,...t,usePlayContextItem:i})})),jm=({items:e})=>{const t=(0,n.useCallback)(((e,t)=>(0,y.jsx)(ym,{item:e,index:t},(0,Qp.E)(e,t))),[]);return(0,y.jsx)(Yp,{items:e,ariaLabel:U.Ru.get("view.recently-played"),renderRow:t,columnCount:rm.$})};var fm=i(77351);const Sm="BP2Fv3OX_ZYbjdA4lovg",Cm="Mxz3x1XNHpH4SvqEVkt0",wm="Olk6uKV_CIIVtWRrdRJc",Nm="AIW16bVmugXaJ42KBNKQ",km=()=>(0,y.jsxs)("div",{className:Sm,children:[(0,y.jsx)(fm.q,{size:"xxlarge","aria-hidden":"true"}),(0,y.jsxs)("div",{className:wm,children:[(0,y.jsx)(l.E,{as:"h1",variant:"titleMedium",semanticColor:"textBase",children:U.Ru.get("history.empty-title")}),(0,y.jsx)("p",{children:U.Ru.get("history.empty-description")})]})]});var Em=i(48387),Rm=i(23841);const Im=["play-history-contents"];function Lm(){const e=(0,Rm.q)(),t=(0,An.jE)();return function(e,t){const i=(0,Rm.q)();(0,n.useEffect)((()=>i.getEvents().addListener(e,t)),[e,t,i])}(Em.X.UPDATE,(e=>t.setQueryData(Im,e.data))),(0,Sn.I)({queryKey:Im,queryFn:()=>e.getContents(),gcTime:3e5,staleTime:0})}const Am=()=>{const{isLoading:e,data:t}=Lm();return e?null:t?.items.length?(0,y.jsx)(jm,{items:t.items}):(0,y.jsx)(km,{})};var Tm=i(68832);const Om=(e,t)=>!t?.didQueueChangeSignificantly,Dm=(e,t,i)=>{Om(0,i?.current)?(0,Tm.oz)({onUpdate:t=>{e.style.opacity=t.toString()}}):e.style.opacity="1"},Bm=(e,t,i,n)=>{Om(0,n?.current)?(0,Tm.oz)({onUpdate:t=>{e.style.opacity=(1-Number(t)).toString()},onComplete:i}):i()},_m=({hideEnteringElements:e,animateEnteringElements:t,animateExitingElements:i,animateFlippedElements:n})=>{e(),i(),n(),t()};var Fm=i(8741);function Um(e){const t=(0,n.useRef)(e);return(0,n.useMemo)((()=>{const i=new Map,n=Mm(t.current,i),a=Mm(e,i),s=(0,Fm.I)(n,a),r=s>16||s>=Math.max(Pm(e),Pm(t.current));return t.current=e,r}),[e])}function Pm(e){return Number(!!e?.current)+(e?.queued.length??0)+(e?.nextUp.length??0)}function Mm({current:e,nextUp:t=[],queued:i=[]},n){let a="";return[[e],t,i].forEach((e=>{e.forEach((e=>{e?.uid&&(n.has(e.uid)||n.set(e.uid,String.fromCharCode(65+n.size)),a+=n.get(e.uid))})),e.length&&(a+=" ")})),a}var Hm=i(58035);const Vm=({current:e,queued:t,nextUp:i,children:a})=>{const s=(0,n.useMemo)((()=>[e,...t,...i].filter(Hm.P).map(Qp.E).join("")),[e,i,t]),r={didQueueChangeSignificantly:Um({current:e,nextUp:i,queued:t})};return(0,y.jsx)(Tm.ZI,{flipKey:s,handleEnterUpdateDelete:_m,decisionData:r,children:a})},qm=({children:e,...t})=>(0,Oi.j)()?(0,y.jsx)(y.Fragment,{children:e}):(0,y.jsx)(Vm,{...t,children:e}),zm=({children:e,...t})=>(0,Oi.j)()?(0,y.jsx)(y.Fragment,{children:e}):(0,y.jsx)(Tm.lf,{shouldFlip:Om,...t,children:e});var Ym=i(18277),Gm=i(35469);const Qm=[nm.fl.TRACKS,nm.fl.LOCAL_TRACKS,nm.fl.EPISODES,nm.fl.CHAPTERS,nm.fl.ALBUMS],Wm=({uri:e,items:t,ariaLabel:i,section:a,showTypeLabel:s,decoratedQueuedByUsersByUsername:r})=>{const l=(0,x.z)(),o=(0,n.useCallback)((e=>{l.removeFromQueue(e)}),[l]),{usePlayContextItem:c}=(0,Ym.b)(e,a),u=(0,n.useCallback)(((e,t)=>{const i=(0,Qp.E)(e,t);return(0,y.jsx)(zm,{flipId:e.metadata?.original_uid??i,onAppear:Dm,onExit:Bm,translate:!0,children:(0,y.jsx)("div",{className:Gm.A.listRowWrapper,children:(0,y.jsx)(hm,{item:e,index:t,usePlayContextItem:c,section:a,allowedDropMimeTypes:Qm,showTypeLabel:s,queuedBy:r?.[e.metadata?.queued_by??""]})})},i)}),[r,a,s,c]);return(0,y.jsx)(Yp,{items:t,renderRow:u,columnCount:rm.$,ariaLabel:i,onRemoveItems:o})};var Zm=i(80656);const Km="jAjrv_00X1qyxaEHmJCb",Jm="YVnLJCNcdaEeIGBQYqJS",Xm="pxocyhWhrvAeBiSlfjbd",$m="aOt09fJWpST6CG8xfHuo",eg=n.memo((function({onClose:e,onConfirm:t,isOpen:i,itemCount:a}){const s=(0,n.useCallback)((i=>{t(),e(i)}),[t,e]),r=U.Ru.get("queue.confirm-title",a);return(0,y.jsx)(Zm.A,{animated:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,onRequestClose:e,contentLabel:r,isOpen:i,children:(0,y.jsxs)("div",{className:Km,children:[(0,y.jsx)(l.E,{as:"h2",variant:"bodyMediumBold",className:Jm,children:r}),(0,y.jsx)(l.E,{as:"p",variant:"bodySmall",className:Xm,paddingBottom:ye.lT,children:U.Ru.get("queue.confirm-message")}),(0,y.jsxs)("div",{className:d()("encore-light-theme",$m),children:[(0,y.jsx)(me.H,{onClick:e,children:U.Ru.get("queue.cancel-button")}),(0,y.jsx)(c.$,{onClick:s,children:U.Ru.get("queue.confirm-button")})]})]})})})),tg="u842BXnznGeq38O3DUTQ",ig="NWVZ_rxlezZ8xTHlMg4Y",ng="Oae51evvT5DrqTupCiZ2",ag="LFdMliaHVgrpBcqNKHU3",sg="IeeqYq0Ozrndd6STmrRk",rg="NljerwmGshDHsI7rIvWl",lg=({nrQueuedItems:e})=>{const t=(0,x.z)(),{logClearQueue:i}=vm(),[a,s]=(0,n.useState)(!1),r=(0,n.useCallback)((()=>{s(!1)}),[]),l=(0,n.useCallback)((()=>{i(),t.clearQueue(),s(!1)}),[i,t]),o=(0,n.useCallback)((()=>{s(!0)}),[]);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(me.H,{size:"small",onClick:o,className:sg,condensed:!0,children:U.Ru.get("queue.clear-queue")}),(0,y.jsx)(eg,{itemCount:e,isOpen:a,onClose:r,onConfirm:l})]})};var og=i(62726);const cg=({queueSection:e,title:t,trailingButton:i})=>{const a=(0,n.useRef)(null),s=(0,og.K)({ref:a});return(0,y.jsx)(zm,{flipId:`section-header-${e}`,onAppear:Dm,onExit:Bm,translate:!0,children:(0,y.jsxs)("div",{className:ag,children:[(0,y.jsx)(da.Zp,{label:t,disabled:!s,children:(0,y.jsx)(l.E,{as:"h2",variant:"bodyMediumBold",semanticColor:"textBase",className:rg,ref:a,children:t})}),i]})})};var ug=i(81181);const dg={[N.E.SMALL]:0,[N.E.MEDIUM]:480},pg=()=>{const e=(0,n.useRef)(null),{breakpoint:t}=(0,E.c)(dg,e);return(0,y.jsxs)("div",{className:d()(Sm,t!==N.E.SMALL&&Cm),ref:e,children:[(0,y.jsx)(ug.j,{size:t===N.E.SMALL?"large":"xlarge","aria-hidden":"true",className:Nm}),(0,y.jsxs)("div",{className:wm,children:[(0,y.jsx)(l.E,{as:"h1",variant:t===N.E.SMALL?"bodyMediumBold":"titleSmall",semanticColor:"textBase",children:U.Ru.get("queue.empty-title")}),(0,y.jsx)(l.E,{as:"p",variant:t===N.E.SMALL?"bodySmall":"bodyMedium",children:U.Ru.get("queue.empty-description")})]}),(0,y.jsx)(rt.N,{to:"/search",children:(0,y.jsx)(c.$,{colorSet:"invertedLight",size:t===N.E.SMALL?"small":"medium",children:U.Ru.get("queue.fine-something")})})]})};var mg=i(48692),gg=i(37007);const vg=Spicetify.GraphQL.Definitions["decorateQueuedByUsers"]=new mg.l("decorateQueuedByUsers","query","1b71b9895bad207fdac0df7ebad17c790260519f853a069ee05f20e51c08636e",null);function xg(e){const{currentSession:t}=(0,Zs.D)(),i=Array.from(new Set(e.map((e=>e?.metadata?.queued_by||null)).filter(Hm.P))).sort().map((e=>(0,_n.Qjr)(e).toURI())),{data:a}=(s={userUris:i},r={gcTime:36e5,staleTime:18e5,enabled:!!i.length,placeholderData:Za.rX},(0,gg.I)(vg,s,r));var s,r;const l=(0,n.useMemo)((()=>Object.fromEntries(a?.users?.map((e=>{return"User"===e.__typename?[e.username,(t=e,{type:Pl.c.USER,...t,images:t.avatar?.sources??[]})]:null;var t})).filter(Hm.P)??[])),[a]);return t?.active?l:{}}var bg=i(33242),hg=i(68200);const yg="_GA0LJ6qjoKBsWLq34XF",jg="s_iKX8Su0w1W5b9yObSm",fg="aQ5ntWUtU9bcqS9fS9aC",Sg="SxLR9RMcR2XyJCZuxYqv",Cg="vtk1i3JMLWObMppMQ0gH",wg="x8qh9EgeC3AdLO0C54Og",Ng="Dm9gGjGoA7yNxClwSV24",kg="MPtthrsnd9PdsCTssJqk",Eg=({onClose:e,onCopyLink:t,inviteUrlQR:i})=>(0,y.jsxs)(he.a,{className:yg,padding:"0",children:[(0,y.jsxs)("div",{className:jg,children:[(0,y.jsxs)("div",{className:Sg,children:[(0,y.jsx)(l.E,{variant:"bodySmallBold",children:U.Ru.get("web-player.social-connect.invitation.qr-code.title")}),(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:U.Ru.get("web-player.social-connect.invitation.qr-code.description")})]}),(0,y.jsx)(me.H,{semanticColor:"textSubdued",iconOnly:xr.M,size:"small",onClick:e,condensedAll:!0,"aria-label":U.Ru.get("web-player.social-connect.invitation-modal.button-tertiary")})]}),(0,y.jsx)("div",{className:Cg}),(0,y.jsxs)("div",{className:d()(jg,fg,wg),children:[(0,y.jsx)(c.$,{iconLeading:hg._,colorSet:"invertedLight",size:"small",onClick:t,className:Ng,children:U.Ru.get("web-player.social-connect.invitation-modal.button-primary")}),(0,y.jsx)("div",{className:kg,children:(0,y.jsx)(bg.Ay,{value:i,size:100})})]})]}),Rg=({onClick:e})=>{const t=(0,F.wA)(),i=(0,n.useCallback)((()=>{e(),t((0,sa.A9)(Qa.EL.END_SESSION))}),[t,e]);return(0,y.jsx)(pe.n,{size:"small",onClick:i,children:U.Ru.get("web-player.social-connect.end-session.end-session-button")})},Ig=({onClick:e})=>(0,y.jsx)(pe.n,{size:"small",onClick:async t=>{e(t)},children:U.Ru.get("web-player.social-connect.invite-button")}),Lg=({onClick:e})=>{const t=(0,F.wA)(),i=(0,n.useCallback)((()=>{e(),t((0,sa.A9)(Qa.EL.LEAVE_SESSION))}),[t,e]);return(0,y.jsx)(pe.n,{size:"small",onClick:i,children:U.Ru.get("web-player.social-connect.leave-session.leave-session-button")})};var Ag=i(34808),Tg=i(87503),Og=i(72569);const Dg="E6U6SyOECK4IENpzZw2R",Bg="rirXgOjB8QWiJWDk5hSD",_g=({currentSession:e,username:t,onClick:i})=>{const{sessionMembers:a}=e,{setQueueView:s}=(0,Ag.m)(),r=a.length+2>3?a.length-3:0,o=(0,Og.t)(e,t,{userFirst:!0}),c=(0,n.useCallback)((()=>{i&&i(),s(Ag.p.PARTICIPANT_LIST)}),[i,s]);return(0,y.jsxs)(pe.n,{size:"small",className:Dg,onClick:c,"aria-label":U.Ru.get("web-player.social-connect.participant-list.title"),children:[(0,y.jsx)(Tg.g,{users:o,maxSlots:3,withoutOverflowBadge:!0}),r>0&&(0,y.jsx)(l.E,{variant:"bodySmallBold",semanticColor:"textBase",className:Bg,children:`+${r}`})]})};var Fg=i(71831),Ug=i(56443);const Pg="CyBimvsotsoxqwtiZeAn",Mg="_GKa4bilkTYbQLgcLogI",Hg="uXHR7rkHhuz9kVPNWwYW",Vg="KFGFA5pPG0hgIB97pZfI",qg=({id:e,label:t,value:i,onChange:n})=>(0,y.jsxs)("label",{htmlFor:e,className:Vg,children:[(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:t}),(0,y.jsx)(Fe.l,{id:e,value:i,onSelected:n,condensed:!0})]}),zg=({className:e,emptyStateComponent:t})=>{const{currentSession:i,setQueueOnlyMode:a,setParticipantVolumeControl:s}=(0,Zs.D)(),r=(0,F.d4)((({session:e})=>e.user?.id)),o=i?.joinSessionShortLink,c=i?.joinSessionShortLinkQR,{logFacePileClick:u,logInviteClick:d,logEndClick:p,logLeaveClick:m,UBIFragmentWithSpec:g}=(0,Ug.O)(),v=(0,Fg.Z)(),[x,b]=(0,n.useState)(!0),h=(0,n.useCallback)((()=>{u()}),[u]),j=(0,n.useCallback)((async()=>{o&&await v(o),d(o?.spotifyUri??"",o?.shareId??"")}),[v,o,d]),f=(0,n.useCallback)((async()=>{b((e=>!e))}),[]),S=(0,n.useCallback)((()=>{p()}),[p]),C=(0,n.useCallback)((()=>{m()}),[m]);if(!i?.active)return t?(0,y.jsx)(y.Fragment,{children:t}):null;const w=i.sessionMembers.find((e=>e.id===i.sessionOwnerId));return(0,y.jsx)(g,{children:(0,y.jsxs)("div",{className:e,children:[(0,y.jsx)("div",{className:Pg,children:(0,y.jsx)(l.E,{as:"h1",variant:"titleSmall",semanticColor:"textBase",children:U.Ru.get("web-player.social-connect.session-info.title",{host:w?.displayName??""})})}),(0,y.jsxs)("div",{className:Mg,children:[(0,y.jsxs)("div",{className:Hg,children:[(0,y.jsx)(_g,{currentSession:i,username:r,onClick:h}),(0,y.jsx)(Ig,{onClick:f}),i.isSessionOwner?(0,y.jsx)(Rg,{onClick:S}):(0,y.jsx)(Lg,{onClick:C})]}),x&&(0,y.jsx)(Eg,{onClose:()=>b(!1),onCopyLink:j,inviteUrlQR:c?.shareableUrl??""}),i.isSessionOwner&&(0,y.jsxs)("div",{children:[(0,y.jsx)(qg,{id:"queueOnlyMode",label:U.Ru.get("web-player.social-connect.controls.queue-only-mode"),value:!i.queueOnlyMode,onChange:e=>a(!e)}),"UNAVAILABLE"!==i.participantVolumeControl&&(0,y.jsx)(qg,{id:"participantVolumeControl",label:U.Ru.get("web-player.social-connect.controls.participant-volume-control"),value:"ENABLED"===i.participantVolumeControl,onChange:e=>s(e)})]})]})]})})};var Yg=i(44607);const Gg=e=>(0,y.jsx)(r.s,{onError:e=>{(0,Yg.Jy)(e,"JamQueueHeader")},suspenseFallback:e.emptyStateComponent,children:(0,y.jsx)(zg,{...e})});var Qg=i(12839);const Wg=()=>{const e=dm(),{uri:t,description:i,current:a,nextUp:s,queued:r,isEmpty:l,hasQueuedTracks:o,hasNextTracks:c}=e,{logQueueContextLinkNavigate:u}=vm(),d=xg([a,...s,...r]),p=(0,n.useMemo)((()=>new Set([a,...r,...s].filter(Hm.P).map((({type:e})=>e))).size>1),[a,s,r]),{currentSession:m}=(0,Zs.D)(),g=(0,Qs.y)();return l?(0,y.jsx)(pg,{}):(0,y.jsxs)(qm,{...e,children:[(0,y.jsx)(Gg,{className:ng}),(0,y.jsxs)("div",{className:tg,children:[a&&(0,y.jsxs)("div",{className:ig,children:[(0,y.jsx)(cg,{queueSection:sm.$.NowPlaying,title:U.Ru.get("queue.now-playing")}),(0,y.jsx)(Wm,{ariaLabel:U.Ru.get("queue.now-playing"),uri:t,items:a?[a]:[],section:sm.$.NowPlaying,showTypeLabel:p,decoratedQueuedByUsersByUsername:d})]}),!m?.active&&g&&(0,y.jsx)(Qg.p,{localStorageKey:"dismissStartJamButtonFromQueue"}),o&&(0,y.jsxs)("div",{className:ig,children:[(0,y.jsx)(cg,{queueSection:sm.$.NextInQueue,title:U.Ru.get("queue.next-in-queue"),trailingButton:(0,y.jsx)(lg,{nrQueuedItems:r.length})}),(0,y.jsx)(Wm,{ariaLabel:U.Ru.get("queue.next-in-queue"),uri:t,items:r,section:sm.$.NextInQueue,showTypeLabel:p,decoratedQueuedByUsersByUsername:d})]}),c&&(0,y.jsxs)("div",{className:ig,children:[(0,y.jsx)(cg,{queueSection:sm.$.NextUp,title:i&&!um(a)&&t?(0,y.jsxs)(y.Fragment,{children:[U.Ru.get("queue.next-from")," ",(0,y.jsx)(rt.N,{to:t,onClick:()=>{u(t)},children:i})]}):U.Ru.get("queue.next-up")},i),(0,y.jsx)(Wm,{ariaLabel:U.Ru.get("queue.next-up"),uri:t,items:s,section:sm.$.NextUp,showTypeLabel:p})]})]})]})};var Zg=i(62165),Kg=i(58721);const Jg="AjjTyUrCO3pZ365KtTXW",Xg="pGtUoenc5OobLi8CscJ6",$g="cArVcLcQ85q_9QSLGYGX",ev="lDtXv1VCrs0PHHSuH5uO",tv="ukjUoaLSzKyRcwoOQw9V",iv="yQwBNeetmAr0a0OTR8t3",nv="fzB4RXxTp0rlpNQlSuu9",av=({sessionMember:e,showRemoveButton:t,onClickMember:i,onClickRemove:n,index:a})=>{const{currentSession:s}=(0,Zs.D)(),{displayName:r,images:l,username:o,uri:c}=(0,Og.c)(e);return(0,y.jsx)(ua.h,{menu:(0,y.jsx)(Kg.B,{uri:c}),children:(0,y.jsx)(W.v,{id:`${a}`,variant:"naked",className:tv,title:(0,y.jsx)(ke.d,{lineClamp:1,children:r}),media:(0,y.jsx)("div",{role:"button",onClick:i,onKeyDown:i,tabIndex:-1,children:(0,y.jsx)(Zg.e,{images:l,userIconSize:"medium",width:48,displayName:r,username:o,label:r})}),subtitle:s?.sessionOwnerId===e.id?U.Ru.get("web-player.social-connect.participant-list.host"):U.Ru.get("web-player.social-connect.participant-list.guest"),onClick:i,trailing:t&&(0,y.jsx)(pe.n,{size:"small",className:iv,onClick:n,"aria-label":U.Ru.get("web-player.social-connect.participant-list.remove-guest-accessible-label",{displayName:r}),children:U.Ru.get("web-player.social-connect.participant-list.remove-guest")})})})};var sv=i(33143);var rv=i(8626);const lv=()=>{const e=(0,Ja.d)(),t=(0,F.wA)(),i=(0,Oe.g)(),a=(0,Fg.Z)(),{currentSession:s,kickAllParticipants:r}=(0,Zs.D)(),{setQueueView:o}=(0,Ag.m)(),{logUserClick:u,logRemoveClick:d}=(()=>{const{spec:e,logger:t,UBIFragment:i}=(0,et.r)(sv.I,{});return{logUserClick:(0,n.useCallback)(((i,n)=>{t.logInteraction(e.participantListFactory().participantListRowFactory({position:i}).userLinkFactory().hitUiNavigate({destination:n}))}),[t,e]),logRemoveClick:(0,n.useCallback)((i=>{t.logInteraction(e.participantListFactory().participantListRowFactory({position:i}).removeButtonFactory().hitUiReveal())}),[t,e]),UBIFragmentWithSpec:(0,n.useCallback)((t=>(0,y.jsx)(i,{spec:e,...t})),[i,e])}})(),p=(0,n.useCallback)((()=>{s?.joinSessionShortLink&&a(s?.joinSessionShortLink)}),[a,s?.joinSessionShortLink]),m=(0,n.useCallback)(((e,i)=>{d(e),t((0,sa.A9)(Qa.EL.REMOVE_PARTICIPANT,void 0,i))}),[t,d]),g=(0,n.useCallback)(((e,t)=>{const n=(0,_n.Qjr)(t.username);u(e,n.toURI()),i(n.toURLPath(!0))}),[u,i]),v=(0,n.useCallback)((()=>{r(s?.sessionId)}),[s?.sessionId,r]),x=(0,rv.T4)(e);return s&&x?(0,y.jsxs)("div",{className:Jg,children:[(0,y.jsx)(l.E,{variant:"titleSmall",semanticColor:"textBase",children:U.Ru.get("web-player.social-connect.participant-list.title")}),(0,y.jsxs)("div",{className:Xg,children:[(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:U.Ru.get("web-player.social-connect.participant-list.subtitle")}),(0,y.jsx)(pe.n,{size:"small",onClick:p,className:$g,children:U.Ru.get("web-player.social-connect.invite-button")})]}),(0,y.jsx)("div",{className:ev,children:s.sessionMembers.map(((t,i)=>(0,y.jsx)(av,{index:i,sessionMember:t,showRemoveButton:(0,rv.kt)(e,(0,_n.Qjr)(t.username).toURI()),onClickRemove:()=>m(i,t),onClickMember:()=>g(i,t)},i)))}),s.isSessionOwner&&s.sessionMembers.length>1&&(0,y.jsx)(c.$,{colorSet:"invertedLight",size:"small",onClick:v,children:U.Ru.get("web-player.social-connect.participant-list.remove-all-guests")}),(0,y.jsx)(l.E,{variant:"marginal",semanticColor:"textSubdued",className:nv,children:U.Ru.get("web-player.social-connect.participant-list.visibility-info")})]}):(o(Ag.p.QUEUE),null)};var ov=i(13763);const cv="BZj_r1yzmmragvivUCrw",uv="hpzTKCoO0rllEslIOMPo",dv="TeBVsFnI9PMHYL9ynJx9",pv="ZDR7q1cqU2yaYjemuy9Z",mv="OLB2ghxc09Kz8k_93eIu",gv=()=>{const{currentQueueView:e,setQueueView:t}=(0,gm.m)(),i=(0,ov.y)(),{logQueuePanelTabChange:a}=vm(),s=(0,n.useMemo)((()=>i?{titleSlot:e!==gm.p.PARTICIPANT_LIST?(0,y.jsx)(Bp.t,{currentTab:e,onTabChange:e=>{e===(0,Fp.c)(gm.p.HISTORY)?(a(gm.p.HISTORY),t(gm.p.HISTORY)):(a(gm.p.QUEUE),t(gm.p.QUEUE))},className:dv,children:(0,y.jsxs)(_p.w,{"aria-label":"",className:pv,children:[(0,y.jsx)(Fp.V,{"aria-selected":e===gm.p.QUEUE,label:U.Ru.get("playback-control.queue"),value:gm.p.QUEUE}),(0,y.jsx)(Fp.V,{"aria-selected":e===gm.p.HISTORY,label:U.Ru.get("view.recently-played"),value:gm.p.HISTORY})]})}):(0,y.jsx)(me.H,{iconLeading:Os.g,onClick:()=>t(gm.p.QUEUE),size:"small",condensed:!0,className:mv,children:U.Ru.get("web-player.social-connect.participant-list.back-to-queue")})}:{title:U.Ru.get("playback-control.queue")}),[i,a,t,e]);return(0,y.jsx)(at._,{label:U.Ru.get("playback-control.queue"),focusTransferId:"QUEUE-HISTORY-PANEL",children:(0,y.jsx)(C.w,{fixedHeader:(0,y.jsx)(w.a,{className:cv,panel:v.Z.Queue,...s}),children:(0,y.jsx)("div",{className:uv,children:e!==gm.p.PARTICIPANT_LIST?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Up.K,{value:"queue",children:e===gm.p.QUEUE&&(0,y.jsx)(Wg,{})}),(0,y.jsx)(Up.K,{value:"history",children:e===gm.p.HISTORY&&(0,y.jsx)(Am,{})})]}):(0,y.jsx)(lv,{})})})})},vv=(0,n.memo)((function(){return(0,y.jsx)(mm,{children:(0,y.jsx)(gv,{})})}));var xv=i(74200);const bv=(0,n.memo)((()=>{const e=(0,s.NC)(al.ZDY),t=(0,Op.X)(),i=(0,Tp._)(),l=function(){const e=(0,n.useRef)(v.Z.NowPlayingView),t=(0,g.XB)();return(0,n.useEffect)((()=>{e.current=t}),[t]),(0,n.useCallback)((i=>{const n=e.current===v.Z.NowPlayingView,a=t===v.Z.NowPlayingView;return i.some((i=>n&&t===i||a&&e.current===i))}),[t])}(),o=(0,qn.S)()===Vn.z.NOW_PLAYING_VIEW,c=(0,n.useRef)(null),u=e&&t===v.Z.Disabled;return(0,y.jsxs)(r.s,{onError:e=>{(0,Yg.Jy)(e,"PanelSection"),i((0,Dp.MQ)(v.Z.Disabled))},children:[(0,y.jsx)(a.A,{nodeRef:c,in:t===v.Z.NowPlayingView||u,exit:v.v.includes(t),timeout:{enter:0,exit:300},unmountOnExit:!0,mountOnEnter:!0,children:(0,y.jsx)(xv.f,{enabled:!u,children:(0,y.jsx)(fp,{nodeRef:c})})}),t===v.Z.BuddyFeed?(0,y.jsx)(Hn,{}):null,(0,y.jsx)(Ap,{isActive:t===v.Z.BuddyFeedOverlay,shouldPlayAnimation:!o&&l([v.Z.BuddyFeedOverlay]),children:(0,y.jsx)(Hn,{})}),t===v.Z.Queue?(0,y.jsx)(vv,{}):null,(0,y.jsx)(Ap,{isActive:t===v.Z.QueueOverlay,shouldPlayAnimation:!o&&l([v.Z.QueueOverlay]),children:(0,y.jsx)(vv,{})}),t===v.Z.Puffin||t===v.Z.PuffinActivation?(0,y.jsx)(Ln,{}):null,(0,y.jsx)(Ap,{isActive:t===v.Z.PuffinActivationOverlay||t===v.Z.PuffinOverlay,shouldPlayAnimation:!o&&l([v.Z.PuffinActivationOverlay,v.Z.PuffinOverlay]),children:(0,y.jsx)(Ln,{})}),t===v.Z.DevicePicker?(0,y.jsx)(Hr,{}):null,(0,y.jsx)(Ap,{isActive:t===v.Z.DevicePickerOverlay,shouldPlayAnimation:!o&&l([v.Z.DevicePickerOverlay]),children:(0,y.jsx)(Hr,{})}),Vr?(0,y.jsxs)(y.Fragment,{children:[t===v.Z.Euterpe?(0,y.jsx)(Vr,{}):null,(0,y.jsx)(Ap,{isActive:t===v.Z.Euterpe,shouldPlayAnimation:l([v.Z.Euterpe]),children:(0,y.jsx)(Vr,{})})]}):null]})}))},82172:(e,t,i)=>{i.d(t,{O:()=>s,j:()=>a});var n=i(30758);let a=function(e){return e[e.Errored=0]="Errored",e}({});const s=(0,n.createContext)({state:null,capturePlaybackError:()=>{}})},82743:(e,t,i)=>{i.d(t,{a:()=>n.a});var n=i(90269)},87078:(e,t,i)=>{i.d(t,{h:()=>w});var n=i(97500),a=i.n(n),s=i(8335),r=i(52227),l=i(21e3),o=i(42738),c=i(72739),u=i(54375),d=i(30626),p=i(43649),m=i(87883),g=i(29398),v=i(94287),x=i(87977),b=i(85105),h=i(69479);const y="URfgKDbFQpKuN8ZjGdui",j="e3hKZQOHyxgax_X0Rb1E",f="main-nowPlayingView-coverArt",S="SwS3WdCPfdr1uOOksVEB";var C=i(86070);const w=({context:e,item:t,index:i,canSwitchVisuals:n=!1,isMinimized:w=!1})=>{const{spec:N,logger:k}=(0,b.r)(r.J,{}),{draggable:E,onDragStart:R}=(0,g.P)(),{ref:I,inView:L}=(0,s.Wx)({threshold:.5,initialInView:!0});return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(o.h,{menu:(0,C.jsx)(u.W,{context:e,item:t,canSwitchVisuals:n}),children:(0,C.jsx)("div",{draggable:E&&((0,x.v)(t)||(0,v.p)(t)),onDragStart:e=>{R(e,{itemUris:[t.uri],dragLabelText:(0,m.r)(t)})},ref:I,className:a()(y,{[j]:w}),children:(0,C.jsx)(p.R,{uri:e.uri,owner:e.metadata?.context_owner,children:(0,C.jsx)(d.e,{context:t.type===h.c.TRACK?t.album:e,item:t,index:i,isVisible:!0,onClick:()=>{k.logInteraction(N.coverArtFactory({uri:t.uri}).hitUiNavigate({destination:t.type===h.c.TRACK?t.album.uri:t.uri}))},adEventReason:l.c.COVER_ART,children:(0,C.jsx)(c.b,{className:a()(f,{[S]:L}),images:t.images??[],type:t.type,maxSize:w?56:384,desiredLabel:w?"small":"xlarge"})})})})})})}},87463:(e,t,i)=>{i.d(t,{D:()=>s});var n=i(98900),a=i(63112);function s(){return(0,a.N)(n.x)}},87883:(e,t,i)=>{i.d(t,{r:()=>n.r});var n=i(14575)},98254:(e,t,i)=>{i.d(t,{U:()=>r});var n=i(59082),a=i(63637),s=i(86070);const r=({children:e,lineClamp:t=2,...i})=>(0,s.jsx)(n.d,{lineClamp:t,as:"div",dir:"auto",className:a.A.title,...i,children:e})}}]);
//# sourceMappingURL=dwp-panel-section.js.map