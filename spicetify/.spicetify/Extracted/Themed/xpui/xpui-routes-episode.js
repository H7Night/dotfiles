"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[9528],{15120:(e,t,i)=>{i.d(t,{d:()=>r});var s=i(75044),a=i(8044),n=i(55405);const r=()=>{const e=(0,s.NC)(n.iGu,{loadingValue:!1}),t=(0,a.V)();return e&&!t}},22324:(e,t,i)=>{i.d(t,{J:()=>u});var s=i(60749),a=i(46462),n=i(51357),r=i(17640),o=i(41430),l=i(47827),c=i(67843),d=i(86070);const u=({leavebehinds:e,surface:t,uri:i,pathname:u,state:p})=>{const m=(0,c.vh)(),h=`${r.Ru.get("view.see-all")} (${e.length<=l.E9?r.Ru.formatNumber(e.length):r.Ru.formatNumber(l.E9)})`;return(0,d.jsx)(s.N_,{to:u,state:p,children:(0,d.jsx)(a.H,{"data-testid":"leavebehinds-see-all",size:"small",onClick:()=>{m.send((0,n.x)({leavebehind_request_id:e[0].requestId,event:"event_clicked",event_reason:"cta_see_all",surface:(0,o.Fh)(t),uri:i}))},children:h})})}},23986:(e,t,i)=>{i.d(t,{o:()=>T});var s=i(30758),a=i(25270),n=i(44850),r=i(57146),o=i(51357),l=i(17640),c=i(29529),d=i(58837),u=i(83155),p=i(39416),m=i(57221),h=i(35763),y=i(24498);const g="c5Ml9BbBuUEHjNkcSwZA";var x=i(86070);const b="70px",v=({adId:e,advertiser:t,tagline:i,displayImage:s,buttonMessage:a,cardOnClick:n,buttonOnClick:r,clickthroughUrl:o})=>(0,x.jsx)(y.N,{to:(0,h.H)(o),className:g,"data-testid":"leavebehind",children:(0,x.jsx)(c.v,{onClick:n,onClickHint:l.Ru.get("ad-formats.learnMore"),layout:"wide",variant:"tinted",id:e,size:"xl",title:(0,x.jsx)(d.d,{weight:"bold",variant:"ballad",lineClamp:1,"data-testid":"leavebehind-advertiser",children:t}),subtitle:(0,x.jsx)(u.j,{as:"div",lineClamp:2,"data-testid":"leavebehind-tagline",children:i}),media:(0,x.jsx)(p.C,{"data-testid":"leavebehind-image",src:s.src,alt:s.alt,imageHeight:b,imageWidth:b,size:"xl"}),trailing:(0,x.jsx)(m.$,{onClick:()=>{r&&r()},"data-testid":"leavebehind-button",colorSet:"invertedLight",size:"small","aria-label":l.Ru.get("ad-formats.learnMore"),children:a})})});var j=i(41430),k=i(47827),P=i(31843),f=i(67843);const C="zlUJfROzFEOsEDWL7ucP",I="Fxvq1Fw7XQdGRDvYokRg",T=({leavebehinds:e,seeAllButton:t,surface:i,uri:c})=>{const d=(0,f.vh)(),u=(0,P.w)(P.P),[p,m]=(0,s.useState)(void 0);(0,s.useEffect)((()=>{e&&e.length>0&&p!==e[0].requestId&&c&&(e.forEach(((e,t)=>{e.uri===c&&(e.trackingEvents?.viewed.forEach((async t=>{try{await u(t)}catch(s){const a=s;d.send((0,r.G)({error_type:"trackingURLFailure",error_message:a.message,http_error_code:422,surface:(0,j.Fh)(i),request_url:t,request_type:"leavebehindAds",lineitem_id:e.lineitemId,ad_content_origin:(0,k.Zl)(i)}))}})),d.send((0,o.x)({leavebehind_lineitem_id:e.lineitemId,leavebehind_request_id:e.requestId,event:"event_viewed",event_reason:`viewed_on_${(0,j.Fh)(i).toLowerCase()}`,surface:(0,j.Fh)(i),surface_position:t+1,uri:c})))})),m(e[0].requestId))}),[d,u,e,c,i,p]);const h=({eventReason:e,lineitemId:t,requestId:s,trackingEvents:a,surfacePosition:n})=>{((e,t)=>{t?.forEach((async t=>{try{await u(t)}catch(s){const a=s;d.send((0,r.G)({error_type:"trackingURLFailure",error_message:a.name,http_error_code:422,surface:(0,j.Fh)(i),request_url:t,request_type:"leavebehindAds",lineitem_id:e,ad_content_origin:(0,k.Zl)(i)}))}}))})(t,a),d.send((0,o.x)({leavebehind_lineitem_id:t,leavebehind_request_id:s,event:"event_clicked",event_reason:e,surface:(0,j.Fh)(i),surface_position:n,uri:c}))};return(0,x.jsxs)("section",{"data-testid":"leavebehinds-wrapper",children:[(0,x.jsxs)("div",{className:I,children:[(0,x.jsx)(a.E,{as:"h2",semanticColor:"textBase",variant:"titleSmall",paddingBottom:(0,n.po)("tighter"),"data-testid":"leavebehinds-title",children:l.Ru.get("podcast-ads.recent_ads")}),t]}),(0,x.jsx)("div",{className:C,"data-testid":"leavebehinds-list-wrapper",children:e.map(((e,t)=>(0,x.jsx)(v,{...e,buttonOnClick:()=>{h({eventReason:"button_clicked",lineitemId:e.lineitemId,trackingEvents:e.trackingEvents?.clicked,requestId:e.requestId,surfacePosition:t+1})},cardOnClick:()=>{h({eventReason:"card_clicked",lineitemId:e.lineitemId,trackingEvents:e.trackingEvents?.clicked,requestId:e.requestId,surfacePosition:t+1})}},e.adId)))})]})}},51664:(e,t,i)=>{i.d(t,{W:()=>G});var s=i(97500),a=i.n(s),n=i(12599),r=i(17640),o=i(73493),l=i(24792),c=i(31491);const d=new l.l("internalLinkRecommenderEpisode","query","5146a0312a2366520b9b43c3b5dd9e54c5b802bd74de3e0bd05f3c6800825c9f",null);var u=i(33880),p=i(30758),m=i(62411),h=i(7705),y=i(97304),g=i(43294),x=i(56952),b=i(32925),v=i(27776),j=i(71226),k=i(37833),P=i(8044),f=i(15310),C=i(78249),I=i(83179),T=i(88774),E=i(82232),w=i(85586),R=i(42668),_=i(19099),S=i(81637),A=i(56838),N=i(86070);const L=e=>`activation-trigger-mme-${e}`,U=p.memo((function({index:e=-1,audio:t,contentInformation:i,coverArt:s,contentRatingLabel:a,description:r,mediaTypes:o,releaseDate:l,name:c,playable:d,playedState:u,podcastSubscription:U,sharingInfo:D,showName:M,showTrailer:F,showTypes:B,showUri:O,status:q,totalMilliseconds:z,type:$,uri:H}){const G=u.playPositionMilliseconds,W=(0,p.useRef)(null),[Q,V]=(0,p.useState)(u.state===S._w.Completed),{draggable:K,onDragStart:Y}=(0,k.P)(),Z=(0,P.V)(),X=(0,w.y)(),J=(0,m.wA)(),{isActive:ee,isPlaying:te,togglePlay:ie}=(0,R.P)({uri:H},{featureIdentifier:"episode"}),[se]=(0,_.S)(1e4,(e=>e?.item?.uri===H));(0,p.useEffect)((()=>{te&&(W.current=se)}),[te,se]),(0,p.useEffect)((()=>{!te&&W.current&&z<=W.current&&V(!0)}),[te,z]);const ae=(0,p.useCallback)((e=>{e||(W.current=0),V(e)}),[]),ne={uri:O,name:M,trailer:F,showTypes:B},re=(0,f.C)({audio:t,name:c,uri:H,mediaTypes:o,coverArt:{sources:s}},ne),oe=(0,p.useCallback)((()=>{$!==S.I_.Episode?Z?re():ie():v.h.set((()=>({triggerId:L(H),triggerAction:null})))}),[$,Z,H,re,ie]),le=U?.isPaywalled??!1,ce=U?.isUserSubscribed??!1,de=le&&!ce,ue=le&&Z,{badges:pe}=(0,A.b)({contentRating:a,isPaywalled:le}),me=(0,p.useCallback)((()=>J((0,h.Tf)(O))),[O,J]),he=(0,p.useCallback)((e=>{let t=e;return(de||ue)&&(t=(0,N.jsx)(j.N,{enabled:!0,showUri:O,children:t})),!d&&pe.nineteen&&(t=(0,N.jsx)("div",{onClick:e=>{e.stopPropagation(),me()},children:e})),t=(0,N.jsx)(y.k,{id:L(H),targetURI:(0,n.o_h)(H),children:t}),t}),[de,ue,d,pe.nineteen,H,O,me]);return(0,N.jsx)(E.pZ,{value:"row",index:e,children:(0,N.jsx)(g.h,{menu:(0,N.jsx)(x.b,{uri:H,showUri:O,sharingInfo:D,isPlayed:Q,onMarkAsPlayed:ae}),children:(0,N.jsx)(b.k,{requestId:void 0,index:e,uri:H,size:X,images:s||[],name:c,showName:M,description:r,isPlayable:d||de,fullyPlayed:Q,durationMs:z,releaseDate:l,resumePositionMs:W.current??G,draggable:K,handleDragStart:e=>{if(e.target!==e.currentTarget)return;Y(e,{itemUris:[H],dragLabelText:`${c} â€¢ ${M}`,contextUri:O})},handlePlaybackClick:oe,isCurrentlyPlaying:ee,isPaywalled:le,isUserSubscribed:ce,isPlaying:te,position:te?se:void 0,episodeSharingInfo:D,onMarkAsPlayed:ae,contentInformation:i,showUri:O,mediaTypes:o??void 0,badges:(0,N.jsxs)(N.Fragment,{children:[pe.explicit&&(0,N.jsx)(C.U,{}),pe.paid&&(0,N.jsx)(I.y,{}),pe.nineteen&&(0,N.jsx)(T.q,{size:16})]}),playButtonWrapper:he,status:q})})})}));var D=i(53321),M=i(75539);var F=i(61825),B=i(37471);const O="GgMHVmfXNzteIydSWMIA",q="GcupflQsYyy0IMOsCeD1",z="A4FqrLbXeENogU0IRaPn",$="YCYs0Gv5B5ctDN0f5Zby",H=({uri:e,isFullPage:t=!1})=>{const{data:i}=(s={uri:e},(0,c.I)(d,s,o));var s,o;const l=i?.seoRecommendedEpisode.totalCount,u=i?.seoRecommendedEpisode.items,p=function(e){return(e||[]).filter((e=>(e=>{return t=e,"NotFound"!==t?.__typename&&"GenericError"!==t?.__typename&&"RestrictedContent"!==t?.__typename&&"Episode"===e.__typename;var t})(e.data)))}(u),m=t?p:p.slice(0,5);if(0===l)return null;const h=(0,n.o_h)(e)?.id,y=`spotify:app:episode:${h}:more-like-this`;return(0,N.jsxs)("section",{className:a()(O,{[q]:!t}),"data-testid":"episode-list",children:[(0,N.jsx)(F.k,{title:r.Ru.get("internal-link-recommender.more-episodes-like-this"),showSeeAll:!t,seeAllUri:y}),m.map((({data:e},t)=>{const i=(e=>{return t=e,"NotFound"!==t?.__typename&&"GenericError"!==t?.__typename&&"RestrictedContent"!==t?.__typename&&"Podcast"===e.__typename;var t})(e.podcastV2.data)?e.podcastV2.data:null;return i?e&&(0,N.jsxs)("div",{className:$,children:[(0,N.jsx)("hr",{className:z,"aria-hidden":!0}),(0,N.jsx)(U,{index:t,audio:e.audio,contentInformation:e.contentInformation,contentRatingLabel:e.contentRating?.label,coverArt:e.coverArt?e.coverArt.sources:void 0,description:e.description,releaseDate:e.releaseDate,mediaTypes:e.mediaTypes,name:e.name,playable:e.playability.playable,playedState:e.playedState,podcastSubscription:(0,B.Wx)(e.restrictions,e.playability),sharingInfo:e.sharingInfo,showTrailer:(s=i.trailerV2?.data,s&&(e=>{return t=e,"NotFound"!==t?.__typename&&"GenericError"!==t?.__typename&&"RestrictedContent"!==t?.__typename&&"Episode"===e.__typename;var t})(s)?{type:M.c.EPISODE,uri:s.uri,name:s.name,coverArt:s.coverArt?.sources||[],audio:s.audio,audioPreview:(0,D.xh)(s),sharingInfo:s.sharingInfo,duration:{milliseconds:s.duration.totalMilliseconds},contentRating:s.contentRating,mediaTypes:s.mediaTypes}:null),showName:i.name,showTypes:i.showTypes,showUri:i.uri,totalMilliseconds:e.duration.totalMilliseconds,type:e.type,uri:e.uri},`${e.uri}/${t}`)]},`${t}${e.uri}`):null;var s}))]})},G=e=>{const t=(0,u.D)({entityType:M.c.EPISODE,componentType:"list",uri:e.uri});return(0,N.jsx)(o.s,{onError:t,children:(0,N.jsx)(H,{...e})})}},52506:(e,t,i)=>{i.d(t,{o:()=>n});var s=i(48583),a=i(46822);function n(){return(0,a.N)(s.g)}},66975:(e,t,i)=>{i.d(t,{L:()=>o});var s=i(30758),a=i(42668),n=i(11957),r=i(69796);function o({episodeUri:e,start:t,stop:i}){const{togglePlay:o,triggerPlay:l,isPlaying:c,isActive:d}=(0,a.P)({uri:e},{featureIdentifier:"episode"}),u=(0,n.o)((e=>(0,r.s)(e)??0)),p=d&&function(e,t,i){return i>=e&&i<t}(t,i,u),m=c&&p;return{onClick:(0,s.useCallback)((e=>{p?o({seekTo:t,loggingParams:e}):l({seekTo:t,loggingParams:e})}),[p,t,o,l]),isPlaying:m,isActive:p}}},71186:(e,t,i)=>{i.r(t),i.d(t,{default:()=>bi});var s=i(30758),a=i(60749),n=i(85387),r=i(43944),o=i(20435),l=i(12599),c=i(17640),d=i(80478),u=i(27776),p=i(51664),m=i(83467),h=i(56691),y=i(62411),g=i(87015),x=i(7705),b=i(66108),v=i(49086),j=i(52116),k=i(2565),P=i(4806),f=i(52110),C=i(56952),I=i(17188),T=i(93850),E=i(25072),w=i(97304),R=i(71226),_=i(15792),S=i(8044),A=i(99150),N=i(86070);const L="activation-trigger-mme",U=({episodeUri:e,showUri:t,isLocked:i,isPlaying:s,isPlayDisabled:a,playButtonPlayLabel:n,playButtonPauseLabel:r,onClick:o,size:c="large"})=>{const d=(0,A.c)();if((0,S.V)())return(0,N.jsx)(_.R,{size:c,onClick:o,isPlaying:s,disabled:a,locked:i,ariaPlayLabel:n,ariaPauseLabel:r});const u=(0,N.jsx)(R.N,{showUri:t,enabled:i,renderInline:!1,children:(0,N.jsx)(_.R,{size:c,onClick:o,isPlaying:s,disabled:a,locked:i,ariaPlayLabel:n,ariaPauseLabel:r})});return d?(0,N.jsx)(w.k,{id:L,targetURI:(0,l.o_h)(e),fadeOut:!0,children:u}):u};var D=i(87717),M=i(92144),F=i(90677),B=i(11849),O=i(19099),q=i(11957),z=i(58089),$=i(5141),H=i(48632),G=i(56838);const W="ZDeijYE6qPzPqT9vG_2w",Q="qEoBuparvnBwiHsPzwEj",V="azmMKgbEFsGjSUnw2Knc",K="oDljdc6tgUKxTeQMyh0D",Y="eCpSFybAW4xJNfuGDJY3",Z="aTeXTpJi_WmakpodeGxX",X="kZWs1d_TjX2JQgmtx90y",J="JCSifKpPc54eqcTYBj5Q",ee="FlK1APGRiu5DTwm_0kix",te="ahQLeD18bYXcFRWkL_vg",ie="l6peddfW1BiAnd1a_mF3",se="Xkg0O12dNVwomjL8dzm4",ae="OexEjZt7Kf7pFUW701v8",ne="jAY3diSzPfk19oswf8_y",re="F3BJWbXwGSqNOwZHInLz",oe="YjVCpFaOT3LCR64t8jTN",le="Q7HlO_WHb9N8aK8bgOjG",ce="xTENSk0_RmQ8qEeEuhnE",de="qH2Mpq2icGtfNZfwIhiW",ue="W4580vs00yDqFNs7363B",pe="H1jMR2c5kT6qQ7lmTqpF",me=({episode:e,onPlayEpisode:t,isPlaying:i,isActive:a,isFullyPlayed:n,setIsFullyPlayed:r,backgroundColor:o,isLocked:l,spec:d})=>{const{uri:u,playedState:p,contentRating:m,playability:h}=e,w=(0,z.s)(),R=(0,y.wA)(),[_]=(0,O.S)(1e4,(e=>e?.item?.uri===u)),S=(0,q.o)((e=>e?.duration)),{badges:A}=(0,G.b)({contentRating:m?.label}),L=(0,s.useCallback)((e=>{!h.playable&&A.nineteen&&(e.stopPropagation(),R((0,x.Tf)(u||"")))}),[u,h.playable,A.nineteen,R]),W=(0,s.useCallback)((()=>{const e=d.contextMenuButtonFactory().hitUiReveal();w.logInteraction(e)}),[w,d]),Q=(0,s.useCallback)(((e,t)=>{(0,F.Qv)(t,d.downloadButtonFactory(),w,u)}),[w,d,u]),V=(0,E.d$)(),{spec:K,logger:Z}=(0,$.r)(g.e,{data:{uri:u}});(0,s.useEffect)((()=>{V&&Z.logImpression(K.impression())}),[V,Z,K]);const X=(0,s.useCallback)((e=>{const t=d.saveButtonFactory();w.logInteraction(e?t.hitLike({itemToBeLiked:u}):t.hitRemoveLike({itemNoLongerLiked:u})),e&&V&&Z.logInteraction(K.hitAddToPlaylist({itemToBeAdded:u,playlist:B.Xn}))}),[w,d,u,V,Z,K]),J=!l&&!e.playability.playable,ee=c.Ru.get("tracklist.a11y.play",e.name,e.podcast?.name),te=c.Ru.get("tracklist.a11y.pause",e.name,e.podcast?.name),ie=e.podcast?.uri,se=(0,M.j)(),ae=(0,T.v)(e.uri),ne=!l;return(0,N.jsxs)(b.E,{backgroundColor:o,children:[(0,N.jsxs)("div",{className:Y,children:[(0,N.jsx)(D.P,{episode:e,showVideoBadge:!0}),(0,N.jsx)(H.j,{fullyPlayed:n,durationMs:a&&S?S:e.duration.milliseconds,releaseDate:e.releaseDate,resumePositionMs:p.playPositionMilliseconds,isPlaying:i,position:a&&_||void 0})]}),(0,N.jsxs)(v.S,{children:[(0,N.jsx)("div",{onClick:L,children:(0,N.jsx)(U,{episodeUri:e.uri,showUri:ie,isLocked:l,onClick:()=>{t(p.playPositionMilliseconds)},isPlaying:i,isPlayDisabled:J,playButtonPlayLabel:ee,playButtonPauseLabel:te,size:se})}),(0,N.jsx)(j.e,{uri:e.uri,onClick:Q,size:se,canDownload:ne,condensed:!0}),ae?(0,N.jsx)(I.g,{uri:e.uri,size:se}):(0,N.jsx)(P.b,{uri:e.uri,size:se,onClick:X,condensed:!0}),(0,N.jsx)(f.b,{onShow:W,menu:(0,N.jsx)(C.b,{uri:e.uri,sharingInfo:e.sharingInfo,showUri:ie,contextUri:e.uri,isPlayed:n,onMarkAsPlayed:r}),children:(0,N.jsx)(k.e,{label:c.Ru.get("more.label.context",e.name),size:se})})]})]})};var he=i(97500),ye=i.n(he),ge=i(80366),xe=i(23986),be=i(22324),ve=i(41430),je=i(64644),ke=i(9553),Pe=i(47827),fe=i(9297),Ce=i(21766),Ie=i(75539);const Te=ve.ui.EPISODE_PAGE,Ee=({leavebehinds:e,uri:t,seeAllPath:i})=>{const a=(0,s.useMemo)((()=>e.slice(0,Pe.un)),[e]);return(0,N.jsx)(xe.o,{leavebehinds:a,surface:Te,uri:t,seeAllButton:e.length>Pe.un?(0,N.jsx)(be.J,{leavebehinds:e,surface:Te,uri:t,pathname:i,state:{uri:t}}):null})};function we(e){const t=(0,fe.L)(),i=(0,l.o_h)(e.uri)?.id,a=(0,ke.c)(i),{data:n,error:r,getLeavebehinds:o}=(0,je.A)({surface:Te,uri:e.uri}),c=(d=t?.item.type,(0,Ce.Z)(d)===Ie.c.AD&&d===Ie.c.EPISODE);var d;(0,s.useEffect)((()=>{o()}),[o]),(0,s.useEffect)((()=>{c&&o()}),[c]);const u=(0,s.useMemo)((()=>n?(0,Pe.iT)(n,e.uri):[]),[n?.requestId]);return u.length<1||r?null:(0,N.jsx)(Ee,{uri:e.uri,leavebehinds:u,seeAllPath:a})}var Re=i(56706),_e=i(25270),Se=i(75044),Ae=i(23903),Ne=i(57221);const Le=({cardHeaderText:e,cardBodyText:t,buttonText:i,buttonTarget:s})=>(0,N.jsxs)("div",{className:J,children:[(0,N.jsxs)("div",{className:ee,children:[(0,N.jsx)(_e.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:e}),(0,N.jsx)(_e.E,{semanticColor:"textBase",children:t})]}),(0,N.jsx)(Ne.$,{size:"small",colorSet:"invertedLight",href:(0,l.o_h)(s).toURLPath(!0),component:Re.v,children:i})]});var Ue=i(55405);const De=({areHTMLDescriptionsEnabled:e,contentInformation:t,description:i,hasDescription:a,htmlDescription:n,onTimeStampClick:r,playability:o,showHeader:l=!0,spec:d})=>{const u=(0,z.s)(),p=(a||t)&&l,m=(0,s.useCallback)((e=>{const t=d.readMoreButtonFactory();u.logInteraction(e?t.hitUiReveal():t.hitUiHide())}),[d,u]),h=(0,Se.NC)(Ue.ZK8,{loadingValue:!1});return(0,N.jsxs)(N.Fragment,{children:[p&&(0,N.jsx)(_e.E,{as:"h2",variant:"titleSmall",semanticColor:"textBase",className:V,children:c.Ru.get("episode.description-title")}),t&&(0,N.jsx)(Le,{cardHeaderText:t.cardHeaderText,cardBodyText:t.cardBodyText,buttonText:t.buttonText,buttonTarget:t.buttonTarget}),a&&(0,N.jsx)(Ae.N,{className:Q,onTimeStampClick:r,maxLines:4,onExpanded:m,content:(i||"").trim(),htmlContent:e&&n?n:void 0,enableTimestamps:o.playable,enableAutomaticLinkification:h&&e&&!!n})]})};var Me=i(75773),Fe=i(68885),Be=i(76617),Oe=i(4427),qe=i(79825),ze=i(83531),$e=function(e){return e.DESCRIPTION="description",e.TRANSCRIPT="transcript",e}($e||{});const He=s.memo((function({transcriptSections:e,descriptionContent:t,transcriptContent:i,spec:a}){const n=(0,z.s)(),[r,o]=(0,s.useState)($e.DESCRIPTION),l=(0,ze.SF)(),{ref:d,inView:u}=(0,Me.Wx)({threshold:[1],root:l.current,rootMargin:`-${qe.uC+1}px 100000px 0px 100000px`}),p=(0,s.useRef)(null),m=(0,s.useCallback)((e=>{p.current=e,d(e)}),[d]);return(0,s.useEffect)((()=>{const e=p.current?.parentElement?.offsetTop,t=l?.current;if(!e||!t)return;const i=e-qe.uC;t.scrollTop>i&&t.scrollTo({top:i})}),[l,r]),(0,N.jsx)(Fe.j,{list:(0,N.jsxs)(Be.L,{className:ye()(oe,{[le]:!u}),ref:m,children:[(0,N.jsx)(Oe.Y,{label:c.Ru.get("web-player.episode.description"),sentenceCase:!0,active:r===$e.DESCRIPTION,onClick:()=>{const e=a.tabsFactory().descriptionTabButtonFactory().hitUiReveal();n.logInteraction(e),o($e.DESCRIPTION)},className:ye()(ce,{[te]:r===$e.DESCRIPTION})}),(0,N.jsx)(Oe.Y,{label:c.Ru.get("web-player.episode.transcript"),sentenceCase:!0,disabled:null===e,active:r===$e.TRANSCRIPT,onClick:()=>{const e=a.tabsFactory().transcriptTabButtonFactory().hitUiReveal();n.logInteraction(e),o($e.TRANSCRIPT)},className:ye()(ce,{[te]:r===$e.TRANSCRIPT})})]}),children:null===e||r===$e.DESCRIPTION?t:i})}));var Ge=i(1784),We=i(42668),Qe=i(87983);const Ve=(0,s.memo)((function({transcriptSections:e,onTimeStampClick:t,episodeUri:i}){const{spec:s,logger:a}=(0,$.r)(Ge.c,{data:{uri:i}}),{isPlaying:n}=(0,We.P)({uri:i},{featureIdentifier:"episode"}),r=s.timestampLinkFactory();return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:se,children:(0,N.jsx)(_e.E,{variant:"bodySmall",semanticColor:"textBase",children:c.Ru.get("web-player.episode.transcript.disclaimer")})}),e.map(((e,s)=>{const o=`transcript-section-${s}`;return(0,N.jsxs)("div",{className:ie,children:[(0,N.jsx)("button",{className:ae,onClick:()=>{t(e.startMs,o),a.logInteraction(n?r.hitSeekToTime({msToSeekTo:e.startMs}):r.hitPlay({itemToBePlayed:i}))},children:(0,N.jsx)(w.k,{id:o,targetURI:(0,l.o_h)(i),fadeOut:!0,children:(0,N.jsx)(_e.E,{variant:"marginalBold",semanticColor:"textSubdued",className:ne,children:(0,Qe.f)(e.startMs)})})}),e.content.map(((e,t)=>(0,N.jsx)(_e.E,{variant:"bodySmall",semanticColor:"textBase",className:re,dir:"auto",children:e},`transcript-text-${t}`)))]},o)}))]})}));var Ke=i(44483),Ye=i(45278),Ze=i(64414),Xe=i(56543),Je=i(91343),et=i(58193),tt=i(74743),it=i(6527),st=i(68607),at=i(42743),nt=i(2959),rt=i(81315),ot=i(67037),lt=i(40638),ct=i(34721),dt=i(3678),ut=i(12543),pt=i(499),mt=i(86697);const ht=({children:e,index:t,ariaRowIndex:i,onTriggerPlay:a,isActive:n,uri:r,spec:o})=>{const l=(0,z.s)(),{pushPopSelected:c,toggleSelected:d,isSelected:u}=(0,s.useContext)(dt.m),p=(0,s.useRef)(null),m=(0,ut.W)(),h=(0,lt.YQ)((e=>{m({intent:"play",type:"double-click"});const t=l.logInteraction(o.doubleHitPlay({itemToBePlayed:r}));a(e,t)}),pt.d,{leading:!0,trailing:!1}),y=(0,s.useCallback)((e=>{d(t,e.shiftKey,e.ctrlKey||e.metaKey)}),[d,t]),g=(0,s.useCallback)((e=>{if(!p.current?.contains(e.target))return;const i="ArrowUp"===e.key?-1:1;["ArrowUp","ArrowDown"].includes(e.key)&&(e.shiftKey?c(t,i):d(t+i,!1,!1))}),[c,d,t]),x=u(t),b=x&&u(t-1),v=x&&u(t+1);return(0,N.jsx)(ct.$,{rowIndex:i,"aria-selected":x,children:(0,N.jsx)("div",{"data-testid":"tracklist-row",className:ye()(mt.A.trackListRow,mt.A.trackListRowGrid,{[mt.A.active]:n,[mt.A.selected]:x,[mt.A.isPreviousRowSelected]:b,[mt.A.isNextRowSelected]:v}),onDoubleClick:h,onClick:y,onKeyDown:g,ref:p,children:e})})};var yt=i(66975),gt=i(82232);const xt=({uri:e,title:t="",index:i,subtitle:a="",showName:n="",showUri:r="",duration:o=0,start:l,stop:d})=>{const{isActive:u,isPlaying:p,onClick:m}=(0,yt.L)({episodeUri:e,start:l,stop:d}),h=(0,s.useCallback)(((e,t)=>{m(t)}),[m]),{spec:y}=(0,$.r)(Ze.i,{data:{position:i,reason:"",uri:e}});return(0,N.jsx)(gt.pZ,{value:"row",index:i,children:(0,N.jsxs)(ht,{index:i,ariaRowIndex:i+1,onTriggerPlay:h,isActive:u,spec:y,uri:e,children:[(0,N.jsxs)(at.U,{ariaColIndex:0,children:[(0,N.jsx)(tt.$,{uri:e,playAriaLabel:c.Ru.get("tracklist.a11y.play",a,n),onClick:h,isPlaying:p,isActive:u,spec:y,children:(0,N.jsx)(it.a,{children:(0,N.jsx)(Ye.M,{className:mt.A.talkIcon,"aria-hidden":!0})})}),(0,N.jsxs)(et.l,{children:[(0,N.jsx)(ot.p,{titleText:t,children:t}),(0,N.jsx)(rt.p,{children:a})]})]}),(0,N.jsx)(nt.o,{ariaColIndex:1,children:(0,N.jsx)(Xe.g,{uri:r,name:n,spec:y,children:(0,N.jsx)("span",{dir:"auto",children:n})})}),(0,N.jsx)(st.l,{ariaColIndex:2,children:(0,N.jsx)(Je.P,{duration:o,className:mt.A.talkSegmentDuration})})]})})};var bt=i(50962),vt=i(49026),jt=i(95741),kt=i(51775),Pt=i(87017),ft=i(6723),Ct=i(35301),It=i(88429);const Tt="HRApv65revEcL42QzRjJ",Et="HbJqPqSmOY5H3lLnQVzD",wt="DBcCnhHVt7coNqp3wMB4",Rt=({episodeUri:e,index:t,duration:i,start:a,stop:n,name:r,uri:o,artists:l,album:d,playable:u})=>{const{isActive:p,isPlaying:m,onClick:h}=(0,yt.L)({episodeUri:e,start:a,stop:n}),y=(0,s.useCallback)(((e,t)=>{u&&h(t)}),[h,u]),{spec:g}=(0,$.r)(Ze.i,{data:{position:t,reason:"",uri:o}});return(0,N.jsx)(gt.pZ,{value:"row",index:t,children:(0,N.jsx)(jt.t,{trigger:"right-click",action:"open",menu:(0,N.jsx)(kt.P,{uri:o}),children:(0,N.jsxs)(Ct.w,{uri:o,index:t,ariaRowIndex:t+1,dragMetadata:{name:r,createdBy:l?.[0].name??""},onTriggerPlay:y,isActive:p,isPlayable:u,spec:g,children:[(0,N.jsxs)(at.U,{ariaColIndex:0,children:[(0,N.jsx)(tt.$,{uri:o,playAriaLabel:c.Ru.get("tracklist.a11y.play",r,l?.[0].name),onClick:y,isPlaying:m,isActive:p,spec:g,children:(0,N.jsx)(it.a,{children:(0,N.jsx)("img",{className:Et,src:d.image,alt:d.name})})}),(0,N.jsxs)(et.l,{children:[(0,N.jsx)(ot.p,{titleText:r,children:r}),(0,N.jsx)(rt.p,{children:(0,N.jsx)(Pt.l,{artists:l,spec:g})})]})]}),(0,N.jsx)(nt.o,{ariaColIndex:1,children:(0,N.jsx)(Xe.g,{uri:d.uri,name:d.name,spec:g,children:d.name})}),(0,N.jsxs)(st.l,{ariaColIndex:2,children:[(0,N.jsx)(It.d,{uri:o,spec:g}),(0,N.jsx)(Je.P,{duration:i}),(0,N.jsx)(ft.Y,{spec:g,menu:(0,N.jsx)(kt.P,{uri:o,artists:l}),label:c.Ru.get("more.label.track",r,l?.[0].name)})]})]})})})};var _t=i(52506),St=i(91563);function At(e,t,i){return e.reduce(((e,s,a)=>((a>0||t>0)&&e.push({type:"SPACER",id:`spacer-${e.length}`}),"MUSIC"===s.type?e.push(function(e,t,i){return{type:"MUSIC",index:t,uri:i.uri,episodeUri:e,start:i.start,stop:i.stop,duration:i.duration,name:i.track.name,artists:i.track.artists,album:i.track.album,playable:i.track.playable}}(i,a,s)):"TALK"===s.type&&e.push(function(e,t,i){return{type:"TALK",index:t,uri:e,title:i.title,subtitle:i.subtitle,start:i.start,stop:i.stop,duration:i.duration,showUri:i.show.uri,showName:i.show.name}}(i,a,s)),e)),[])}const Nt=({uri:e,segmentCount:t})=>{const i=(0,_t.o)(),a=(0,s.useCallback)((async(s,a)=>{const n=Math.ceil(s/2);try{return{items:At(await i.getSegments(e,n,a),n,e),totalLength:2*t-1}}catch(e){return{items:[],totalLength:0}}}),[t,i,e]),n=(0,s.useCallback)((t=>{switch(t.type){case"SPACER":return(0,N.jsx)("div",{className:wt},t.id);case"MUSIC":return(0,N.jsx)(Rt,{...t},`${e}-${t.index}`);case"TALK":return(0,N.jsx)(xt,{...t},`${e}-${t.index}`);default:return(0,St.d)(t)}}),[e]),r=(0,s.useCallback)((e=>({uri:"MUSIC"===e.type?e.uri:""})),[]),o=c.Ru.get("music_and_talk.in_this_episode");return(0,N.jsxs)("div",{children:[(0,N.jsx)(_e.E,{as:"h2",variant:"titleSmall",semanticColor:"textBase",className:Tt,children:o}),(0,N.jsx)(bt.S4,{ariaLabel:o,hasHeaderRow:!0,rowPlaceholder:Ke.qq,columns:[vt.$.TITLE_AND_ARTIST,vt.$.ALBUM_OR_SHOW,vt.$.DURATION],renderRow:n,fetchTracks:a,resolveItem:r,limit:50,nrTracks:2*t-1,testID:"music-and-talk-tracklist"})]})},Lt=(0,s.lazy)((async()=>{const{CommentsList:e}=await Promise.all([i.e(261),i.e(969),i.e(7668),i.e(4483)]).then(i.bind(i,88929));return{default:e}}));var Ut=i(15120),Dt=i(41952),Mt=i(85586),Ft=i(75105),Bt=i(92375);const Ot=({areHTMLDescriptionsEnabled:e,contentInformation:t,description:i,hasDescription:a,hasMusicAndTalkSegments:n,htmlDescription:r,onDescriptionTimestampClick:o,onTranscriptTimestampClick:l,playability:d,segmentCount:u,showUrl:p,transcript:m,uri:h,spec:y})=>{const g=(0,z.s)(),x=(0,Ut.d)(),b=(0,s.useMemo)((()=>y.descriptionSectionFactory()),[y]),v=(0,s.useMemo)((()=>b.trackListFactory()),[b]),[j,k]=(0,s.useState)(null),P=(0,s.useCallback)((async e=>{const t=await(0,Ft.Q)(e);k(t)}),[]);(0,s.useEffect)((()=>{m&&m.length>0&&P(m[0].cdnUrl)}),[P,m]);const f=(0,Mt.y)(),C=l=>(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(De,{hasDescription:a,contentInformation:t,onTimeStampClick:o,description:i,areHTMLDescriptionsEnabled:e,htmlDescription:r,playability:d,showHeader:l,spec:b}),n&&(0,N.jsx)(Bt.r,{spec:v,children:(0,N.jsx)(Nt,{segmentCount:u,uri:h})}),p&&(0,N.jsx)(ge.n,{size:"small",className:K,href:p,component:Re.v,onClick:()=>{g.logInteraction(b.allEpisodesLinkFactory().hitUiNavigate({destination:p}))},children:c.Ru.get("episode.see_all_episodes")}),x&&(0,N.jsx)(s.Suspense,{fallback:null,children:(0,N.jsx)("div",{className:ye()(de,{[ue]:f===Dt.E.LARGE}),children:(0,N.jsx)(Lt,{uri:h,className:pe})})}),(0,N.jsx)(we,{uri:h})]}),I=m&&m?.length>0&&d.playable;return(0,N.jsx)(N.Fragment,{children:I?(0,N.jsx)(He,{transcriptSections:j,descriptionContent:C(!1),transcriptContent:(0,N.jsx)(Ve,{transcriptSections:j||[],onTimeStampClick:l,episodeUri:h}),spec:y}):C(!0)})};var qt=i(43294),zt=i(33860),$t=i(82594),Ht=i(46511),Gt=i(80678),Wt=i(86422),Qt=i(19436),Vt=i(84318),Kt=i(10227),Yt=i(58993),Zt=i(24498),Xt=i(93787),Jt=i(68583),ei=i(71264);const ti=({coverArt:e,name:t})=>{const i=(0,Mt.y)(),s=i===Dt.E.SMALL||i===Dt.E.XSMALL;return(0,N.jsx)(Jt.b,{images:e,type:Ie.c.EPISODE,shape:Jt.u.ROUNDED_CORNERS,title:t,size:s?ei.Qe.SIZE_20:ei.Qe.SIZE_24,className:Z})};var ii=i(81637);const si=({episode:e,isFullyPlayed:t,setIsFullyPlayed:i,onPlayEpisode:a,isPlaying:n,isLocked:r,backgroundColor:o,spec:d})=>{const{uri:u,name:p,sharingInfo:m,playedState:h,episodeType:y,releaseDate:g,coverArt:x}=e,b=(0,z.s)(),v=function(e,t,i,s,a){const n=t===ii.I_.Episode;return(0,Xt.hD)(e,s,i,a)?(0,N.jsx)(Xt.Ih,{isMusicAndTalk:n}):n?c.Ru.get("type.showEpisode"):c.Ru.get("type.podcastEpisode")}(u,y||ii.I_.Unknown,h.playPositionMilliseconds,function(e){return e?.replace(/T.*/,"")||""}(g?.isoString),h.state===ii._w.Completed),j=e.podcast?.uri,k=function(e){const t=(0,l.o_h)(e);return`/show/${(0,l.cEw)(t?.id||"")}`}(j),P=(0,s.useCallback)((()=>{b.logInteraction(d.podcastLinkFactory().hitUiNavigate({destination:k}))}),[b,k,d]),f=e.podcast?.coverArt,I=!!(f&&f.length===x.length&&x.every(((e,t)=>e.url===f[t].url))),T=!r&&!e.playability.playable,E=c.Ru.get("tracklist.a11y.play",e.name,e.podcast?.name),w=c.Ru.get("tracklist.a11y.pause",e.name,e.podcast?.name),R=(0,N.jsx)(C.b,{uri:u,sharingInfo:m,showUri:j,contextUri:u,isPlayed:t,onMarkAsPlayed:i});return(0,N.jsxs)(zt.z,{backgroundColor:o,children:[(0,N.jsxs)(Gt.h,{children:[(0,N.jsx)(U,{episodeUri:e.uri,showUri:j,isLocked:r,onClick:()=>{a(h.playPositionMilliseconds)},isPlaying:n,isPlayDisabled:T,playButtonPlayLabel:E,playButtonPauseLabel:w,size:"medium"}),(0,N.jsx)(qt.h,{menu:R,children:(0,N.jsx)(Wt.X,{text:p,dragUri:u,dragLabel:p})})]}),!I&&(0,N.jsx)($t.X,{children:(0,N.jsx)(qt.h,{menu:R,children:(0,N.jsx)(Qt.b,{loading:"eager",name:p,images:x,placeholderType:"episode",shape:Qt.u.SQUARE})})}),(0,N.jsxs)(Ht.Y,{children:[(0,N.jsx)(Vt.B,{children:v}),(0,N.jsx)(qt.h,{menu:R,children:(0,N.jsx)(Yt.mm,{dragUri:u,dragLabel:p,scaleAtMinWidth:Yt.tw,className:W,children:(0,N.jsx)("span",{"data-testid":"episodeTitle",children:p})})}),(0,N.jsx)(qt.h,{menu:R,children:(0,N.jsxs)(Zt.N,{to:k,onClick:P,className:X,children:[I&&(0,N.jsx)(ti,{name:p,coverArt:x}),(0,N.jsx)(Kt.g,{children:(0,N.jsx)("span",{"data-testid":"showTitle",children:e.podcast?.name})})]})})]})]})};var ai=i(7840);var ni=i(87771),ri=i(7217),oi=i(40755),li=i(81286),ci=i(15310),di=i(90089),ui=i(44721),pi=i(36838),mi=i(54799),hi=i(84792),yi=i(4319),gi=i(68456);const xi=({episode:e})=>{const{uri:t,episodeType:i,description:n,htmlDescription:o,podcastSubscription:c,segmentsCount:m,podcast:y,contentInformation:g,playedState:x,coverArt:b}=e,{spec:v,logger:j}=(0,$.r)(r.g,{data:{uri:t}}),k=(0,li.n)(),P=(0,s.useMemo)((()=>v.headerFactory()),[v]),f=(0,s.useMemo)((()=>v.actionBarFactory()),[v]),[C,I]=(0,s.useState)(x.state===ii._w.Completed),T=(0,pi.z)(),E=void 0!==m&&m>0,w=(0,S.V)(),{triggerPlay:R,togglePlay:_,isActive:U}=(0,We.P)({uri:t,...k?{}:{pages:[{items:[{type:Ie.c.EPISODE,uri:t,uid:null,provider:null}]}]}},{featureIdentifier:"episode"}),{isActive:D,isPlaying:M}=(0,mi.te)(t),F=b.at(0)?.url,B=(0,di.H)(F||null),O=(0,q.o)((e=>e?.isPaused??void 0)),z=(0,A.c)(),H=c.isPaywalled&&!c.isUserSubscribed,G=D||U,W=e?{name:e.name,uri:e.uri,mediaTypes:e.mediaTypes,audio:{items:e.audio.items.map((e=>({url:e.url})))}}:null,Q=y?{name:y.name,uri:y.uri,trailer:y.trailer,showTypes:y.showTypes}:null,V=(0,ci.C)(W,Q),K=(0,s.useCallback)(((e,t,s,a)=>{const n=()=>{O?(a?.("resume"),T.resume({featureIdentifier:"episode"})):(a?.("pause"),T.pause({featureIdentifier:"episode"}))};if(!H)if(i===ii.I_.Episode&&z)u.h.set((()=>({triggerId:s||L,triggerAction:null})));else if(U&&!t)w?n():_({loggingParams:a?.()});else if(D&&!t)n();else{const t=a?.("play");w?V({seekTo:e,loggingParams:t}):R({seekTo:e,loggingParams:t})}}),[H,i,z,D,U,w,O,T,_,V,R]),Y=(0,s.useCallback)((e=>{K(e,!1,void 0,(e=>{const i=v.actionBarFactory().playButtonFactory();let s;return s="pause"===e||M?i.hitPause({itemToBePaused:t}):"resume"===e||G?i.hitResume({itemToBeResumed:t}):i.hitPlay({itemToBePlayed:t}),j.logInteraction(s)}))}),[K,G,M,j,v,t]),Z=(0,s.useCallback)((e=>{K(e,!0,void 0,(()=>j.logInteraction(v.descriptionSectionFactory().timestampLinkFactory().hitPlay({itemToBePlayed:t}))))}),[K,j,v,t]),X=(0,s.useCallback)(((e,t)=>{K(e,!0,t)}),[K]),[J,ee]=(0,a.ok)();(e=>{const t=(0,ai.g)(),[i]=(0,a.ok)(),n=e.gatedEntityRelations?.entitiesWithValueProps.at(0),r=(0,l.o_h)(n?.fallbackNavigation?.uri),o=n?.uri,c=i.has("si");(0,s.useEffect)((()=>{if(!c||!o)return;let i;e.hasGatedEntityRelationAccess&&e.uri!==o?i=(0,l.o_h)(o)?.toURLPath(!0):!e.hasGatedEntityRelationAccess&&r&&(i=r.toURLPath(!0)),i&&t(i,{replace:!0})}),[r,c,t,o,e.hasGatedEntityRelationAccess,e.uri])})(e),(0,s.useEffect)((()=>{if(e&&!G&&J.has("t")){const t=J.get("t")||"0",i=1e3*parseInt(t,10);i<=e.duration.milliseconds&&(J.delete("t"),ee(J,{replace:!0}),K(i,!0))}}),[e,K,G,J,ee]);const te=!!n||!!o,ie=e.podcast?.uri,se=(0,l.o_h)(ie)?.toURLPath(!0);return(0,N.jsxs)("section",{"data-testid":"episode",children:[(0,N.jsx)(d.Q,{children:(0,gi.L$)({episodeOrChapterName:e.name,showOrAudiobookName:e.podcast?.name??"",type:"Podcast"})}),(0,N.jsx)(h.c,{artistOrShow:e.podcast?.name,title:e.name,uri:t,entityType:h.p.EPISODE}),(0,N.jsx)(si,{episode:e,onPlayEpisode:Y,isPlaying:M,isFullyPlayed:C,setIsFullyPlayed:I,backgroundColor:B,spec:P,isLocked:H}),(0,N.jsx)(me,{episode:e,onPlayEpisode:Y,isPlaying:M,isActive:G,isFullyPlayed:C,setIsFullyPlayed:I,backgroundColor:B,isLocked:H,spec:f}),(0,N.jsxs)("div",{className:"contentSpacing",children:[(0,N.jsx)(ni.q,{gatedEntityRelations:e.gatedEntityRelations,upsellExplanation:e.upsellExplanation,hasAccess:e.hasGatedEntityRelationAccess,showValueProps:!1,showCoverArt:!1}),(0,N.jsx)(Ot,{transcript:e.transcript,hasDescription:te,contentInformation:g,onDescriptionTimestampClick:Z,onTranscriptTimestampClick:X,description:e.description,areHTMLDescriptionsEnabled:!0,htmlDescription:e.htmlDescription,playability:e.playability,hasMusicAndTalkSegments:E,segmentCount:m,uri:e.uri,showUrl:se,spec:v}),z&&(0,N.jsx)(p.W,{uri:t})]})]})},bi=s.memo((function(){const{episodeId:e=""}=(0,n.g)(),t=(0,l.iMK)(e).toURI(),i=(0,hi.d)(t);return i?.isError||!i?.episodeOrChapter?(0,N.jsx)(m.LoadingPage,{hasError:i?.isError||!1,errorMessage:c.Ru.get("error.not_found.title.podcast")}):(0,yi.Gr)(i.episodeOrChapter)?(0,N.jsx)(ri.$,{to:(0,l.o_h)(i.episodeOrChapter.book?.uri).toURLPath(!0)}):(0,N.jsx)(s.Suspense,{fallback:null,children:(0,N.jsx)(oi.u,{pageId:o.$h.PODCAST_EPISODE,uri:t,children:(0,N.jsx)(ui.d,{dynamicColors:i.episodeOrChapter.dynamicColors,children:(0,N.jsx)(xi,{episode:i.episodeOrChapter})})})})}))},87717:(e,t,i)=>{i.d(t,{P:()=>s.P});var s=i(83242)}}]);
//# sourceMappingURL=xpui-routes-episode.js.map