"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[319],{8633:(e,t,i)=>{i.d(t,{F:()=>d});var n=i(30758),a=i(53177),s=i(615),r=i(51185),o=i(55910),l=i(45730);const c="KrBYgWLGb5aRHjoD_prX";var u=i(86070);const d=(0,a.mc)((()=>{const{setVideoPlayerUIFlag:e}=(0,o.d)(),t=(0,s.XB)();return(0,n.useEffect)((()=>(t===r.Z.NowPlayingView&&e(l.nP.npv,!0),()=>{e(l.nP.npv,!1)})),[t,e]),(0,u.jsx)("div",{id:"VideoPlayerNpv_ReactPortal",className:c})}),{name:"NPVVideoContainer"})},8827:(e,t,i)=>{i.d(t,{R:()=>p});var n=i(30758),a=i(44396),s=i(45232);function r(e,t,i=!1){if(!e)return void console.error("No list element found. Canceling moving focus");if(!(0,s.fk)(e))return;const n=e.querySelector('[tabindex="0"]');t===a.O.UP&&(0,s.MS)(n,o(e,n,a.O.UP,i)),t===a.O.DOWN&&(0,s.MS)(n,o(e,n,a.O.DOWN,i)),t===a.O.RIGHT&&(0,s.MS)(n,l(n,a.O.RIGHT,i)),t===a.O.LEFT&&(0,s.MS)(n,l(n,a.O.LEFT,i)),t===a.O.HOME&&(0,s.MS)(n,c(a.O.HOME,i)??n),t===a.O.END&&(0,s.MS)(n,c(a.O.END,i)??n)}function o(e,t,i,n=!1){const r=t.closest('li[role="row"]');if(!r)return t;let o=r;const c=Array.from(e.querySelectorAll('li[role="row"]')),u=Array.from(r.querySelectorAll(s.nu)),d=c.indexOf(r);if(d<0)return t;const m=(n&&t!==u[0]||!n&&t!==r)&&!(t instanceof HTMLLIElement);if(i===a.O.UP){if(document.activeElement===e){o=c[c.length-1];return(n?o.querySelector(s.nu):o)??t}if(m)return l(t,a.O.LEFT,n);let i=d-1;if(-1===i)return t;o=c[i],i-=1}else if(i===a.O.DOWN){if(document.activeElement===e){o=c[0];return(n?o.querySelector(s.nu):o)??t}if(m)return l(t,a.O.RIGHT,n);let i=d+1;if(i===c.length)return t;o=c[i],i+=1}return(n?o.querySelector(s.nu):o)??t}function l(e,t,i=!1){const n=e.closest('li[role="row"]');if(!n)return e;let r=e;const o=Array.from(n.querySelectorAll(s.nu)),l=o.indexOf(e);let c=0;if(t===a.O.RIGHT&&l-1!==o.length)c=l+1;else{if(t===a.O.LEFT&&-1===l)return n;if(t===a.O.LEFT&&0!==l)c=l-1;else if(t===a.O.LEFT&&0===l){return(i?n.querySelector(s.nu):n)??n}}return r=o.at(c),r??e}function c(e,t=!1){const{currentFocus:i,listEl:n}=function(){const e=document.activeElement,t=e?.closest("ul");return((0,a.I)(e)||e instanceof HTMLLIElement)&&t?{currentFocus:e,listEl:t}:{currentFocus:null,listEl:null}}();if(null===i||null===n)return null;const r=i.closest('li[role="row"]');if(!r)return i;const o=Array.from(n.querySelectorAll('li[role="row"]')),l=Array.from(r.querySelectorAll(s.nu));if(o.indexOf(r)<0)return i;const c=t&&i===l[0]||!t&&i===r;if(e===a.O.HOME){if(c){return(t?o[0].querySelector(s.nu):o[0])??i}return(t?l[1]:l[0])??i}if(e===a.O.END){if(c){return(t?o[o.length-1].querySelector(s.nu):o[o.length-1])??i}return l[l.length-1]??i}return i}var u=i(15777),d=i(30333),m=i(86070);const p=(0,n.forwardRef)((({onKeyDown:e,children:t,firstInteractiveIsWrapper:i=!1,...o},l)=>{const c=(0,d.N)(l);(0,u.R)(c);const p=(0,n.useCallback)((t=>{c.current?.contains(t.target)&&("ArrowUp"!==t.key&&"ArrowDown"!==t.key&&"Home"!==t.key&&"End"!==t.key||t.preventDefault(),"ArrowUp"!==t.key&&"ArrowDown"!==t.key||document.documentElement.classList.remove("no-focus-outline"),"ArrowUp"===t.key&&r(c.current,a.O.UP,i),"ArrowDown"===t.key&&r(c.current,a.O.DOWN,i),"ArrowRight"===t.key&&r(c.current,a.O.RIGHT,i),"ArrowLeft"===t.key&&r(c.current,a.O.LEFT,i),"Home"===t.key&&r(c.current,a.O.HOME,i),"End"===t.key&&r(c.current,a.O.END,i),e?.(t))}),[i,c,e]),g=(0,n.useCallback)((e=>{if(!c.current)return;const t=e.target,i=c.current.querySelector('[tabindex="0"]');t.closest('li[role="row"]')&&t!==i&&(0,s.MS)(i,t,{preventScroll:!0})}),[c]);return(0,m.jsx)("ul",{role:"treegrid",ref:c,onKeyDown:p,onFocus:g,tabIndex:0,...o,children:t})}))},11167:(e,t,i)=>{i.d(t,{c:()=>o});var n=i(30758),a=i(34709),s=i(61860),r=i(91247);function o(e,t){const i=(0,s.d)(),o=(0,r.J)(t),l=(0,a.a)();(0,n.useEffect)((()=>i.getBroadcastingEvents().addListener(e,(e=>{l()&&o(e)}))),[i,o,e,l])}},14382:(e,t,i)=>{i.d(t,{h:()=>k});var n=i(97500),a=i.n(n),s=i(8335),r=i(42296),o=i(34589),l=i(96535),c=i(5334),u=i(93018),d=i(31284),m=i(76776),p=i(34118),g=i(94583),v=i(53502),x=i(12496),h=i(55712),b=i(19492);const y="URfgKDbFQpKuN8ZjGdui",f="e3hKZQOHyxgax_X0Rb1E",j="main-nowPlayingView-coverArt",C="SwS3WdCPfdr1uOOksVEB";var w=i(86070);const k=({context:e,item:t,index:i,canSwitchVisuals:n=!1,isMinimized:k=!1})=>{const{spec:S,logger:N}=(0,h.D)(r.J,{}),{draggable:R,onDragStart:E}=(0,g.P)(),{ref:I,inView:A}=(0,s.Wx)({threshold:.5,initialInView:!0});return(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(l.h,{menu:(0,w.jsx)(u.W,{context:e,item:t,canSwitchVisuals:n}),children:(0,w.jsx)("div",{draggable:R&&((0,x.v)(t)||(0,v.p)(t)),onDragStart:e=>{E(e,{itemUris:[t.uri],dragLabelText:(0,p.r)(t)})},ref:I,className:a()(y,{[f]:k}),children:(0,w.jsx)(m.R,{uri:e.uri,owner:e.metadata?.context_owner,children:(0,w.jsx)(d.e,{context:t.type===b.c.TRACK?t.album:e,item:t,index:i,isVisible:!0,onClick:()=>{N.logInteraction(S.coverArtFactory({uri:t.uri}).hitUiNavigate({destination:t.type===b.c.TRACK?t.album.uri:t.uri}))},adEventReason:o.c.COVER_ART,children:(0,w.jsx)(c.b,{className:a()(j,{[C]:A}),images:t.images??[],type:t.type,maxSize:k?56:384,desiredLabel:k?"small":"xlarge"})})})})})})}},16511:(e,t,i)=>{i.d(t,{O:()=>s,j:()=>a});var n=i(30758);let a=function(e){return e[e.Errored=0]="Errored",e}({});const s=(0,n.createContext)({state:null,capturePlaybackError:()=>{}})},17621:(e,t,i)=>{i.d(t,{$:()=>r,e:()=>s});var n=i(28191),a=i(28155);const s={SMALL:"small",LARGE:"large"},r=()=>(0,a.y)()===n.E.SMALL?"small":"large"},21308:(e,t,i)=>{i.d(t,{p:()=>h});var n=i(30758),a=i(17369),s=i(35638),r=i(74396),o=i(29174),l=i(26930),c=i(35199),u=i(61384),d=i(84040);const m="pIxPdfuNasUDLbEDmuK_",p="T5TwrUTf23N311rgrEAc",g="BTwQUS5iBiiOBgdda2Zi",v="lu2OTpzgQ6hv6AYWXMNQ";var x=i(86070);const h=({localStorageKey:e,onDismiss:t})=>{const[i,h]=(0,d.x)(e,!1),{logStartJam:b}=(0,u.O)(),{enqueueSnackbar:y}=(0,l.d)(),f=(0,n.useCallback)((()=>{h(!0),t&&t(),y(o.Ru.get("web-player.social-connect.promotion.how-to-start-a-jam-reminder"),{autoHideDuration:5e3})}),[y,t,h]);return i?(0,x.jsx)(x.Fragment,{}):(0,x.jsxs)("div",{className:m,children:[(0,x.jsxs)("div",{className:p,children:[(0,x.jsx)(a.E,{as:"p",variant:"bodySmall",semanticColor:"textSubdued",children:o.Ru.get("web-player.social-connect.invitation-modal.subtitle")}),(0,x.jsx)(s.H,{iconOnly:r.M,className:g,"aria-label":o.Ru.get("close"),onClick:f,size:"small"})]}),(0,x.jsx)("div",{className:v,children:(0,x.jsx)(c.$,{onClick:b})})]})}},22286:(e,t,i)=>{i.d(t,{$:()=>n.$});var n=i(94519)},22521:(e,t,i)=>{i.d(t,{A:()=>n});const n={nowPlaying:"main-nowPlayingWidget-nowPlaying",controls:"ZbFkATBbLkWh2SHMXDt6",coverArtCollapsed:"main-coverSlotCollapsed-navAltContainer",coverArt:"main-nowPlayingWidget-coverArt",contextItemInfo:"main-nowPlayingWidget-trackInfo",coverArtButton:"HD9s7U5E1RLSWKpXmrqx",hidden:"Pw2N_vxQ21_h3HC4zu1y"}},26953:(e,t,i)=>{i.d(t,{_:()=>f,s:()=>y});var n=i(30758),a=i(97500),s=i.n(a),r=i(62411),o=i(93727),l=i(41588),c=i(84706),u=i(52276),d=i(615),m=i(51185);const p="ffFwfKcPDbmAPLXzxzKq",g="jD_TVjbjclUwewP7P9e8",v="nZaXB942idDuiFv4bKNk",x="Fwe5dGEAgs_VFp4SPrzv",h="gchSBzolAjaPDHD1q0rA";var b=i(86070);const y=(0,n.createContext)(null),f=({label:e,style:t,focusTransferId:i,children:a,className:f,nodeRef:j})=>{const C=(0,n.useRef)(null),w=j??C,k=(0,u.S)(),S=(0,c.h)(),N=(0,r.d4)((e=>e.ui?.fullscreenMode?.isOpen??!1)),R=(0,d.XB)(),E=k===l.z.NOW_PLAYING_VIEW;return(0,o.X)(i??null,w),(0,b.jsx)(y.Provider,{value:w,children:(0,b.jsx)("aside",{"aria-label":e,className:s()(p,f,{[v]:E,[h]:N,[x]:S,[g]:R!==m.Z.Disabled&&R!==m.Z.NowPlayingView}),style:t,id:"Desktop_PanelContainer_Id",ref:w,tabIndex:-1,children:a})})}},28722:(e,t,i)=>{i.d(t,{L:()=>o});var n=i(30758),a=i(34939),s=i(5956),r=i(67715);function o({episodeUri:e,start:t,stop:i}){const{togglePlay:o,triggerPlay:l,isPlaying:c,isActive:u}=(0,a.P)({uri:e},{featureIdentifier:"episode"}),d=(0,s.o)((e=>(0,r.s)(e)??0)),m=u&&function(e,t,i){return i>=e&&i<t}(t,i,d),p=c&&m;return{onClick:(0,n.useCallback)((e=>{m?o({seekTo:t,loggingParams:e}):l({seekTo:t,loggingParams:e})}),[m,t,o,l]),isPlaying:p,isActive:m}}},31645:(e,t,i)=>{i.d(t,{k:()=>a});var n=i(61860);const a=()=>(0,n.d)().getJamJoinInfo()},33849:(e,t,i)=>{i.d(t,{k:()=>u});var n=i(30758),a=i(97500),s=i.n(a),r=i(30024),o=i(17621),l=i(48745),c=i(86070);const u=(0,n.memo)((function({breakpoint:e,className:t,showSeparator:i=!1,isActive:n,...a}){return(0,c.jsx)(r.v,{"data-entity-row":!0,className:s()(t,l.A.entityRow,{[l.A.separator]:i,[l.A.active]:n}),hoverBackgroundColor:"backgroundTintedHighlight",activeBackgroundColor:"backgroundTintedBase",layout:e===o.e.SMALL?"regular":"wide",hoverAnimationDuration:"0ms",horizontalGap:e===o.e.SMALL?"12px":"16px",paddingBlockStart:"12px",paddingBlockEnd:"12px",...a})}))},33957:(e,t,i)=>{i.d(t,{w:()=>h});var n=i(30758),a=i(97500),s=i.n(a),r=i(44715),o=i(67974),l=i(12875),c=i(97036);const u="AAdBM1nhG73supMfnYX7",d="W3E0IT3_STcazjTeyOJa",m="mdMUqcSHFw1lZIcYEblu",p="cZCuJDjrGA2QMXja_Sua",g="zduvaX0Ioxqd5ypeWoAf";var v=i(86070);const x=({fixedHeader:e,scrollNodeRef:t,children:i,scrolledClassName:n})=>{const a=(0,l.y)(t);return(0,v.jsxs)("div",{className:s()(u),children:[(0,v.jsx)("div",{className:s()(d,{[n??m]:a}),children:e}),i]})},h=n.forwardRef((({children:e,className:t,fixedHeader:i,scrolledClassName:a},l)=>{const d=(0,n.useRef)(null);(0,o.g)(d);const m=(0,n.useMemo)((()=>({scrollNodeRef:d})),[d]),h=(0,v.jsx)(c.bi.Provider,{value:m,children:(0,v.jsx)(r.a,{className:p,scrollNodeRef:d,children:(0,v.jsx)("div",{ref:l,className:s()(u,g,t),children:e})})});return i?(0,v.jsx)(x,{fixedHeader:i,scrollNodeRef:d,scrolledClassName:a,children:h}):h}))},34074:(e,t,i)=>{function n(e){return e}i.d(t,{v:()=>n})},34118:(e,t,i)=>{i.d(t,{r:()=>n.r});var n=i(18320)},35199:(e,t,i)=>{i.d(t,{$:()=>m});var n=i(30758),a=i(62411),s=i(77676),r=i(83157),o=i(29174),l=i(56168),c=i(83868),u=i(43123),d=i(86070);const m=({onClick:e})=>{const t=(0,a.wA)(),i=(0,c.Y)(),m=(0,n.useCallback)((async()=>{try{e(),await i()}catch(e){t((0,l.A9)(u.EL.ERROR))}}),[i,t,e]);return(0,d.jsx)(s.$,{iconLeading:r.V,size:"small",onClick:m,children:o.Ru.get("web-player.social-connect.menu-action.title")})}},42956:(e,t,i)=>{i.d(t,{a:()=>b});var n=i(30758),a=i(97500),s=i.n(a),r=i(29174),o=i(50754),l=i(22286),c=i(52854),u=i(73740),d=i(83884),m=i(26930),p=i(61186),g=i(31909),v=i(5638),x=i(22521),h=i(86070);const b=({context:e,item:t,className:i,onClick:a=()=>{}})=>{const{dislikeEndpoint:b,shouldShowFeedbackControls:y}=(0,d.d)(e),f=(0,l.$)(),j=y&&!f,{canDisplayButton:C,hideButton:w}=(0,u.$)(t,e),k=(0,p.i)(t.uri),{ban:S}=(0,c.N)(k,e.uri,e.metadata?.[v.W.CONTEXT_DESCRIPTION],t.provider??void 0),{enqueueSnackbar:N}=(0,m.d)(),R=e.metadata?.[v.W.CONTEXT_DESCRIPTION]??"",{setDislikeFeedback:E}=(0,g.I)({uri:t.uri,setFeedbackPath:b,contextUri:e.uri}),I=(0,n.useCallback)((async()=>{E(),N(r.Ru.get("feedback.hide-song",R)),a?.()}),[N,R,a,E]),A=(0,n.useCallback)((async()=>{k&&(S(),a?.())}),[k,S,a]);return j||C?(0,h.jsx)(o.O,{className:s()(i,{[x.A.hidden]:w}),isDisliked:!1,onClick:f?A:I}):null}},47157:(e,t,i)=>{i.d(t,{o:()=>s});var n=i(3044),a=i(65891);function s(){return(0,a.N)(n.g)}},48745:(e,t,i)=>{i.d(t,{A:()=>n});const n={entityRow:"ci11tAmTK1LnxThQkXPy",actions:"_2sJPwAAp1wY1Ftke6iFe",visibleAction:"yuNzasMLs7hvemHI4d8Q",active:"dNymWGRudMrTI6ot9FBg",title:"luWcW9hkbLdFxRQB0yGb",body:"abYR6tZoE7BdzThmWTb0",footer:"GOcKQxqNMhGzbGiAXBig",separator:"yFQjuDAhri_egM1pwn70",badges:"tykXaR_9v2wPQNrdPkK6",sixteenByNineContainer:"E2i9h7eyJn47xpv7p_PN",stretchImage:"fCudaI7y0gpf7EBPMLIR",largeImage:"uDQzuB2XvOEryRAL_Dre"}},53595:(e,t,i)=>{i.d(t,{e:()=>c});var n=i(17621),a=i(66408),s=i(40381),r=i(69146),o=i(19492),l=i(86070);const c=({images:e,breakpoint:t,type:i,name:c,style:u,...d})=>{const m=(0,r._)(),p=i===o.c.ARTIST||i===o.c.USER?a.u.CIRCLE:a.u.ROUNDED_CORNERS,g=t===n.e.SMALL?s.Qe.SIZE_64:s.Qe.SIZE_112;return(0,l.jsx)(a.b,{fadeIn:!0,images:m(e,s.BZ[g]),shape:p,size:g,iconSize:t===n.e.SMALL?"medium":"xlarge",type:i,title:c,loadingMode:"eager",style:u,...d})}},54861:(e,t,i)=>{i.d(t,{P:()=>n});const n=()=>!1},58542:(e,t,i)=>{i.d(t,{t:()=>s});var n=i(65891),a=i(41065);function s(){return(0,n.N)(a.Z)}},61384:(e,t,i)=>{i.d(t,{O:()=>c});var n=i(30758),a=i(50556),s=i(46058),r=i(9221),o=i(17154),l=i(86070);const c=()=>{const{spec:e,logger:t,UBIFragment:i}=(0,o.r)(a.J,{}),{uri:c}=(0,r.f)(),u=(0,n.useCallback)(((i,n)=>{const a=e.inviteButtonFactory().hitShare({entityToBeShared:i,shareId:n});t.logInteraction(a)}),[t,e]),d=(0,n.useCallback)((()=>{const i=e.endButtonFactory().hitUiReveal();t.logInteraction(i)}),[t,e]),m=(0,n.useCallback)((()=>{const i=e.leaveButtonFactory().hitUiReveal();t.logInteraction(i)}),[t,e]),p=(0,n.useCallback)((()=>{const i=e.facepileButtonFactory().hitUiNavigate({destination:s.S.PARTICIPANTS_PAGE});t.logInteraction(i)}),[t,e]),g=(0,n.useCallback)((t=>(0,l.jsx)(i,{spec:e,...t})),[i,e]);return{logInviteClick:u,logEndClick:d,logLeaveClick:m,logFacePileClick:p,logStartJam:(0,n.useCallback)((()=>{const i=e.createJamButtonFactory().hitUiNavigate({destination:c??""});t.logInteraction(i)}),[t,e,c]),UBIFragmentWithSpec:g}}},66610:(e,t,i)=>{i.d(t,{l:()=>m});var n=i(30758),a=i(97500),s=i.n(a);const r="x-toggle-wrapper",o="x-toggle-indicator",l="JCFCfOY_6UEZZSOO2xrl",c="x-toggle-indicatorWrapper",u="x-toggle-input";var d=i(86070);const m=(0,n.forwardRef)((({value:e,disabled:t,onSelected:i,onClick:n,id:a,className:m,condensed:p=!1},g)=>(0,d.jsxs)("label",{className:s()(r,m),onClick:n,children:[(0,d.jsx)("input",{id:a,className:u,type:"checkbox",disabled:t,checked:e,onChange:e=>{const t=e.target.checked;i(t)},ref:g}),(0,d.jsx)("span",{className:s()(c,{[l]:p}),children:(0,d.jsx)("span",{className:s()(o,{[l]:p})})})]})))},72292:(e,t,i)=>{i.d(t,{x:()=>o});var n=i(30758);const a=1,s=.5,r={threshold:[0,s,a]};function o({target:e}){const[t,i]=(0,n.useState)("visible_unknown");return(0,n.useEffect)((()=>{if(e){const t=new IntersectionObserver((([e])=>i((()=>e?e.intersectionRatio>=a?"visible_100":e.intersectionRatio>=s?"visible_50":e.intersectionRatio<s?"visible_0":"visible_unknown":"visible_unknown"))),r);return t.observe(e),()=>t.disconnect()}i("visible_unknown")}),[e]),{visibilityState:t}}},73740:(e,t,i)=>{i.d(t,{X:()=>c,$:()=>d});var n=i(94519),a=i(61186),s=i(38975),r=i(12496),o=i(93211);const l=["artistsets","artist-mix-reader","blend","daily-mix","daylist","discover-weekly","descripto","inspiredby-mix","on-repeat","release-radar","repeat-rewind","topic-mix"],c=e=>!!e&&l.includes(e),u=(e,t)=>"autoplay"===e.provider||!("context"!==e.provider||!c(t.metadata?.format_list_type)),d=(e,t)=>{const i=(0,n.$)(),l=(0,a.i)(e.uri),[c]=(0,s.A)(l),d=(0,o.g)();return(0,r.v)(e)&&t&&i&&e.uri===l&&!d?c?{canDisplayButton:u(e,t),hideButton:!0}:{canDisplayButton:u(e,t),hideButton:!1}:{canDisplayButton:!1,hideButton:!0}}},76776:(e,t,i)=>{i.d(t,{R:()=>n.R});var n=i(28994)},77841:(e,t,i)=>{i.d(t,{U:()=>r});var n=i(49358),a=i(48745),s=i(86070);const r=({children:e,lineClamp:t=2,...i})=>(0,s.jsx)(n.d,{lineClamp:t,as:"div",dir:"auto",className:a.A.title,...i,children:e})},82358:(e,t,i)=>{i.d(t,{a:()=>n.a});var n=i(42956)},83884:(e,t,i)=>{i.d(t,{d:()=>n});const n=e=>{const t=e?.metadata?.["dislike-endpoint"]??null;return{dislikeEndpoint:t,shouldShowFeedbackControls:"1"===e?.metadata?.["dislike-feedback-available"]&&null!==t}}},85706:(e,t,i)=>{i.d(t,{$:()=>a});var n=i(30758);const a=()=>{const[e,t]=(0,n.useState)(document.hasFocus());return(0,n.useEffect)((()=>{function e(){t(!0)}function i(){t(!1)}return window.addEventListener("focus",e),window.addEventListener("blur",i),()=>{window.removeEventListener("focus",e),window.removeEventListener("blur",i)}}),[]),e}},87389:(e,t,i)=>{i.d(t,{r:()=>c,z:()=>u});var n=i(30758),a=i(66590),s=i(5916),r=i(13625),o=i(96455),l=i(30675);function c(e=null){const{request:t}=(0,n.useContext)(o.j),{data:i}=(0,l.I)({queryKey:["extracted-color",e],queryFn:()=>e?(0,r.j)(t,e).then((([{colorDark:e,colorLight:t,colorRaw:i}])=>({colorDark:e.toCSS(s.a.HEX),colorLight:t.toCSS(s.a.HEX),colorRaw:i.toCSS(s.a.HEX)}))):null,gcTime:864e5,staleTime:216e5,enabled:!!e});return i??void 0}function u(e=null,t=a.l0o,i="colorRaw"){return c(e)?.[i]??t}},89115:(e,t,i)=>{i.d(t,{a:()=>M,k:()=>P});var n=i(30758),a=i(97500),s=i.n(a),r=i(17369),o=i(43726),l=i(87421),c=i(74396),u=i(42296),d=i(23736),m=i(29174),p=i(34172),g=i(96535),v=i(22529),x=i(68443),h=i(70719),b=i(17872),y=i(84706),f=i(615),j=i(65045),C=i(51185),w=i(94583),k=i(91030),S=i(55712);const N="eTT681T6oUKXsIMiP8pT",R="gwmgu53xszgwAXxqLT0h",E="fNXmHtlrj4UVWmhQrJ_5",I="XOSSUjLDKk9RRmiX_UWa",A="KILnOHUdx4pspVEoJ7kq",T="XNFZdOLgMlx491fEWdYJ",L="icNf66tgG3uxDMbCCIaN",D="NmIQ4hxBcXT8Bd7Abwdi",O="rkIl3GXeAGoK2gIX2zuj",F="j9Ey7DzF10wbxpBIVtcb";var U=i(86070);const B=({title:e,variant:t,semanticColor:i})=>(0,U.jsx)(b.r,{title:e,children:(0,U.jsx)(r.E,{as:"h1",dir:"auto",variant:t,semanticColor:i,children:e||""})},e||""),P=({link:e,title:t,item:i,panelLinkRef:n,variant:a,semanticColor:r,className:o,hasNPVCloseButton:l})=>{const{spec:c,logger:m}=(0,S.D)(u.J,{}),p=(0,d.o_h)(e),x=p?.toURI(),b=!(!x||!t),y=b?[x]:[],f=(0,v.H)(x),{draggable:j,onDragStart:C}=(0,w.P)({itemUris:y,dragLabelText:t??""});return(0,U.jsx)(g.h,{menu:f,children:(0,U.jsx)("div",{className:s()(N,o,{[F]:l}),children:e&&t?(0,U.jsx)(h.N,{ref:n,draggable:j&&b,onDragStart:b?C:void 0,to:e,search:i?`?uid=${i.uid}&uri=${i.uri}`:void 0,className:R,onClick:()=>{m.logInteraction(c.contextLinkFactory().hitUiNavigate({destination:e||""}))},children:(0,U.jsx)(B,{title:t,variant:a,semanticColor:r})}):(0,U.jsx)(B,{title:t,variant:a,semanticColor:r})})})},_=j.$S.PANEL_CLOSE_CLICK,M=({link:e,title:t,titleSlot:i,actions:a,onClose:r,className:u,panelLinkRef:d,preventDefaultClose:g=!1,onBack:v,item:h,titleVariant:b="bodyMediumBold",titleSemanticColor:j="textBase"})=>{const w=(0,f._Y)(),S=(0,f.Ev)(_),N=(0,f.XB)()===C.Z.NowPlayingView,R=(0,y.h)(),F=(0,n.useDeferredValue)(N),B=(0,n.useCallback)((()=>{r?.(),g||w(_)}),[r,g,w]),M=null!==h&&(0,k.N)(h);return(0,U.jsx)(n.Suspense,{fallback:null,children:(0,U.jsxs)("div",{className:s()(E,u,{[A]:N}),children:[v&&(0,U.jsx)("span",{className:s()(L,D),children:(0,U.jsx)(x.Zp,{label:m.Ru.get("desktop.login.Back"),children:(0,U.jsx)(p.a,{ariaLabel:m.Ru.get("desktop.login.Back"),size:"sm",onClick:v,icon:o.g})})}),F&&(0,U.jsx)(p.a,{icon:l.t,size:"sm",onClick:B,ariaLabel:m.Ru.get("web-player.now-playing-view.hide"),className:O}),i||(0,U.jsx)(P,{title:t,panelLinkRef:d,item:h,link:e,variant:b,semanticColor:j}),(0,U.jsxs)("span",{className:s()(L,I),children:[a,!M&&!N&&!R&&(0,U.jsx)("div",{"data-testid":"PanelHeader_CloseButton",children:(0,U.jsx)(x.Zp,{label:m.Ru.get("close"),children:(0,U.jsx)(p.a,{ariaLabel:m.Ru.get("close"),className:T,size:"sm",onClick:B,icon:c.M,disabled:!S})})})]})]})})}},94445:(e,t,i)=>{i.d(t,{C:()=>s});var n=i(13932),a=i(32040);const s=()=>(0,n.NC)(a.f9,{loadingValue:!0})},94519:(e,t,i)=>{i.d(t,{$:()=>r});var n=i(13932),a=i(32897),s=i(32040);const r=()=>{const e=(0,a.j)(),t=(0,n.NC)(s.en,{loadingValue:!1});return e.getCapabilities().canBan&&t}},95404:(e,t,i)=>{i.d(t,{PanelSection:()=>xg});var n=i(30758),a=i(94079),s=i(13932),r=i(74297),o=(i(32807),i(97500)),l=i.n(o),c=i(17369),u=(i(62895),i(4127)),d=i(77676),m=i(33957),p=i(89115),g=i(51185),v=i(28191),x=i(28155),h=i(24010);const b="Xq5xnpTOsoPxFR95BkTU",y="N7OMJte9T4Lv7DDX16ky",f="s6WrZvnP8euCyqjUm0Uk",j="NJATxQbY2o4sl0BHxU3T";var C=i(86070);const w=({children:e,className:t,...i})=>{const a=(0,n.useRef)(null),{breakpoint:s}=(0,h.c)({[v.E.SMALL]:0,[v.E.MEDIUM]:448,[v.E.LARGE]:780},a);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(p.a,{panel:g.Z.Puffin,className:l()(y,t),...i}),(0,C.jsx)(m.w,{className:f,ref:a,children:(0,C.jsx)(x.o.Provider,{value:s,children:e})})]})};let k=function(e){return e.Overview="overview",e.ActivationIntro="activationIntro",e.ActivationDetection="activationDetection",e.ActivationSignifiers="activationSignifiers",e.Error="error",e.ManualSelection="manualSelection",e.AirpodsSelection="airpodsSelection",e.DiscoverLossless="discoverLossless",e.IncompatibleHeadphones="incompatibleHeadphones",e}({}),S=function(e){return e.GetStarted="getStarted",e.OnError="onError",e.SelectManually="selectManually",e.Continue="continue",e.Close="close",e.Activate="activate",e.SetupNewDevice="setupNewDevice",e.NotFound="notFound",e.OnboardLossless="onboardLossless",e.Details="details",e.Airpods="airpods",e}({});var N=i(615),R=i(53129);const E=[k.ActivationIntro,k.ActivationDetection,k.ActivationSignifiers,k.ManualSelection,k.AirpodsSelection],I=e=>{const t=(0,n.useRef)(!1),i=(0,R.z)(),a=(0,N.XB)();(0,n.useEffect)((()=>{const n=i.getState()?.isPaused,s=(r=e,o=a,E.includes(r)&&(o===g.Z.PuffinActivation||o===g.Z.PuffinActivationOverlay));var r,o;!s||n||t.current?!s&&n&&t.current&&(i.resume({featureIdentifier:"birdhouse"}),t.current=!1):(i.pause({featureIdentifier:"birdhouse"}),t.current=!0)}),[a,e,i])},A={[k.Overview]:{[S.GetStarted]:k.ActivationIntro,[S.OnError]:k.Error,[S.SelectManually]:k.ManualSelection,[S.OnboardLossless]:k.DiscoverLossless},[k.ActivationIntro]:{[S.Close]:k.Overview,[S.OnError]:k.Error,[S.Continue]:k.ActivationDetection,[S.SelectManually]:k.ManualSelection,[S.Activate]:k.Overview},[k.ActivationDetection]:{[S.SelectManually]:k.ManualSelection,[S.Airpods]:k.AirpodsSelection,[S.Close]:k.Overview,[S.OnError]:k.Error,[S.Continue]:k.ActivationSignifiers},[k.ActivationSignifiers]:{[S.Close]:k.Overview,[S.OnError]:k.Error,[S.Activate]:k.Overview},[k.ManualSelection]:{[S.Continue]:k.ActivationSignifiers,[S.Close]:k.Overview,[S.OnError]:k.Error,[S.NotFound]:k.IncompatibleHeadphones},[k.AirpodsSelection]:{[S.Continue]:k.ActivationSignifiers,[S.Close]:k.Overview,[S.OnError]:k.Error,[S.NotFound]:k.Error},[k.DiscoverLossless]:{[S.Continue]:k.Overview},[k.Error]:{},[k.IncompatibleHeadphones]:{[S.Close]:k.Overview,[S.OnError]:k.Error,[S.Continue]:k.Overview}},T=(0,n.createContext)({currentView:k.Overview,viewTransitions:A,setCurrentView:()=>{},toPreviousView:()=>{},viewOptions:null}),L=({children:e})=>{const t=(0,N.XB)(),[i,a]=(0,n.useState)((()=>(e=>[{view:e===g.Z.PuffinActivation||e===g.Z.PuffinActivationOverlay?k.ActivationDetection:k.Overview,options:{}}])(t))),s=(0,n.useCallback)(((e,t)=>{e===k.Overview?a([{view:e,options:t??{}}]):a((i=>[...i,{view:e,options:t??{}}]))}),[]),r=(0,n.useCallback)((()=>{a((e=>e.slice(0,-1)))}),[]);if(0===i.length)throw new Error("Puffin view state stack should never be empty");const{view:o,options:l}=i.at(-1);I(o);const c=(0,n.useMemo)((()=>({currentView:o,viewOptions:l,setCurrentView:s,toPreviousView:r,viewTransitions:A})),[o,s,r,l]);return(0,C.jsx)(T.Provider,{value:c,children:e})},D="EqLKhgGIINyN_LINFjl1",O="OyIY0v1_h3UWgLlxyPHL",F=({resetError:e})=>{const{toPreviousView:t,setCurrentView:i}=(0,n.useContext)(T);return(0,C.jsx)(w,{onBack:()=>{t()},children:(0,C.jsxs)("div",{className:D,children:[(0,C.jsx)(u.b,{size:"xlarge",semanticColor:"textBase"}),(0,C.jsxs)("div",{className:O,children:[(0,C.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",children:"Something went wrong"}),(0,C.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:"We couldn’t turn on your headphone tools."})]}),(0,C.jsx)(d.$,{colorSet:"invertedLight",size:"medium",onClick:()=>{e?.(),i(k.Overview)},children:"Retry"})]})})},U=({resetError:e})=>(0,C.jsx)(F,{resetError:e});var B=i(96931),P=i(62411),_=i(29174),M=i(26038),H=i(33760),V=i(32002),z=i(82836),q=i(1473),G=i(41097);const Q=()=>{const e=(0,P.d4)((e=>e.platform.isDesktop)),t=(0,H.b)(),i=(0,M.lS)(t),{isPlayingRemotely:a,remoteDeviceName:s,isConnected:r}=(0,z.v)((e=>{const t=(0,V.V)(e);return{isPlayingRemotely:t.isPlayingRemotely,remoteDeviceName:t.remoteDevice?.name,isConnected:t.connectionStatus===q.zP.CONNECTED}}),G.a),o=(0,n.useMemo)((()=>e?_.Ru.get("web-player.connect.device-picker.this-computer"):_.Ru.get("web-player.connect.device-picker.this-web-browser")),[e]),l=(0,n.useMemo)((()=>{if(t)return e?_.Ru.get("web-player.connect.device-picker.from-this-computer",{device_name:t.name}):_.Ru.get("web-player.connect.device-picker.from-this-web-browser",{device_name:t.name})}),[e,t]);if(s&&a&&r)return{deviceName:s,playingFrom:s};if(t?.transportType===M.Yg.AIRPLAY||t?.transportType===M.Yg.BLUETOOTH&&t?.terminalType===M.FI.SPEAKERS)return{deviceName:t?.name,playingFrom:o,formattedDeviceName:l};if(i){if(t?.transportType===M.Yg.BUILT_IN||t?.transportType===M.Yg.USB)return{deviceName:_.Ru.get("web-player.puffin.wired-connection"),playingFrom:o};if(t?.name&&t?.terminalType===M.FI.HEADPHONES)return{deviceName:t?.name,playingFrom:o,formattedDeviceName:l}}return{deviceName:o,playingFrom:o}},Y=()=>{const{deviceName:e}=Q();return(0,C.jsx)(c.E,{variant:"bodyMediumBold",semanticColor:"textSubdued",children:e})};var W=i(65045);const Z=()=>null;var K=i(54861),X=i(30024),J=i(35638),$=i(93727);const ee="PYLIWbzDyJA6Mbh2EQQg",te="GkHvzcvpGO5jTMSKlWkc",ie="r3oTh3jKov0cW3m5qF1N",ne=({title:e,subtitle:t,buttonLabel:i,onClick:a,dismissButtonLabel:s,onDismissClick:r,focusTransferKey:o=null})=>{const l=(0,n.useRef)(null);return(0,$.X)(o,l),(0,C.jsx)(X.v,{variant:"naked",size:"lg",id:"getStarted",title:e,subtitle:t,padding:"16px",className:ee,footer:(0,C.jsxs)("div",{className:te,children:[(0,C.jsx)(d.$,{size:"small",onClick:a,ref:l,colorSet:"inverted",children:(0,C.jsx)(c.E,{variant:"bodySmallBold",children:i})}),s&&r&&(0,C.jsx)(J.H,{className:ie,size:"small",onClick:r,children:(0,C.jsx)(c.E,{variant:"bodySmallBold",children:s})})]})})};var ae=i(69229),se=i(49358),re=i(61150);var oe=i(29752);const le=()=>{const e=(0,oe.A)(),t=(e=>{switch(e){case re.Yn.LOSSLESS_24:return{title:_.Ru.get("web-player.pigeon.audio-quality.lossless"),titleFull:_.Ru.get("web-player.pigeon.audio-quality.lossless-24.label"),bitrateLabel:_.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate"),bitrateDetails:[_.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-1"),_.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-2")]};case re.Yn.LOSSLESS:return{title:_.Ru.get("web-player.pigeon.audio-quality.lossless"),titleFull:_.Ru.get("web-player.pigeon.audio-quality.lossless-16.label"),bitrateLabel:_.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate"),bitrateDetails:[_.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate-details-1"),_.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate-details-2")]};case re.Yn.VERY_HIGH:return{title:_.Ru.get("web-player.pigeon.audio-quality.very-high.label"),bitrateLabel:_.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate"),bitrateDetails:[_.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate-details")]};case re.Yn.HIGH:return{title:_.Ru.get("web-player.pigeon.audio-quality.high.label"),bitrateLabel:_.Ru.get("web-player.pigeon.audio-quality.high.bitrate"),bitrateDetails:[_.Ru.get("web-player.pigeon.audio-quality.high.bitrate-details")]};case re.Yn.NORMAL:return{title:_.Ru.get("web-player.pigeon.audio-quality.normal.label"),bitrateLabel:_.Ru.get("web-player.pigeon.audio-quality.normal.bitrate"),bitrateDetails:[_.Ru.get("web-player.pigeon.audio-quality.normal.bitrate-details")]};case re.Yn.LOW:return{title:_.Ru.get("web-player.pigeon.audio-quality.low.label"),bitrateLabel:_.Ru.get("web-player.pigeon.audio-quality.low.bitrate"),bitrateDetails:[_.Ru.get("web-player.pigeon.audio-quality.low.bitrate-details")]};case re.Yn.UNKNOWN:default:return{title:_.Ru.get("web-player.pigeon.audio-quality.unknown.label"),bitrateLabel:null}}})(e),i=e===re.Yn.LOSSLESS||e===re.Yn.LOSSLESS_24;return(0,C.jsx)(X.v,{id:"qualityV2",pretitle:_.Ru.get("web-player.pigeon.audio-quality.file-quality"),title:(0,C.jsx)(se.d,{lineClamp:2,variant:"titleSmall",semanticColor:"textBrightAccent",children:t.titleFull||t.title}),subtitle:i&&t.bitrateDetails?.map(((e,t)=>(0,C.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBrightAccent",children:e},`bitrate-details-${t}`)))})};var ce=i(7371),ue=i(34074),de=i(99454),me=i(41443);const pe=(e=de.a.AUDIO_QUALITY_STEAMING)=>{const t=(0,me.g)();return(0,n.useCallback)((()=>{t(`/preferences?highlight=${e}`)}),[e,t])},ge="hJ2UuUhdLid7OxDkPzK5",ve="S54KbBEh90RF5pzJd8m2",xe="_mHoKKYy00yUQszf1BOy",he=()=>{const e=pe();return(0,C.jsx)(X.v,{className:xe,id:"changeSettings",size:"md",leading:(0,C.jsx)(ce.s,{semanticColor:"textSubdued",size:"small"}),title:(0,ue.v)("Change quality settings"),onClick:e})},be=()=>(0,C.jsxs)(ae.a,{variant:"naked",padding:"tighter-2",className:ge,children:[(0,C.jsx)(le,{}),(0,C.jsx)("div",{className:ve}),(0,C.jsx)(he,{})]});var ye=i(84040);const fe=()=>(0,ye.x)("onboarding-dismissed:lossless",!1);var je=i(24889),Ce=i(43026);const we=({spec:e})=>{const t=(0,Ce.s)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(T),s=a[k.Overview],r=(0,je.j)(),[o]=fe();return r?(0,C.jsxs)(C.Fragment,{children:[!o&&(0,C.jsx)(ne,{title:_.Ru.get("web-player.pigeon.get-started.title"),subtitle:_.Ru.get("web-player.pigeon.get-started.subtitle"),buttonLabel:_.Ru.get("web-player.pigeon.get-started.button"),onClick:()=>{t.logInteraction(e.losslessOnboardingButtonFactory().hitUiReveal()),i(s.onboardLossless)}}),(0,C.jsx)(be,{})]}):null},ke="bLEXMWOER6nmfeLfBRIN",Se="zZwkZyyhSv9h7BTbmZDt",Ne="jqGbXZxxmrSK5hMvbgtd",Re="miut1T8p2NcOXDYoNr1D",Ee="vb_sTwQZJfzXXNYmB4KE",Ie=({spec:e})=>{const t=(0,Ce.s)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(T),s=a[k.Overview];return(0,C.jsx)(X.v,{className:Ee,id:"changeModel",size:"md",leading:(0,C.jsx)(ce.s,{semanticColor:"textSubdued",size:"small"}),title:_.Ru.get("web-player.puffin.listening-with.change-model"),onClick:()=>{t.logInteraction(e.changeModelButtonFactory().hitUiReveal()),i(s.selectManually)}})};var Ae=i(70337);const Te=()=>{const{deviceFilterState:e}=(0,Ae.j)();return(0,C.jsx)(X.v,{id:"modelRow",size:"md",pretitle:_.Ru.get("web-player.puffin.listening-with.model"),horizontalGap:"0px",isInteractive:!1,title:(0,C.jsx)(se.d,{lineClamp:2,children:e.headphoneDevice?.deviceName??_.Ru.get("web-player.puffin.listening-with.placeholder-model")})})};var Le=i(4351),De=i(55852);const Oe=({title:e,description:t,confirmButtonText:i="OK",cancelButtonText:a="Cancel",onConfirm:s,onClose:r})=>{const{setCurrentView:o}=(0,n.useContext)(T),l=(0,N._Y)(),[c,u]=(0,n.useState)(!1),d=(0,n.useRef)(!1);return{dialog:c?(0,C.jsx)(De.T,{onClose:()=>{u(!1),r?.()},onConfirm:()=>{s(),d.current?l(W.$S.PUFFIN_BUTTON_CLICK):o(k.Overview)},titleText:e,"aria-label":e,descriptionText:t,cancelText:a,confirmText:i}):null,triggerDialog:(e=!1)=>{d.current=e,u(!0)}}};var Fe=i(44298);const Ue=()=>{const e=(0,Fe.N)();return{setCurrentDevice:(0,n.useCallback)(((t,i)=>{e.setCurrentDevice(t,i)}),[e]),removeCurrentDevice:(0,n.useCallback)((t=>{e.removeCurrentDevice(t)}),[e])}},Be=({spec:e})=>{const{triggerDialog:t,dialog:i,ref:a}=(()=>{const e=(0,n.useRef)(null),{removeCurrentDevice:t}=Ue();(0,$.X)("RESET_HEADPHONES_BUTTON",e);const{triggerDialog:i,dialog:a}=Oe({title:_.Ru.get("web-player.puffin.reset-headphones.dialog.title"),description:_.Ru.get("web-player.puffin.reset-headphones.dialog.subtitle"),confirmButtonText:_.Ru.get("web-player.puffin.reset-headphones.dialog.confirm"),onConfirm:()=>{t(!0),(0,$.I)("SETUP_HEADPHONES_BUTTON")},onClose:()=>{(0,$.I)("RESET_HEADPHONES_BUTTON")}});return{triggerDialog:i,dialog:a,ref:e}})(),s=(0,Ce.s)();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(X.v,{ref:a,className:Ee,id:"resetHeadphones",size:"md",leading:(0,C.jsx)(Le.x,{semanticColor:"textSubdued",size:"small"}),title:_.Ru.get("web-player.puffin.reset-headphones.menu-item"),onClick:i=>{s.logInteraction(e.resetHeadphonesButtonFactory().hitUiReveal()),i.preventDefault(),t(!1)}}),i]})};var Pe=i(66610);const _e=()=>(0,C.jsx)(X.v,{id:"filterError",variant:"naked",size:"sm",leading:(0,C.jsx)(u.b,{semanticColor:"textSubdued",size:"small"}),title:_.Ru.get("web-player.puffin.error-troubleshooting")}),Me=({currentDeviceState:e,spec:t,isError:i})=>{const a=(0,Ce.s)(),s=(0,n.useCallback)((()=>{a.logInteraction(t.optimizeToggleFactory().hitUiElementToggle()),e.toggleTuneHeadphones?.()}),[e,a,t]),r=null!==e.toggleTuneHeadphones,{specificRestricted:o,processingCapabilitiesRestricted:l}=e.contentRestrictions,c=(0,n.useMemo)((()=>o||l?_.Ru.get("web-player.puffin.enhancement-unavailable.content-restriction"):(r||_.Ru.get("web-player.puffin.listening-with.filters.specific-subtitle-unavailable"),_.Ru.get("web-player.puffin.listening-with.filters.specific-subtitle"))),[r,l,o]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(X.v,{size:"md",id:"headphones",className:Ne,disabled:o||l||!r||i,title:(0,C.jsx)(se.d,{className:Re,children:_.Ru.get("web-player.puffin.listening-with.filters.specific-title")}),subtitle:c,trailing:(0,C.jsx)(Pe.l,{id:"headphoneTunes",onSelected:s,disabled:o||l||i,value:e.currentState.specificEnabled,condensed:!0})}),i&&(0,C.jsx)(_e,{})]})},He=({spec:e})=>{const{deviceFilterState:t,isError:i}=(0,Ae.j)(),n=t.isOnboarded;return(0,C.jsxs)(ae.a,{variant:"naked",padding:"tighter-2",className:ke,children:[(0,C.jsx)(Te,{}),n&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{className:Se}),(0,C.jsx)(Me,{currentDeviceState:t,spec:e,isError:i}),(0,C.jsx)("div",{className:Se}),(0,C.jsx)(Ie,{spec:e}),(0,C.jsx)(Be,{spec:e})]})]})},Ve=({spec:e})=>{const{setCurrentView:t,viewTransitions:i}=(0,n.useContext)(T),a=i[k.Overview],{deviceFilterState:s,isMaybeHeadphoneDevice:r,isLoading:o}=(0,Ae.j)(),l=(0,Ce.s)(),{triggerDialog:c,dialog:u,isHiddenByUser:d}=(()=>{const{deviceFilterState:e}=(0,Ae.j)(),t=e.audioDevice?.id,[i,a]=(0,ye.x)("puffin-hide-get-started",[]),s=(0,n.useMemo)((()=>!!t&&i.includes(t)),[t,i]),r=(0,n.useCallback)((()=>{if(t){const e=[...i,t].slice(-50);a(e)}}),[t,a,i]);return{...Oe({title:_.Ru.get("web-player.puffin.dismiss-get-started.title"),description:_.Ru.get("web-player.puffin.dismiss-get-started.body"),confirmButtonText:_.Ru.get("hifi.yes"),cancelButtonText:_.Ru.get("web-player.puffin.dismiss-get-started.cancel"),onConfirm:()=>{r()}}),isHiddenByUser:s}})(),m=s.isOnboarded,p=r&&!m&&!d,g=(0,n.useCallback)((()=>{l.logInteraction(e.setupHeadphonesButtonFactory().hitUiReveal()),s.audioDevice?t(a.getStarted):t(a.selectManually,{showDialogOnBack:!0})}),[l,e,s.audioDevice,t,a.getStarted,a.selectManually]);return!r||o?null:(0,C.jsxs)(C.Fragment,{children:[u,m&&(0,C.jsx)(He,{spec:e}),p&&(0,C.jsx)(ne,{title:_.Ru.get("web-player.puffin.get-started.title"),subtitle:_.Ru.get("web-player.puffin.get-started.subtitle"),buttonLabel:_.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm"),onClick:g,dismissButtonLabel:_.Ru.get("web-player.puffin.upsell.enhance-headphones.not-headphones"),onDismissClick:c,focusTransferKey:"SETUP_HEADPHONES_BUTTON"})]})};var ze=i(28873),qe=i(17154);const Ge="TJAbLKl8aSWZqWk4EFkk",Qe=W.$S.DEVICE_PICKER_BUTTON_CLICK,Ye=()=>{const e=(0,V.l)(),{panelSend:t}=(0,N.AI)(g.Z.DevicePicker,g.Z.DevicePickerOverlay),i=(0,K.P)(),a=(0,je.j)(),s=(0,ze.v)(),{spec:r,logger:o}=(0,qe.r)(B.R,{}),l=!e&&s,c=(0,n.useCallback)((()=>{o.logInteraction(r.backButtonFactory().hitUiReveal()),t(Qe)}),[o,t,r]);return(0,C.jsx)(w,{onBack:c,onClose:()=>{o.logInteraction(r.closeButtonFactory().hitUiHide())},titleSlot:(0,C.jsx)(Y,{}),children:(0,C.jsxs)("div",{className:Ge,children:[i&&(0,C.jsx)(n.Suspense,{fallback:null,children:(0,C.jsx)(Z,{})}),l&&(0,C.jsx)(Ve,{spec:r}),a&&(0,C.jsx)(we,{spec:r})]})})};var We=i(26953),Ze=i(53702),Ke=i(48330);const Xe="GYa976HrK40QHF7ZZvwM",Je="MHROZzo24FoePahYMEFJ",$e="qQ5CfbxUDYyLgy_O6Gah",et=({nrSteps:e,currentStep:t,onClick:i})=>(0,C.jsx)("div",{className:Xe,children:Array.from({length:e}).map(((e,n)=>(0,C.jsx)("button",{"aria-label":(0,ue.v)(`Go to Step ${n+1}`),className:l()(Je,{[$e]:t===n}),onClick:()=>i(n)},n)))});var tt=i(24818),it=i(21042),nt=i(70773),at=i(69146);const st="Vpnd2l8y0SgEYWxGIRzB",rt="cUTxS9VrHd466oEAGs7_",ot="JvZLieWRZZQjIU2ElJ2Y",lt="ub90kjJH_P8M2r1QL_jL",ct="U3xgLhEWHrv2mb_ZSesP",ut="ZiS7XuaKSNH6O814jzTW",dt="W8RJgFmuCgvRsxpnXMWG",mt="pAYPkrJQFNaLczxADAGc",pt="nBOyGCpnbwg691MCewBj",gt="hr6LueujvRuzxi6lBlVZ",vt="zwfOn0Sx4qfhn2imHyQ9",xt="UcHPiDY6dLRbaeY65j16",ht="KsS00iz9PKUXYN0PHhno",bt="h66wSXbM4f8lkj4EppJQ",yt=({imageUrl:e,max:t,alt:i=""})=>{const n=(0,at.dZ)();return(0,C.jsx)(nt._,{className:ct,src:n(e,t),loading:"eager",alt:i})};var ft=i(75793);const jt=({path:e,loop:t=!0})=>(0,C.jsx)(n.Suspense,{fallback:null,children:(0,C.jsx)(ft.o,{loop:t,autoplay:!0,path:e,className:lt,style:{width:"auto",height:"100%"}})});var Ct=i(29728);function wt({children:e,variant:t}){const i=(0,n.useRef)(null);return(0,Ct.i)({ref:i}),(0,C.jsx)(c.E,{variant:t,semanticColor:"textBase",className:pt,tabIndex:-1,ref:i,children:e})}const kt={[v.E.SMALL]:{titleVariant:"bodyMediumBold",subtitleVariant:"marginalBold",bodyVariant:"bodySmall",containerGap:0,headerGap:0,assetGap:8,subtitleGap:4,titleGap:4,buttonGap:12,assetMaxHeight:165},[v.E.MEDIUM]:{titleVariant:"titleSmall",subtitleVariant:"marginalBold",bodyVariant:"bodySmall",containerGap:16,headerGap:24,assetGap:24,subtitleGap:12,titleGap:8,buttonGap:24,assetMaxHeight:240},[v.E.LARGE]:{titleVariant:"titleMedium",subtitleVariant:"bodySmall",bodyVariant:"bodyMedium",containerGap:32,headerGap:32,assetGap:48,subtitleGap:16,titleGap:8,buttonGap:32,assetMaxHeight:320}},St="AOGvMtDLQNbo94n8r8mu",Nt=({icon:e,text:t,condensed:i=!1,className:n})=>(0,C.jsxs)("div",{className:l()(St,n),children:[(0,C.jsx)(e,{size:i?"xsmall":"small",semanticColor:"textBrightAccent"}),(0,C.jsx)(c.E,{variant:i?"marginalBold":"bodySmallBold",semanticColor:"textBrightAccent",children:t})]});var Rt=i(1133);const Et=({onboardingContent:e,onNext:t,onTertiaryClick:i,layout:s="vertical",showLoader:r=!1})=>{const{bodyTitle:o,bodySubtitle:u,bodyText:m,imageUrl:p,lottiePath:g,loopAnimation:h=!0,subtitleIcon:b,buttonText:y,tertiaryButtonText:f}=e,j=(0,x.y)(),{titleVariant:w,subtitleVariant:k,bodyVariant:S,containerGap:N,headerGap:R,assetGap:E,subtitleGap:I,titleGap:A,buttonGap:T,assetMaxHeight:L}=(0,n.useMemo)((()=>{let e=v.E.MEDIUM;switch(j){case v.E.SMALL:e=v.E.SMALL;break;case v.E.MEDIUM:e=v.E.MEDIUM;break;case v.E.LARGE:e=v.E.LARGE}return kt[e]}),[j]),D=(0,n.useRef)(null),O=(0,Rt.j)();return(0,C.jsx)(tt.A,{mode:"out-in",children:(0,C.jsx)(a.A,{timeout:O?0:800,classNames:{enter:vt,enterActive:xt,exit:ht,exitActive:bt},nodeRef:D,children:(0,C.jsx)("div",{className:st,style:{"--onboarding-container-gap":`${N}px`,"--onboarding-asset-gap":`${E}px`,"--onboarding-subtitle-gap":`${I}px`,"--onboarding-title-gap":`${A}px`,"--onboarding-button-gap":`${T}px`,"--onboarding-asset-max-height":`${L}px`,"--onboarding-header-gap":`${R}px`},ref:D,children:(0,C.jsxs)("div",{className:l()(rt,{[ut]:"horizontal"===s}),children:[(0,C.jsxs)("div",{className:ot,children:[p?(0,C.jsx)(yt,{imageUrl:p,max:L}):null,g?(0,C.jsx)(jt,{path:g,loop:h}):null]}),(0,C.jsxs)("div",{className:dt,children:[(0,C.jsx)(Nt,{icon:b,text:u,condensed:j!==v.E.LARGE,className:mt,variant:k}),(0,C.jsx)(wt,{variant:w,children:o}),(0,C.jsx)(c.E,{variant:S,children:m}),(0,C.jsx)("div",{className:gt,children:r?(0,C.jsx)(it.m,{}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(d.$,{colorSet:"invertedLight",size:j===v.E.LARGE?"medium":"small",onClick:t,children:y}),i&&f?(0,C.jsx)(J.H,{size:j===v.E.LARGE?"medium":"small",onClick:i,condensed:!0,children:e.tertiaryButtonText}):null]})})]})]})})},o)})};const It=({variant:e})=>(0,C.jsx)(c.E,{variant:e,semanticColor:"textBase",children:_.Ru.get("navbar.premium")}),At=()=>[{bodyTitle:_.Ru.get("web-player.pigeon.introduction.step-1.title"),bodySubtitle:"Lossless",bodyText:_.Ru.get("web-player.pigeon.introduction.step-1.subtitle"),subtitleIcon:Ze.Q,buttonText:_.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc00009256c4d947fba90f6244343446ee"},{bodyTitle:_.Ru.get("web-player.pigeon.introduction.step-2.title"),bodySubtitle:"Lossless",bodyText:_.Ru.get("web-player.pigeon.introduction.step-2.subtitle"),subtitleIcon:Ze.Q,buttonText:_.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc00005e4e6fd833f6f5c2cf4f81c1da66"},{bodyTitle:_.Ru.get("web-player.pigeon.introduction.step-3.title"),bodySubtitle:"Lossless",bodyText:_.Ru.get("web-player.pigeon.introduction.step-3.subtitle"),subtitleIcon:Ze.Q,buttonText:_.Ru.get("web-player.pigeon.introduction.button.done"),imageUrl:"spotify:image:ab671fcc000092564a451c0c1fba3acf8fed995f"}],Tt=()=>{const[e,t]=fe(),{setCurrentView:i,toPreviousView:a,viewTransitions:s}=(0,n.useContext)(T),{spec:r,logger:o}=(0,qe.r)(Ke.m,{}),l=pe(),c=s[k.DiscoverLossless],{onNext:u,onBack:d,currentStep:m,goTo:p}=function(e){const[t,i]=(0,n.useState)(0),[a,s]=(0,n.useState)(!1),r=(0,n.useCallback)((()=>{t!==e-1?i(t+1):s(!0)}),[t,e]),o=(0,n.useCallback)((()=>{0!==t&&i(t-1),a&&s(!1)}),[t,a]),l=(0,n.useCallback)((t=>{t>=0&&t<e&&i(t),t===e?s(!0):a&&s(!1)}),[e,a]);return{currentStep:t,onNext:r,onBack:o,reachedEnd:a,goTo:l}}(At().length),g=(0,n.useCallback)((()=>{o.logInteraction(r.closeButtonFactory().hitUiHide()),i(c.continue)}),[o,i,r,c.continue]);return(0,C.jsxs)(w,{titleSlot:(0,C.jsx)(It,{variant:"bodySmallBold"}),onBack:()=>{o.logInteraction(r.backButtonFactory().hitUiHide()),m>0?d():a()},onClose:g,preventDefaultClose:!0,children:[(0,C.jsx)(Et,{onboardingContent:At()[m],onNext:()=>{2===m?(o.logInteraction(r.doneButtonFactory().hitUiHide()),t(!0),i(c.continue),l()):u()}}),(0,C.jsx)(et,{nrSteps:At().length,currentStep:m,onClick:p})]})};var Lt=i(92760),Dt=i(72904),Ot=i(52379);const Ft=e=>({bodyTitle:_.Ru.get("web-player.puffin.activation-2.title",e.headphoneDevice?.deviceName),bodySubtitle:_.Ru.get("web-player.puffin.signifier-text"),lottiePath:(0,Ot.bj)("animations/puffin-onboarding-tour-2.json"),subtitleIcon:Dt.C,buttonText:_.Ru.get("web-player.puffin.activation-2.button-confirm"),tertiaryButtonText:_.Ru.get("web-player.puffin.activation-2.button-cancel"),loopAnimation:!1}),Ut=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(T),{deviceFilterState:i,isMaybeHeadphoneDevice:a,isLoading:s}=(0,Ae.j)(),r=t[k.ActivationDetection];(0,n.useLayoutEffect)((()=>{i.headphoneDevice||s||!a||e(k.ManualSelection,{showDialogOnBack:!0})}),[i.headphoneDevice,s,a,e]);const o=(0,n.useMemo)((()=>i?.wasAmbiguous),[i]);return(0,C.jsx)(Et,{onboardingContent:Ft(i),onNext:()=>{e(o?r.airpods:r.continue)},onTertiaryClick:()=>{e(r.selectManually)},showLoader:s||!i.headphoneDevice})},Bt=()=>{const{deviceFilterState:e,isLoading:t}=(0,Ae.j)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(T),s=a[k.ActivationIntro],r=(0,n.useCallback)((()=>{e.toggleTuneHeadphones?i(s.continue):i(s.selectManually,{showDialogOnBack:!0})}),[e,i,s.continue,s.selectManually]),o={bodyTitle:_.Ru.get("web-player.puffin.activation-1.title"),bodySubtitle:_.Ru.get("web-player.puffin.signifier-text"),lottiePath:(0,Ot.bj)("animations/puffin-onboarding-tour-1.json"),subtitleIcon:Dt.C,buttonText:_.Ru.get("web-player.puffin.activation-1.button")};return(0,C.jsx)(Et,{onboardingContent:o,onNext:r,showLoader:t||!e.audioDevice})};var Pt=i(98418),_t=i(44335);const Mt=e=>{const{deviceFilterState:t}=(0,Ae.j)(),{setCurrentDevice:i}=Ue(),a=(0,Pt.vh)(),{setCurrentView:s}=(0,n.useContext)(T),r=(0,n.useCallback)((async()=>{i(t.headphoneDevice,!0);try{await t.setFilterState({specificEnabled:!!t.toggleTuneHeadphones,externalizationEnabled:!!t.toggleTuneStudio})}catch{return void s(k.Error)}((e,t)=>{e.send((0,_t.d)({has_tuner:!!t.toggleTuneHeadphones,filter_brand:t.headphoneDevice?.brand??null,filter_model:t.headphoneDevice?.model??null,was_predicted:!!t.predictedState,headphone_name_over_bluetooth:t.audioDevice?.transportType===M.Yg.BLUETOOTH?t.audioDevice.name:null,external_accessory_mapping_predicted_brand:t.predictedState?.predictedBrand??null,external_accessory_mapping_predicted_model:t.predictedState?.predictedModel??null,was_matched:(t.predictedState?.wasMatched&&!t.headphoneDevice?.isAmbiguous)??!1,was_ambiguous:t.headphoneDevice?.isAmbiguous??!1,was_manually_selected:(t.headphoneDevice?.isAmbiguous||t.headphoneDevice?.wasSelectedManually)??!1}))})(a,t),e()}),[t,a,e,i,s]);return{handleClick:r}},Ht=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(T),{spec:i,logger:a}=(0,qe.r)(Lt.i,{}),s=t[k.ActivationSignifiers],{handleClick:r}=Mt((()=>{a.logInteraction(i.doneButtonFactory().hitUiHide()),e(s.activate)}));return(0,C.jsx)(Et,{onboardingContent:{bodyTitle:_.Ru.get("web-player.puffin.activation-3.title"),bodySubtitle:_.Ru.get("web-player.puffin.signifier-text"),bodyText:_.Ru.get("web-player.puffin.activation-3.subtitle"),imageUrl:"spotify:image:ab671fcc00005e4ed89275c5e4eef1d432ac3fe2",subtitleIcon:Dt.C,buttonText:_.Ru.get("web-player.puffin.button.done"),loopAnimation:!0},onNext:r})},Vt="FcycLYpZEbmuEClARSPP",zt="NSoA0u_DehEmTu_M20Qn",qt="fGnSEIwIPGid9ALC9ANP",Gt="ZknipG1So_RdKeJ911k3",Qt=({number:e,message:t})=>(0,C.jsxs)("div",{className:qt,children:[(0,C.jsx)("div",{className:Gt,children:(0,C.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBase",children:e})}),(0,C.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:t})]}),Yt=()=>{const{setCurrentView:e}=(0,n.useContext)(T);return(0,C.jsxs)("div",{className:Vt,children:[(0,C.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",children:_.Ru.get("web-player.puffin.device-connection-lost.title")}),(0,C.jsxs)("div",{className:zt,children:[(0,C.jsx)(Qt,{number:1,message:_.Ru.get("web-player.puffin.device-connection-lost.tip-1")}),(0,C.jsx)(Qt,{number:2,message:_.Ru.get("web-player.puffin.device-connection-lost.tip-2")}),(0,C.jsx)(Qt,{number:3,message:_.Ru.get("web-player.puffin.device-connection-lost.tip-3")}),(0,C.jsx)(Qt,{number:4,message:_.Ru.get("web-player.puffin.device-connection-lost.tip-4")})]}),(0,C.jsx)(J.H,{semanticColor:"textSubdued",onClick:()=>{e(k.Overview)},children:"Still not working"})]})},Wt=()=>{const{removeCurrentDevice:e}=Ue();return Oe({title:_.Ru.get("web-player.puffin.activation-dialog.title"),description:_.Ru.get("web-player.puffin.activation-dialog.subtitle"),confirmButtonText:_.Ru.get("web-player.puffin.activation-dialog.button-cancel"),cancelButtonText:_.Ru.get("web-player.puffin.activation-dialog.button-confirm"),onConfirm:()=>{e(!0),(0,$.I)("SETUP_HEADPHONES_BUTTON")}})},Zt=({type:e})=>{const{isMaybeHeadphoneDevice:t}=(0,Ae.j)(),{spec:i,logger:a}=(0,qe.r)(Lt.i,{}),{triggerDialog:s,dialog:r}=Wt(),o=(0,n.useCallback)((()=>{a.logInteraction(i.closeButtonFactory().hitUiHide()),s(!0)}),[a,i,s]),l=(0,n.useCallback)((()=>{a.logInteraction(i.backButtonFactory().hitUiReveal()),s(!1)}),[a,i,s]);return(0,C.jsx)(w,{titleSlot:(0,C.jsx)(It,{variant:"bodySmallBold"}),onClose:o,onBack:l,preventDefaultClose:!0,children:t?(0,C.jsxs)(C.Fragment,{children:[r,"intro"===e&&(0,C.jsx)(Bt,{}),"detection"===e&&(0,C.jsx)(Ut,{}),"signifiers"===e&&(0,C.jsx)(Ht,{})]}):(0,C.jsx)(Yt,{})})};i(54615);var Kt=i(28515),Xt=i(17512),Jt=i(36948),$t=i(98809),ei=i(13003),ti=i(99853);const ii=({device:e,onClick:t,isAirpodDevice:i})=>{const n=i?`${e.model} (${e.releaseYear})`:e.model,a=i?_.Ru.get("web-player.puffin.manual-selection.models-list",e.modelNumbers.join(_.Ru.getSeparator())):e.brand;return(0,C.jsx)(ti.c,{children:(0,C.jsx)(X.v,{variant:"naked",size:"md",isInteractive:!0,id:e.id,title:(0,C.jsx)(se.d,{onClick:()=>{t(e)},children:n}),subtitle:a,trailing:(0,C.jsx)(ei.V,{size:"small",semanticColor:"textSubdued"}),onClick:()=>{t(e)},hoverAnimationDuration:"0s"},e.id)})},ni={container:"xf1SndiROslLiaLieC6b",listContainer:"fjltNoIqUMIY7LfgtvCH",headerContainer:"WNi2uq00PuqJnOvv6b6a",titleContainer:"T3zyYZ33nGeJfw6NgwwV",notListed:"fr_QT3qQxce_KdFUhktQ",deviceList:"wMsnDxvKohBJOUguxi8p",loading:"O842FkxrdjAlid2byB9c",emptyState:"E6yKOmbA9ekxMnRhJDnA",textContainer:"sm96uN6u5WGLjNfbT6kF",queryContainer:"bWJ8TFqqyCV4TqeScz7D",query:"SRl_K6g2YOd8qrpIFij7"},ai=({search:e})=>(0,C.jsxs)("div",{className:ni.emptyState,children:[(0,C.jsx)(c.E,{semanticColor:"textBase",variant:"titleSmall",className:ni.textContainer,children:_.Ru.get("web-player.puffin.manual-selection.empty.title",(0,C.jsx)("span",{className:ni.queryContainer,children:(0,C.jsx)("span",{className:ni.query,children:e})}))}),(0,C.jsx)(c.E,{semanticColor:"textSubdued",variant:"bodySmall",children:_.Ru.get("web-player.puffin.manual-selection.empty.subtitle")})]}),si={id:"unknown_device",brand:"",model:"",deviceName:"Generic",modelNumbers:[],releaseYear:""},ri=({devices:e,isAirpodsList:t=!1})=>{const{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(T),s=t?a[k.AirpodsSelection]:a[k.ManualSelection],{filter:r,setFilter:o}=(0,n.useContext)(Xt.g),{setCurrentDevice:l}=Ue(),c=(0,n.useCallback)((e=>{const n=e?{...e,wasSelectedManually:!0,isAmbiguous:t}:null;l(n,!0),i(e?.id===si.id?s.notFound:s.continue),o("")}),[t,l,i,s.notFound,s.continue,o]),u=e.filter((({deviceName:e,brand:t,model:i,modelNumbers:n})=>[e,t,i,...n].some((e=>e.toLowerCase().includes(r.toLowerCase())))));return(0,C.jsxs)("div",{className:ni.deviceList,children:[(0,C.jsx)($t.$,{children:u.map((e=>(0,C.jsx)(ii,{device:e,onClick:c,isAirpodDevice:t},e.id)))}),0===u.length&&(0,C.jsx)(ai,{search:r}),(0,C.jsx)("div",{className:ni.notListed,children:(0,C.jsx)(Jt.n,{size:"small",onClick:()=>{c(si)},children:_.Ru.get("web-player.puffin.manual-selection.not-found-button")})})]})};var oi=i(30675);const li=()=>{const e=(0,Fe.N)(),{data:t,isLoading:i,isError:n}=(0,oi.I)({queryKey:["puffin-devices"],queryFn:async()=>await e.getDevices(),gcTime:18e5,staleTime:6e5});return{data:t??null,loading:i,error:n}},ci=()=>{const{toPreviousView:e}=(0,n.useContext)(T),{data:t}=li(),i=(0,n.useMemo)((()=>t?.filter((e=>"apple"===e.brand.toLowerCase()&&e.model.toLowerCase().includes("airpods")))),[t]);return(0,C.jsx)(w,{onBack:()=>{e()},children:(0,C.jsxs)(Xt.s,{uri:"spotify:internal:bettersound",children:[(0,C.jsxs)("div",{className:ni.headerContainer,children:[(0,C.jsx)("div",{className:ni.headerGradient}),(0,C.jsxs)("div",{className:ni.titleContainer,children:[(0,C.jsx)(c.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:_.Ru.get("web-player.puffin.manual-selection.airpods.title")}),(0,C.jsx)(c.E,{variant:"bodySmall",children:_.Ru.get("web-player.puffin.manual-selection.airpods.subtitle")})]}),(0,C.jsx)(Kt.S,{placeholder:_.Ru.get("web-player.puffin.manual-selection.airpods.search-placeholder"),alwaysExpanded:!0,fullWidth:!0,debounceFilterChangeTimeout:0})]}),i?(0,C.jsx)("div",{className:ni.listContainer,children:(0,C.jsx)(ri,{devices:i,isAirpodsList:!0})}):(0,C.jsx)("div",{className:ni.loading,children:(0,C.jsx)(it.m,{})})]})})},ui=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(T),i=t[k.IncompatibleHeadphones],{handleClick:a}=Mt((()=>e(i.continue))),{toPreviousView:s}=(0,n.useContext)(T);return(0,C.jsx)(w,{onBack:()=>{s()},titleSlot:(0,C.jsx)(It,{variant:"bodySmallBold"}),children:(0,C.jsx)(Et,{onboardingContent:{bodyTitle:_.Ru.get("web-player.puffin.incompatible-headphones.title"),bodySubtitle:_.Ru.get("web-player.puffin.incompatible-headphones.subtitle"),bodyText:_.Ru.get("web-player.puffin.incompatible-headphones.description"),imageUrl:"spotify:image:ab671fcc000092562c122d1cc442ac4f3c8dbab4",subtitleIcon:Dt.C,buttonText:_.Ru.get("web-player.puffin.incompatible-headphones.close-button")},onNext:a})})},di=()=>{const{toPreviousView:e,viewOptions:t}=(0,n.useContext)(T),{data:i}=li(),{triggerDialog:a,dialog:s}=Wt();return(0,C.jsxs)(w,{onBack:()=>{t?.showDialogOnBack?a():e()},titleSlot:(0,C.jsx)(It,{variant:"bodySmallBold"}),children:[s,(0,C.jsxs)(Xt.s,{uri:"spotify:internal:bettersound",children:[(0,C.jsxs)("div",{className:ni.headerContainer,children:[(0,C.jsxs)("div",{className:ni.titleContainer,children:[(0,C.jsx)(c.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:_.Ru.get("web-player.puffin.manual-selection.title")}),(0,C.jsx)(c.E,{variant:"bodySmall",children:_.Ru.get("web-player.puffin.manual-selection.subtitle")})]}),(0,C.jsx)(Kt.S,{placeholder:_.Ru.get("web-player.puffin.manual-selection.search-placeholder"),alwaysExpanded:!0,fullWidth:!0,debounceFilterChangeTimeout:0})]}),i?(0,C.jsx)("div",{className:ni.listContainer,children:(0,C.jsx)(ri,{devices:i})}):(0,C.jsx)("div",{className:ni.loading,children:(0,C.jsx)(it.m,{})})]})]})};var mi=i(26188);const pi=()=>{const{currentView:e}=(0,n.useContext)(T);switch(e){case k.ActivationIntro:return(0,C.jsx)(Zt,{type:"intro"});case k.ActivationDetection:return(0,C.jsx)(Zt,{type:"detection"});case k.ActivationSignifiers:return(0,C.jsx)(Zt,{type:"signifiers"});case k.Error:return(0,C.jsx)(F,{});case k.ManualSelection:return(0,C.jsx)(di,{});case k.AirpodsSelection:return(0,C.jsx)(ci,{});case k.Overview:return(0,C.jsx)(Ye,{});case k.DiscoverLossless:return(0,C.jsx)(Tt,{});case k.IncompatibleHeadphones:return(0,C.jsx)(ui,{});default:return(0,mi.k)(e),null}},gi=()=>{const{currentView:e}=(0,n.useContext)(T),t=(0,N._Y)(),i=(0,N.XB)(),a=[g.Z.Puffin,g.Z.PuffinActivation,g.Z.PuffinOverlay,g.Z.PuffinActivationOverlay].some((e=>e===i)),s=[k.ActivationIntro,k.ActivationDetection,k.ActivationSignifiers,k.ManualSelection,k.IncompatibleHeadphones].includes(e),r=[k.ActivationIntro,k.ActivationDetection,k.ActivationSignifiers,k.DiscoverLossless,k.ManualSelection,k.AirpodsSelection,k.IncompatibleHeadphones].includes(e);return(0,n.useEffect)((()=>{a&&t(s?W.$S.PUFFIN_START_ACTIVATION:W.$S.PUFFIN_FINISH_ACTIVATION)}),[t,s,a]),(0,C.jsxs)("div",{className:l()(b,{[j]:r}),children:[(0,C.jsx)(pi,{}),false]})},vi=()=>(0,C.jsx)(We._,{label:"Puffin",focusTransferId:"PUFFIN",children:(0,C.jsx)(r.s,{Fallback:U,children:(0,C.jsx)(L,{children:(0,C.jsx)(gi,{})})})});var xi=i(69198),hi=i(90791);i(24929);function bi(e){return e.sort(((e,t)=>t.timestamp-e.timestamp))}function yi(e,t){return t.some((t=>t.user.uri===e.user.uri))?t:bi([...t,e])}function fi(e,t){return t.filter((t=>t.user.uri!==e))}i(89370);var ji=i(23736);var Ci=i(90301),wi=i(15019);function ki(){const e=(0,hi.C)(),t=(0,xi.jE)(),i=["friend-activity"],a=e=>{t.setQueryData(i,((t=[])=>{const i=Array.isArray(e)?e.at(0):e;return i?function(e,t){return bi(t.map((t=>t.user.uri===e.user.uri?e:t)))}(i,t):t}))},{subscribeToFriend:s,unSubscribeFromFriend:r,subscribeAndFetchFeed:o}=function(e){const t=(0,hi.C)(),i=(0,n.useRef)({}),a=(0,n.useRef)(e);a.current=e;const s=(0,n.useCallback)((e=>{const n=(0,ji.o_h)(e)?.username,s=t.subscribeToBuddyActivity(n,(e=>{e&&a.current(e)}));return i.current[e]=s,s}),[t]),r=(0,n.useCallback)((e=>{i.current[e]?.cancel(),delete i.current[e]}),[]),o=(0,n.useCallback)(((e,i,n)=>t.fetchFriendActivityWithSubscriptions(e,i,n)),[t]);return(0,n.useEffect)((()=>{const e=i.current;return()=>{Object.values(e).forEach((e=>{e.cancel()}))}}),[t]),{subscribeToFriend:s,unSubscribeFromFriend:r,subscribeAndFetchFeed:o}}(a),l=(0,n.useRef)();(0,n.useEffect)((()=>()=>l.current?.cancel()),[]);const c=(0,oi.I)({queryKey:i,queryFn:()=>new Promise(((e,t)=>{l.current=o(a,e,t)})).then((e=>bi(e))),staleTime:6e5,gcTime:36e5,refetchInterval:864e5,refetchOnWindowFocus:!1,refetchOnMount:"always",refetchOnReconnect:!0});return(0,wi.N)(Ci.mc.OPERATION_COMPLETE,(async n=>{const a=n.data.uris;if(n.data.operation!==Ci.JK.FOLLOW_USER){if(n.data.operation===Ci.JK.UNFOLLOW_USER)for(const e of a)r(e),t.setQueryData(i,((t=[])=>fi(e,t)))}else for(const n of a){const a=(await e.fetchFriendActivity([n])).at(0);a&&(t.setQueryData(i,((e=[])=>yi(a,e))),s(n))}})),c}var Si=i(68007);const Ni=(0,n.lazy)((()=>i.e(7564).then(i.bind(i,34330))));function Ri(){const{data:e,error:t,isLoading:i}=ki();return!(0,Si.n)()||i||t?null:(0,C.jsx)(Ni,{friends:e??[]})}var Ei=i(41588),Ii=i(52276);i(7354);const Ai="device-picker-section-heading",Ti="device-picker-troubleshooting-list";var Li=i(32040);const Di="uqXaqvqZq1oSLhXLYRo9",Oi="YuPZ1nUe5BAH7HJworb6",Fi="aVWZBvlWjLJFYO_GE5qL",Ui="wWalUsrOkGgHa0u8o86Q",Bi="yNttGX9uUxTih93MKEWB",Pi="kD25df_SN_uDB8lhZgQB",_i="szp7gPJjKd4T69SzCEpF",Mi="E912cqRfb05FrRPFKDZ_",Hi="D7sZlTAybIM02cRvh4sV",Vi="xdAVCtEIoo_8z_Ubj7tU",zi=({foundDevices:e})=>{const t=(0,s.NC)(Li.Q5);if(e&&t)return null;let i;return i=e?_.Ru.get("web-player.connect.device-picker.select-another-device"):_.Ru.get("web-player.connect.device-picker.no-devices-found"),(0,C.jsx)("span",{className:Bi,id:Ai,"data-testid":Ai,children:(0,C.jsx)(c.E,{as:"h2",variant:"bodyMediumBold",semanticColor:"textBase",children:i})})};var qi=i(15001),Gi=i(56168),Qi=i(40638),Yi=i(97382),Wi=i(87050),Zi=i(65906),Ki=i(96535),Xi=i(68443),Ji=i(35834),$i=i(34529),en=i(80436),tn=i(35398),nn=i(23528),an=i(26445),sn=i(19293),rn=i(65477),on=i(61919),ln=i(67867),cn=i(65891);var un=i(87612);const dn="mFr6W9mwg0p_c7eJlhc_",mn="lpPBKkIGJcyWu59iOpsS",pn=({deviceId:e,connectStateDeviceId:t,allowForgetDevice:i,incarnation:n})=>{const a=(0,cn.N)(ln.r),s=(0,Ce.s)(),{spec:r}=(0,qe.r)(an.d,{}),o=(0,un.t)(r),l=r.forgetDeviceButtonFactory(),c=(0,un.t)(l),u=r.deviceIncarnationContainerFactory(),d=(0,un.t)(u);return i||n?(0,C.jsx)("span",{ref:o,className:mn,children:(0,C.jsxs)(sn.W,{children:[i&&(0,C.jsx)(on.D,{role:"menuitem",leadingIcon:(0,C.jsx)(tn.V,{size:"small"}),onClick:()=>{s.logInteraction(l.hitLogoutFromRemoteDevice({remoteDeviceId:t})),a.logout(e)},elementRef:c,children:_.Ru.get("web-player.connect.context-menu.log-out-of-device")}),n&&(0,C.jsxs)("div",{ref:d,children:[(0,C.jsx)(rn.y,{children:_.Ru.get("web-player.connect.context-menu.incarnation-title")}),n.available.map((i=>{const{icon:r,text:o}=(e=>{switch(e){case"connect":return{icon:(0,C.jsx)(Wi.E,{size:"small"}),text:_.Ru.get("web-player.connect.context-menu.incarnation-connect")};case"cast":return{icon:(0,C.jsx)(en.m,{size:"small"}),text:_.Ru.get("web-player.connect.context-menu.incarnation-cast")};default:return{}}})(i);return(0,C.jsx)(on.D,{role:"menuitemradio",leadingIcon:r,onClick:()=>{let r;switch(i){case"cast":r=u.googleCastButtonFactory();break;case"connect":r=u.spotifyConnectButtonFactory()}n.preferred!==i?(r&&s.logInteraction(r.hitChangeRemoteDeviceIncarnation({remoteDeviceId:t})),a.setPreferredIncarnation(e,i)):r&&s.logInteraction(r.hitNoAction())},"aria-checked":n.preferred===i,CheckedIcon:nn.i,children:o},i)}))]})]})}):null};var gn=i(17934);const vn=({title:e,deviceId:t,connectStateDeviceId:i,allowForgetDevice:a,incarnation:s,className:r,onHide:o,onShow:c,spec:u})=>{const[d,m]=(0,n.useState)(!1),p=u.contextMenuButtonFactory({identifier:i}),g=(0,Ce.s)(),v=(0,un.t)(p);return(0,C.jsx)($i.b,{renderInline:!0,menu:(0,C.jsx)(gn.r,{spec:p,children:(0,C.jsx)(pn,{deviceId:t,connectStateDeviceId:i,allowForgetDevice:a,incarnation:s})}),onShow:()=>{m(!0),c?.()},onHide:()=>{m(!1),o?.()},offset:[0,-8],children:(0,C.jsx)(Ji.e,{ref:v,size:Ji.M.xs,label:_.Ru.get("more.label.context",e),className:l()(dn,r),onClick:e=>{e.stopPropagation(),g.logInteraction(d?p.hitUiHide():p.hitUiReveal())}})})},xn=(0,n.createContext)({rowWithMenuOpenIdentifier:null,setRowWithMenuOpenIdentifier:()=>{}}),hn=({children:e})=>{const[t,i]=(0,n.useState)(null),a=(0,n.useMemo)((()=>({rowWithMenuOpenIdentifier:t,setRowWithMenuOpenIdentifier:i})),[t]);return(0,C.jsx)(xn.Provider,{value:a,children:e})},bn=e=>e instanceof qi.B.ContainerViewEventFactory.DeviceListEventFactory.RemoteDeviceEventFactory||e instanceof qi.B.ContainerViewEventFactory.DeviceListEventFactory.DisabledDeviceEventFactory||e instanceof qi.B.ContainerViewEventFactory.OffNetworkDeviceListEventFactory.RemoteDeviceEventFactory||e instanceof qi.B.ContainerViewEventFactory.OffNetworkDeviceListEventFactory.DisabledDeviceEventFactory||e instanceof qi.B.ContainerViewEventFactory.OnNetworkDeviceListEventFactory.RemoteDeviceEventFactory,yn=e=>e instanceof qi.B.ContainerViewEventFactory.DeviceListEventFactory.RemoteDeviceEventFactory;var fn=i(74760),jn=i(12834);const Cn="AWblt0YATqa_XQaPUDMc",wn="sX7AwqoSzMeT9qhlEViU",kn="jIlVu16bmijzUKG6u5VW",Sn="ZkuPLR9bss2N7f7thixx",Nn="QSZFk1XCj76mVplNmiV1",Rn="O0wmxPM0kfA59paiHqR9",En=(0,n.forwardRef)((function({deviceId:e,connectStateDeviceId:t,Icon:i,TechIcon:a,title:s,subtitle:r,canLogout:o,isDisabled:c,incarnation:u,jamSession:d,onClick:m,spec:p},g){const v=(0,N._Y)(),x=(0,fn.HJ)(u),h=o||x,{rowWithMenuOpenIdentifier:b,setRowWithMenuOpenIdentifier:y}=(0,n.useContext)(xn),f=(0,un.t)(yn(p)&&d?.token?p.inPersonListeningSessionFactory({identifier:d.sessionId??d.token}):void 0,!!d?.token),j=(0,Qi.YQ)((()=>{m(),v(W.$S.PANEL_CLOSE_CLICK)}),1e3,{leading:!0,trailing:!1}),w=(0,n.useCallback)((e=>{"Enter"===e.key&&j()}),[j]),k=(0,C.jsx)(pn,{deviceId:e,connectStateDeviceId:t,allowForgetDevice:o,incarnation:x?u:void 0}),S=d?.participants.find((e=>e.id===d.sessionOwnerId))?.displayName,R=d?.jamType===jn.H.NEARBY_JAM?(0,C.jsx)(Yi.C,{"data-testid":"sub-nearby-jam-icon",semanticColor:"textBrightAccent",size:"small"}):(0,C.jsx)(Wi.E,{"data-testid":"sub-jam-icon",semanticColor:"textBrightAccent",size:"small"}),E=S&&!d.isSessionOwner?(0,C.jsxs)("div",{className:wn,ref:f,children:[R,(0,C.jsx)(Zi.j,{semanticColor:"textBrightAccent",lineClamp:1,children:_.Ru.get("web-player.social-connect.broadcasting.bradcasting-device-subtitle",{host:S})})]}):(0,C.jsxs)("div",{className:wn,children:[a&&(0,C.jsx)(a,{className:kn,semanticColor:"textSubdued","data-testid":"sub-icon",role:"presentation",size:"small"}),r&&(0,C.jsx)(Zi.j,{semanticColor:"textSubdued",lineClamp:1,children:r})]});return(0,C.jsx)(Ki.h,{menu:k,children:(0,C.jsx)(ti.c,{onKeyDown:w,onClick:j,className:l()(Sn,{[Rn]:b===e}),children:(0,C.jsx)(X.v,{id:e,ref:g,"data-testid":"device-picker-row-sidepanel",media:(0,C.jsx)(i,{semanticColor:c?"textSubdued":"textBase","data-testid":"main-icon",role:"presentation"}),onClick:()=>{},onClickHint:_.Ru.get("web-player.connect.device-picker.connect-to-device"),title:(0,C.jsx)("span",{className:Cn,children:(0,C.jsx)(Xi.Zp,{label:s,renderInline:!0,children:(0,C.jsx)(se.d,{"data-testid":"list-row-title",lineClamp:1,semanticColor:c?"textSubdued":"textBase",dir:"auto",children:s})})}),subtitle:E,trailing:h&&bn(p)&&(0,C.jsx)(vn,{title:s,deviceId:e,connectStateDeviceId:t,allowForgetDevice:o,incarnation:x?u:void 0,spec:p,className:l()(Nn),onShow:()=>{y(e)},onHide:()=>{y(null)}})})})})})),In=({position:e,deviceId:t,connectStateDeviceId:i,deviceName:n,deviceType:a,deviceModelName:s,isGroup:r,disabledReason:o,canLogout:l,spec:c})=>{const u=(0,fn.tf)(a,r),{helpText:d}=(0,fn.uY)(o,(0,fn.p2)(a,s)),m=c.disabledDeviceFactory({identifier:i,position:e,reason:o??"null"}),p=(0,un.t)(m),g=(0,P.wA)();return(0,C.jsx)(En,{deviceId:t,connectStateDeviceId:i,ref:p,isDisabled:!0,disabledReason:o,Icon:u,title:n,subtitle:d,canLogout:l,onClick:()=>{o===q.bU.RESTRICTED&&g((0,Gi.yx)(t))},spec:m})};var An=i(26460);const Tn=({isDisabled:e=!1,spec:t})=>{const i=(0,P.wA)(),n=t.containerViewFactory().deviceListFactory().castPlaceholderFactory(),a=(0,un.t)(n),s=(0,fn.$A)(q.bq.CAST_AUDIO,"disconnected"),r=(0,Ce.s)();return(0,C.jsx)(En,{deviceId:"cast-placeholder",connectStateDeviceId:"cast-placeholder",ref:a,Icon:s,title:_.Ru.get("web-player.connect.device-picker.google-cast-devices"),supportsHiFi:!1,onClick:()=>{r.logInteraction(n.hitUiReveal()),i((0,An.Ym)())},isDisabled:e,spec:n})};var Ln=i(98768);const Dn=({deviceId:e,connectStateDeviceId:t,deviceName:i,supportsHiFi:n,spec:a})=>{const s=(0,Ce.s)(),r=a.localDeviceFactory(),o=(0,fn.tf)(q.bq.COMPUTER,!1),l=(0,Ln.D)();return(0,C.jsx)(En,{deviceId:e,connectStateDeviceId:t,Icon:o,title:i,supportsHiFi:n,onClick:()=>{const{interactionId:t,pageInstanceId:i}=s.logInteraction(r.hitPullPlaybackToLocalDevice());l.transferPlayback(e,{interactionId:t,pageInstanceId:i})},spec:r})},On=()=>{const[e,t]=(0,ye.x)("connect-picker-recent-transfers",{});return{registerTransferAttempt:(0,n.useCallback)((i=>{t({...e,[i]:(new Date).getTime()})}),[e,t]),recentTransfersMap:e}};var Fn=i(43123),Un=i(58872),Bn=i(34314),Pn=i(64103),_n=i(61860),Mn=i(11167);const Hn=({position:e,deviceId:t,connectStateDeviceId:i,deviceName:n,deviceType:a,isGroup:r,supportsHiFi:o,canLogout:l,incarnation:c,jamSession:u,spec:d})=>{const m=(0,Ce.s)(),p=d.remoteDeviceFactory({identifier:i,position:e}),g=(0,fn.tf)(a,r);let v,x;(0,fn.Mp)(a)&&(v=(0,fn.$A)(a,"disconnected"),x=_.Ru.get("web-player.connect.device-picker.google-cast"));const h=(0,P.wA)(),{registerTransferAttempt:b}=On(),y=(0,Ln.D)(),f=(0,un.t)(p),j=(0,s.NC)(Li.Yr),w=(0,Un.Ad)((e=>{const t=(0,_n.d)(),i=(0,xi.jE)(),n=(0,s.NC)(Li.$4,{loadingValue:!1}),{data:a}=(0,oi.I)({queryKey:["useResolveJamFromConnectDevice",e],queryFn:()=>t.getJoinTokenFromConnectDeviceId(e),enabled:n}),{data:r}=(0,oi.I)({queryKey:["useResolveJamFromConnectDevice",a],queryFn:a?()=>t.getSessionInfo(a):Bn.hT,enabled:!!a});return(0,Mn.c)(Pn.P.SCAN_UPDATE,(()=>{i.invalidateQueries({queryKey:["useResolveJamFromConnectDevice",e]})})),r??null})(i));let k;k=j?u??null:w;return(0,C.jsx)(En,{deviceId:t,connectStateDeviceId:i,ref:f,Icon:g,TechIcon:v,title:n,subtitle:x,supportsHiFi:o,canLogout:l,incarnation:c,jamSession:k,onClick:()=>{if(k?.token&&!k.isSessionOwner){yn(p)&&m.logInteraction(p.inPersonListeningSessionFactory({identifier:k.sessionId??k.token}).hitUiReveal());let e=Fn.EL.JOIN_LISTENING_SESSION;k.jamType===jn.H.NEARBY_JAM&&(e=Fn.EL.JOIN_NEARBY_JAM),h((0,Gi.A9)(e,k.token,void 0,{id:t,name:n,type:a,isGroup:r}))}else{const{interactionId:e,pageInstanceId:n}=m.logInteraction(p.hitConnectToRemoteDevice({remoteDeviceId:i}));y.transferPlayback(t,{interactionId:e,pageInstanceId:n}),b(i)}},spec:p})};var Vn=i(5956);const zn=()=>(0,Vn.o)((e=>(e?.restrictions?.disallowTransferringPlaybackReasons?.length??0)>0)),qn=({devices:e,areWebPlayerCastDevicesAvailable:t=!1,networkHeadingID:i="",spec:n})=>{const a=(0,s.NC)(Li.Yr),r=(0,s.NC)(Li.Q5),o=zn(),l=n.containerViewFactory().deviceListFactory(),c=(0,un.t)(l),u=(e,t)=>{const i=_.Ru.get("web-player.connect.device-picker.this-computer"),n=(r||!e.isLocalNetwork)&&e.supportsLogout;if(e.isDisabled)return(0,C.jsx)(In,{position:e.isLocal?0:t+1,deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:e.isLocal?i:e.name,deviceType:e.isLocal?q.bq.COMPUTER:e.type,deviceModelName:e.modelDisplayName,isGroup:e.isGroup,disabledReason:e.disabledReason,canLogout:n,spec:l},e.id);if(e.isLocal&&(e=>e instanceof qi.B.ContainerViewEventFactory.DeviceListEventFactory||e instanceof qi.B.ContainerViewEventFactory.OnNetworkDeviceListEventFactory)(l))return(0,C.jsx)(Dn,{deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:i,supportsHiFi:e.supportsHiFi,spec:l},e.id);let s=null;return a&&(0,Un.HV)(e)?s=e.nearbyJamSession:(0,Un.C7)(e)&&(s=e.jamSession),(0,C.jsx)(Hn,{position:t+1,deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:e.name,deviceType:e.type,isGroup:e.isGroup,supportsHiFi:e.supportsHiFi,canLogout:n,incarnation:e.incarnation,jamSession:s,spec:l},e.id)};return(0,C.jsxs)($t.$,{circular:!1,ref:c,"aria-labelledby":`${Ai} ${i}`,"data-testid":`devices-list-${i}`,allowsMultipleInteractiveChildrenInItem:!0,children:[e.map(((e,t)=>u(e,t))),t&&(0,C.jsx)(Tn,{isDisabled:o,spec:n})]})},Gn="local-network-heading",Qn="other-networks-heading",Yn=({localNetworkDevices:e,otherNetworksDevices:t,spec:i})=>{const n=(0,s.NC)(Li.Q5),a=e.length>0?_.Ru.get("web-player.connect.device-picker.on-this-network"):_.Ru.get("web-player.connect.device-picker.no-devices-local-network"),r=!n||n&&e.length<=0;return(0,C.jsxs)(C.Fragment,{children:[r&&(0,C.jsx)(c.E,{as:"h3",variant:n?"bodyMedium":"bodySmall",semanticColor:"textSubdued",className:Pi,id:Gn,children:a}),e.length>0&&(0,C.jsx)(qn,{devices:e,networkHeadingID:Gn,spec:i}),t.length>0&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(c.E,{as:"h3",variant:n?"bodyMedium":"bodySmall",semanticColor:"textSubdued",className:l()(Pi,_i),id:Qn,children:_.Ru.get("web-player.connect.device-picker.on-other-networks")}),(0,C.jsx)(qn,{devices:t,networkHeadingID:Qn,spec:i})]})]})};var Wn=i(70447);const Zn=({url:e,linkText:t,handleClick:i,elementRef:n})=>(0,C.jsx)("a",{className:l()(Sn),href:e,target:"_blank",ref:n,onClick:i,children:(0,C.jsx)(X.v,{title:t,id:t,isRedundantOnClick:!0,onClick:()=>{},"data-testid":"list-row-external-link",trailing:(0,C.jsx)(Wn.H,{size:"small","data-testid":"icon-external-link",semanticColor:"textSubdued",role:"presentation",autoMirror:!0,"aria-hidden":"true"})})}),Kn=({spec:e})=>{const t="https://www.spotify.com/connect?utm_campaign=connect&utm_medium=app&utm_source=desktop",i=e.containerViewFactory().externalConnectHubLinkFactory(),n=(0,un.t)(i),a=(0,Ce.s)();return(0,C.jsx)(Zn,{url:t,linkText:_.Ru.get("web-player.connect.device-picker.connect-hub-external-link"),elementRef:n,handleClick:()=>{a.logInteraction(i.hitNavigateToExternalUri({destination:t}))}})},Xn="https://support.spotify.com/article/spotify-connect/",Jn=({spec:e})=>{const t=e.containerViewFactory().externalHelpLinkFactory(),i=(0,un.t)(t),n=(0,Ce.s)();return(0,C.jsx)(Zn,{url:Xn,linkText:_.Ru.get("web-player.connect.device-picker.help-external-link"),elementRef:i,handleClick:()=>{n.logInteraction(t.hitNavigateToExternalUri({destination:Xn}))}})};var $n=i(55733);const ea=[$n.h.en,$n.h.enGB],ta=()=>{const e=_.Ru.getLocaleForTranslation();return ea.includes(e)};const ia=({devices:e,areWebPlayerCastDevicesAvailable:t})=>{zn();const i=ta(),n=(0,s.NC)(Li.Q5),a=e,{recentTransfersMap:r}=On(),o=function(e,t){const i=[],n=e.find((e=>e.isLocal));n&&i.push(n);const a=e.filter((e=>!e.isLocal)),{usedDevices:s,unusedDevices:r}=function(e,t){const i=[],n=[];for(const a of e)t[a.sortingId]?i.push({device:a,timestamp:t[a.sortingId]}):n.push(a);return{usedDevices:i,unusedDevices:n}}(a,t);s.sort(((e,t)=>t.timestamp-e.timestamp));for(const e of s)i.push(e.device);const o=i.concat(function(e){return e.sort(((e,t)=>e.isLocal?-1:t.isLocal?1:e.name.toLowerCase().localeCompare(t.name.toLowerCase())))}(r));return o}(a,r),{spec:c}=(0,qe.r)(qi.p,{}),u=o.filter((e=>e.isLocalNetwork)),d=o.filter((e=>!e.isLocalNetwork));return(0,C.jsxs)("div",{className:l()(Di,Oi,{[Fi]:n}),children:[(0,C.jsx)("div",{children:d.length>0?(0,C.jsx)(Yn,{localNetworkDevices:u,otherNetworksDevices:d,spec:c}):(0,C.jsx)(qn,{devices:o,areWebPlayerCastDevicesAvailable:t,spec:c})}),(0,C.jsxs)("div",{className:l()(Mi),children:[(0,C.jsx)(Jn,{spec:c}),i&&(0,C.jsx)(Kn,{spec:c})]})]})};var na=i(34077),aa=i(3032),sa=i(79131),ra=i(10642);const oa=(0,n.forwardRef)((function({Icon:e,title:t,subtitle:i,onClick:n},a){return(0,C.jsx)(ti.c,{className:Sn,children:(0,C.jsx)(X.v,{id:t,ref:a,"data-testid":"device-picker-row-sidepanel",media:(0,C.jsx)(e,{semanticColor:"textSubdued"}),title:(0,C.jsx)("span",{className:Cn,children:(0,C.jsx)(Xi.Zp,{label:t,renderInline:!0,children:(0,C.jsx)(se.d,{"data-testid":"list-row-title",lineClamp:1,semanticColor:"textBase",dir:"auto",onClick:n,children:t})})}),subtitle:(0,C.jsx)("div",{className:wn,children:(0,C.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:i})}),onClick:n})})}));var la=i(36415),ca=i(82944);const ua="A3PPnVKE5LH9mT5URPB2",da="cU0IpwDfJzDgQaY4MSXA",ma="dlS4nc0WL68C7_8zwfiS",pa="pdLJBD_CNQ_r5Ad4mZZk",ga="FpmhhFL8lCsiyh3X0fjK",va="scv87ulfUcibJW8QhCeH",xa="oCa5Np4laJc3s5P2uUqw",ha=({onClick:e})=>{const{deviceName:t,formattedDeviceName:i}=Q();return(0,C.jsx)("div",{className:xa,children:(0,C.jsx)(Xi.Zp,{label:i??t,children:(0,C.jsx)(Zi.j,{lineClamp:1,onClick:e,children:(0,C.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:i??t})})})})};var ba=i(68128),ya=i(87417);const fa=({size:e="medium",className:t})=>{const i=(0,Rt.j)(),n=(0,ya.k)(e);return(0,C.jsx)(C.Fragment,{children:i?(0,C.jsx)(ba.A,{size:e,semanticColor:"textBrightAccent",className:t,"data-testid":"now-playing-active"}):(0,C.jsx)("img",{className:t,width:n,height:n,alt:"","aria-hidden":"true",src:(0,Ot.bj)("images/device-picker-equaliser-animation.webp"),"data-testid":"animated-now-playing"})})};var ja=i(78054);const Ca=({deviceType:e,isGroup:t,isLocalDevice:i,isPlaying:n})=>{const a=(0,ja.g)();let s;if(n)s=(0,C.jsx)(fa,{});else{const n=(0,fn.tf)(e,t,i?a:null);s=(0,C.jsx)(n,{semanticColor:"textBrightAccent","data-testid":"device-icon",role:"presentation"})}return(0,C.jsxs)("div",{className:pa,children:[(0,C.jsx)("div",{className:ga,children:s}),(0,C.jsx)(se.d,{variant:"titleSmall",semanticColor:"textBase",lineClamp:1,children:_.Ru.get("web-player.connect.device-picker.current-device")})]})};var wa=i(43726),ka=i(2499),Sa=i(98746);const Na=()=>{const{currentDevice:e}=(0,Sa.l)(),{id:t,connectStateId:i,isLocalNetwork:n,supportsLogout:a}=e,r=(0,ka.W)(),o=(0,s.NC)(Li.Q5),l=!n&&a,c=!o&&l,{spec:u}=(0,qe.r)(qi.p,{}),d=(0,ze.v)(),m=(0,je.j)(),{deviceName:p,formattedDeviceName:g}=Q(),v=r?wa.g:ei.V,x=o?"textSubdued":"textBase";return(0,C.jsx)("div",{className:va,children:d||m?(0,C.jsx)(v,{"aria-label":_.Ru.get("more.label.context",g??p),size:"small",autoMirror:!1,semanticColor:x}):c&&(0,C.jsx)(vn,{title:g??p,deviceId:t,connectStateDeviceId:i,allowForgetDevice:l,spec:u.containerViewFactory().headerFactory().activeDeviceFactory()})})};var Ra=i(7436),Ea=i(35017),Ia=i(26930),Aa=i(41991);const Ta=()=>{const e=(0,_n.d)(),{enqueueSnackbar:t}=(0,Ia.d)(),{spec:i,logger:a}=(0,qe.r)(la.g,{}),[s,r]=(0,n.useState)(Aa.ez.BROADCAST_STATUS_UNKNOWN),o=s===Aa.ez.BROADCAST_STATUS_UNKNOWN||s===Aa.ez.BROADCAST_UNAVAILABLE,l=s===Aa.ez.BROADCAST_ON;(0,Mn.c)(Pn.P.BROADCAST_STATUS_UPDATE,(({data:e})=>{r(e??Aa.ez.BROADCAST_STATUS_UNKNOWN)}));const c=(0,n.useCallback)((t=>e.setBroadcastStatus(t?Aa.ez.BROADCAST_ON:Aa.ez.BROADCAST_OFF)),[e]),u=(0,Ea.n)({mutationFn:c,onMutate:async e=>{const t=s;return r(e?Aa.ez.BROADCAST_ON:Aa.ez.BROADCAST_OFF),{prevBroadcastingState:t,allowBroadcasting:e}},onError:(e,i,n)=>{r(n?.prevBroadcastingState??Aa.ez.BROADCAST_STATUS_UNKNOWN),t(_.Ru.get("error.generic"))}});return{isHidden:o,toggleIsSwitchedOn:l,setToggleState:(0,n.useCallback)((e=>{const t=e?"device_discoverable_off":"device_discoverable_on",n=e?"device_discoverable_on":"device_discoverable_off";a.logInteraction(i.deviceDiscoverableToggleFactory().hitToggleState({stateBeforeToggle:t,stateAfterToggle:n})),u.mutate(e)}),[a,u,i])}},La="k5CAXCZwazRLdTWi5mpN",Da="f2Wgf5OqTaBlTRRKZe9X",Oa=()=>{const{isHidden:e,toggleIsSwitchedOn:t,setToggleState:i}=Ta();return e?null:(0,C.jsxs)("div",{className:La,children:[(0,C.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",as:"label",htmlFor:"jam.broadcasting",className:Da,children:_.Ru.get("web-player.social-connect.broadcasting.toggle-label")}),(0,C.jsx)(Pe.l,{id:"jam.broadcasting",value:t,onSelected:i,condensed:!0})]})};var Fa=i(2035),Ua=i(35199),Ba=i(81271),Pa=i(9221),_a=i(93211);const Ma="device-picker-header",Ha=({isPlaying:e})=>{const{currentDevice:t}=(0,Sa.l)(),{id:i,connectStateId:a,type:r,isLocal:o,isLocalNetwork:c,isGroup:u,incarnation:d,supportsLogout:m}=t,p=(0,ze.v)(),g=(0,je.j)(),{togglePuffin:v}=(0,Ra.c)(),x=(0,_a.g)(),h=(0,Ba.y)(),b=(0,s.NC)(Li.$4),y=!x&&h,f=(0,fn.HJ)(d),j=!c&&m,w=j||f,{spec:k,logger:S}=(0,qe.r)(la.g,{}),{uri:N}=(0,Pa.f)(),R=()=>{v(),S.logInteraction(k.hitUiReveal())},E=(0,n.useCallback)((()=>{S.logInteraction(k.createJamButtonFactory().hitUiNavigate({destination:N??""}))}),[S,k,N]),I=(0,C.jsx)(pn,{deviceId:i,connectStateDeviceId:a,allowForgetDevice:j,incarnation:f?d:void 0}),A=p||g,T=(0,C.jsx)(X.v,{className:l()(da,{[ma]:A}),id:Ma,variant:"naked",title:(0,C.jsx)(Ca,{deviceType:r,isGroup:u,isLocalDevice:o,isPlaying:e}),subtitle:(0,C.jsxs)("div",{className:xa,children:[(0,C.jsx)(ha,{onClick:A?R:void 0}),A&&(0,C.jsx)(ca.Q,{})]}),trailing:(0,C.jsx)(Na,{}),"aria-labelledby":Ma,onClick:A?R:void 0,onClickHint:_.Ru.get("web-player.connect.device-picker.current-device"),body:h&&(0,C.jsxs)(C.Fragment,{children:[b&&(0,C.jsx)(Oa,{}),(0,C.jsx)("hr",{className:ua})]}),footer:(0,C.jsxs)(C.Fragment,{children:[y&&(0,C.jsx)(Ua.$,{onClick:E}),x&&b&&(0,C.jsx)(Fa.K,{})]})});return w?(0,C.jsx)(Ki.h,{menu:I,children:T}):T},Va=({isDesktop:e})=>{const t=(0,me.g)(),i=ta(),{spec:n}=(0,qe.r)(qi.p,{}),a=n.containerViewFactory().noDevicesViewFactory(),s=(0,un.t)(a);return(0,C.jsxs)("div",{ref:s,className:l()(Hi,Oi,Di),"data-testid":Ti,children:[(0,C.jsxs)("ul",{"aria-labelledby":`${Ma} ${Ai}`,className:Vi,children:[(0,C.jsx)(oa,{Icon:na.T,title:_.Ru.get("web-player.connect.device-picker.check-wifi"),subtitle:_.Ru.get("web-player.connect.device-picker.check-wifi-subtitle")}),(0,C.jsx)(oa,{Icon:aa.g,title:_.Ru.get("web-player.connect.device-picker.play-from-another"),subtitle:_.Ru.get("web-player.connect.device-picker.play-from-another-subtitle")}),e?(0,C.jsx)(oa,{Icon:sa.H,title:_.Ru.get("web-player.connect.device-picker.restart-speaker"),subtitle:_.Ru.get("web-player.connect.device-picker.restart-speaker-subtitle")}):(0,C.jsx)(oa,{Icon:ra.i,title:_.Ru.get("web-player.connect.device-picker.switch-to-app"),subtitle:_.Ru.get("web-player.connect.device-picker.switch-to-app-subtitle"),onClick:()=>t("/download")})]}),(0,C.jsxs)("div",{"aria-describedby":Ti,children:[(0,C.jsx)(Jn,{spec:n}),i&&(0,C.jsx)(Kn,{spec:n})]})]})},za=({devices:e,areWebPlayerCastDevicesAvailable:t})=>{const i=Boolean(e.find((e=>!e.isLocal))),n=e.filter((e=>!e.isActive&&e.name.length>0)),a=i||t;return(0,C.jsxs)("div",{className:l()(Ui,Oi),children:[(0,C.jsx)(zi,{foundDevices:a}),a?(0,C.jsx)(hn,{children:(0,C.jsx)(ia,{devices:n,areWebPlayerCastDevicesAvailable:t})}):(0,C.jsx)(Va,{isDesktop:!0})]})};var qa=i(71938);const Ga=()=>{const{currentDevice:e}=(0,Sa.l)(),{formattedDeviceName:t}=Q(),i=(0,qa.d)(),n=_.Ru.get("web-player.connect.device-picker.this-computer");let a;(0,fn.Mp)(e.type)&&(a=_.Ru.get("web-player.connect.device-picker.google-cast"));const s=[(t??null)&&n,a??null,i].filter(Boolean).join(" • ");return(0,C.jsx)(Zi.j,{semanticColor:"textSubdued",lineClamp:1,children:s})};var Qa=i(2585),Ya=i(5206);const Wa="cuG1_yCuW2Mnw3H6IUYD",Za=()=>{const{currentDevice:e}=(0,Sa.l)(),{type:t,isLocal:i,isGroup:n}=e,a=(0,ja.g)(),s=(0,ze.v)(),r=(0,je.j)(),{togglePuffin:o}=(0,Ra.c)(),{deviceName:l}=Q(),c=s||r,u=(0,Ya.K)(),d=s&&u?Dt.C:(0,Qa.tf)(t,n,i?a:null),{spec:m,logger:p}=(0,qe.r)(la.g,{});return(0,C.jsx)(X.v,{id:"device-picker-header",variant:"naked",size:"md",className:Wa,title:l,"data-testid":"device-picker-row-sidepanel",media:(0,C.jsx)(d,{semanticColor:"textBrightAccent","data-testid":"device-icon",role:"presentation"}),onClick:c?()=>{o(),p.logInteraction(m.hitUiReveal())}:void 0,trailing:(0,C.jsx)(Na,{}),subtitle:(0,C.jsx)(Ga,{})})},Ka="G6For7gcz2GTgCkOeJKc",Xa=()=>{const{isHidden:e,toggleIsSwitchedOn:t,setToggleState:i}=Ta();return e?null:(0,C.jsxs)("div",{className:Ka,children:[(0,C.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBase",as:"label",htmlFor:"jam.broadcasting",children:_.Ru.get("web-player.connect.device-picker.auto-invite-jam-toggle")}),(0,C.jsx)(Pe.l,{id:"jam.broadcasting",value:t,onSelected:i,condensed:!0})]})};var Ja=i(83157),$a=i(46686);const es="fkBkl4cpmR6fFGNpsPZx",ts="Wv3hgdJTMsji4hS4an1O",is="uqNT_uoUuNHbne2OA1u0",ns=({openQueue:e})=>{const t=(0,$a.D)(),{uri:i}=(0,Pa.f)(),{spec:a,logger:s}=(0,qe.r)(la.g,{}),r=(0,n.useCallback)((()=>{s.logInteraction(a.createJamButtonFactory().hitUiNavigate({destination:i??""}))}),[s,a,i]);return(0,C.jsxs)("div",{className:es,children:[(0,C.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",as:"label",htmlFor:"jam.broadcasting",className:ts,children:_.Ru.get("web-player.connect.device-picker.start-jam-description")}),(0,C.jsx)(Jt.n,{onClick:()=>{r(),t.createSession(),e()},iconLeading:Ja.V,size:"small",className:is,children:_.Ru.get("web-player.connect.device-picker.start-jam")})]})};var as=i(93381);const ss="rk32VTG0b6NU0RicbiOH",rs=()=>{const{openQueue:e}=(0,as.R)(),t=(0,_a.g)()?(0,C.jsx)(Fa.K,{}):(0,C.jsx)(ns,{openQueue:e});return(0,C.jsxs)("div",{className:l()(ss),"aria-label":_.Ru.get("web-player.connect.device-picker.current-device"),role:"group",children:[(0,C.jsx)(Za,{}),(0,C.jsx)(Xa,{}),t]})};var os=i(74396);const ls="Y5BWxTfO9OmenxMup_H7",cs="s0kxKAi2bTiuoEJhkYph",us="Cdlb8uLk1VIkwKmGBViF",ds=({Icon:e,title:t,subtitle:i,buttonText:a,onClick:s,onDismiss:r})=>{const{spec:o}=(0,qe.r)(qi.p,{}),l=o.containerViewFactory().messageBoxViewFactory({identifier:t}),u=(0,Ce.s)(),d=(0,n.useCallback)((()=>{u.logInteraction(l.dismissMessageBoxFactory().hitUiHide()),r()}),[u,l,r]),m=(0,n.useCallback)((()=>{u.logInteraction(l.recommendedActionButtonFactory().hitUiHide()),s()}),[u,l,s]),p=(0,C.jsxs)("div",{className:us,children:[e&&(0,C.jsx)(e,{semanticColor:"textSubdued",size:"small"}),(0,C.jsx)(c.E,{variant:"bodyMediumBold",color:"baseText",children:t})]});return(0,C.jsx)(X.v,{id:"messageBox",variant:"elevated",size:"lg",className:ls,title:p,subtitle:i,paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,C.jsx)(Jt.n,{size:"small",onClick:m,children:a}),trailing:(0,C.jsx)(J.H,{className:cs,semanticColor:"textBase",iconOnly:os.M,size:"small",onClick:d,condensedAll:!0,"aria-label":_.Ru.get("close")})})},ms=e=>{if("object"==typeof e&&"custom"in e)return e.custom;switch(e){case"required":return 1e3;case"high":return 500;case"normal":return 300;case"low":return 100;default:return 0}},ps=()=>{const{deviceFilterState:e}=(0,Ae.j)(),t=(0,n.useMemo)((()=>e.audioDevice?.id),[e.audioDevice?.id]),[i,a]=(0,ye.x)("onboarding-dismissed:puffin",{}),s=(0,n.useCallback)((()=>{t&&a({...i,[t]:(i[t]??0)+1})}),[t,i,a]);return{isDeviceDismissed:(0,n.useMemo)((()=>!!t&&i[t]>=3),[t,i]),incrementDismissCountForDevice:s}},gs=()=>[(()=>{const e=(0,N._Y)(),{incrementDismissCountForDevice:t,isDeviceDismissed:i}=ps(),{deviceFilterState:n,isMaybeHeadphoneDevice:a}=(0,Ae.j)(),s=n.isOnboarded,r=a&&!s&&!i;return{id:"puffinDevicePickerUpsell",title:_.Ru.get("web-player.puffin.get-started.title"),subtitle:_.Ru.get("web-player.puffin.get-started.subtitle"),buttonText:_.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm"),onClick:()=>{e(W.$S.PUFFIN_START_ACTIVATION)},onDismiss:()=>{t()},shouldShow:r,priority:"normal"}})()],vs=e=>{const t=e.filter((e=>e.shouldShow)).sort(((e,t)=>{return i=e.priority,n=t.priority,ms(i)<ms(n)?1:-1;var i,n}));return t[0]?t[0]:null};var xs=i(44483),hs=i(33633);const bs=()=>{const{currentDevice:e}=(0,Sa.l)(),t=gs(),i=vs(t),[a,s]=(0,n.useState)(e.isLocal&&null!==i);if((0,hs.W)(xs.P.UPDATE,(()=>s(e.isLocal&&null!==i))),null===i||!a)return null;return(0,C.jsx)(ds,{...i,onDismiss:()=>{i.onDismiss(),s(!1)}})};var ys=i(408);const fs="hmVfxvHNFzG0vUNl80tU",js="TuVVAkUzyLv_yCLzKTqW",Cs=()=>{const[e,t]=(0,n.useState)(!0),{deviceFilterState:i,isMaybeHeadphoneDevice:a}=(0,Ae.j)(),s=i.isOnboarded,{incrementDismissCountForDevice:r,isDeviceDismissed:o}=ps(),l=(0,n.useMemo)((()=>a&&!s&&!o),[o,a,s]),c=(0,N._Y)(),u=(0,n.useCallback)((()=>c(W.$S.PUFFIN_START_ACTIVATION)),[c]),d=(0,n.useCallback)((()=>{r(),t(!1)}),[r]);return l&&e?(0,C.jsx)(X.v,{id:"puffinDevicePickerUpsell",variant:"tinted",size:"lg",className:fs,title:_.Ru.get("web-player.puffin.get-started.title"),subtitle:_.Ru.get("web-player.puffin.get-started.subtitle"),paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,C.jsx)(Jt.n,{size:"small",onClick:u,children:_.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm")}),trailing:(0,C.jsx)(J.H,{className:js,semanticColor:"textSubdued",iconOnly:os.M,size:"small",onClick:d,condensedAll:!0,"aria-label":_.Ru.get("close")})}):null};var ws=i(31288),ks=i(38823),Ss=i(10688),Ns=i(49196);function Rs(){return(0,cn.N)(Ns.v)}const Es=()=>{const e=Rs(),{devices:t,currentDevice:i}=(0,Sa.l)(),a=(()=>{const e=Rs(),[t,i]=(0,n.useState)([]),a=(0,n.useCallback)((()=>{e.getJamDevices().then((e=>i(e)))}),[e]);return(0,Mn.c)(Pn.P.SCAN_UPDATE,(()=>a())),(0,n.useEffect)((()=>a()),[a]),t})(),[s,r]=(0,n.useState)(t.map((e=>(0,Un.gS)(e)))),o=(0,Qi.dh)((()=>{const n=e.combineJamsWithEntities(t,a,i.connectStateId);r(n)}),100,{leading:!1,trailing:!0});return(0,n.useEffect)((()=>o()),[t,a,i,o]),s},Is="h0XG5HZ9x0lYV7JNwhoA",As="JHlPg4iOkqbXmXjXwVdo",Ts="jEsh5c0FZojBDcUF990w",Ls=()=>{const e=(0,ks.O)(),t=(0,ze.v)(),i=(0,V.l)(),a=(0,ys.C)(),r=(0,s.NC)(Li.Yr),o=(0,s.NC)(Li.Q5),{devices:c}=(0,Sa.l)(),u=Es(),{isPlaying:d}=(0,Ss.GK)(),[v]=(0,N.sV)(),x=(0,n.useRef)(a),h=(0,n.useRef)(v.context.devicePicker?.interactionId);x.current=a,h.current=v.context.devicePicker?.interactionId;const b=(0,P.d4)((e=>e.playback?.castState??window.cast?.framework.CastState.NO_DEVICES_AVAILABLE)),y=(0,ws.Or)(b);return(0,n.useEffect)((()=>()=>{x.current(h.current)}),[h]),(0,n.useEffect)((()=>{e.startActiveDiscovery()}),[e]),(0,C.jsx)(We._,{label:_.Ru.get("playback-control.connect-picker"),focusTransferId:"DEVICE-PICKER",children:(0,C.jsx)(m.w,{className:l()(Is,{[As]:o}),fixedHeader:(0,C.jsx)(p.a,{title:o?(0,ue.v)("Connect"):_.Ru.get("playback-control.connect-picker"),panel:g.Z.DevicePicker}),children:(0,C.jsxs)("div",{role:"group",className:Ts,children:[o?(0,C.jsx)(rs,{}):(0,C.jsx)(Ha,{isPlaying:d}),o?(0,C.jsx)(bs,{}):t&&!i&&(0,C.jsx)(Cs,{}),(0,C.jsx)(za,{devices:r?u:c.map((e=>(0,Un.gS)(e))),areWebPlayerCastDevicesAvailable:y})]})})})},Ds=()=>null;var Os=i(53177),Fs=i(41205),Us=i(40767),Bs=i(42296),Ps=i(61434),_s=i(42551);const Ms=(0,_s.Mz)([e=>e.ads],(e=>e.embeddedAd)),Hs=(0,_s.Mz)(Ms,(e=>e?.ad)),Vs=(0,_s.Mz)(Ms,(e=>e?.isOpen||!1)),zs=(0,_s.Mz)(Ms,(e=>e?.canShowAd||!1)),qs=(0,_s.Mz)(Ms,(e=>e?.lastTimeInView));var Gs=i(85706),Qs=i(41045),Ys=i(12496);const Ws=e=>{const t=(0,Qs.Z)(e);return!(!t||e&&!(0,Ys.v)(e))&&t?.uid!==e?.uid};var Zs=i(8558);const Ks=()=>{const e=(0,P.wA)(),t=(0,Gs.$)(),i=(0,P.d4)((e=>e.ui.videoPlayer.uiFlags.npv)),a=(0,s.NC)(Zs.Ym5,{loadingValue:!1}),r=(0,s.NC)(Zs._TI),o=(0,Vn.o)((e=>e?.item),((e,t)=>e?.uid===t?.uid)),l=(0,P.d4)(zs),c=!!(0,P.d4)(Hs),u=(0,P.d4)(qs),d=(({canShowEmbeddedAd:e,nvpIsActive:t,trackChanged:i,featureEnabled:a,storeHasAd:s,isFocused:r,enoughTimePassedSinceLastRender:o})=>(0,n.useMemo)((()=>!!e&&t&&i&&a&&r&&!s&&o),[e,t,i,a,s,r,o]))({canShowEmbeddedAd:l,nvpIsActive:i,trackChanged:Ws(o),featureEnabled:a,storeHasAd:c,isFocused:t,enoughTimePassedSinceLastRender:!u||Date.now()-u>1e3*r});return(0,n.useEffect)((()=>{d&&e((0,Ps.PY)())}),[d,e,o]),null};var Xs=i(16511);const Js=({children:e})=>{const[t,i]=(0,n.useState)(null),a=(0,n.useCallback)((()=>{i(Xs.j.Errored)}),[]),s=(0,n.useMemo)((()=>({state:t,capturePlaybackError:a})),[t,a]);return(0,C.jsx)(Xs.O.Provider,{value:s,children:e})},$s=(0,n.lazy)((()=>Promise.all([i.e(2039),i.e(2235),i.e(5346)]).then(i.bind(i,13212)))),er=e=>(0,C.jsx)(Js,{children:(0,C.jsx)($s,{...e})});var tr=i(93018),ir=i(35580);const nr=()=>(0,C.jsx)(C.Fragment,{});var ar=i(66605),sr=i(98349),rr=i(30334),or=i(85028),lr=i(88640),cr=i(60988),ur=i(37588),dr=i(37867),mr=i(38975);const pr="ykU0u_RLxGVmkHVI7if7",gr="KpPP2M5NXZAY5NwqT1uf",vr=({uri:e})=>{const{spec:t,logger:i}=(0,qe.r)(ar.t,{}),n=(0,P.wA)(),{data:a}=(0,sr.S)(e),[s,r]=(0,mr.A)(e);if(!a)return null;const{description:o,name:l,images:c}=a,u=(0,dr.t)({avatarImages:c,preferFullBleed:!1});return(0,C.jsxs)(ur.M,{name:l,openModal:()=>{const e=t.authorAboutModalButtonFactory().hitUiReveal();i.logInteraction(e),n((0,Gi.Te)({bio:a.description,images:a.images.slice(0,1),name:a.name}))},children:[(0,C.jsx)(lr.R,{cardVariant:u,avatarImageSources:c,header:_.Ru.get("web-player.now-playing-view.author-about.title"),name:l}),(0,C.jsxs)("div",{className:pr,children:[(0,C.jsxs)("div",{className:gr,children:[(0,C.jsx)(cr.c,{name:l,uri:e,onLinkClick:()=>i.logInteraction(t.authorNameFactory().hitUiNavigate({destination:e}))}),(0,C.jsx)(or.T,{toggleFollow:n=>{n.preventDefault(),n.stopPropagation();const a=s?t.followButtonFactory().hitUnfollow({itemToBeUnfollowed:e}):t.followButtonFactory().hitFollow({itemToBeFollowed:e});i.logInteraction(a),r(!s)},isInLibrary:s})]}),(0,C.jsx)(rr._,{text:o})]})]})},xr=({item:e})=>{const t=e.book.authors.at(0)?.uri;return t?(0,C.jsx)(vr,{uri:t}):null};var hr=i(29025),br=i(9676),yr=i(64947),fr=i(30386),jr=i(52479),Cr=i(24173),wr=i(12513),kr=i(87419),Sr=i(17872),Nr=i(83165),Rr=i(79922),Er=i(19492);var Ir=i(28722),Ar=i(80571),Tr=i(27120);const Lr="_QEMUk5U16U3CQn0wvbD",Dr="mbkl2P60JUhDqc9qGvp9",Or="Xh6dG3pzi2SS7v4cvZzG",Fr="sOdoW26RUwggLToa7xDt",Ur="B_TcBcc1BM2yLgvXbh66",Br="tRnhyUQiKOxA3z8mUD_U",Pr="_shxqlkLuB52H1iCh_OQ",_r="hAwePVlxumRNpdOSpwyV";const Mr=n.forwardRef((function({className:e="",segment:t,onClickPlay:i,isPlaying:a},s){const{label:r,Icon:o}=(0,n.useMemo)((()=>function(e){if("TALK"===e.type)return{Icon:Cr.L,label:_.Ru.get("playlist.a11y.play",e.title)};const t=e.track.artists?.map((e=>e.name)).join(_.Ru.getSeparator())||"";return{Icon:wr.v,label:_.Ru.get("tracklist.a11y.play",e.track.name,t)}}(t)),[t]),c=(0,n.useCallback)((()=>{i()}),[i]);return(0,C.jsxs)("div",{className:l()(Pr,e),children:[a?(0,C.jsx)(Ar.J,{className:Br,animated:!0}):(0,C.jsx)("span",{className:Br,children:(0,C.jsx)(o,{iconSize:16,"aria-hidden":"true"})}),(0,C.jsx)(Nr.x,{className:Ur,iconClassName:_r,onClick:c,isPlaying:a,isLocked:!1,playAriaLabel:r,ref:s})]})})),Hr=({children:e,onTriggerPlay:t,episodeUri:i,index:n})=>{const{spec:a,logger:s}=(0,qe.r)(kr.f,{}),r=(0,Qi.YQ)((()=>{const e=s.logInteraction(a.segmentItemFactory({uri:i,position:n||0}).doubleHitPlay({itemToBePlayed:i}));t(e)}),Tr.d,{leading:!0,trailing:!1});return(0,C.jsx)("div",{className:Fr,onDoubleClick:r,children:e})},Vr=({segment:e,episodeUri:t,index:i})=>{const{spec:a,logger:s}=(0,qe.r)(kr.f,{}),{isActive:r,isPlaying:o,onClick:l}=(0,Ir.L)({episodeUri:t,start:e.start,stop:e.stop}),c={uri:t},u=function(e){const t=[{url:e.track.album.image}];return{type:Er.c.TRACK,uri:e.uri,uid:null,provider:null,images:t,name:e.track.name,mediaType:"audio",duration:{milliseconds:0},album:{type:Er.c.ALBUM,uri:e.track.album.uri,name:e.track.album.name,images:t},artists:e.track.artists.map((e=>({type:Er.c.ARTIST,name:e.name,uri:e.uri})))}}(e),d=a.segmentItemFactory({uri:t,position:i||0}).playbackButtonFactory(),m=(0,n.useCallback)((()=>{l({}),r&&o?s.logInteraction(d.hitPause({itemToBePaused:t})):r&&!o?s.logInteraction(d.hitResume({itemToBeResumed:t})):s.logInteraction(d.hitPlay({itemToBePlayed:t}))}),[t,r,o,s,l,d]);return(0,C.jsxs)(Hr,{onTriggerPlay:l,episodeUri:t,children:[(0,C.jsx)(Mr,{segment:e,isActive:r,isPlaying:o,onClickPlay:()=>{m()}}),(0,C.jsx)(Rr.d,{context:c,item:u,titleTypeVariant:"bodyMedium",subtitleTypeVariant:"bodySmall",onTitleClick:e=>{s.logInteraction(a.segmentItemFactory({uri:t,position:i||0}).albumLinkFactory({uri:c.uri}).hitUiNavigate({destination:e||""}))},onSubtitleClick:e=>{s.logInteraction(a.segmentItemFactory({uri:t,position:i||0}).artistLinkFactory({uri:e||"",position:0}).hitUiNavigate({destination:e||""}))}})]})},zr=({segment:e,episodeUri:t,index:i})=>{const{spec:a,logger:s}=(0,qe.r)(kr.f,{}),{isActive:r,isPlaying:o,onClick:l}=(0,Ir.L)({episodeUri:t,start:e.start,stop:e.stop}),u=function(e){const t=[];return{type:Er.c.UNKNOWN,uri:e.uri,uid:null,provider:null,images:t,name:e.title,mediaType:"audio",duration:{milliseconds:0},album:{type:Er.c.ALBUM,uri:e.show.uri,name:e.show.name,images:t},artists:[]}}(e),d=a.segmentItemFactory({uri:t,position:i||0}).playbackButtonFactory(),m=(0,n.useCallback)((()=>{l({}),r&&o?s.logInteraction(d.hitPause({itemToBePaused:t})):r&&!o?s.logInteraction(d.hitResume({itemToBeResumed:t})):s.logInteraction(d.hitPlay({itemToBePlayed:t}))}),[t,r,o,s,l,d]);return(0,C.jsxs)(Hr,{onTriggerPlay:l,episodeUri:t,children:[(0,C.jsx)(Mr,{segment:e,isActive:r,isPlaying:o,onClickPlay:()=>{m()}}),(0,C.jsx)(Sr.r,{title:u.name,children:(0,C.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:u.name})},u.name)]})};var qr=i(41167),Gr=i(47157);function Qr(e){return!!(0,Gr.o)().getCapabilities().isSupported&&function(e){const t=e.metadata?.["parent_episode.uri"];return!!t&&(0,ji.gHQ)(t)}(e)}var Yr=i(75082);const Wr=(0,Os.mc)((({item:e})=>{const t=e.metadata?.["parent_episode.uri"],i=function(e){const t=(0,Gr.o)();return(0,n.useCallback)((async(i,n)=>{if(!e)return[];try{return await t.getSegments(e,i,n)}catch(e){return[]}}),[e,t])}(t),[a,s]=(0,n.useState)([]),r=(0,n.useRef)(!1),o=(0,n.useRef)(0),l=(0,n.useCallback)((()=>{const e=o.current;null!==e&&(r.current||(r.current=!0,i(e,10).then((e=>{s((t=>{const i=t.concat(e);return o.current=i.length+1,i})),r.current=!1}))))}),[i]);return(0,n.useEffect)((()=>{s([])}),[e.uri]),t?(0,C.jsxs)(qr.w,{className:Lr,children:[(0,C.jsx)(qr.X,{className:Dr,children:_.Ru.get("music_and_talk.in_this_episode")}),(0,C.jsx)("div",{className:Or,children:(0,C.jsx)(Yr._,{onReachBottom:l,triggerOnInitialLoad:!0,children:a.map(((e,i)=>"MUSIC"===e.type?(0,C.jsx)(Vr,{segment:e,episodeUri:t},`${e.uri}-${i}`):(0,C.jsx)(zr,{segment:e,episodeUri:t},`${e.uri}-${i}`)))})})]}):null}),{name:"NPVInThisEpisode"});var Zr=i(6233),Kr=i(95202),Xr=i(96977),Jr=i(61728);const $r="f6_Fu_ei4TIJWR0wzvTk",eo="TLmzadNIdvV8sYzTuXRg",to="MT9De6UrCVQ8Qo6o3ikA",io=n.memo((()=>{const{cssStyles:e}=(0,Jr.Y)();return(0,C.jsx)("div",{className:$r,style:{"--section-background-base":e?.["--section-background-base"]},"aria-hidden":!0,children:(0,C.jsxs)("div",{className:eo,children:[(0,C.jsx)(Xr.Y,{as:"div",variant:"bodyMediumBold",className:to,charCount:8,isLoading:!0}),[20,50,25].map(((e,t)=>(0,C.jsx)(Xr.Y,{as:"div",variant:"bodySmall",className:to,charCount:e,isLoading:!0},t)))]})})}));var no=i(32360),ao=i(81469),so=i(50151),ro=i(45395);const oo=(0,n.lazy)((async()=>{const{TopCommentsCard:e}=await Promise.resolve().then(i.bind(i,57115));return{default:e}}));var lo=i(79945),co=i(38701);const uo=({item:e,spec:t})=>{const i=(0,n.useCallback)((()=>{}),[]),a=(0,s.NC)(Zs.xEc),r=(0,lo.d)(),o=(0,co.d)(e.uri)?.episodeOrChapter,l=Qr(e),c={uri:e.uri,numberOfChapters:jr.Kp},{data:u,isLoading:d,error:m}=(0,ao.X)({queryKey:["queryNpvEpisode",c],staleTime:jr.Ff,gcTime:jr.CD,variables:c});if(d&&e.uri&&!m)return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(io,{}),(0,C.jsx)(io,{})]});const p=(0,br.SB)(u?.episodeUnionV2),g=(0,br.lz)(u?.episodeUnionV2);if(!e.uri||!p||d||m)return null;const v=o&&o.type===Er.c.EPISODE&&o.transcript&&o.transcript.length>0;return(0,C.jsxs)(gn.r,{spec:t,children:[r&&(0,C.jsx)(n.Suspense,{fallback:null,children:(0,C.jsx)(oo,{uri:p.uri})}),(0,C.jsx)(fr.N,{episode:p}),!p.originalEpisode&&(0,C.jsx)(yr.c,{episode:p}),(0,C.jsx)(so.F,{episode:p}),!l&&(0,C.jsx)(hr.I,{episode:p}),a&&g&&(0,C.jsx)(Kr.m,{coverArt:g.coverArt||void 0,description:g.htmlDescription||"",name:g.name,publisher:g.publisher?.name,uri:g.uri}),v&&(0,C.jsx)(ro.n,{episode:e}),l&&(0,C.jsx)(Wr,{item:e}),(0,C.jsx)(no.K,{topics:g?.topics.items??[],logTopicNavigation:i}),(0,C.jsx)(Zr.A,{})]})},mo=({item:e,spec:t})=>(0,Si.n)()?(0,C.jsx)(uo,{item:e,spec:t}):(0,C.jsx)(C.Fragment,{}),po=()=>(0,C.jsx)(C.Fragment,{});var go=i(74734),vo=i(10658),xo=i(5968),ho=i(51598),bo=i(22752),yo=i(80772),fo=i(9098),jo=i(5920);const Co="BwWUH9yjgY_WvN25wDeP",wo="cHBYwKeb2FSgzFWglPRH",ko="HzNOPORl7WOGyK9UyEQ5",So="VfpX7TZbPNCABaui6xBp",No="Sb2rC16jDkGc9eweOU8g",Ro="DMYN160EH08ptMceRIEz",Eo="BO5glvOfX032J6W28Dit",Io="sTihEgSs3yBFALZdsa2V",Ao="main-nowPlayingView-lyricsGradient",To="SjlTHRmuefFiB_RQTR9O",Lo="KJK5nyHkgL2CCw1mKMt4",Do=({uri:e})=>{const{spec:t,logger:i}=(0,qe.r)(jo.X,{}),{mode:n,setMode:a}=(0,fo.r)();return(0,C.jsxs)("div",{className:ko,children:[n===Fn.YU.npv&&(0,C.jsx)(d.$,{label:_.Ru.get("web-player.now-playing-view.lyrics.show-less"),colorSet:"invertedLight",size:"small",onClick:()=>{i.logInteraction(t.lyricsModeExpandedFactory({uri:e}).showLessButtonFactory().hitUiHide()),a(Fn.YU.static)},children:_.Ru.get("web-player.now-playing-view.lyrics.show-less")}),n===Fn.YU.static&&(0,C.jsx)(d.$,{label:_.Ru.get("web-player.now-playing-view.lyrics.show-more"),colorSet:"invertedLight",size:"small",onClick:()=>{i.logInteraction(t.lyricsModePreviewFactory({uri:e}).showMoreButtonFactory().hitUiReveal()),a(Fn.YU.npv)},children:_.Ru.get("web-player.now-playing-view.lyrics.show-more")})]})};var Oo=i(33278);const Fo="CYp94DZpsBBc8VTtyKtg",Uo="FmLR481pO58TJmXKoHjK",Bo="PbfyPbvSNDShjhPRRP7M",Po=({uri:e})=>{const{spec:t,logger:i}=(0,qe.r)(jo.X,{}),n=t.lyricsModePreviewFactory({uri:e}).cappedModalFactory(),a=(0,un.t)(n);return(0,C.jsx)("div",{className:Fo,children:(0,C.jsxs)("div",{className:Uo,ref:a,children:[(0,C.jsx)(c.E,{semanticColor:"textBase",className:Bo,as:"p",children:_.Ru.get("web-player.lyrics.capped.monthly-limit-reached")}),(0,C.jsx)(Oo.k,{onClick:e=>{i.logInteraction(n.cappedLearnMoreButtonFactory().hitNavigateToExternalUri({destination:e}))}})]})})};var _o=i(70417),Mo=i(10909),Ho=i(62139),Vo=i(13232),zo=i(33720),qo=i(6938);const Go=({uri:e})=>{const{spec:t,logger:i}=(0,qe.r)(jo.X,{}),{setMode:a}=(0,fo.r)(),s=(0,n.useCallback)((()=>{i.logInteraction(t.lyricsModePreviewFactory({uri:e}).hideLyricsButtonFactory().hitUiHide()),a(Fn.YU.none)}),[a,e,i,t]);return(0,C.jsx)(on.D,{role:"menuitem",onClick:s,children:_.Ru.get("web-player.now-playing-view.lyrics.hide-option")})},Qo=({uri:e})=>(0,C.jsx)(sn.W,{children:(0,C.jsx)(Go,{uri:e})});var Yo=i(31592);const Wo=({label:e,onClick:t,iconOnly:i,nodeRef:n})=>(0,C.jsx)(Xi.Zp,{label:e,children:(0,C.jsx)(J.H,{ref:n,className:Io,iconOnly:i,size:"small",onClick:t,"aria-label":e})}),Zo=({uri:e})=>{const{spec:t,logger:i}=(0,qe.r)(jo.X,{}),a=t.lyricsModeExpandedFactory({uri:e}),s=(0,un.t)(a),r=(0,zo.l)(),o=(0,qo.F)(),l=(0,n.useRef)(null);(0,$.X)("NPV_OPEN_CINEMA_LYRICS",l,3e3);const c=(0,Ho.lZ)(),{isFullScreenSupported:u,toggleFullScreen:d}=(0,Yo.H)({refOrElement:document.body});return(0,C.jsxs)("div",{ref:s,className:wo,children:[c&&u&&(0,C.jsx)(Wo,{label:_.Ru.get("web-player.now-playing-view.lyrics.fullscreen"),onClick:async()=>{i.logInteraction(a.buttonFullscreenFactory().hitUiReveal());try{await d()}catch(e){}o("lyrics"),r(Ei.z.NOW_PLAYING_VIEW)},iconOnly:Vo.T,nodeRef:l}),(0,C.jsx)(Wo,{label:_.Ru.get("web-player.now-playing-view.lyrics.cinema-mode"),onClick:()=>{r(Ei.z.NOW_PLAYING_VIEW),o("lyrics"),i.logInteraction(a.cinemaModeButtonFactory().hitUiReveal())},iconOnly:_o.L,nodeRef:l})]})},Ko=({uri:e})=>{const{spec:t}=(0,qe.r)(jo.X,{}),i=(0,un.t)(t.lyricsModePreviewFactory({uri:e}));return(0,C.jsx)("div",{ref:i,className:wo,children:(0,C.jsx)($i.b,{placement:"bottom-end",menu:(0,C.jsx)(Qo,{uri:e}),children:(0,C.jsx)(Ji.e,{className:Io,size:"small",condensed:!1,label:_.Ru.get("more")})})})},Xo=({uri:e})=>{const{spec:t,logger:i}=(0,qe.r)(jo.X,{}),n=(0,un.t)(t.lyricsModeHiddenFactory({uri:e})),{setMode:a}=(0,fo.r)(),s=_.Ru.get("web-player.now-playing-view.show.lyrics");return(0,C.jsx)("div",{ref:n,className:l()(wo,Eo),children:(0,C.jsx)(Wo,{label:s,onClick:()=>{a(Fn.YU.static),i.logInteraction(t.lyricsModeHiddenFactory({uri:e}).showLyricsButtonFactory().hitUiReveal())},iconOnly:Mo.r})})};var Jo=i(40964),$o=i(5916);const el=(0,Os.mc)((({item:e})=>{const t=(0,n.useRef)(null),{mode:i}=(0,fo.r)(),a=(0,n.useRef)(null),s=(0,n.useRef)(0),{data:r}=(0,yo.J)(),o=(0,Vn.o)((e=>e?.nextItems?.[0]),((e,t)=>e?.uri===t?.uri));(0,bo.I)(o?.uri,o?.images);const u=(0,n.useCallback)((()=>{s.current=Date.now()}),[]),d=(0,n.useCallback)((({lineRef:e,isActiveLine:n,shouldAnimateScroll:r,activeLineIndex:o,isFirstLine:l})=>{if(i!==Fn.YU.npv)return;if(!t.current||!a.current)return;let c;if(e.current&&n?c=e.current?.offsetTop-a.current?.offsetTop-16:l&&o<0&&(c=0),void 0===c)return;const u=a.current?.scrollTop,d=Math.abs(u-c),m=t.current.clientHeight,p=Date.now()-s.current<2e3,g=s.current>0&&d>1*m;if(p||g)return;s.current=0;const v="visible"===document.visibilityState&&r?"smooth":"auto";a.current?.scrollTo({top:c,behavior:v})}),[i]);(0,n.useLayoutEffect)((()=>{s.current=0,a.current?.scrollTo({top:0,behavior:"auto"})}),[e.uri]);const m=r?.hasLyrics?r.dynamicColors?.higherContrast:null;if(!r?.hasLyrics)return null;const p=r?.hasLyrics&&!r.isTimeSynced,g={"--lyrics-color-active":m?.textBase.toCSS($o.a.RGBA)??(p?xo.ONy:r.colors.activeText),"--lyrics-color-inactive":m?.textSubdued.toCSS($o.a.RGBA)??r.colors.text,"--lyrics-color-passed":m?.textBase.toCSS($o.a.RGBA)??Jo.Q.fromCSS(r.colors.activeText,.7).toCSS($o.a.RGBA),"--lyrics-color-background":m?.backgroundBase.toCSS($o.a.RGBA)??r.colors.background},v="CAPPED"===r?.capStatus;return(0,C.jsxs)(qr.w,{className:l()(Co,Ao,{[So]:i===Fn.YU.static,[No]:i===Fn.YU.npv}),style:g,ref:t,testId:"lyrics-npv-section",children:[(0,C.jsx)(qr.X,{action:(()=>{switch(i){case Fn.YU.npv:return(0,C.jsx)(Zo,{uri:e.uri});case Fn.YU.static:return(0,C.jsx)(Ko,{uri:e.uri});default:return(0,C.jsx)(Xo,{uri:e.uri})}})(),className:l()({[Ro]:i===Fn.YU.npv}),children:i===Fn.YU.static?_.Ru.get("web-player.now-playing-view.lyrics.title-preview"):_.Ru.get("web-player.lyrics.title")}),(0,C.jsxs)("div",{className:l()(To,{[Lo]:i===Fn.YU.npv}),ref:a,onWheel:u,onScroll:u,children:[p&&i===Fn.YU.npv&&(0,C.jsx)(c.E,{as:"p",variant:"bodySmall",dir:"auto",style:{color:r.colors.text},children:_.Ru.get("web-player.lyrics.unsynced")}),(0,C.jsx)(ho.x,{trackUri:e.uri,data:{...r,isTimeSynced:i!==Fn.YU.static&&r.isTimeSynced},format:"card",onActiveLineChange:d,isSnippet:i===Fn.YU.static})]}),v?(0,C.jsx)(Po,{uri:e.uri}):(0,C.jsx)(Do,{uri:e.uri})]})}),{name:"NPVLyrics"});var tl=i(72365),il=i(10751),nl=i(39963),al=i(38054),sl=i(24114),rl=i(2772),ol=i(80722),ll=i(33849),cl=i(77841),ul=i(17621),dl=i(53595),ml=i(80120);const pl="Kz3HNT1PWTHOL6wjYXb8",gl="Fip8h1J04RvF8_CRfdwc",vl="WEz9K1UHOS2wrRWQmZBo",xl="AUxek3jYdcq9XPBwL7N0",hl=({images:e,breakpoint:t,type:i,name:n,isPlaying:a,onClick:s,...r})=>(0,C.jsxs)("div",{className:gl,children:[(0,C.jsx)("div",{className:vl,children:(0,C.jsx)(dl.e,{images:e,breakpoint:t,type:i,name:n,...r})}),(0,C.jsx)("div",{className:l()(pl,{[xl]:i===Er.c.ARTIST||i===Er.c.USER}),children:(0,C.jsx)(ml.R,{onClick:s,isPlaying:a,version:ml.H.transparent,size:"small"})})]});var bl=i(98098),yl=i(40381),fl=i(34939);function jl({uri:e,spec:t,logger:i,images:a}){const{usePlayContextItem:s}=(0,fl.P)({uri:e},{featureIdentifier:"track"}),{isPlaying:r,isActive:o,togglePlay:l}=s({uri:e}),c=(0,n.useCallback)((()=>{const n=(0,bl.$I)({spec:t.playbackButtonFactory(),logger:i,uri:e,isActive:o,isPlaying:r});l({loggingParams:n})}),[t,i,e,o,r,l]);return(0,C.jsx)(hl,{type:Er.c.TRACK,size:yl.Qe.SIZE_48,images:a??[],breakpoint:ul.e.SMALL,name:"",loadingMode:"lazy",isPlaying:r,onClick:c})}var Cl=i(35655),wl=i(37739);const kl="xwokxeEfMKnFFg0UPVC7",Sl="mNgLTx6k86JO7fS8CBx5",Nl="k1ZhEUZAYffOk3UxUsYF",Rl="toF4isn16zybsTjDktbg",El="pXKTpGpCyvyKgwx858dg",Il="TGaA9GNwNHNqOI1puGsG",Al="WbAVELAe4MYolhkCc3Fi",Tl="dbxGYAFrGj4AmrkUZUF_",Ll="R9vTZwai2jSPTWVMsiwJ",Dl="jgrHQqqua05ZPua5D9FG",Ol="RuZBN01h_ndf_5HWz8PD",Fl="A80fpjJSB0qHk0hL0C9x",Ul="koRjwkroF5WiR0X2mPtc",Bl="KLD8LzZlxKsRrqV4j2EP";function Pl({spec:e,logger:t,uri:i}){const a=(0,n.useCallback)((n=>{const a=e.heartButtonFactory().hitLike({itemToBeLiked:i}),s=e.heartButtonFactory().hitRemoveLike({itemNoLongerLiked:i});t.logInteraction(n?a:s)}),[e,i,t]);return(0,C.jsx)(wl.b,{onClick:a,uri:i,size:Cl.t.sm,className:Al})}var _l=i(60749),Ml=i(95144),Hl=i(2232),Vl=i(48431),zl=i(3256),ql=i(54947);function Gl({spec:e,logger:t,track:i}){const{badges:a,hasBadges:s}=(0,ql.b)({isExplicit:i.contentRating?.label===zl.x7.Explicit,isMOGEFRestricted:i.contentRating?.label===zl.x7.NineteenPlus}),r=(i,n)=>()=>{const a=e.artistLinkFactory({position:n,uri:i}).hitUiNavigate({destination:i});t.logInteraction(a)};return(0,C.jsx)(Zi.j,{dir:"auto",children:(0,C.jsxs)(c.E,{semanticColor:"textSubdued",variant:"bodySmall",className:Dl,children:[s&&(0,C.jsxs)("span",{className:Tl,children:[a.explicit&&(0,C.jsx)(Hl.U,{}),a.nineteen&&(0,C.jsx)(Vl.q,{size:16,className:Ll})]}),(0,C.jsx)(c.E,{semanticColor:"textSubdued",variant:"bodySmall",children:_.Ru.get("song")}),(0,C.jsx)(c.E,{semanticColor:"textSubdued",variant:"bodySmall",children:(0,C.jsx)(C.Fragment,{children:"•"})}),(0,C.jsx)("span",{className:Ol,children:i.artists.items.map(((e,t,i)=>(0,C.jsxs)(n.Fragment,{children:[(0,C.jsx)(Ki.h,{menu:(0,C.jsx)(Ml.t,{uri:e.uri}),children:(0,C.jsx)(_l.N_,{to:e.uri,onClick:r(e.uri,t),children:(0,C.jsx)(c.E,{variant:"bodySmall",className:Ul,children:e.profile.name})})}),t<i.length-1&&_.Ru.getSeparator()]},`${e.uri}-${t}`)))})]})})}var Ql=i(55712);const Yl=(0,Os.mc)((({track:e,position:t})=>{const{spec:i,logger:n}=(0,Ql.D)(rl.i,{data:{position:t,uri:e.uri,reason:""}}),{isActive:a}=(0,Ss.l_)(e.uri);return(0,C.jsx)("div",{className:Il,children:(0,C.jsx)(Ki.h,{menu:(0,C.jsx)(ol.P,{uri:e.uri}),children:(0,C.jsx)(ll.k,{isActive:a,id:e.uri,size:"lg",onClick:()=>{},isRedundantOnClick:!0,variant:"elevated",hoverBackgroundColor:"backgroundElevatedHighlight",activeBackgroundColor:"backgroundElevatedBase",className:Bl,breakpoint:ul.e.SMALL,media:(0,C.jsx)(jl,{uri:e.uri,spec:i,logger:n,images:e.albumOfTrack?.coverArt?.sources??[]}),title:(0,C.jsx)(cl.U,{lineClamp:1,children:e.name}),subtitle:(0,C.jsx)(Gl,{spec:i,logger:n,track:e}),trailing:(0,C.jsx)(Pl,{spec:i,logger:n,uri:e.uri})})})})}),{name:"RelatedAudioTracksChild"}),Wl=(0,Os.mc)((({data:e,item:t,position:i=0,fullBleedGap:n=0,carouselCardWidth:a=280})=>{const{spec:s,logger:r}=(0,Ql.D)(al.f,{data:{identifier:"related-audio-tracks",position:i,uri:t.uri}}),o=(0,un.t)(s),c=_.Ru.get("web-player.now-playing-view.related-audio-tracks-title");if(!t.uri||"Track"!==e?.trackUnion.__typename||0===e.trackUnion.associationsV3?.unmappedVideoTrackAssociations.items.length)return null;const u=e.trackUnion.associationsV3.unmappedVideoTrackAssociations.items;return(0,C.jsx)(qr.w,{ref:o,className:Nl,style:{"--full-bleed-gap":`${n}px`,"--carousel-shelf-element-width":`${a}px`},children:(0,C.jsxs)(gn.r,{spec:s,children:[(0,C.jsx)(qr.X,{className:l()(Sl),children:c}),(0,C.jsx)(sl.FN,{chevronsClassName:kl,scrollContentClassName:l()(El),scrollerClassName:l()(Rl),scrollingMethod:sl.Hv.BY_RATIO,scrollRatio:.5,wheelScrollEnabled:!1,dragToScrollOptions:{isDisabled:!1},showButtons:sl.C_.ON_HOVER,onNavigationClick:()=>r.logInteraction(s.shelfHeaderFactory().shelfCarouselControlsFactory().shelfCarouselControlsPreviousFactory().hitUiReveal()),edgeGradients:sl.TB.NONE,children:(0,C.jsx)(nl.FK,{className:Fl,"aria-label":c,items:u,layout:"stack",children:e=>{if("Track"!==e.associatedTrack?.data.__typename)return null;const t=e.associatedTrack.data;return(0,C.jsx)(nl.KP,{id:t.uri,"aria-label":t.name,children:(0,C.jsx)(Yl,{track:t,position:u.indexOf(e)})})}})})]})})}),{name:"RelatedAudioTracks"});var Zl=i(26552),Kl=i(67380);const Xl=({item:e,spec:t})=>{const i=(0,s.NC)(Zs.LX5),n=(0,s.NC)(Zs.RsN),{loading:a,error:r,data:o}=(0,Kl.i)(e),l=(0,s.NC)(Zs.L$q),c=Qr(e);if(a&&e.uri&&!r)return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(io,{}),(0,C.jsx)(io,{}),(0,C.jsx)(io,{})]});if(!e.uri||"Artist"!==o?.artistUnion.__typename||"Track"!==o?.trackUnion.__typename||a||r)return null;const{profile:u,stats:d,visuals:m,profile:{externalLinks:p}}=o.artistUnion,{credits:g}=o.trackUnion,v=l!==Zs.vkU.CONTROL;return(0,C.jsx)(C.Fragment,{children:(0,C.jsxs)(gn.r,{spec:t,children:[v&&(0,C.jsx)(el,{item:e}),i&&(0,C.jsx)(Zl.a,{data:o,item:e}),n&&(0,C.jsx)(Wl,{data:o,item:e,position:1+Number(v)+Number(i)}),(0,C.jsx)(go.F,{artistUri:o.artistUnion.uri,artist:u,stats:d,visuals:m,externalLinks:p.items}),g&&(0,C.jsx)(vo.V,{data:g,trackUri:e.uri}),(0,C.jsx)(il.I,{artistId:o.artistUnion.id,data:o.artistUnion.goods.concerts}),(0,C.jsx)(tl.J,{artistId:o.artistUnion.id,artistUri:o.artistUnion.uri,merch:o.trackUnion.merch.items}),c&&(0,C.jsx)(Wr,{item:e})]})})},Jl=({item:e,spec:t})=>(0,Si.n)()&&e.artists[0]?.uri?(0,C.jsx)(Xl,{item:e,spec:t}):(0,C.jsx)(C.Fragment,{});var $l=i(91030),ec=i(79530),tc=i(53502);const ic=({item:e,spec:t})=>(0,Ys.v)(e)&&!e.isLocal?(0,C.jsx)(Jl,{item:e,spec:t}):(0,Ys.v)(e)&&e.isLocal?(0,C.jsx)(po,{}):(0,tc.p)(e)?(0,C.jsx)(mo,{item:e,spec:t}):(0,ec.d)(e)?(0,C.jsx)(xr,{item:e}):(0,$l.N)(e)?(0,C.jsx)(nr,{}):null;var nc=i(46099),ac=i(49496),sc=i(81223),rc=i(43878),oc=i(23164);const lc="Ez4qKWmsDLh3iWdsnhKb",cc="ekcURLG5sTWx5S7E_Ul_",uc="_ChTSMj9kopaozdg25FG",dc=(0,n.forwardRef)((({spec:e,logger:t},i)=>{const a=(0,Pt.mv)(),s=a.operatingSystem===oc.f.macOS?(0,Ot.bj)("images/download-page-image-mac.png"):(0,Ot.bj)("images/download-page-image.png");const{downloadUrl:r}=(0,rc.z)(),o=(0,n.useCallback)((()=>{t.logInteraction(e.buttonDownloadFactory().hitNavigateToExternalUri({destination:r})),window.open(r,"_blank")}),[r,t,e]);return(0,C.jsxs)("div",{className:lc,ref:i,children:[(0,C.jsx)("div",{className:cc,style:{"--background-image":`url(${s})`}}),(0,C.jsxs)("div",{className:uc,children:[(0,C.jsx)(c.E,{variant:"titleMedium",semanticColor:"textBase",children:_.Ru.get("web-player.now-playing-view.web2desktop-funnel.title",{device:(0,sc.e)(a.operatingSystem)})}),(0,C.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textSubdued",children:_.Ru.get("web-player.now-playing-view.web2desktop-funnel.subtitle")}),(0,C.jsx)(d.$,{size:"medium",colorSet:"brightAccent",onClick:o,style:{alignSelf:"flex-start"},"aria-label":_.Ru.get("web-player.now-playing-view.web2desktop-funnel.button"),children:_.Ru.get("web-player.now-playing-view.web2desktop-funnel.button")})]})]})})),mc="Yl2wNWzQgsRb49UB30No",pc="Ko2eaQC7YRLTy1QsIY4Q";function gc(){const e=(0,ac.K)(),{spec:t,logger:i}=(0,qe.r)(nc.l,{}),a=(0,un.t)(t),s=(0,n.useCallback)((()=>{i.logInteraction(t.buttonSearchFactory().hitFocusInputField()),document.querySelector("[data-top-bar-search]")?.focus()}),[i,t]);return e?(0,C.jsx)(dc,{spec:t,ref:a,logger:i}):(0,C.jsxs)("div",{className:mc,ref:a,children:[(0,C.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",className:pc,children:_.Ru.get("queue.fine-something")}),(0,C.jsx)(d.$,{size:"small",colorSet:"brightAccent",onClick:s,children:_.Ru.get("web-player.now-playing-view.empty-state-cta")})]})}var vc=i(99912),xc=i(8335),hc=i(34589),bc=i(5334),yc=i(31284),fc=i(76776),jc=i(34118),Cc=i(94583);const wc="KHaAkbA62j5I7pcLsDAx",kc="Zaorh8_jZ8Vlyn3v2N3B",Sc="jKvr1cqkZZXpH5z92z9b",Nc="peN_VMHSmvTVUx9rneyY",Rc=({context:e,item:t,index:i,isVisible:n})=>{const{spec:a,logger:s}=(0,Ql.D)(Bs.J,{}),{draggable:r,onDragStart:o}=(0,Cc.P)(),{ref:c,inView:u}=(0,xc.Wx)({threshold:.5,initialInView:!0});return(0,C.jsx)("div",{className:l()(wc,{[kc]:n}),"data-testid":"minimized-track-visual-enhancement",children:(0,C.jsx)(Ki.h,{menu:(0,C.jsx)(tr.W,{context:e,item:t}),children:(0,C.jsx)("div",{draggable:r&&(0,Ys.v)(t),onDragStart:e=>{o(e,{itemUris:[t.uri],dragLabelText:(0,jc.r)(t)})},ref:c,children:(0,C.jsx)(fc.R,{uri:e.uri,owner:e.metadata?.context_owner,children:(0,C.jsx)(yc.e,{context:t.type===Er.c.TRACK?t.album:e,item:t,index:i,isVisible:!0,onClick:()=>{s.logInteraction(a.coverArtFactory({uri:t.uri}).hitUiNavigate({destination:t.type===Er.c.TRACK?t.album.uri:t.uri}))},adEventReason:hc.c.COVER_ART,children:(0,C.jsx)(bc.b,{className:l()(Sc,{[Nc]:u}),images:t.images??[],type:t.type,maxSize:56,desiredLabel:"small"})})})})})})};var Ec=i(66590),Ic=i(27377),Ac=i(53224),Tc=i(70719);const Lc="TkDZFBZ0IPbGaHDxeCci",Dc="bBG9E6mmFFC74pSkqU0o",Oc=({ad:e,backgroundColor:t,onClick:i})=>{const a=(0,Ac.H)(e.clickthroughUrl),s=e.metadata?.buttonMessage||_.Ru.get("ad-formats.learnMore");return(0,C.jsx)(Tc.N,{to:a,"data-testid":"ad-companion-card",onClick:i,className:Lc,children:(0,C.jsx)(X.v,{style:{backgroundColor:t},className:Dc,onClickHint:_.Ru.get("ad-formats.learnMore"),variant:"tinted",horizontalGap:(0,Ic.po)("looser"),id:e.adId,title:(0,C.jsx)(se.d,{variant:"bodySmallBold",children:e.metadata.advertiser||_.Ru.get("ad-formats.learnMore")}),trailing:(0,C.jsx)(n.Suspense,{fallback:(0,C.jsx)(ei.V,{}),children:e.metadata?.advertiser?(0,C.jsx)(d.$,{colorSet:"invertedLight",size:"small",children:s}):(0,C.jsx)(ei.V,{"data-testid":"embedded-ad-cta-button-fallback",semanticColor:"textBase"})})})})};var Fc=i(83258);const Uc="wibNcSZSkSmE1N7F0QbG",Bc="xIrPThBgWj2hMwWDOcVq",Pc=({onDismiss:e})=>(0,C.jsxs)("div",{className:Bc,children:[(0,C.jsx)(Fc.v,{colorSet:"overMedia",className:Uc,children:(0,C.jsx)(c.E,{variant:"marginalBold",semanticColor:"textBase",children:_.Ru.get("ad-formats.advertisement")})}),(0,C.jsx)(d.$,{"aria-label":_.Ru.get("ad-formats.dismissAd"),colorSet:"overMedia",iconOnly:os.M,onClick:e,size:"small"})]});i(88747);var _c=i(59328),Mc=i(21577);const Hc="YPTXM8u2OcJuJskm6uwv",Vc="QRqQ5S1T7WIBTZzJ6cAh",zc=({ad:e,onClick:t,onLoad:i,onError:n})=>{const a=e.display.reduce(((e,t)=>(t.url&&e.push({url:t.url,width:t.width,height:t.height}),e)),[]),s=(0,_c.h)(a??void 0,{desiredSize:384}),r=(0,Mc.m)({imageUriOrUrl:s});return(0,C.jsx)(Tc.N,{to:e.clickthroughUrl,onClick:t,className:Hc,"data-testid":"embedded-ad-creative-link",children:(0,C.jsx)(nt._,{loading:"eager",src:r,className:Vc,onLoad:i,onError:n})})};var qc=i(16575),Gc=i(72292);var Qc=i(87389);const Yc="XOqwMsxI9nljlJz4i3za",Wc=({ad:e})=>{const t=(0,P.wA)(),i=(0,n.useRef)(null),a=(0,n.useRef)(null),r=(0,n.useRef)(null),o=(0,s.NC)(Zs.vDv),{useVisibilityLogging:l,handleCreativeLoadedWithVisibility:c,handleCreativeLoaded:u,handleCreativeError:d,handleClickEvent:m,handleDismissEvent:p,handleEndEvent:g}=(({ad:e,creativeRef:t,entranceAnimationRef:i,exitAnimationRef:a})=>{const r=(0,s.NC)(Zs.qPh),o=(0,P.wA)(),l=(0,n.useRef)(!1),c=(0,n.useRef)(!1),u=(0,n.useRef)(!1),d=(0,n.useRef)(!1),[m,p]=(0,n.useState)(void 0),{visibilityState:g}=(0,Gc.x)({target:m}),[v,x]=(0,n.useState)(!1),{adEventLogger:h,embeddedNPVAdEventLogger:b,embeddedAdErrorLogger:y}=(0,qc.CO)(),{context:f,item:j}=(0,Vn.o)((e=>e),ir.F)||{context:null,item:null};(0,n.useEffect)((()=>{t.current&&p(t.current)}),[t]),(0,n.useEffect)((()=>{"visible_100"!==g&&"visible_50"!==g||!v||c.current||!r||i.current?.finished.then((()=>{h.log("viewed",e),c.current=!0})),r&&c.current&&"running"!==a.current?.playState&&"paused"!==a.current?.playState&&"finished"!==a.current?.playState&&h.log(g,e)}),[g,v,h,e,a,i,r]);const C=(0,n.useCallback)((()=>{x(!0),b.log("start",e,{context_uri:f?.uri,track_uri:j?.uri}),l.current=!0}),[e,f?.uri,b,j?.uri]),w=(0,n.useCallback)((()=>{l.current||c.current||(h.log("viewed",e),b.log("start",e,{context_uri:f?.uri,track_uri:j?.uri}),l.current=!0,c.current=!0)}),[e,h,f?.uri,b,j?.uri]),k=(0,n.useCallback)((()=>{u.current||(h.log("errored",e,{event_reason:"creative load error"}),y.log("error",e,{error_message:"creative load error"}),o((0,Ps.Xo)()),u.current=!0)}),[e,h,o,y]),S=(0,n.useCallback)((()=>{h.log("clicked",e),b.log("click",e,{context_uri:f?.uri,track_uri:j?.uri}),o((0,Ps.Xo)())}),[e,h,b,f?.uri,j?.uri,o]),N=(0,n.useCallback)((()=>{h.log("dismissed",e),o((0,Ps.Xo)())}),[e,h,o]),R=(0,n.useCallback)((()=>{d.current||(h.log("ended",e),b.log("end",e,{context_uri:f?.uri,track_uri:j?.uri}),d.current=!0)}),[e,h,b,f?.uri,j?.uri]);return{useVisibilityLogging:r,handleCreativeLoadedWithVisibility:C,handleCreativeLoaded:w,handleCreativeError:k,handleClickEvent:S,handleDismissEvent:N,handleEndEvent:R}})({ad:e,creativeRef:i,entranceAnimationRef:a,exitAnimationRef:r});(0,n.useEffect)((()=>{i.current&&(a.current=i.current.animate([{opacity:0,transform:"translateY(-100%)"},{opacity:1,transform:"translateY(0)"}],{duration:350,fill:"forwards",easing:"ease-out"}))}),[i]),(0,n.useEffect)((()=>{const e=setTimeout((async()=>{i.current?(r.current=i.current.animate([{opacity:1,transform:"translateY(0)"},{opacity:0,transform:"translateY(-100%)"}],{duration:350,fill:"forwards",easing:"ease-out"}),await r.current.finished,t((0,Ps.Xo)())):t((0,Ps.Xo)())}),1e3*o);return()=>{g(),t((0,Ps.Xo)()),clearTimeout(e)}}),[t,o,g]);const v=(0,Qc.z)(e.display[0]?.url,Ec.CpN,"colorDark");return(0,C.jsxs)("div",{ref:i,className:Yc,"data-testid":"embedded-ad",children:[(0,C.jsx)(Pc,{onDismiss:p}),(0,C.jsx)(zc,{ad:e,onClick:m,onLoad:l?c:u,onError:d}),(0,C.jsx)(Oc,{ad:e,backgroundColor:v,onClick:m})]})};var Zc=i(62443),Kc=i(23457),Xc=i(87150);const Jc=(0,Os.mc)((()=>{const e=(0,n.useContext)(We.s),t=(0,Xc.a)({tryAvoidGraphQLFetching:!1});return t?.canvas&&e?(0,C.jsx)(Kc.Gg,{fileId:t.canvas.fileId,canvasUrl:t.canvas.url,canvasType:t.canvas.type,canvasUri:t.canvas.uri,playerContainerClass:"canvasVideoContainerNPV",playbackType:Kc.RT.LoopOnPlayback,allowAspectRatioFix:!0,mouseHoverRef:e,useContainerMouseOverEvents:!1}):null}),{name:"NPVCanvas"});var $c=i(39708),eu=i(79769),tu=i(64605),iu=i(53795),nu=i(22853),au=i(82358),su=i(98834),ru=i(52396),ou=i(94445),lu=i(75168);const cu="main-nowPlayingView-nowPlayingWidget",uu="T5_sYfKJ2efL3n3dFNuN",du="bLX5l9C_iEfonbMKiFD_",mu="sJHheSrjFUt_MAcNrUXQ",pu="hhFdIYRyHsqlCHy7T_8A",gu="main-nowPlayingView-nowPlayingGrid",vu="main-nowPlayingView-contextItemInfo",xu="O5NOY8Xw4NH0IhBZu8tm",hu="DFvRASpHOFAoziM4w7En",bu="main-nowPlayingView-coverArtContainer",yu="ylBRlfNqGnzVa4kjUQGP",fu="E08D6ucrHuPJYzzGO7HG",ju="hjyiWzPtKHn_5kCe9vyg",Cu="pUIBQ9cykHKYx2A2ZIPA",wu="_q9LkNJJIpxoOkOFI2Nd",ku="S6W0kreMgaIXYWSEYHya",Su="hCImOEZCJwYaSy2r1Xgx",Nu="GY_emVGtuRR8FWeKK9je",Ru="main-nowPlayingView-trackInfo",Eu="eEiwEPDfVRD0HKjYM_dq",Iu=({item:e,spec:t})=>{const i=(0,Ce.s)(),a=(0,n.useCallback)((n=>{const a=n?t.heartButtonFactory().hitLike({itemToBeLiked:e.uri}):t.heartButtonFactory().hitRemoveLike({itemNoLongerLiked:e.uri});i.logInteraction(a)}),[e.uri,i,t]),s=(0,nu.v)(e),r=(0,x.y)();return s?(0,C.jsx)(iu.g,{uri:e.uri,size:r===v.E.MEDIUM?"medium":"small",className:pu}):(0,Ys.v)(e)&&!e.isLocal?(0,C.jsx)(wl.b,{uri:e.uri,size:r===v.E.MEDIUM?Cl.t.sm:Cl.t.xs,onClick:a,className:pu}):(0,tc.p)(e)?(0,C.jsx)(eu.b,{uri:e.uri,size:r===v.E.MEDIUM?Cl.t.sm:Cl.t.xs,onClick:a,className:pu,condensed:!0}):null},Au=({context:e,item:t})=>{const{spec:i,logger:n}=(0,Ql.D)(Bs.J,{}),{spec:a}=(0,qe.r)($c.p6,{data:{identifier:$c.gw.DESKTOP}}),s=(0,lu.X)(),r=(0,ou.C)(),o=(0,x.y)();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(tu.w,{className:l()(hu,mu),uri:t.uri,sharingInfo:null,interactionData:{intent:"share",type:"click"},condensedAll:!0,onClick:()=>{n.logInteraction(i.shareButtonFactory({uri:t.uri}).hitCopyToClipboard())},ariaLabel:(0,ji.gHQ)(t.uri)?_.Ru.get("context-menu.copy-episode-link"):_.Ru.get("context-menu.copy-track-link"),size:o===v.E.MEDIUM?"medium":"small"}),(0,C.jsx)(au.a,{context:e,item:t,className:l()(xu,uu),onClick:()=>{n.logInteraction(a.hideButtonFactory().hitRemoveRecommendation({recommendedItemUri:t.uri,contextUri:e.uri}))}}),s&&r&&(0,ru.N)(t)?(0,C.jsx)(gn.r,{spec:i,children:(0,C.jsx)("div",{className:xu,children:(0,C.jsx)(su.o,{contextUri:t.metadata?.context_uri??e.uri,id:t.uid??void 0,uri:t.uri,isActive:!0})})}):(0,C.jsx)("div",{className:xu,children:(0,C.jsx)(Iu,{item:t,spec:i})})]})};var Tu=i(14382),Lu=i(8633),Du=i(45605),Ou=i(96431),Fu=i(59018),Uu=i(55910),Bu=i(45730);let Pu=function(e){return e[e.NONE=0]="NONE",e[e.COVER_ART=1]="COVER_ART",e[e.VIDEO_OVER_PIP_PLACEHOLDER=2]="VIDEO_OVER_PIP_PLACEHOLDER",e[e.VIDEO_OVER_CONNECT_PLACEHOLDER=3]="VIDEO_OVER_CONNECT_PLACEHOLDER",e[e.CANVAS=4]="CANVAS",e}({});const _u=()=>{const e=(0,ir.L)(),t=(0,V.l)(),{videoPlayerMode:i}=(0,Uu.d)(),{isSongVideo:n,isSongVideoPlayingVideo:a}=(0,Fu.k)(),s=(0,P.d4)((e=>e.ads?.vto)),{showCanvasInNPV:r}=(0,Xc.a)({tryAvoidGraphQLFetching:!0});if(!e)return Pu.NONE;const{item:o}=e;return i===Bu.Kz.documentPip||i===Bu.Kz.pip?Pu.VIDEO_OVER_PIP_PLACEHOLDER:o?.type===Er.c.AD&&s?.isMinimized&&"audio"!==o?.mediaType?Pu.NONE:o?.type!==Er.c.EPISODE||"video"!==o?.mediaType&&"mixed"!==o?.mediaType?n&&a?t?Pu.VIDEO_OVER_CONNECT_PLACEHOLDER:Pu.NONE:r?Pu.CANVAS:Pu.COVER_ART:t?Pu.VIDEO_OVER_CONNECT_PLACEHOLDER:Pu.NONE};var Mu=i(87915);const Hu=(0,Os.mc)((({hideContextItemInfo:e=!1})=>{const t=(0,ir.L)(),i=_u(),{draggable:a,onDragStart:r}=(0,Cc.P)(),[o,c]=(0,n.useState)(!0),{spec:u,logger:d}=(0,Ql.D)(Bs.J,{}),{spec:m}=(0,qe.r)(vc.E,{data:{uri:t?.item.uri??"",identifier:Bu.Kz.npv}}),{isSongVideo:p}=(0,Fu.k)(),g=i===Pu.CANVAS,v=i===Pu.COVER_ART,x=(0,P.d4)(Hs),h=((e,t)=>{const[i,a]=(0,n.useState)(!1),r=(0,n.useRef)(),o=(0,s.NC)(Zs.Ym5,{loadingValue:!1}),l=(0,P.d4)(Vs),c=(0,P.d4)(Hs),u=(0,Gs.$)(),d=Ws(t),m=(0,n.useMemo)((()=>Boolean(l&&o&&e)),[e,o,l]),p=(0,n.useCallback)((()=>{r.current&&(clearTimeout(r.current),r.current=null)}),[]);return(0,n.useEffect)((()=>{d&&(p(),a(!1))}),[d,p]),(0,n.useEffect)((()=>m&&c?(r.current=setTimeout((()=>{a(!0)}),2e3),p):(a(!1),()=>{})),[m,p,c,d]),(0,n.useMemo)((()=>Boolean(m&&c&&l&&i&&u)),[m,c,l,i,u])})(v,t?.item),b=(0,n.useRef)(null),y=(0,n.useRef)(null),f=(0,n.useRef)(null),j=!(0,Rt.j)(),[w,k]=(0,n.useState)(null),S=(0,s.NC)(Zs.qes),N=(0,zo.l)();if(j&&g&&b.current&&f.current&&(k(f.current),setTimeout((()=>{k(null)}),600)),b.current=v,y.current=g,f.current=t,null===t)return null;const{context:R,item:E,index:I}=t;return(0,C.jsx)("div",{className:l()(cu),children:(0,C.jsxs)("div",{className:gu,children:[(0,C.jsxs)("div",{onClick:()=>g&&c(!o),className:l()(bu,{[ju]:g,[Su]:v,[Cu]:o,[Nu]:h}),children:[h&&x&&(0,C.jsx)(Wc,{ad:x}),(0,C.jsx)("div",{className:l()(yu,{[wu]:g||h}),"aria-hidden":g||h,"data-testid":"track-visual-enhancement",children:(0,C.jsx)(Tu.h,{context:w?.context||R,item:w?.item||E,index:I,canSwitchVisuals:!0,isMinimized:h})}),i===Pu.VIDEO_OVER_PIP_PLACEHOLDER&&(0,C.jsx)(Du.k,{}),i===Pu.VIDEO_OVER_CONNECT_PLACEHOLDER&&(0,C.jsx)(Ou.V,{}),(0,C.jsx)("div",{className:l()(fu,{[ku]:!g}),"aria-hidden":"true",children:(0,C.jsx)(Ki.h,{menu:(0,C.jsx)(tr.W,{context:R,item:E,canSwitchVisuals:!0}),children:(0,C.jsx)("div",{draggable:a,onDragStart:e=>{r(e,{itemUris:[E.uri],dragLabelText:(0,jc.r)(E)})},children:g&&(0,C.jsx)(Jc,{uri:E.uri})})})}),(0,C.jsx)(Lu.F,{})]}),p&&(0,C.jsx)(Mu.L,{className:g?Eu:"",createImpressionSpec:e=>m.toggleAudioVideoButtonFactory({identifier:e?"switch_to_audio":"switch_to_video"}),onClick:e=>{"switch_to_video"===e&&S&&N(Ei.z.NOW_PLAYING_VIEW),d.logInteraction(m.toggleAudioVideoButtonFactory({identifier:e}).hitPlay({itemToBePlayed:E.uri}))}}),e?null:(0,C.jsxs)("div",{className:l()(vu,{[du]:g}),children:[(0,C.jsx)(Rc,{isVisible:h,context:R,item:E,index:I}),(0,C.jsx)(Rr.d,{className:l()(Ru),context:R,item:E,titleTypeVariant:"titleSmall",subtitleTypeVariant:"bodyMedium",onTitleClick:e=>{d.logInteraction(u.titleFactory({uri:E.uri}).hitUiNavigate({destination:e||""}))},onSubtitleClick:e=>{d.logInteraction(u.artistFactory({uri:E.uri}).hitUiNavigate({destination:e||""}))},referrer:Zc.G.NPV}),!(0,$l.N)(E)&&(0,C.jsx)(Au,{context:R,item:E})]})]})})}),{name:"NPVHeader"});function Vu(){return(0,C.jsx)(Hu,{})}const zu=({className:e})=>{const t=(0,n.useRef)(null);(0,$.X)("NPV_OPEN_CINEMA_MODE_BUTTON",t);const i=(0,zo.l)(),{spec:a,logger:s}=(0,Ql.D)(Bs.J,{}),r=(0,n.useCallback)((()=>{i(Ei.z.NOW_PLAYING_VIEW),s.logInteraction(a.expandNpvButtonFactory().hitUiReveal())}),[s,i,a]);return(0,C.jsx)(Xi.Zp,{label:_.Ru.get("web-player.now-playing-view.cinema-mode.expand"),children:(0,C.jsx)(J.H,{ref:t,iconOnly:_o.L,size:"small",onClick:r,"aria-label":_.Ru.get("web-player.now-playing-view.cinema-mode.expand"),className:e})})};var qu=i(1197),Gu=i(44944),Qu=i(57297);const Yu={context:null,item:null};var Wu=i(28719),Zu=i(53799),Ku=i(69083),Xu=i(97036),Ju=i(58623),$u=i(62290),ed=i(2088),td=i(90879),id=i(99922);const nd="yvZooOj0rpfRS__cAUCo",ad="k_ndsg7yz9ZAgEmei1n3",sd="vDev2BqBHloweL24GNHK",rd="IkRGajTjItEFQkRMeH6v",od="f2UE9n5nZcbgZrGYTU3r",ld="nw2W4ZMdICuBo08Tzxg9",cd="wPHL366l99aluPsMU8Bl",ud="UAg2mNxhAm_jv0zFjG8z";function dd(e){return(0,Ys.v)(e)||(0,ed.v)(e)||(0,tc.p)(e)||(0,ec.d)(e)?e.name:(0,$l.N)(e)?"":(0,mi.d)(e)}const md=n.memo((({item:e,spec:t})=>{const{ref:i,breakpoint:n}=(0,h.x)({[v.E.XSMALL]:0,[v.E.SMALL]:280,[v.E.MEDIUM]:320});return(0,C.jsx)("div",{className:ld,"data-testid":"NPV_Panel_OpenDiv",ref:i,children:e&&(0,C.jsxs)(x.o.Provider,{value:n,children:[(0,C.jsx)(Hu,{}),(0,C.jsx)(ic,{item:e,spec:t}),!(0,tc.p)(e)&&(0,C.jsx)(Zr.A,{})]})})})),pd=({context:e,item:t,spec:i})=>{const a=(0,Xu.SF)();return(0,n.useEffect)((()=>{a.current&&(a.current.scrollTop=0)}),[t?.uri,a]),(0,Zu.bJ)(e,t)?(0,C.jsx)(Wu.IT,{spec:i}):(0,C.jsx)(md,{context:e,item:t,spec:i})},gd=({context:e,item:t,spec:i})=>{const n=(0,Ii.S)();return Ks(),n===Ei.z.NOW_PLAYING_VIEW?null:(0,C.jsx)(pd,{context:e,item:t,spec:i})},vd=()=>_u()===Pu.CANVAS,xd=({item:e})=>{const t=(0,n.useRef)(null),i=(0,ir.L)(),{title:a,link:s}=(0,Ku.$)(),r=vd(),{spec:o,logger:c}=(0,Ql.D)(Bs.J,{}),u=(0,n.useCallback)((()=>{const e=o.closeButtonFactory().hitUiHide();c.logInteraction(e)}),[o,c]);return(0,n.useEffect)((()=>{null!==t.current&&t.current.focus({preventScroll:!0})}),[]),(0,C.jsx)(p.a,{title:a,titleSlot:(0,C.jsx)(p.k,{title:a,panelLinkRef:t,item:e,link:s,variant:"bodyMediumBold",semanticColor:"textBase",className:ad,hasNPVCloseButton:!0}),link:s,actions:i&&i.context&&(0,C.jsxs)("div",{className:ud,children:[(0,C.jsx)($i.b,{menu:(0,C.jsx)(tr.W,{context:i.context,item:e,canSwitchVisuals:!0}),children:(0,C.jsx)(Ji.e,{size:"small",condensed:!1,label:_.Ru.get("more.label.context",e?dd(e):""),onClick:()=>{c.logInteraction(o.contextMenuButtonFactory().hitUiReveal())},className:cd})}),(0,C.jsx)(zu,{className:cd})]}),panelLinkRef:t,panel:g.Z.NowPlayingView,onClose:u,item:e,className:l()({[nd]:r})})},hd=({item:e})=>{const t=!!e&&(0,$l.N)(e);return(0,n.useMemo)((()=>t?null:(0,C.jsx)(xd,{item:e})),[e,t])},bd=(0,Os.mc)((({nodeRef:e})=>{const t=!(0,Si.n)(),{context:i,item:n,index:a}=(0,Vn.o)((e=>e),ir.F)||{context:null,item:null,index:null},{spec:r,UBIFragment:o}=(0,id.$)(Us.t,{data:{uri:n?n.uri:""}}),c=vd(),u=!!n&&(0,$l.N)(n),d=(0,un.t)(r),p=(()=>{const{item:e,context:t}=(0,ir.L)()||Yu,{isYourDJNarrator:i,hasYourDJMetadata:n}=(0,Gu.C)(),a=(0,s.NC)(Zs.yon),r=(0,Qc.z)(e?.images?.[0]?.url,Ec.l0o,"colorDark");return i&&n?(0,Qu.p)(t?.metadata?.["narration.background.color"],qu.lZ):a?r:void 0})(),g={"--background-base":p};let v=null;v=(0,td.O)(i)&&null!==n?t?(0,C.jsx)(Vu,{}):u?(0,C.jsx)(er,{item:n,context:i,index:a}):(0,C.jsx)(gd,{spec:r,context:i,item:n}):(0,C.jsx)(gc,{});const x={cssStyles:{"--section-background-base":p?"var(--background-tinted-base)":"var(--background-elevated-base)","--section-padding":Fs.spacer16,"--section-border-radius":Fs.spacer8},headerVariant:"bodyMediumBold"};return(0,C.jsx)($u.P,{surface:Ju.u.NOW_PLAYING,children:(0,C.jsx)(Xu.ql.Provider,{value:"now_playing_panel",children:(0,C.jsx)(Jr.T,{...x,children:(0,C.jsx)(We._,{nodeRef:e,label:_.Ru.get("web-player.now-playing-view.label"),style:{...g,...x.cssStyles},itemUri:n?.uri?n.uri:"","data-testid":"now-playing-view-container",className:"NowPlayingView",children:(0,C.jsx)(o,{spec:r,children:(0,C.jsx)(m.w,{className:l()(rd,{[od]:void 0!==p}),fixedHeader:(0,C.jsx)(hd,{item:n}),scrolledClassName:c?sd:void 0,ref:d,children:v})})})})})})}),{name:"NPV"}),yd="vzeIlCPBQJUaqdMZHqHE",fd="iZgGvu9g2gDlQ1ofJ7rH",jd="FSZKuoSTDgGwCPXO_qel",Cd="cPpNQwPTiEn9Zegl5Dwz",wd="p2Yw6bT_O5PW8yGv1R0X",kd="pK7G3_mtRcuFjbhJzm1s",Sd="gVJxtuXo8lHAw8XLKHfQ",Nd="BR3H6wavkReGa2xeSeaV",Rd="vXYSi4u1nPutJ_ZkC6mq",Ed=e=>{const t=(0,n.useRef)(null);return(0,C.jsx)(a.A,{in:e.isActive,nodeRef:t,timeout:{enter:e.shouldPlayAnimation?200:0,exit:e.shouldPlayAnimation?300:0},classNames:{enter:e.shouldPlayAnimation?fd:kd,enterActive:e.shouldPlayAnimation?jd:Sd,exit:e.shouldPlayAnimation?Cd:Nd,exitActive:e.shouldPlayAnimation?wd:Sd},unmountOnExit:!0,mountOnEnter:!0,children:(0,C.jsx)("div",{className:yd,children:(0,C.jsx)("div",{className:Rd,ref:t,children:e.children})})})};var Id=i(91118),Ad=i(12096),Td=i(96479),Ld=i(59572),Dd=i(42326),Od=i(93805),Fd=i(20697),Ud=i(8827),Bd=i(59520),Pd=i(25848),_d=i(19413);const Md="PddBvUOS0_6f9B21fVGF",Hd=({ariaLabel:e,onRemoveItems:t,nrItems:i,columnCount:a,children:s})=>{const r=(0,n.useRef)(null);(0,Bd.g)(r);const o=(0,Pd.d)(t);return(0,C.jsx)(Ud.R,{firstInteractiveIsWrapper:!0,"aria-label":e,"aria-rowcount":i,"aria-colcount":a,className:Md,ref:r,onKeyDown:o,children:s})},Vd=({items:e,renderRow:t,...i})=>{const a=(0,n.useCallback)(((t,i)=>e.slice(t,i+1)),[e]);return(0,C.jsx)(_d.k,{resolveItem:zd,getItems:a,nrTracks:e.length,children:(0,C.jsx)(Hd,{nrItems:e.length,...i,children:e.map(t)})})};function zd(e){return{uri:e.uri,uid:e.uid??void 0,type:e.type}}var qd=i(53384),Gd=i(58824),Qd=i(93677),Yd=i(36603),Wd=i(2189),Zd=i(46877),Kd=i(1746);const Xd=({chapter:e,index:t,showTypeLabel:i,...n})=>{const{uid:a,uri:s,type:r,name:o,images:l,book:c}=e,u=(0,qd.E)(e,t),d=(0,Kd.Y)(n.section),m=(0,C.jsx)(Yd.r,{uri:s,removeFromQueueData:{uid:a??void 0,contextUri:d}}),p=(0,C.jsx)(Zd.n,{item:e,tooltipText:c.name,showTypeLabel:i,subtitle:(0,C.jsx)(Ki.h,{menu:(0,C.jsx)(Qd.p,{uri:c.uri}),children:(0,C.jsx)(Tc.N,{to:c.uri,stopPropagation:!0,children:c.name})})});return(0,C.jsx)(Wd.b,{uid:a,uri:s,contextUri:d,id:u,index:t,type:r,title:o,subtitle:p,images:l,dragLabel:o,menu:m,moreButtonLabelName:o,ariaPauseLabel:_.Ru.get("playlist.a11y.pause",o),ariaPlayLabel:_.Ru.get("playlist.a11y.play",o),...n})};var Jd=i(56608),$d=i(42402),em=i(83080),tm=i(58220),im=i(49742),nm=i(90023),am=i(63088),sm=i(39705),rm=i(73790);function om(e){return"autoplay"===e?.provider}function lm(){const{uri:e,description:t}=(0,Pa.f)(),{current:i,nextUp:n,queued:a}=(0,rm.w)(),s=n.filter((e=>om(e)?e:"autoplay"!==e.provider)),r=!!a?.length,o=!!s?.length;return{uri:e,description:t,current:i,nextUp:s,queued:a,isEmpty:!1===(i||r||o),hasQueuedTracks:r,hasNextTracks:o}}const cm=(0,n.createContext)(null),um=({children:e})=>{const{uri:t}=lm(),{spec:i,UBIFragment:a}=(0,qe.r)(am.i,{data:{identifier:sm.$h.NOWPLAYING_QUEUE,uri:t??""}}),s=(0,n.useMemo)((()=>i.nowPlayingSectionFactory()),[i]),r=(0,n.useMemo)((()=>i.nextInQueueSectionFactory()),[i]),o=(0,n.useMemo)((()=>i.nextFromSectionFactory()),[i]),l=(0,n.useMemo)((()=>({queueSpec:i,nowPlayingSectionSpec:s,nextInQueueSectionSpec:r,nextFromSectionSpec:o})),[i,s,r,o]);return(0,C.jsx)(cm.Provider,{value:l,children:(0,C.jsx)(a,{spec:i,children:e})})};var dm=i(49078);const mm=()=>{const e=(0,n.useContext)(cm);if(!e)throw Error("useQueueUBI must be used within a QueuePanelUBIProvider!");const{queued:t}=lm(),i=(0,Ce.s)(),{queueSpec:a,nowPlayingSectionSpec:s,nextInQueueSectionSpec:r,nextFromSectionSpec:o}=e;return{logClearQueue:(0,n.useCallback)((()=>{const e=r.clearQueueButtonFactory().hitRemoveItemsFromQueue({numberOfItemsToRemoveFromQueue:t.length});return i.logInteraction(e)}),[i,r,t.length]),logAddToQueue:(0,n.useCallback)(((e,t)=>{let n;switch(e){case im.$.NowPlaying:n=s;break;case im.$.NextInQueue:n=r;break;case im.$.NextUp:n=o;break;default:return}const a=1===t.length?n.dragAddItemToQueue({itemToAddToQueue:t[0]}):n.dragAddItemsToQueue({numberOfItemsToAddToQueue:t.length});return i.logInteraction(a)}),[i,o,r,s]),logSort:(0,n.useCallback)((e=>{let t;switch(e){case im.$.NextInQueue:t=r;break;case im.$.NextUp:t=o;break;case im.$.NowPlaying:default:return}const n=t.dragSort();return i.logInteraction(n)}),[i,o,r]),logQueuePanelTabChange:(0,n.useCallback)((e=>{if(e!==dm.p.PARTICIPANT_LIST){const t=a.queueHistoryTabFactory({identifier:e===dm.p.QUEUE?"queue":"recently_played"}).hitUiReveal();return i.logInteraction(t)}}),[i,a]),logQueueContextLinkNavigate:(0,n.useCallback)((e=>{const t=o.queueContextLinkFactory().hitUiNavigate({destination:e??""});return i.logInteraction(t)}),[i,o])}};var pm=i(5170),gm=i(96455);const vm=(0,n.memo)((function({item:e,...t}){const i=function(e,t){const i=(0,R.z)(),{request:a}=(0,n.useContext)(gm.j),{logAddToQueue:s,logSort:r}=mm();return(0,n.useCallback)((async(n,o,l)=>{const{contextUri:c,sectionId:u,itemIds:d}=l??{},m=t===im.$.NowPlaying,p=nm.v===c&&!m,g=n[em.fl.ALBUMS]?.at(0),v=Object.values(n).flat();let x=[];if(g){const{trackUris:e}=await(0,pm.s)(g,0,a);x=e.map((e=>({uri:e,uid:null})))}else x=p&&d?.length?d.map((e=>({uri:"",uid:e}))):Object.values(n).flat().map((e=>({uri:e,uid:null})))??[];const h=p&&u===im.$.NowPlaying;let b;if(b=o===tm.Nz.BEFORE?{before:{uri:e.uri,uid:e.uid??null}}:{after:{uri:e.uri,uid:e.uid??null}},p&&!h)t&&r(t),i.reorderQueue(x,b);else{let e;t&&(e=s(t,v)),m?i.addToQueue(x,{interactionId:e?.interactionId}):i.insertIntoQueue(x,b,{interactionId:e?.interactionId})}}),[e.uid,e.uri,s,r,i,a,t])}(e,t.section);switch(e.type){case Er.c.TRACK:return(0,C.jsx)($d.e,{track:e,onDrop:i,...t});case Er.c.EPISODE:return(0,C.jsx)(Jd.I,{episode:e,onDrop:i,...t});case Er.c.CHAPTER:return(0,C.jsx)(Xd,{chapter:e,onDrop:i,...t});case Er.c.AD:return(0,C.jsx)(Gd.Y,{ad:e,onDrop:i,...t});case Er.c.UNKNOWN:return null;default:return(0,mi.k)(e),null}})),xm=(0,n.memo)((function({item:e,...t}){const{usePlayContextItem:i}=(0,fl.P)({uri:e.uri,pages:[{items:[e]}]},{featureIdentifier:"history"});return(0,C.jsx)(vm,{item:e,...t,usePlayContextItem:i})})),hm=({items:e})=>{const t=(0,n.useCallback)(((e,t)=>(0,C.jsx)(xm,{item:e,index:t},(0,qd.E)(e,t))),[]);return(0,C.jsx)(Vd,{items:e,ariaLabel:_.Ru.get("view.recently-played"),renderRow:t,columnCount:nm.$})};var bm=i(91507);const ym="BP2Fv3OX_ZYbjdA4lovg",fm="Mxz3x1XNHpH4SvqEVkt0",jm="Olk6uKV_CIIVtWRrdRJc",Cm="AIW16bVmugXaJ42KBNKQ",wm=()=>(0,C.jsxs)("div",{className:ym,children:[(0,C.jsx)(bm.q,{size:"xxlarge","aria-hidden":"true"}),(0,C.jsxs)("div",{className:jm,children:[(0,C.jsx)(c.E,{as:"h1",variant:"titleMedium",semanticColor:"textBase",children:_.Ru.get("history.empty-title")}),(0,C.jsx)("p",{children:_.Ru.get("history.empty-description")})]})]});var km=i(3816),Sm=i(50262);const Nm=["play-history-contents"];function Rm(){const e=(0,Sm.q)(),t=(0,xi.jE)();return function(e,t){const i=(0,Sm.q)();(0,n.useEffect)((()=>i.getEvents().addListener(e,t)),[e,t,i])}(km.X.UPDATE,(e=>t.setQueryData(Nm,e.data))),(0,oi.I)({queryKey:Nm,queryFn:()=>e.getContents(),gcTime:3e5,staleTime:0})}const Em=()=>{const{isLoading:e,data:t}=Rm();return e?null:t?.items.length?(0,C.jsx)(hm,{items:t.items}):(0,C.jsx)(wm,{})};var Im=i(68832);const Am=(e,t)=>!t?.didQueueChangeSignificantly,Tm=(e,t,i)=>{Am(0,i?.current)?(0,Im.oz)({onUpdate:t=>{e.style.opacity=t.toString()}}):e.style.opacity="1"},Lm=(e,t,i,n)=>{Am(0,n?.current)?(0,Im.oz)({onUpdate:t=>{e.style.opacity=(1-Number(t)).toString()},onComplete:i}):i()},Dm=({hideEnteringElements:e,animateEnteringElements:t,animateExitingElements:i,animateFlippedElements:n})=>{e(),i(),n(),t()};var Om=i(8741);function Fm(e){const t=(0,n.useRef)(e);return(0,n.useMemo)((()=>{const i=new Map,n=Bm(t.current,i),a=Bm(e,i),s=(0,Om.I)(n,a),r=s>16||s>=Math.max(Um(e),Um(t.current));return t.current=e,r}),[e])}function Um(e){return Number(!!e?.current)+(e?.queued.length??0)+(e?.nextUp.length??0)}function Bm({current:e,nextUp:t=[],queued:i=[]},n){let a="";return[[e],t,i].forEach((e=>{e.forEach((e=>{e?.uid&&(n.has(e.uid)||n.set(e.uid,String.fromCharCode(65+n.size)),a+=n.get(e.uid))})),e.length&&(a+=" ")})),a}var Pm=i(82412);const _m=({current:e,queued:t,nextUp:i,children:a})=>{const s=(0,n.useMemo)((()=>[e,...t,...i].filter(Pm.P).map(qd.E).join("")),[e,i,t]),r={didQueueChangeSignificantly:Fm({current:e,nextUp:i,queued:t})};return(0,C.jsx)(Im.ZI,{flipKey:s,handleEnterUpdateDelete:Dm,decisionData:r,children:a})},Mm=({children:e,...t})=>(0,Rt.j)()?(0,C.jsx)(C.Fragment,{children:e}):(0,C.jsx)(_m,{...t,children:e}),Hm=({children:e,...t})=>(0,Rt.j)()?(0,C.jsx)(C.Fragment,{children:e}):(0,C.jsx)(Im.lf,{shouldFlip:Am,...t,children:e});var Vm=i(28454),zm=i(4801);const qm=[em.fl.TRACKS,em.fl.LOCAL_TRACKS,em.fl.EPISODES,em.fl.CHAPTERS,em.fl.ALBUMS],Gm=({uri:e,items:t,ariaLabel:i,section:a,showTypeLabel:s,decoratedQueuedByUsersByUsername:r})=>{const o=(0,R.z)(),l=(0,n.useCallback)((e=>{o.removeFromQueue(e)}),[o]),{usePlayContextItem:c}=(0,Vm.b)(e,a),u=(0,n.useCallback)(((e,t)=>{const i=(0,qd.E)(e,t);return(0,C.jsx)(Hm,{flipId:e.metadata?.original_uid??i,onAppear:Tm,onExit:Lm,translate:!0,children:(0,C.jsx)("div",{className:zm.A.listRowWrapper,children:(0,C.jsx)(vm,{item:e,index:t,usePlayContextItem:c,section:a,allowedDropMimeTypes:qm,showTypeLabel:s,queuedBy:r?.[e.metadata?.queued_by??""]})})},i)}),[r,a,s,c]);return(0,C.jsx)(Vd,{items:t,renderRow:u,columnCount:nm.$,ariaLabel:i,onRemoveItems:l})};var Qm=i(87327),Ym=i(9322);const Wm="jAjrv_00X1qyxaEHmJCb",Zm="YVnLJCNcdaEeIGBQYqJS",Km="pxocyhWhrvAeBiSlfjbd",Xm="aOt09fJWpST6CG8xfHuo",Jm=n.memo((function({onClose:e,onConfirm:t,isOpen:i,itemCount:a}){const s=(0,n.useCallback)((i=>{t(),e(i)}),[t,e]),r=_.Ru.get("queue.confirm-title",a);return(0,C.jsx)(Ym.A,{animated:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,onRequestClose:e,contentLabel:r,isOpen:i,children:(0,C.jsxs)("div",{className:Wm,children:[(0,C.jsx)(c.E,{as:"h2",variant:"bodyMediumBold",className:Zm,children:r}),(0,C.jsx)(c.E,{as:"p",variant:"bodySmall",className:Km,paddingBottom:Qm.lT,children:_.Ru.get("queue.confirm-message")}),(0,C.jsxs)("div",{className:l()("encore-light-theme",Xm),children:[(0,C.jsx)(J.H,{onClick:e,children:_.Ru.get("queue.cancel-button")}),(0,C.jsx)(d.$,{onClick:s,children:_.Ru.get("queue.confirm-button")})]})]})})})),$m="u842BXnznGeq38O3DUTQ",ep="NWVZ_rxlezZ8xTHlMg4Y",tp="Oae51evvT5DrqTupCiZ2",ip="LFdMliaHVgrpBcqNKHU3",np="IeeqYq0Ozrndd6STmrRk",ap="NljerwmGshDHsI7rIvWl",sp=({nrQueuedItems:e})=>{const t=(0,R.z)(),{logClearQueue:i}=mm(),[a,s]=(0,n.useState)(!1),r=(0,n.useCallback)((()=>{s(!1)}),[]),o=(0,n.useCallback)((()=>{i(),t.clearQueue(),s(!1)}),[i,t]),l=(0,n.useCallback)((()=>{s(!0)}),[]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(J.H,{size:"small",onClick:l,className:np,condensed:!0,children:_.Ru.get("queue.clear-queue")}),(0,C.jsx)(Jm,{itemCount:e,isOpen:a,onClose:r,onConfirm:o})]})};var rp=i(64141);const op=({queueSection:e,title:t,trailingButton:i})=>{const a=(0,n.useRef)(null),s=(0,rp.K)({ref:a});return(0,C.jsx)(Hm,{flipId:`section-header-${e}`,onAppear:Tm,onExit:Lm,translate:!0,children:(0,C.jsxs)("div",{className:ip,children:[(0,C.jsx)(Xi.Zp,{label:t,disabled:!s,children:(0,C.jsx)(c.E,{as:"h2",variant:"bodyMediumBold",semanticColor:"textBase",className:ap,ref:a,children:t})}),i]})})};var lp=i(40145);const cp={[v.E.SMALL]:0,[v.E.MEDIUM]:480},up=()=>{const e=(0,n.useRef)(null),{breakpoint:t}=(0,h.c)(cp,e);return(0,C.jsxs)("div",{className:l()(ym,t!==v.E.SMALL&&fm),ref:e,children:[(0,C.jsx)(lp.j,{size:t===v.E.SMALL?"large":"xlarge","aria-hidden":"true",className:Cm}),(0,C.jsxs)("div",{className:jm,children:[(0,C.jsx)(c.E,{as:"h1",variant:t===v.E.SMALL?"bodyMediumBold":"titleSmall",semanticColor:"textBase",children:_.Ru.get("queue.empty-title")}),(0,C.jsx)(c.E,{as:"p",variant:t===v.E.SMALL?"bodySmall":"bodyMedium",children:_.Ru.get("queue.empty-description")})]}),(0,C.jsx)(Tc.N,{to:"/search",children:(0,C.jsx)(d.$,{colorSet:"invertedLight",size:t===v.E.SMALL?"small":"medium",children:_.Ru.get("queue.fine-something")})})]})};var dp=i(61179),mp=i(12074);const pp=Spicetify.GraphQL.Definitions["decorateQueuedByUsers"]=new dp.l("decorateQueuedByUsers","query","1b71b9895bad207fdac0df7ebad17c790260519f853a069ee05f20e51c08636e",null);function gp(e){const t=(0,_a.g)(),i=Array.from(new Set(e.map((e=>e?.metadata?.queued_by||null)).filter(Pm.P))).sort().map((e=>(0,ji.Qjr)(e).toURI())),{data:a}=(s={userUris:i},r={gcTime:36e5,staleTime:18e5,enabled:!!i.length,placeholderData:Bn.rX},(0,mp.I)(pp,s,r));var s,r;const o=(0,n.useMemo)((()=>Object.fromEntries(a?.users?.map((e=>{return"User"===e.__typename?[e.username,(t=e,{type:Er.c.USER,...t,images:t.avatar?.sources??[]})]:null;var t})).filter(Pm.P)??[])),[a]);return t?o:{}}var vp=i(33242),xp=i(34852);const hp="_GA0LJ6qjoKBsWLq34XF",bp="s_iKX8Su0w1W5b9yObSm",yp="aQ5ntWUtU9bcqS9fS9aC",fp="SxLR9RMcR2XyJCZuxYqv",jp="vtk1i3JMLWObMppMQ0gH",Cp="x8qh9EgeC3AdLO0C54Og",wp="Dm9gGjGoA7yNxClwSV24",kp="MPtthrsnd9PdsCTssJqk",Sp=({onClose:e,onCopyLink:t,inviteUrlQR:i})=>(0,C.jsxs)(ae.a,{className:hp,padding:"0",children:[(0,C.jsxs)("div",{className:bp,children:[(0,C.jsxs)("div",{className:fp,children:[(0,C.jsx)(c.E,{variant:"bodySmallBold",children:_.Ru.get("web-player.social-connect.invitation.qr-code.title")}),(0,C.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:_.Ru.get("web-player.social-connect.invitation.qr-code.description")})]}),(0,C.jsx)(J.H,{semanticColor:"textSubdued",iconOnly:os.M,size:"small",onClick:e,condensedAll:!0,"aria-label":_.Ru.get("web-player.social-connect.invitation-modal.button-tertiary")})]}),(0,C.jsx)("div",{className:jp}),(0,C.jsxs)("div",{className:l()(bp,yp,Cp),children:[(0,C.jsx)(d.$,{iconLeading:xp._,colorSet:"invertedLight",size:"small",onClick:t,className:wp,children:_.Ru.get("web-player.social-connect.invitation-modal.button-primary")}),(0,C.jsx)("div",{className:kp,children:(0,C.jsx)(vp.Ay,{value:i,size:100})})]})]}),Np=({onClick:e})=>{const t=(0,P.wA)(),i=(0,n.useCallback)((()=>{e(),t((0,Gi.A9)(Fn.EL.END_SESSION))}),[t,e]);return(0,C.jsx)(Jt.n,{size:"small",onClick:i,children:_.Ru.get("web-player.social-connect.end-session.end-session-button")})},Rp=({onClick:e})=>(0,C.jsx)(Jt.n,{size:"small",onClick:async t=>{e(t)},children:_.Ru.get("web-player.social-connect.invite-button")}),Ep=({onClick:e})=>{const t=(0,P.wA)(),i=(0,n.useCallback)((()=>{e(),t((0,Gi.A9)(Fn.EL.LEAVE_SESSION))}),[t,e]);return(0,C.jsx)(Jt.n,{size:"small",onClick:i,children:_.Ru.get("web-player.social-connect.leave-session.leave-session-button")})};var Ip=i(93821),Ap=i(19699),Tp=i(80586);const Lp="E6U6SyOECK4IENpzZw2R",Dp="rirXgOjB8QWiJWDk5hSD",Op=({currentSession:e,username:t,onClick:i})=>{const{sessionMembers:a}=e,{setQueueView:s}=(0,Ip.m)(),r=a.length+2>3?a.length-3:0,o=(0,Tp.t)(e,t,{userFirst:!0}),l=(0,n.useCallback)((()=>{i&&i(),s(Ip.p.PARTICIPANT_LIST)}),[i,s]);return(0,C.jsxs)(Jt.n,{size:"small",className:Lp,onClick:l,"aria-label":_.Ru.get("web-player.social-connect.participant-list.title"),children:[(0,C.jsx)(Ap.g,{users:o,maxSlots:3,withoutOverflowBadge:!0}),r>0&&(0,C.jsx)(c.E,{variant:"bodySmallBold",semanticColor:"textBase",className:Dp,children:`+${r}`})]})};var Fp=i(95140),Up=i(61384),Bp=i(31645);const Pp="CyBimvsotsoxqwtiZeAn",_p="_GKa4bilkTYbQLgcLogI",Mp="uXHR7rkHhuz9kVPNWwYW",Hp="KFGFA5pPG0hgIB97pZfI",Vp=({id:e,label:t,value:i,onChange:n})=>(0,C.jsxs)("label",{htmlFor:e,className:Hp,children:[(0,C.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:t}),(0,C.jsx)(Pe.l,{id:e,value:i,onSelected:n,condensed:!0})]}),zp=({className:e,emptyStateComponent:t})=>{const{currentSession:i,setQueueOnlyMode:a,setParticipantVolumeControl:s}=(0,$a.D)(),r=(0,Bp.k)(),o=(0,P.d4)((({session:e})=>e.user?.id)),l=r?.joinSessionShortLink,u=r?.joinSessionShortLinkQR,{logFacePileClick:d,logInviteClick:m,logEndClick:p,logLeaveClick:g,UBIFragmentWithSpec:v}=(0,Up.O)(),x=(0,Fp.Z)(),[h,b]=(0,n.useState)(!0),y=(0,n.useCallback)((()=>{d()}),[d]),f=(0,n.useCallback)((async()=>{l&&await x(l),m(l?.spotifyUri??"",l?.shareId??"")}),[x,l,m]),j=(0,n.useCallback)((async()=>{b((e=>!e))}),[]),w=(0,n.useCallback)((()=>{p()}),[p]),k=(0,n.useCallback)((()=>{g()}),[g]);if(!i?.active)return t?(0,C.jsx)(C.Fragment,{children:t}):null;const S=i.sessionMembers.find((e=>e.id===i.sessionOwnerId));return(0,C.jsx)(v,{children:(0,C.jsxs)("div",{className:e,children:[(0,C.jsx)("div",{className:Pp,children:(0,C.jsx)(c.E,{as:"h1",variant:"titleSmall",semanticColor:"textBase",children:_.Ru.get("web-player.social-connect.session-info.title",{host:S?.displayName??""})})}),(0,C.jsxs)("div",{className:_p,children:[(0,C.jsxs)("div",{className:Mp,children:[(0,C.jsx)(Op,{currentSession:i,username:o,onClick:y}),(0,C.jsx)(Rp,{onClick:j}),i.isSessionOwner?(0,C.jsx)(Np,{onClick:w}):(0,C.jsx)(Ep,{onClick:k})]}),h&&(0,C.jsx)(Sp,{onClose:()=>b(!1),onCopyLink:f,inviteUrlQR:u?.shareableUrl??""}),i.isSessionOwner&&(0,C.jsxs)("div",{children:[(0,C.jsx)(Vp,{id:"queueOnlyMode",label:_.Ru.get("web-player.social-connect.controls.queue-only-mode"),value:!i.queueOnlyMode,onChange:e=>a(!e)}),"UNAVAILABLE"!==i.participantVolumeControl&&(0,C.jsx)(Vp,{id:"participantVolumeControl",label:_.Ru.get("web-player.social-connect.controls.participant-volume-control"),value:"ENABLED"===i.participantVolumeControl,onChange:e=>s(e)})]})]})]})})};var qp=i(60247);const Gp=e=>(0,C.jsx)(r.s,{onError:e=>{(0,qp.Jy)(e,"JamQueueHeader")},suspenseFallback:e.emptyStateComponent,children:(0,C.jsx)(zp,{...e})});var Qp=i(21308);const Yp=()=>{const e=lm(),{uri:t,description:i,current:a,nextUp:s,queued:r,isEmpty:o,hasQueuedTracks:l,hasNextTracks:c}=e,{logQueueContextLinkNavigate:u}=mm(),d=gp([a,...s,...r]),m=(0,n.useMemo)((()=>new Set([a,...r,...s].filter(Pm.P).map((({type:e})=>e))).size>1),[a,s,r]),p=(0,_a.g)(),g=(0,Ba.y)();return o?(0,C.jsx)(up,{}):(0,C.jsxs)(Mm,{...e,children:[(0,C.jsx)(Gp,{className:tp}),(0,C.jsxs)("div",{className:$m,children:[a&&(0,C.jsxs)("div",{className:ep,children:[(0,C.jsx)(op,{queueSection:im.$.NowPlaying,title:_.Ru.get("queue.now-playing")}),(0,C.jsx)(Gm,{ariaLabel:_.Ru.get("queue.now-playing"),uri:t,items:a?[a]:[],section:im.$.NowPlaying,showTypeLabel:m,decoratedQueuedByUsersByUsername:d})]}),!p&&g&&(0,C.jsx)(Qp.p,{localStorageKey:"dismissStartJamButtonFromQueue"}),l&&(0,C.jsxs)("div",{className:ep,children:[(0,C.jsx)(op,{queueSection:im.$.NextInQueue,title:_.Ru.get("queue.next-in-queue"),trailingButton:(0,C.jsx)(sp,{nrQueuedItems:r.length})}),(0,C.jsx)(Gm,{ariaLabel:_.Ru.get("queue.next-in-queue"),uri:t,items:r,section:im.$.NextInQueue,showTypeLabel:m,decoratedQueuedByUsersByUsername:d})]}),c&&(0,C.jsxs)("div",{className:ep,children:[(0,C.jsx)(op,{queueSection:im.$.NextUp,title:i&&!om(a)&&t?(0,C.jsxs)(C.Fragment,{children:[_.Ru.get("queue.next-from")," ",(0,C.jsx)(Tc.N,{to:t,onClick:()=>{u(t)},children:i})]}):_.Ru.get("queue.next-up")},i),(0,C.jsx)(Gm,{ariaLabel:_.Ru.get("queue.next-up"),uri:t,items:s,section:im.$.NextUp,showTypeLabel:m})]})]})]})};var Wp=i(67125),Zp=i(54199);const Kp="AjjTyUrCO3pZ365KtTXW",Xp="pGtUoenc5OobLi8CscJ6",Jp="cArVcLcQ85q_9QSLGYGX",$p="lDtXv1VCrs0PHHSuH5uO",eg="ukjUoaLSzKyRcwoOQw9V",tg="yQwBNeetmAr0a0OTR8t3",ig="fzB4RXxTp0rlpNQlSuu9",ng=({sessionMember:e,showRemoveButton:t,onClickMember:i,onClickRemove:n,index:a})=>{const{currentSession:s}=(0,$a.D)(),{displayName:r,images:o,username:l,uri:c}=(0,Tp.c)(e);return(0,C.jsx)(Ki.h,{menu:(0,C.jsx)(Zp.B,{uri:c}),children:(0,C.jsx)(X.v,{id:`${a}`,variant:"naked",className:eg,title:(0,C.jsx)(se.d,{lineClamp:1,children:r}),media:(0,C.jsx)("div",{role:"button",onClick:i,onKeyDown:i,tabIndex:-1,children:(0,C.jsx)(Wp.e,{images:o,userIconSize:"medium",width:48,displayName:r,username:l,label:r})}),subtitle:s?.sessionOwnerId===e.id?_.Ru.get("web-player.social-connect.participant-list.host"):_.Ru.get("web-player.social-connect.participant-list.guest"),onClick:i,trailing:t&&(0,C.jsx)(Jt.n,{size:"small",className:tg,onClick:n,"aria-label":_.Ru.get("web-player.social-connect.participant-list.remove-guest-accessible-label",{displayName:r}),children:_.Ru.get("web-player.social-connect.participant-list.remove-guest")})})})};var ag=i(33143);var sg=i(15223);const rg=()=>{const e=(0,_n.d)(),t=(0,P.wA)(),i=(0,me.g)(),a=(0,Fp.Z)(),{currentSession:s,kickAllParticipants:r}=(0,$a.D)(),{setQueueView:o}=(0,Ip.m)(),l=(0,Bp.k)(),{logUserClick:u,logRemoveClick:m}=(()=>{const{spec:e,logger:t,UBIFragment:i}=(0,qe.r)(ag.I,{});return{logUserClick:(0,n.useCallback)(((i,n)=>{t.logInteraction(e.participantListFactory().participantListRowFactory({position:i}).userLinkFactory().hitUiNavigate({destination:n}))}),[t,e]),logRemoveClick:(0,n.useCallback)((i=>{t.logInteraction(e.participantListFactory().participantListRowFactory({position:i}).removeButtonFactory().hitUiReveal())}),[t,e]),UBIFragmentWithSpec:(0,n.useCallback)((t=>(0,C.jsx)(i,{spec:e,...t})),[i,e])}})(),p=(0,n.useCallback)((()=>{l?.joinSessionShortLink&&a(l.joinSessionShortLink)}),[a,l?.joinSessionShortLink]),g=(0,n.useCallback)(((e,i)=>{m(e),t((0,Gi.A9)(Fn.EL.REMOVE_PARTICIPANT,void 0,i))}),[t,m]),v=(0,n.useCallback)(((e,t)=>{const n=(0,ji.Qjr)(t.username);u(e,n.toURI()),i(n.toURLPath(!0))}),[u,i]),x=(0,n.useCallback)((()=>{r(s?.sessionId)}),[s?.sessionId,r]),h=(0,sg.T4)(e);return s&&h?(0,C.jsxs)("div",{className:Kp,children:[(0,C.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",children:_.Ru.get("web-player.social-connect.participant-list.title")}),(0,C.jsxs)("div",{className:Xp,children:[(0,C.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:_.Ru.get("web-player.social-connect.participant-list.subtitle")}),(0,C.jsx)(Jt.n,{size:"small",onClick:p,className:Jp,children:_.Ru.get("web-player.social-connect.invite-button")})]}),(0,C.jsx)("div",{className:$p,children:s.sessionMembers.map(((t,i)=>(0,C.jsx)(ng,{index:i,sessionMember:t,showRemoveButton:(0,sg.kt)(e,(0,ji.Qjr)(t.username).toURI()),onClickRemove:()=>g(i,t),onClickMember:()=>v(i,t)},i)))}),s.isSessionOwner&&s.sessionMembers.length>1&&(0,C.jsx)(d.$,{colorSet:"invertedLight",size:"small",onClick:x,children:_.Ru.get("web-player.social-connect.participant-list.remove-all-guests")}),(0,C.jsx)(c.E,{variant:"marginal",semanticColor:"textSubdued",className:ig,children:_.Ru.get("web-player.social-connect.participant-list.visibility-info")})]}):(o(Ip.p.QUEUE),null)};var og=i(97e3);const lg="BZj_r1yzmmragvivUCrw",cg="hpzTKCoO0rllEslIOMPo",ug="TeBVsFnI9PMHYL9ynJx9",dg="ZDR7q1cqU2yaYjemuy9Z",mg="OLB2ghxc09Kz8k_93eIu",pg=()=>{const{currentQueueView:e,setQueueView:t}=(0,dm.m)(),i=(0,og.y)(),{logQueuePanelTabChange:a}=mm(),s=(0,n.useMemo)((()=>i?{titleSlot:e!==dm.p.PARTICIPANT_LIST?(0,C.jsx)(Ld.t,{currentTab:e,onTabChange:e=>{e===(0,Od.c)(dm.p.HISTORY)?(a(dm.p.HISTORY),t(dm.p.HISTORY)):(a(dm.p.QUEUE),t(dm.p.QUEUE))},className:ug,children:(0,C.jsxs)(Dd.w,{"aria-label":"",className:dg,children:[(0,C.jsx)(Od.V,{"aria-selected":e===dm.p.QUEUE,label:_.Ru.get("playback-control.queue"),value:dm.p.QUEUE}),(0,C.jsx)(Od.V,{"aria-selected":e===dm.p.HISTORY,label:_.Ru.get("view.recently-played"),value:dm.p.HISTORY})]})}):(0,C.jsx)(J.H,{iconLeading:wa.g,onClick:()=>t(dm.p.QUEUE),size:"small",condensed:!0,className:mg,children:_.Ru.get("web-player.social-connect.participant-list.back-to-queue")})}:{title:_.Ru.get("playback-control.queue")}),[i,a,t,e]);return(0,C.jsx)(We._,{label:_.Ru.get("playback-control.queue"),focusTransferId:"QUEUE-HISTORY-PANEL",children:(0,C.jsx)(m.w,{fixedHeader:(0,C.jsx)(p.a,{className:lg,panel:g.Z.Queue,...s}),children:(0,C.jsx)("div",{className:cg,children:e!==dm.p.PARTICIPANT_LIST?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(Fd.K,{value:"queue",children:e===dm.p.QUEUE&&(0,C.jsx)(Yp,{})}),(0,C.jsx)(Fd.K,{value:"history",children:e===dm.p.HISTORY&&(0,C.jsx)(Em,{})})]}):(0,C.jsx)(rg,{})})})})},gg=(0,n.memo)((function(){return(0,C.jsx)(um,{children:(0,C.jsx)(pg,{})})}));var vg=i(73589);const xg=(0,n.memo)((()=>{const e=(0,s.NC)(Zs.ZDY),t=(0,Ad.X)(),i=(0,Id._)(),o=function(){const e=(0,n.useRef)(g.Z.NowPlayingView),t=(0,N.XB)();return(0,n.useEffect)((()=>{e.current=t}),[t]),(0,n.useCallback)((i=>{const n=e.current===g.Z.NowPlayingView,a=t===g.Z.NowPlayingView;return i.some((i=>n&&t===i||a&&e.current===i))}),[t])}(),l=(0,Ii.S)()===Ei.z.NOW_PLAYING_VIEW,c=(0,n.useRef)(null),u=e&&t===g.Z.Disabled;return(0,C.jsxs)(r.s,{onError:e=>{(0,qp.Jy)(e,"PanelSection"),i((0,Td.MQ)(g.Z.Disabled))},children:[(0,C.jsx)(a.A,{nodeRef:c,in:t===g.Z.NowPlayingView||u,exit:g.v.includes(t),timeout:{enter:0,exit:300},unmountOnExit:!0,mountOnEnter:!0,children:(0,C.jsx)(vg.f,{enabled:!u,children:(0,C.jsx)(bd,{nodeRef:c})})}),t===g.Z.BuddyFeed?(0,C.jsx)(Ri,{}):null,(0,C.jsx)(Ed,{isActive:t===g.Z.BuddyFeedOverlay,shouldPlayAnimation:!l&&o([g.Z.BuddyFeedOverlay]),children:(0,C.jsx)(Ri,{})}),t===g.Z.Queue?(0,C.jsx)(gg,{}):null,(0,C.jsx)(Ed,{isActive:t===g.Z.QueueOverlay,shouldPlayAnimation:!l&&o([g.Z.QueueOverlay]),children:(0,C.jsx)(gg,{})}),t===g.Z.Puffin||t===g.Z.PuffinActivation?(0,C.jsx)(vi,{}):null,(0,C.jsx)(Ed,{isActive:t===g.Z.PuffinActivationOverlay||t===g.Z.PuffinOverlay,shouldPlayAnimation:!l&&o([g.Z.PuffinActivationOverlay,g.Z.PuffinOverlay]),children:(0,C.jsx)(vi,{})}),t===g.Z.DevicePicker?(0,C.jsx)(Ls,{}):null,(0,C.jsx)(Ed,{isActive:t===g.Z.DevicePickerOverlay,shouldPlayAnimation:!l&&o([g.Z.DevicePickerOverlay]),children:(0,C.jsx)(Ls,{})}),Ds?(0,C.jsxs)(C.Fragment,{children:[t===g.Z.Euterpe?(0,C.jsx)(Ds,{}):null,(0,C.jsx)(Ed,{isActive:t===g.Z.Euterpe,shouldPlayAnimation:o([g.Z.Euterpe]),children:(0,C.jsx)(Ds,{})})]}):null]})}))},98349:(e,t,i)=>{i.d(t,{S:()=>l});i(54615),i(32807);var n=i(30675),a=i(38012),s=i(5911),r=i(77398),o=i(58542);function l(e){const t=(0,o.t)();return(0,n.I)({queryKey:["author",e],queryFn:async()=>t.fetch([e??""],[s.UH.IDENTITY_TRAIT,s.UH.VISUAL_IDENTITY_TRAIT,s.UH.AVAILABLE_RELEASES]).then((([e])=>function({uri:e,extensions:{[s.UH.IDENTITY_TRAIT]:t,[s.UH.VISUAL_IDENTITY_TRAIT]:i,[s.UH.AVAILABLE_RELEASES]:n}}){return t?{uri:e,name:t.name,description:t.description,images:(i?.sixteenByNineCoverImage?.instances??i?.squareCoverImage?.instances)?.map((({size:e,flatFile:t})=>({url:t?.cdnUrl??"",label:c[e]}))).filter((e=>!!e.url))??[],availableBooksUris:n?.availableReleases.map((e=>e.uri))??[],dynamicColors:(0,a.V)(i?.squareCoverImage?.extractedColorSet)}:null}(e))),staleTime:0,gcTime:36e5,enabled:!!e})}const c={[r.hJ.IMAGE_SIZE_UNSPECIFIED]:"standard",[r.hJ.IMAGE_SIZE_SMALL]:"small",[r.hJ.IMAGE_SIZE_DEFAULT]:"standard",[r.hJ.IMAGE_SIZE_LARGE]:"large",[r.hJ.IMAGE_SIZE_XLARGE]:"xlarge",[r.hJ.IMAGE_SIZE_XXLARGE]:"xlarge",[r.hJ.UNRECOGNIZED]:"standard"}},98768:(e,t,i)=>{i.d(t,{D:()=>s});var n=i(43021),a=i(65891);function s(){return(0,a.N)(n.x)}},98834:(e,t,i)=>{i.d(t,{o:()=>S});var n=i(30758),a=i(97500),s=i.n(a),r=i(35638),o=i(36615),l=i(45353),c=i(70553),u=i(23736),d=i(29174),m=i(68443),p=i(57306),g=i(28191),v=i(28155),x=i(9221),h=i(62824),b=i(43026),y=i(17154);const f="VcqCvLW71lZT4kqnCgt0";var j=i(86070);const C=({contextUri:e="",uri:t,id:i=t,className:a,canAdd:u})=>{const{description:h}=(0,x.f)(),C=(0,b.s)(),{spec:w}=(0,y.r)(c.A,{data:{uri:e}}),k=(0,n.useCallback)((()=>{C.logInteraction(w.undoButtonFactory({uri:t}).hitUiHide())}),[C,w,t]),S=(0,n.useCallback)((()=>{C.logInteraction(w.removeRecommendationButtonFactory({uri:t}).hitRemoveRecommendation({recommendedItemUri:t,contextUri:e}))}),[e,C,w,t]),N=(0,n.useCallback)((()=>{C.logInteraction(w.addRecommendationButtonFactory({uri:t}).hitAddToPlaylist({playlist:e,itemToBeAdded:t}))}),[e,C,w,t]),{removeRecommendation:R,addRecommendation:E,canRemoveRecommendation:I,canAddRecommendation:A}=(0,p.t)({uri:t,uid:i,contextUri:e,onUndo:k,onRemoveRecommendation:S,onAddRecommendation:N}),T=(0,n.useCallback)((()=>h?d.Ru.get("web-player.smart-shuffle.add-to-playlist-button",h):d.Ru.get("web-player.smart-shuffle.add-to-playlist-button-fallback")),[h]),L=(0,v.y)();return(0,j.jsxs)("div",{className:s()(f,a),children:[I&&(0,j.jsx)(m.Zp,{label:d.Ru.get("web-player.smart-shuffle.removed-from-recommendations-button"),children:(0,j.jsx)(r.H,{onClick:R,iconOnly:o.P,size:L===g.E.MEDIUM?"medium":"small","aria-label":d.Ru.get("web-player.smart-shuffle.removed-from-recommendations-button"),condensedAll:!0})}),u&&A&&(0,j.jsx)(m.Zp,{label:T(),children:(0,j.jsx)(r.H,{onClick:E,iconOnly:l.P,size:L===g.E.MEDIUM?"medium":"small","aria-label":T(),condensedAll:!0})})]})},w=e=>{const t=(0,h.J)(e.contextUri);return(0,j.jsx)(C,{...e,canAdd:t?.canAdd??!1})},k=e=>(0,j.jsx)(C,{...e,canAdd:!0}),S=e=>e.contextUri&&(0,u.tbX)(e.contextUri)?(0,j.jsx)(w,{...e,contextUri:e.contextUri}):e.contextUri&&(0,u.Z0m)(e.contextUri)?(0,j.jsx)(k,{...e,contextUri:e.contextUri}):(0,j.jsx)(C,{...e,canAdd:!1})},99454:(e,t,i)=>{i.d(t,{a:()=>n});let n=function(e){return e.AUDIO_QUALITY_STEAMING="audio_quality_streaming",e.DSA="dsa",e}({})}}]);
//# sourceMappingURL=dwp-panel-section.js.map