"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[319],{3413:(e,t,i)=>{i.d(t,{a:()=>c});var n=i(5305),a=i(16318),s=i(51175),r=i(53989),o=i(30758);const l=["play-history-contents"];function c(){const e=(0,r.q)(),t=(0,n.jE)();return function(e,t){const i=(0,r.q)();(0,o.useEffect)((()=>i.getEvents().addListener(e,t)),[e,t,i])}(s.X.UPDATE,(e=>t.setQueryData(l,e.data))),(0,a.I)({queryKey:l,queryFn:()=>e.getContents(),gcTime:3e5,staleTime:0})}},6705:(e,t,i)=>{i.d(t,{F:()=>d});var n=i(30758),a=i(53177),s=i(37953),r=i(46628),o=i(49361),l=i(35397);const c="KrBYgWLGb5aRHjoD_prX";var u=i(86070);const d=(0,a.mc)((()=>{const{setVideoPlayerUIFlag:e}=(0,o.d)(),t=(0,s.XB)();return(0,n.useEffect)((()=>(t===r.Z.NowPlayingView&&e(l.nP.npv,!0),()=>{e(l.nP.npv,!1)})),[t,e]),(0,u.jsx)("div",{id:"VideoPlayerNpv_ReactPortal",className:c})}),{name:"NPVVideoContainer"})},9699:(e,t,i)=>{i.d(t,{a:()=>n.a});var n=i(30337)},15066:(e,t,i)=>{i.d(t,{w:()=>b});var n=i(30758),a=i(97500),s=i.n(a),r=i(1185),o=i(92113),l=i(25186),c=i(83531);const u="AAdBM1nhG73supMfnYX7",d="W3E0IT3_STcazjTeyOJa",p="mdMUqcSHFw1lZIcYEblu",m="cZCuJDjrGA2QMXja_Sua",g="zduvaX0Ioxqd5ypeWoAf";var v=i(86070);const x=({fixedHeader:e,scrollNodeRef:t,children:i,scrolledClassName:n})=>{const a=(0,l.y)(t);return(0,v.jsxs)("div",{className:s()(u),children:[(0,v.jsx)("div",{className:s()(d,{[n??p]:a}),children:e}),i]})},b=n.forwardRef((({children:e,className:t,fixedHeader:i,scrolledClassName:a},l)=>{const d=(0,n.useRef)(null);(0,o.g)(d);const p=(0,n.useMemo)((()=>({scrollNodeRef:d})),[d]),b=(0,v.jsx)(c.bi.Provider,{value:p,children:(0,v.jsx)(r.a,{className:m,scrollNodeRef:d,children:(0,v.jsx)("div",{ref:l,className:s()(u,g,t),children:e})})});return i?(0,v.jsx)(x,{fixedHeader:i,scrollNodeRef:d,scrolledClassName:a,children:b}):b}))},15120:(e,t,i)=>{i.d(t,{d:()=>r});var n=i(75044),a=i(8044),s=i(55405);const r=()=>{const e=(0,n.NC)(s.iGu,{loadingValue:!1}),t=(0,a.V)();return e&&!t}},15514:(e,t,i)=>{i.d(t,{p:()=>b});var n=i(30758),a=i(25270),s=i(46462),r=i(76151),o=i(17640),l=i(93301),c=i(77112),u=i(61055),d=i(99565);const p="pIxPdfuNasUDLbEDmuK_",m="T5TwrUTf23N311rgrEAc",g="BTwQUS5iBiiOBgdda2Zi",v="lu2OTpzgQ6hv6AYWXMNQ";var x=i(86070);const b=({localStorageKey:e,onDismiss:t})=>{const[i,b]=(0,d.x)(e,!1),{logStartJam:y}=(0,u.O)(),{enqueueSnackbar:h}=(0,l.d)(),f=(0,n.useCallback)((()=>{b(!0),t&&t(),h(o.Ru.get("web-player.social-connect.promotion.how-to-start-a-jam-reminder"),{autoHideDuration:5e3})}),[h,t,b]);return i?(0,x.jsx)(x.Fragment,{}):(0,x.jsxs)("div",{className:p,children:[(0,x.jsxs)("div",{className:m,children:[(0,x.jsx)(a.E,{as:"p",variant:"bodySmall",semanticColor:"textSubdued",children:o.Ru.get("web-player.social-connect.invitation-modal.subtitle")}),(0,x.jsx)(s.H,{iconOnly:r.M,className:g,"aria-label":o.Ru.get("close"),onClick:f,size:"small"})]}),(0,x.jsx)("div",{className:v,children:(0,x.jsx)(c.$,{onClick:y})})]})}},17216:(e,t,i)=>{i.d(t,{a:()=>V,k:()=>M});var n=i(30758),a=i(97500),s=i.n(a),r=i(25270),o=i(59993),l=i(89750),c=i(76151),u=i(75044),d=i(81720),p=i(12599),m=i(17640),g=i(59001),v=i(43294),x=i(92354),b=i(58325),y=i(24498),h=i(88312),f=i(78631),j=i(37953),S=i(84104),C=i(46628),w=i(37833),N=i(55405),E=i(31889),R=i(5141);const I="eTT681T6oUKXsIMiP8pT",k="gwmgu53xszgwAXxqLT0h",A="fNXmHtlrj4UVWmhQrJ_5",L="XOSSUjLDKk9RRmiX_UWa",T="KILnOHUdx4pspVEoJ7kq",D="XNFZdOLgMlx491fEWdYJ",O="icNf66tgG3uxDMbCCIaN",_="NmIQ4hxBcXT8Bd7Abwdi",B="rkIl3GXeAGoK2gIX2zuj",F="j9Ey7DzF10wbxpBIVtcb";var P=i(86070);const U=({title:e,variant:t,semanticColor:i})=>(0,P.jsx)(h.r,{children:(0,P.jsx)(r.E,{as:"h1",variant:t,semanticColor:i,children:e||""})},e||""),M=({link:e,title:t,item:i,panelLinkRef:n,variant:a,semanticColor:r,className:o})=>{const{spec:l,logger:c}=(0,R.r)(d.J,{}),m=(0,p.o_h)(e),g=m?.toURI(),b=!(!g||!t),h=b?[g]:[],f=(0,x.H)(g),S=(0,j.XB)().split("_").join(" "),{draggable:C,onDragStart:E}=(0,w.P)({itemUris:h,dragLabelText:t??""}),A=(0,u.NC)(N.mzn);return(0,P.jsx)(v.h,{menu:f,children:(0,P.jsx)("div",{className:s()(I,o,{[F]:A}),children:e&&t?(0,P.jsx)(y.N,{ref:n,"aria-label":`${S} link`,draggable:C&&b,onDragStart:b?E:void 0,to:e,search:i?`?uid=${i.uid}&uri=${i.uri}`:void 0,className:k,onClick:()=>{c.logInteraction(l.contextLinkFactory().hitUiNavigate({destination:e||""}))},children:(0,P.jsx)(U,{title:t,variant:a,semanticColor:r})}):(0,P.jsx)(U,{title:t,variant:a,semanticColor:r})})})},H=S.$S.PANEL_CLOSE_CLICK,V=({link:e,title:t,titleSlot:i,actions:a,onClose:r,className:d,panelLinkRef:p,preventDefaultClose:v=!1,onBack:x,item:y,titleVariant:h="bodyMediumBold",titleSemanticColor:S="textBase"})=>{const w=(0,j._Y)(),R=(0,j.Ev)(H),I=(0,u.NC)(N.mzn),k=(0,j.XB)()===C.Z.NowPlayingView&&I,F=(0,f.h)(),U=(0,n.useCallback)((()=>{r?.(),v||w(H)}),[r,v,w]),V=null!==y&&(0,E.N)(y);return(0,P.jsx)(n.Suspense,{fallback:null,children:(0,P.jsxs)("div",{className:s()(A,d,{[T]:I}),children:[x&&(0,P.jsx)("span",{className:s()(O,_),children:(0,P.jsx)(b.Zp,{label:m.Ru.get("desktop.login.Back"),children:(0,P.jsx)(g.a,{ariaLabel:m.Ru.get("desktop.login.Back"),size:"sm",onClick:x,icon:o.g})})}),I&&(0,P.jsx)(g.a,{icon:l.t,size:"sm",onClick:U,ariaLabel:m.Ru.get("web-player.now-playing-view.hide"),className:B}),i||(0,P.jsx)(M,{title:t,panelLinkRef:p,item:y,link:e,variant:h,semanticColor:S}),(0,P.jsxs)("span",{className:s()(O,L),children:[a,!V&&!k&&!F&&(0,P.jsx)("div",{"data-testid":"PanelHeader_CloseButton",children:(0,P.jsx)(b.Zp,{label:m.Ru.get("close"),children:(0,P.jsx)(g.a,{ariaLabel:m.Ru.get("close"),className:D,size:"sm",onClick:U,icon:c.M,disabled:!R})})})]})]})})}},28233:(e,t,i)=>{i.d(t,{x:()=>s});var n=i(16318),a=i(37641);function s(){const e=(0,a.t)();return(0,n.I)({queryKey:["settings-formats"],queryFn:()=>e.quality.getFormats(),gcTime:36e5,staleTime:6e5}).data}},29584:(e,t,i)=>{i.d(t,{O:()=>s,j:()=>a});var n=i(30758);let a=function(e){return e[e.Errored=0]="Errored",e}({});const s=(0,n.createContext)({state:null,capturePlaybackError:()=>{}})},34524:(e,t,i)=>{i.d(t,{S:()=>l});var n=i(16318),a=i(16659),s=i(89723),r=i(21112),o=i(69107);function l(e){const t=(0,o.t)();return(0,n.I)({queryKey:["author",e],queryFn:async()=>t.fetch([e??""],[s.UH.IDENTITY_TRAIT,s.UH.VISUAL_IDENTITY_TRAIT,s.UH.AVAILABLE_RELEASES]).then((([e])=>function({uri:e,extensions:{[s.UH.IDENTITY_TRAIT]:t,[s.UH.VISUAL_IDENTITY_TRAIT]:i,[s.UH.AVAILABLE_RELEASES]:n}}){return t?{uri:e,name:t.name,description:t.description,images:((i?.sixteenByNineCoverImage?.instances??i?.squareCoverImage?.instances)?.map((({size:e,flatFile:t})=>({url:t?.cdnUrl??"",label:c[e]}))).filter((e=>!!e.url))??[]).slice(0,1),availableBooksUris:n?.availableReleases.map((e=>e.uri))??[],dynamicColors:(0,a.V)(i?.squareCoverImage?.extractedColorSet)}:null}(e))),staleTime:0,gcTime:36e5,enabled:!!e})}const c={[r.hJ.IMAGE_SIZE_UNSPECIFIED]:"standard",[r.hJ.IMAGE_SIZE_SMALL]:"small",[r.hJ.IMAGE_SIZE_DEFAULT]:"standard",[r.hJ.IMAGE_SIZE_LARGE]:"large",[r.hJ.IMAGE_SIZE_XLARGE]:"xlarge",[r.hJ.IMAGE_SIZE_XXLARGE]:"xlarge",[r.hJ.UNRECOGNIZED]:"standard"}},34824:(e,t,i)=>{i.d(t,{R:()=>m});var n=i(30758),a=i(93225),s=i(84429);function r(e,t,i=!1){if(!e)return void console.error("No list element found. Canceling moving focus");if(!(0,s.fk)(e))return;const n=e.querySelector('[tabindex="0"]');t===a.O.UP&&(0,s.MS)(n,o(e,n,a.O.UP,i)),t===a.O.DOWN&&(0,s.MS)(n,o(e,n,a.O.DOWN,i)),t===a.O.RIGHT&&(0,s.MS)(n,l(n,a.O.RIGHT,i)),t===a.O.LEFT&&(0,s.MS)(n,l(n,a.O.LEFT,i)),t===a.O.HOME&&(0,s.MS)(n,c(a.O.HOME,i)??n),t===a.O.END&&(0,s.MS)(n,c(a.O.END,i)??n)}function o(e,t,i,n=!1){const r=t.closest('li[role="row"]');if(!r)return t;let o=r;const c=Array.from(e.querySelectorAll('li[role="row"]')),u=Array.from(r.querySelectorAll(s.nu)),d=c.indexOf(r);if(d<0)return t;const p=(n&&t!==u[0]||!n&&t!==r)&&!(t instanceof HTMLLIElement);if(i===a.O.UP){if(document.activeElement===e){o=c[c.length-1];return(n?o.querySelector(s.nu):o)??t}if(p)return l(t,a.O.LEFT,n);let i=d-1;if(-1===i)return t;o=c[i],i-=1}else if(i===a.O.DOWN){if(document.activeElement===e){o=c[0];return(n?o.querySelector(s.nu):o)??t}if(p)return l(t,a.O.RIGHT,n);let i=d+1;if(i===c.length)return t;o=c[i],i+=1}return(n?o.querySelector(s.nu):o)??t}function l(e,t,i=!1){const n=e.closest('li[role="row"]');if(!n)return e;let r=e;const o=Array.from(n.querySelectorAll(s.nu)),l=o.indexOf(e);let c=0;if(t===a.O.RIGHT&&l-1!==o.length)c=l+1;else{if(t===a.O.LEFT&&-1===l)return n;if(t===a.O.LEFT&&0!==l)c=l-1;else if(t===a.O.LEFT&&0===l){return(i?n.querySelector(s.nu):n)??n}}return r=o.at(c),r??e}function c(e,t=!1){const{currentFocus:i,listEl:n}=function(){const e=document.activeElement,t=e?.closest("ul");return((0,a.I)(e)||e instanceof HTMLLIElement)&&t?{currentFocus:e,listEl:t}:{currentFocus:null,listEl:null}}();if(null===i||null===n)return null;const r=i.closest('li[role="row"]');if(!r)return i;const o=Array.from(n.querySelectorAll('li[role="row"]')),l=Array.from(r.querySelectorAll(s.nu));if(o.indexOf(r)<0)return i;const c=t&&i===l[0]||!t&&i===r;if(e===a.O.HOME){if(c){return(t?o[0].querySelector(s.nu):o[0])??i}return(t?l[1]:l[0])??i}if(e===a.O.END){if(c){return(t?o[o.length-1].querySelector(s.nu):o[o.length-1])??i}return l[l.length-1]??i}return i}var u=i(79236),d=i(74278),p=i(86070);const m=(0,n.forwardRef)((({onKeyDown:e,children:t,firstInteractiveIsWrapper:i=!1,...o},l)=>{const c=(0,d.N)(l);(0,u.R)(c);const m=(0,n.useCallback)((t=>{c.current?.contains(t.target)&&("ArrowUp"!==t.key&&"ArrowDown"!==t.key&&"Home"!==t.key&&"End"!==t.key||t.preventDefault(),"ArrowUp"!==t.key&&"ArrowDown"!==t.key||document.documentElement.classList.remove("no-focus-outline"),"ArrowUp"===t.key&&r(c.current,a.O.UP,i),"ArrowDown"===t.key&&r(c.current,a.O.DOWN,i),"ArrowRight"===t.key&&r(c.current,a.O.RIGHT,i),"ArrowLeft"===t.key&&r(c.current,a.O.LEFT,i),"Home"===t.key&&r(c.current,a.O.HOME,i),"End"===t.key&&r(c.current,a.O.END,i),e?.(t))}),[i,c,e]),g=(0,n.useCallback)((e=>{if(!c.current)return;const t=e.target,i=c.current.querySelector('[tabindex="0"]');t.closest('li[role="row"]')&&t!==i&&(0,s.MS)(i,t,{preventScroll:!0})}),[c]);return(0,p.jsx)("ul",{role:"treegrid",ref:c,onKeyDown:m,onFocus:g,tabIndex:0,...o,children:t})}))},40792:(e,t,i)=>{i.d(t,{J:()=>n.J});var n=i(98965)},46915:(e,t,i)=>{i.d(t,{H:()=>l});var n=i(36394),a=i(25270),s=i(17640),r=i(1080),o=i(86070);const l=()=>(0,o.jsxs)("div",{className:r.A.emptyContainer,children:[(0,o.jsx)(n.q,{size:"xxlarge","aria-hidden":"true"}),(0,o.jsxs)("div",{className:r.A.titleContainer,children:[(0,o.jsx)(a.E,{as:"h1",variant:"titleMedium",semanticColor:"textBase",children:s.Ru.get("history.empty-title")}),(0,o.jsx)("p",{children:s.Ru.get("history.empty-description")})]})]})},49526:(e,t,i)=>{i.d(t,{h:()=>S});var n=i(97500),a=i.n(n),s=i(75773),r=i(81720),o=i(53476),l=i(43294),c=i(24527),u=i(85827),d=i(49211),p=i(35279),m=i(66999),g=i(37833),v=i(47219),x=i(24821),b=i(5141),y=i(75539);const h="main-nowPlayingView-coverArt",f="SwS3WdCPfdr1uOOksVEB";var j=i(86070);const S=({context:e,item:t,index:i,canSwitchVisuals:n=!1})=>{const{spec:S,logger:C}=(0,b.r)(r.J,{}),{draggable:w,onDragStart:N}=(0,g.P)(),{ref:E,inView:R}=(0,s.Wx)({threshold:.5,initialInView:!0});return(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(l.h,{menu:(0,j.jsx)(u.W,{context:e,item:t,canSwitchVisuals:n}),children:(0,j.jsx)("div",{draggable:w&&((0,x.v)(t)||(0,v.p)(t)),onDragStart:e=>{N(e,{itemUris:[t.uri],dragLabelText:(0,m.r)(t)})},ref:E,children:(0,j.jsx)(p.R,{uri:e.uri,owner:e.metadata?.context_owner,children:(0,j.jsx)(d.e,{context:t.type===y.c.TRACK?t.album:e,item:t,index:i,isVisible:!0,onClick:()=>{C.logInteraction(S.coverArtFactory({uri:t.uri}).hitUiNavigate({destination:t.type===y.c.TRACK?t.album.uri:t.uri}))},adEventReason:o.c.COVER_ART,children:(0,j.jsx)(c.b,{className:a()(h,{[f]:R}),images:t.images??[],type:t.type,maxSize:384,desiredLabel:"xlarge"})})})})})})}},52506:(e,t,i)=>{i.d(t,{o:()=>s});var n=i(48583),a=i(46822);function s(){return(0,a.N)(n.g)}},60523:(e,t,i)=>{i.d(t,{D:()=>s});var n=i(19912),a=i(46822);function s(){return(0,a.N)(n.x)}},61764:(e,t,i)=>{i.d(t,{PanelSection:()=>Qp});var n=i(30758),a=i(94079),s=i(75044),r=i(73493),o=i(97500),l=i.n(o),c=i(25270),u=(i(76669),i(23800)),d=i(57221),p=i(17216),m=i(46628);const g="Xq5xnpTOsoPxFR95BkTU",v="N7OMJte9T4Lv7DDX16ky",x="NJATxQbY2o4sl0BHxU3T";var b=i(86070);const y=({children:e,className:t,...i})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.a,{panel:m.Z.Puffin,className:l()(v,t),...i}),e]});let h=function(e){return e.Overview="overview",e.ActivationIntro="activationIntro",e.ActivationDetection="activationDetection",e.ActivationSignifiers="activationSignifiers",e.Error="error",e.ManualSelection="manualSelection",e.AirpodsSelection="airpodsSelection",e.AudioQualitySettings="audioQualitySettings",e.AudioQualityDetails="audioQualityDetails",e.DiscoverLossless="discoverLossless",e.IncompatibleHeadphones="incompatibleHeadphones",e}({}),f=function(e){return e.GetStarted="getStarted",e.OnError="onError",e.SelectManually="selectManually",e.Continue="continue",e.Close="close",e.Activate="activate",e.SetupNewDevice="setupNewDevice",e.NotFound="notFound",e.Settings="settings",e.OnboardLossless="onboardLossless",e.Details="details",e.Airpods="airpods",e}({});var j=i(37953),S=i(36838);const C=[h.ActivationIntro,h.ActivationDetection,h.ActivationSignifiers,h.ManualSelection,h.AirpodsSelection],w=e=>{const t=(0,n.useRef)(!1),i=(0,S.z)(),a=(0,j.XB)();(0,n.useEffect)((()=>{const n=i.getState()?.isPaused,s=(r=e,o=a,C.includes(r)&&(o===m.Z.PuffinActivation||o===m.Z.PuffinActivationOverlay));var r,o;!s||n||t.current?!s&&n&&t.current&&(i.resume({featureIdentifier:"birdhouse"}),t.current=!1):(i.pause({featureIdentifier:"birdhouse"}),t.current=!0)}),[a,e,i])},N={[h.Overview]:{[f.GetStarted]:h.ActivationIntro,[f.OnError]:h.Error,[f.SelectManually]:h.ManualSelection,[f.Settings]:h.AudioQualitySettings,[f.OnboardLossless]:h.DiscoverLossless,[f.Details]:h.AudioQualityDetails},[h.ActivationIntro]:{[f.Close]:h.Overview,[f.OnError]:h.Error,[f.Continue]:h.ActivationDetection,[f.SelectManually]:h.ManualSelection,[f.Activate]:h.Overview},[h.ActivationDetection]:{[f.SelectManually]:h.ManualSelection,[f.Airpods]:h.AirpodsSelection,[f.Close]:h.Overview,[f.OnError]:h.Error,[f.Continue]:h.ActivationSignifiers},[h.ActivationSignifiers]:{[f.Close]:h.Overview,[f.OnError]:h.Error,[f.Activate]:h.Overview},[h.ManualSelection]:{[f.Continue]:h.ActivationSignifiers,[f.Close]:h.Overview,[f.OnError]:h.Error,[f.NotFound]:h.IncompatibleHeadphones},[h.AirpodsSelection]:{[f.Continue]:h.ActivationSignifiers,[f.Close]:h.Overview,[f.OnError]:h.Error,[f.NotFound]:h.Error},[h.DiscoverLossless]:{[f.Continue]:h.Overview},[h.AudioQualitySettings]:{},[h.AudioQualityDetails]:{},[h.Error]:{},[h.IncompatibleHeadphones]:{[f.Close]:h.Overview,[f.OnError]:h.Error,[f.Continue]:h.Overview}},E=(0,n.createContext)({currentView:h.Overview,viewTransitions:N,setCurrentView:()=>{},toPreviousView:()=>{},viewOptions:null}),R=({children:e})=>{const t=(0,j.XB)(),[i,a]=(0,n.useState)((()=>(e=>[{view:e===m.Z.PuffinActivation||e===m.Z.PuffinActivationOverlay?h.ActivationDetection:h.Overview,options:{}}])(t))),s=(0,n.useCallback)(((e,t)=>{e===h.Overview?a([{view:e,options:t??{}}]):a((i=>[...i,{view:e,options:t??{}}]))}),[]),r=(0,n.useCallback)((()=>{a((e=>e.slice(0,-1)))}),[]);if(0===i.length)throw new Error("Puffin view state stack should never be empty");const{view:o,options:l}=i.at(-1);w(o);const c=(0,n.useMemo)((()=>({currentView:o,viewOptions:l,setCurrentView:s,toPreviousView:r,viewTransitions:N})),[o,s,r,l]);return(0,b.jsx)(E.Provider,{value:c,children:e})},I="EqLKhgGIINyN_LINFjl1",k="OyIY0v1_h3UWgLlxyPHL",A=({resetError:e})=>{const{toPreviousView:t,setCurrentView:i}=(0,n.useContext)(E);return(0,b.jsx)(y,{onBack:()=>{t()},children:(0,b.jsxs)("div",{className:I,children:[(0,b.jsx)(u.b,{size:"xlarge",semanticColor:"textBase"}),(0,b.jsxs)("div",{className:k,children:[(0,b.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",children:"Something went wrong"}),(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:"We couldn’t turn on your headphone tools."})]}),(0,b.jsx)(d.$,{colorSet:"invertedLight",size:"medium",onClick:()=>{e?.(),i(h.Overview)},children:"Retry"})]})})},L=({resetError:e})=>(0,b.jsx)(A,{resetError:e});var T=i(16174),D=i(62411),O=i(17640),_=i(43955),B=i(5849),F=i(52253),P=i(9981),U=i(59242),M=i(12434);const H=()=>{const e=(0,D.d4)((e=>e.platform.isDesktop)),t=(0,B.b)(),i=(0,_.lS)(t),{isPlayingRemotely:a,remoteDeviceName:s,isConnected:r}=(0,P.v)((e=>{const t=(0,F.V)(e);return{isPlayingRemotely:t.isPlayingRemotely,remoteDeviceName:t.remoteDevice?.name,isConnected:t.connectionStatus===U.zP.CONNECTED}}),M.a),o=(0,n.useMemo)((()=>e?O.Ru.get("web-player.connect.device-picker.this-computer"):O.Ru.get("web-player.connect.device-picker.this-web-browser")),[e]),l=(0,n.useMemo)((()=>{if(t)return e?O.Ru.get("web-player.connect.device-picker.from-this-computer",{device_name:t.name}):O.Ru.get("web-player.connect.device-picker.from-this-web-browser",{device_name:t.name})}),[e,t]);if(s&&a&&r)return{deviceName:s,playingFrom:s};if(t?.transportType===_.Yg.AIRPLAY||t?.transportType===_.Yg.BLUETOOTH&&t?.terminalType===_.FI.SPEAKERS)return{deviceName:t?.name,playingFrom:o,formattedDeviceName:l};if(i){if(t?.transportType===_.Yg.BUILT_IN||t?.transportType===_.Yg.USB)return{deviceName:O.Ru.get("web-player.puffin.wired-connection"),playingFrom:o};if(t?.name&&t?.terminalType===_.FI.HEADPHONES)return{deviceName:t?.name,playingFrom:o,formattedDeviceName:l}}return{deviceName:o,playingFrom:o}},V=()=>{const{deviceName:e}=H();return(0,b.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",children:e})};var q=i(29529),Y=i(23263),z=i(37641),G=i(29431);const Q=({onClick:e})=>{const{playingFrom:t}=H(),i=(0,z.t)(),[{data:n}]=(0,G.K)(i.quality.streamingQuality);return void 0===n?null:(0,b.jsx)(q.v,{id:"qualitySetting",variant:"naked",title:O.Ru.get("desktop.settings.streamingQuality"),leading:(0,b.jsx)(Y.s,{size:"small"}),subtitle:t,onClick:e,padding:"0px 12px"})};var K=i(52670),Z=i(58652),W=i(537),J=i(84104);const X=({title:e,description:t,confirmButtonText:i="OK",cancelButtonText:a="Cancel",onConfirm:s,onClose:r})=>{const{setCurrentView:o}=(0,n.useContext)(E),l=(0,j._Y)(),[c,u]=(0,n.useState)(!1),d=(0,n.useRef)(!1);return{dialog:c?(0,b.jsx)(W.T,{onClose:()=>{u(!1),r?.()},onConfirm:()=>{s(),d.current?l(J.$S.PUFFIN_BUTTON_CLICK):o(h.Overview)},titleText:e,"aria-label":e,descriptionText:t,cancelText:a,confirmText:i}):null,triggerDialog:(e=!1)=>{d.current=e,u(!0)}}};var $=i(10192),ee=i(77413);const te=()=>{const e=(0,ee.N)();return{setCurrentDevice:(0,n.useCallback)(((t,i)=>{e.setCurrentDevice(t,i)}),[e]),removeCurrentDevice:(0,n.useCallback)((t=>{e.removeCurrentDevice(t)}),[e])}};var ie=i(58089);const ne=({spec:e})=>{const t=(0,ie.s)(),i=(0,n.useRef)(null),{removeCurrentDevice:a}=te(),{deviceFilterState:s}=(0,$.j)();(0,Z.X)("RESET_HEADPHONES_BUTTON",i);const{triggerDialog:r,dialog:o}=X({title:O.Ru.get("web-player.puffin.reset-headphones.dialog.title"),description:O.Ru.get("web-player.puffin.reset-headphones.dialog.subtitle"),confirmButtonText:O.Ru.get("web-player.puffin.reset-headphones.dialog.confirm"),onConfirm:()=>{a(!0),(0,Z.I)("SETUP_HEADPHONES_BUTTON")},onClose:()=>{(0,Z.I)("RESET_HEADPHONES_BUTTON")}});return s.isOnboarded?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(q.v,{id:"resetHeadphonesButton",ref:i,variant:"naked",title:O.Ru.get("web-player.puffin.reset-headphones.menu-item"),leading:(0,b.jsx)(K.x,{size:"small"}),onClick:i=>{t.logInteraction(e.resetHeadphonesButtonFactory().hitUiReveal()),i.preventDefault(),r(!1)},padding:"0px 12px"}),o]}):null};var ae=i(99612);const se=({isPlayingRemotely:e,spec:t})=>{const i=(0,ie.s)(),{setCurrentView:a,viewTransitions:s}=(0,n.useContext)(E),r=s[h.Overview],o=(0,ae.j)();return(0,b.jsxs)("div",{children:[o&&(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(Q,{onClick:()=>{i.logInteraction(t.qualitySettingsButtonFactory().hitUiReveal()),a(r.settings)}})}),!e&&(0,b.jsx)(ne,{spec:t})]})};var re=i(80366),oe=i(46462);const le="k4f1o0jOMnxv6OS8dC7p",ce="PYLIWbzDyJA6Mbh2EQQg",ue="r3oTh3jKov0cW3m5qF1N",de=({title:e,subtitle:t,buttonLabel:i,onClick:a,dismissButtonLabel:s,onDismissClick:r,focusTransferKey:o=null})=>{const l=(0,n.useRef)(null);return(0,Z.X)(o,l),(0,b.jsx)(q.v,{variant:"naked",size:"lg",id:"getStarted",className:le,title:e,subtitle:t,paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,b.jsxs)("div",{className:ce,children:[(0,b.jsx)(re.n,{size:"small",onClick:a,ref:l,children:(0,b.jsx)(c.E,{variant:"bodySmallBold",children:i})}),s&&r&&(0,b.jsx)(oe.H,{className:ue,size:"small",onClick:r,children:(0,b.jsx)(c.E,{variant:"bodySmallBold",children:s})})]})})};var pe=i(23317),me=i(20953),ge=i(72699);const ve=e=>{switch(e){case ge.Yn.LOSSLESS_24:return{title:O.Ru.get("web-player.pigeon.audio-quality.lossless"),titleFull:O.Ru.get("web-player.pigeon.audio-quality.lossless-24.label"),bitrateLabel:O.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate"),bitrateDetails:[O.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-1"),O.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-2")]};case ge.Yn.LOSSLESS:return{title:O.Ru.get("web-player.pigeon.audio-quality.lossless"),titleFull:O.Ru.get("web-player.pigeon.audio-quality.lossless-16.label"),bitrateLabel:O.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate"),bitrateDetails:[O.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate-details-1"),O.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate-details-2")]};case ge.Yn.VERY_HIGH:return{title:O.Ru.get("web-player.pigeon.audio-quality.very-high.label"),bitrateLabel:O.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate"),bitrateDetails:[O.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate-details")]};case ge.Yn.HIGH:return{title:O.Ru.get("web-player.pigeon.audio-quality.high.label"),bitrateLabel:O.Ru.get("web-player.pigeon.audio-quality.high.bitrate"),bitrateDetails:[O.Ru.get("web-player.pigeon.audio-quality.high.bitrate-details")]};case ge.Yn.NORMAL:return{title:O.Ru.get("web-player.pigeon.audio-quality.normal.label"),bitrateLabel:O.Ru.get("web-player.pigeon.audio-quality.normal.bitrate"),bitrateDetails:[O.Ru.get("web-player.pigeon.audio-quality.normal.bitrate-details")]};case ge.Yn.LOW:return{title:O.Ru.get("web-player.pigeon.audio-quality.low.label"),bitrateLabel:O.Ru.get("web-player.pigeon.audio-quality.low.bitrate"),bitrateDetails:[O.Ru.get("web-player.pigeon.audio-quality.low.bitrate-details")]};case ge.Yn.UNKNOWN:default:return{title:O.Ru.get("web-player.pigeon.audio-quality.unknown.label"),bitrateLabel:null}}},xe="SsVVyvM7DIniTIOjJFuM",be="dHDe0DUG4UkEeM8p5PEa",ye="T49oF8shvnsadykMrogA",he=({quality:e,onClick:t})=>{const i=ve(e),n=[ge.Yn.VERY_HIGH,ge.Yn.HIGH,ge.Yn.NORMAL,ge.Yn.LOW];e===ge.Yn.LOSSLESS_24?n.unshift(ge.Yn.LOSSLESS_24):n.unshift(ge.Yn.LOSSLESS);const a=e===ge.Yn.UNKNOWN?"textBase":"textBrightAccent";return(0,b.jsxs)(pe.a,{as:"button",variant:"tinted",className:xe,onClick:t,children:[(0,b.jsx)(q.v,{id:"quality",size:"lg",pretitle:O.Ru.get("web-player.pigeon.overview-card.title"),titleGap:me.v4,title:(0,b.jsx)(c.E,{variant:"titleSmall",semanticColor:a,children:i.titleFull||i.title}),paddingInlineStart:"0px",paddingInlineEnd:"0px",variant:"naked"}),(0,b.jsx)("div",{children:n.map(((t,i)=>{const n=ve(t),a=t===e,s=a?"textBrightAccent":"textSubdued";return(0,b.jsx)(q.v,{id:n.title,size:"sm",paddingInlineStart:"0px",paddingInlineEnd:"0px",media:(0,b.jsx)("div",{className:l()(be,{[ye]:a})}),title:(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:s,children:n.title}),trailing:(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:s,children:n.bitrateLabel}),variant:"naked"},i)}))})]})};var fe=i(99565);const je=()=>(0,fe.x)("onboarding-dismissed:lossless",!1);var Se=i(46905);const Ce=({spec:e})=>{const t=(0,ie.s)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(E),s=a[h.Overview],r=(0,ae.j)(),o=(0,Se.A)(),[l]=je();return r?(0,b.jsxs)(b.Fragment,{children:[!l&&(0,b.jsx)(de,{title:O.Ru.get("web-player.pigeon.get-started.title"),subtitle:O.Ru.get("web-player.pigeon.get-started.subtitle"),buttonLabel:O.Ru.get("web-player.pigeon.get-started.button"),onClick:()=>{t.logInteraction(e.losslessOnboardingButtonFactory().hitUiReveal()),i(s.onboardLossless)}}),(0,b.jsx)(he,{quality:o,onClick:()=>{t.logInteraction(e.audioQualityCardFactory().hitUiReveal()),i(s.details)}})]}):null},we=({isError:e})=>e?(0,b.jsx)(q.v,{id:"filterError",variant:"tinted",paddingBlockStart:"12px",paddingBlockEnd:"12px",paddingInlineStart:"16px",paddingInlineEnd:"16px",leading:(0,b.jsx)(u.b,{semanticColor:"textSubdued",size:"small"}),title:O.Ru.get("web-player.puffin.error-troubleshooting")}):null;var Ne=i(58837),Ee=i(7638);const Re="jvVll3Ia4Nrq9Fsd78Fo",Ie="d_HhOkLKxYpYKpP2gQy7",ke="fLp9X9keK84drMHcmOFW",Ae=({currentDeviceState:e,spec:t})=>{const i=(0,ie.s)(),a=(0,n.useCallback)((()=>{i.logInteraction(t.optimizeToggleFactory().hitUiElementToggle()),e.toggleTuneHeadphones?.()}),[e,i,t]),s=null!==e.toggleTuneHeadphones,{specificRestricted:r,processingCapabilitiesRestricted:o}=e.contentRestrictions,l=(0,n.useMemo)((()=>r||o?O.Ru.get("web-player.puffin.enhancement-unavailable.content-restriction"):(s||O.Ru.get("web-player.puffin.listening-with.filters.specific-subtitle-unavailable"),O.Ru.get("web-player.puffin.listening-with.filters.specific-subtitle"))),[s,o,r]);return(0,b.jsx)("div",{className:Re,children:(0,b.jsx)(q.v,{variant:"naked",size:"md",id:"headphones",className:Ie,disabled:r||o||!s,title:(0,b.jsx)(Ne.d,{className:ke,children:O.Ru.get("web-player.puffin.listening-with.filters.specific-title")}),subtitle:l,trailing:(0,b.jsx)(Ee.l,{id:"headphoneTunes",onSelected:a,disabled:r||o,value:e.currentState.specificEnabled,condensed:!0})})})},Le="bLEXMWOER6nmfeLfBRIN",Te=({spec:e})=>{const t=(0,ie.s)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(E),s=a[h.Overview],{deviceFilterState:r}=(0,$.j)(),o=r.isOnboarded;return(0,b.jsx)(q.v,{id:"listeningWith",variant:"tinted",pretitle:O.Ru.get("web-player.puffin.listening-with.model"),horizontalGap:"0px",paddingBlockStart:"12px",paddingBlockEnd:"12px",paddingInlineStart:"16px",paddingInlineEnd:"16px",className:Le,trailing:(0,b.jsx)(re.n,{size:"small",onClick:()=>{t.logInteraction(e.changeModelButtonFactory().hitUiReveal()),i(s.selectManually)},children:(0,b.jsx)(c.E,{variant:"bodySmallBold",children:O.Ru.get("web-player.puffin.listening-with.change-model")})}),footer:o&&(0,b.jsx)(Ae,{currentDeviceState:r,spec:e}),title:(0,b.jsx)(Ne.d,{lineClamp:2,children:r.headphoneDevice?.deviceName??O.Ru.get("web-player.puffin.listening-with.placeholder-model")})})},De=({spec:e})=>{const{setCurrentView:t,viewTransitions:i}=(0,n.useContext)(E),a=i[h.Overview],{deviceFilterState:s,isMaybeHeadphoneDevice:r,isError:o,isLoading:l}=(0,$.j)(),c=(0,ie.s)(),{triggerDialog:u,dialog:d,isHiddenByUser:p}=(()=>{const{deviceFilterState:e}=(0,$.j)(),t=e.audioDevice?.id,[i,a]=(0,fe.x)("puffin-hide-get-started",[]),s=(0,n.useMemo)((()=>!!t&&i.includes(t)),[t,i]),r=(0,n.useCallback)((()=>{if(t){const e=[...i,t].slice(-50);a(e)}}),[t,a,i]);return{...X({title:O.Ru.get("web-player.puffin.dismiss-get-started.title"),description:O.Ru.get("web-player.puffin.dismiss-get-started.body"),confirmButtonText:O.Ru.get("hifi.yes"),cancelButtonText:O.Ru.get("web-player.puffin.dismiss-get-started.cancel"),onConfirm:()=>{r()}}),isHiddenByUser:s}})(),m=s.isOnboarded,g=r&&!m&&!p,v=(0,n.useCallback)((()=>{c.logInteraction(e.setupHeadphonesButtonFactory().hitUiReveal()),s.audioDevice?t(a.getStarted):t(a.selectManually,{showDialogOnBack:!0})}),[c,e,s.audioDevice,t,a.getStarted,a.selectManually]);return r?o||l?(0,b.jsx)(we,{isError:o}):(0,b.jsxs)(b.Fragment,{children:[d,m&&(0,b.jsx)(Te,{spec:e}),g&&(0,b.jsx)(de,{title:O.Ru.get("web-player.puffin.get-started.title"),subtitle:O.Ru.get("web-player.puffin.get-started.subtitle"),buttonLabel:O.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm"),onClick:v,dismissButtonLabel:O.Ru.get("web-player.puffin.upsell.enhance-headphones.not-headphones"),onDismissClick:u,focusTransferKey:"SETUP_HEADPHONES_BUTTON"})]}):null};var Oe=i(80396),_e=i(5141);const Be="TJAbLKl8aSWZqWk4EFkk",Fe=J.$S.DEVICE_PICKER_BUTTON_CLICK,Pe=()=>{const e=(0,F.l)(),{panelSend:t}=(0,j.AI)(m.Z.DevicePicker,m.Z.DevicePickerOverlay),i=(0,ae.j)(),a=(0,Oe.v)(),{spec:s,logger:r}=(0,_e.r)(T.R,{}),o=!e&&a,l=(0,n.useCallback)((()=>{r.logInteraction(s.backButtonFactory().hitUiReveal()),t(Fe)}),[r,t,s]);return(0,b.jsx)(y,{onBack:l,onClose:()=>{r.logInteraction(s.closeButtonFactory().hitUiHide())},children:(0,b.jsxs)("div",{className:Be,children:[(0,b.jsx)(V,{}),o&&(0,b.jsx)(De,{spec:s}),i&&(0,b.jsx)(Ce,{spec:s}),(0,b.jsx)(se,{isPlayingRemotely:e,spec:s})]})})};var Ue=i(67880),Me=i(15066),He=i(7098),Ve=i(24498);let qe=function(e){return e.INFO="INFO",e.ERROR="ERROR",e}({});function Ye(e){return e.type===qe.ERROR}function ze(e){return e.type===qe.INFO}var Ge=i(75170);const Qe="UPAv6TbmqM79jDLYgiad",Ke=({card:{type:e,id:t,title:i,text:n}})=>(0,b.jsx)(q.v,{id:t,className:Qe,variant:"tinted",leading:e===qe.ERROR?(0,b.jsx)(He.Z,{size:"small",semanticColor:"textWarning"}):null,title:(0,b.jsx)(Ne.d,{variant:"bodyMedium",children:i}),body:"string"==typeof n?(0,b.jsx)(Ge.y,{LinkComponent:Ve.N,source:n,splitter:/\|/g,semanticColor:"textSubdued",variant:"mesto"}):n});var Ze=i(67009),We=i(78);const Je="GdqxZ88oz8MtwHaBnwgb",Xe="Q4TWj1C8EEkH_beo9jI8",$e="slKZiyNh_zlnTSEo8VG7",et="ichtbB4QY2SKusRio97a",tt="xTMuOBwhiZlpUZtnm0M6";let it=function(e){return e[e.PASSING=0]="PASSING",e[e.NEEDS_ATTENTION=1]="NEEDS_ATTENTION",e[e.UNKNOWN=2]="UNKNOWN",e}({});const nt=({metric:e,label:t,severity:i})=>(0,b.jsxs)("div",{className:l()(Je,{[et]:i===it.UNKNOWN}),children:[(()=>{switch(i){case it.PASSING:return(0,b.jsx)(Ze.k,{size:"large",className:Xe,semanticColor:"textBase"});case it.NEEDS_ATTENTION:return(0,b.jsx)(He.Z,{size:"large",className:$e,semanticColor:"textWarning"});case it.UNKNOWN:return(0,b.jsx)(We.N,{size:"large",className:$e,semanticColor:"textBase"});default:return null}})(),(0,b.jsxs)("div",{className:tt,children:[(0,b.jsx)(c.E,{as:"p",variant:"bodyMedium",semanticColor:"textBase",children:e}),(0,b.jsx)(c.E,{as:"p",semanticColor:"textSubdued",variant:"bodySmall",children:t})]})]});let at=function(e){return e.bitrateLevel="bitrateLevel",e.targetBitrateLevel="targetBitrateLevel",e.targetBitrateAvailable="targetBitrateAvailable",e.strategy="strategy",e.isLocal="isLocal",e.autoAdjust="autoAdjust",e.deviceSupported="deviceSupported",e}({}),st=function(e){return e.Bluetooth_Degrades_Lossless="Bluetooth_Degrades_Lossless",e.Connect_Explanation="Connect_Explanation",e.Default_To_Very_High="Default_To_Very_High",e.Need_To_Redownload="Need_To_Redownload",e.Opt_Out_Of_Downgrade="Opt_Out_Of_Downgrade",e.Poor_Bandwidth_Interferes="Poor_Bandwidth_Interferes",e.Lossless_Unavailable="Lossless_Unavailable",e.Listen_Offline="Listen_Offline",e.Update_Setting="Update_Setting",e}({}),rt=function(e){return e[e.Internet=0]="Internet",e[e.Spotify_Connect=1]="Spotify_Connect",e[e.Downloads=2]="Downloads",e}({}),ot=function(e){return e.Good="good",e.Poor="poor",e.Unknown="unknown",e.Unavailable="unavailable",e}({});const lt=[{criteria:{online:!0,autoAdjust:!1,trackLosslessAvailable:!0},result:st.Opt_Out_Of_Downgrade},{criteria:{online:!0,streamingLossless:!1,targetingLossless:!0,deviceCompatible:!0,internetBandwidth:ot.Poor,trackLosslessAvailable:!0},result:st.Poor_Bandwidth_Interferes},{criteria:{online:!0,autoAdjust:!0,streamingLossless:!1,targetingLossless:!1,deviceCompatible:!0,internetBandwidth:ot.Poor,trackLosslessAvailable:!0},result:st.Default_To_Very_High},{criteria:{online:!0,streamingLossless:!1,bitrateStrategy:[ge.ZT.OFFLINED_FILE],trackLosslessAvailable:!0},result:st.Need_To_Redownload},{criteria:{online:!0,targetingLossless:!0,trackLosslessAvailable:!1},result:st.Lossless_Unavailable},{criteria:{online:!0,isSetStreamingQualityLessThanLossless:!0},result:st.Update_Setting}];const ct=[{criteria:{bitrateLevel:[ge.Yn.LOSSLESS],strategy:[ge.ZT.BEST_MATCHING,ge.ZT.BACKEND_ADVISED,ge.ZT.CACHED_FILE],deviceSupported:!0,autoAdjust:!0},result:ot.Good},{criteria:{bitrateLevel:[ge.Yn.LOW,ge.Yn.NORMAL,ge.Yn.HIGH,ge.Yn.VERY_HIGH],targetBitrateLevel:[ge.Yn.LOW,ge.Yn.NORMAL,ge.Yn.HIGH,ge.Yn.VERY_HIGH],strategy:[ge.ZT.BEST_MATCHING,ge.ZT.CACHED_FILE],deviceSupported:!0,autoAdjust:!0},result:ot.Good},{criteria:{bitrateLevel:[ge.Yn.LOW,ge.Yn.NORMAL,ge.Yn.HIGH,ge.Yn.VERY_HIGH],targetBitrateLevel:[ge.Yn.LOSSLESS],strategy:[ge.ZT.BEST_MATCHING,ge.ZT.BACKEND_ADVISED,ge.ZT.CACHED_FILE],targetBitrateAvailable:!0,deviceSupported:!0,autoAdjust:!0},result:ot.Poor},{criteria:{bitrateLevel:[ge.Yn.LOW,ge.Yn.NORMAL,ge.Yn.HIGH,ge.Yn.VERY_HIGH],targetBitrateLevel:[ge.Yn.LOW,ge.Yn.NORMAL,ge.Yn.HIGH,ge.Yn.VERY_HIGH],strategy:[ge.ZT.BACKEND_ADVISED],deviceSupported:!0,autoAdjust:!0},result:ot.Poor},{criteria:{bitrateLevel:[ge.Yn.LOW,ge.Yn.NORMAL,ge.Yn.HIGH,ge.Yn.VERY_HIGH],targetBitrateLevel:[ge.Yn.LOSSLESS],targetBitrateAvailable:!1,deviceSupported:!0,autoAdjust:!0},result:ot.Unavailable},{criteria:{autoAdjust:!1},result:ot.Unknown},{criteria:{deviceSupported:!1},result:ot.Unknown}],ut=[{criteria:{bitrateLevel:[ge.Yn.LOSSLESS,ge.Yn.LOSSLESS_24],deviceSupported:!0},result:!0},{criteria:{bitrateLevel:[ge.Yn.UNKNOWN,ge.Yn.LOW,ge.Yn.NORMAL,ge.Yn.HIGH,ge.Yn.VERY_HIGH],strategy:[ge.ZT.BEST_MATCHING,ge.ZT.BACKEND_ADVISED,ge.ZT.CACHED_FILE],targetBitrateLevel:[ge.Yn.LOSSLESS,ge.Yn.LOSSLESS_24],targetBitrateAvailable:!0,deviceSupported:!0},result:!0},{criteria:{bitrateLevel:[ge.Yn.UNKNOWN,ge.Yn.LOW,ge.Yn.NORMAL,ge.Yn.HIGH,ge.Yn.VERY_HIGH],strategy:[ge.ZT.OFFLINED_FILE],targetBitrateLevel:[ge.Yn.LOSSLESS,ge.Yn.LOSSLESS_24],targetBitrateAvailable:!0,deviceSupported:!0},result:!1},{criteria:{strategy:[ge.ZT.BEST_MATCHING,ge.ZT.BACKEND_ADVISED,ge.ZT.CACHED_FILE],targetBitrateAvailable:!0,deviceSupported:!0},result:!1},{criteria:{deviceSupported:!1},result:!0},{criteria:{bitrateLevel:[ge.Yn.UNKNOWN,ge.Yn.LOW,ge.Yn.NORMAL,ge.Yn.HIGH,ge.Yn.VERY_HIGH],targetBitrateLevel:[ge.Yn.LOSSLESS,ge.Yn.LOSSLESS_24],targetBitrateAvailable:!1,deviceSupported:!0},result:!0},{criteria:{targetBitrateLevel:[ge.Yn.LOSSLESS,ge.Yn.LOSSLESS_24]},result:!0}],dt=(e,t)=>{for(const[i,n]of Object.entries(t.criteria))if(i===at.bitrateLevel){if(!n.includes(e[at.bitrateLevel]))return!1}else if(i===at.targetBitrateLevel){if(!n.includes(e[at.targetBitrateLevel]))return!1}else if(i===at.strategy){if(!n.includes(e[at.strategy]))return!1}else{if(!n===e[i])return!1}return!0},pt=e=>[ge.Yn.LOSSLESS,ge.Yn.LOSSLESS_24].includes(e);var mt=i(24754),gt=i(65895),vt=i(81286),xt=i(11957);const bt={losslessStatus:ge.p4.NONE,bitrateLevel:ge.Yn.UNKNOWN,targetBitrateLevel:ge.Yn.UNKNOWN,targetBitrateAvailable:!1,strategy:ge.ZT.UNKNOWN};function yt(){const{losslessStatus:e,bitrateLevel:t,targetBitrateLevel:i,targetBitrateAvailable:a,strategy:s}=(0,xt.o)((e=>({...bt,...e?.playbackQuality??null})),M.a),r=(0,F.l)(),o=(0,z.t)(),[{data:l}]=(0,G.K)(o.quality.streamingQuality),[{data:c}]=(0,G.K)(o.quality.remoteQuality),u=(0,P.v)((e=>e.activeDevice)),d=(0,n.useMemo)((()=>null!==u&&u.losslessSupport?u.losslessSupport:{fullySupported:!1,deviceSupported:!1,userEligible:!1}),[u]).deviceSupported,{settings:{values:p}}=(0,gt.t0)(),m=p["audio.allow_downgrade"],g=u?.isLocal||!1;let v;v=g?s===ge.ZT.CACHED_FILE||s===ge.ZT.OFFLINED_FILE?rt.Downloads:rt.Internet:rt.Spotify_Connect;const x={bitrateLevel:t,targetBitrateLevel:i,targetBitrateAvailable:a,strategy:s,isLocal:g,deviceSupported:d,autoAdjust:m},b=(e=>{for(const t of ut)if(dt(e,t))return t.result;return!(!pt(e[at.bitrateLevel])&&!pt(e[at.targetBitrateLevel]))})(x),y=(e=>{for(const t of ct)if(dt(e,t))return t.result;return e[at.strategy]===ge.ZT.BACKEND_ADVISED?ot.Poor:ot.Good})(x),h=(0,vt.n)(),f=pt(i)&&a,j=pt(t),S=pt(i),C=r?c?.streamingQuality:l,w=function({online:e,streamingLossless:t,targetingLossless:i,strategy:n,trackLosslessAvailable:a,autoAdjust:s,internetBandwidth:r,losslessCompatibleDevice:o,isLocal:l,isSetStreamingQualityLessThanLossless:c}){const u=[st.Listen_Offline,st.Connect_Explanation,st.Bluetooth_Degrades_Lossless];for(const d of lt){const{criteria:p,result:m}=d;p.online===e&&(void 0!==p.autoAdjust&&p.autoAdjust!==s||void 0!==p.streamingLossless&&p.streamingLossless!==t||void 0!==p.targetingLossless&&p.targetingLossless!==i||void 0!==p.deviceCompatible&&p.deviceCompatible!==o||void 0!==p.bitrateStrategy&&!1===l||(void 0===p.bitrateStrategy||void 0!==n&&p.bitrateStrategy.includes(n))&&(void 0!==p.internetBandwidth&&p.internetBandwidth!==r||void 0!==p.trackLosslessAvailable&&p.trackLosslessAvailable!==a||void 0!==p.isSetStreamingQualityLessThanLossless&&p.isSetStreamingQualityLessThanLossless!==c||u.push(m)))}return u}({online:h,streamingLossless:j,targetingLossless:S,strategy:s,trackLosslessAvailable:f,autoAdjust:m,internetBandwidth:y,losslessCompatibleDevice:d,isLocal:g,isSetStreamingQualityLessThanLossless:!!C&&C<mt.a1.LOSSLESS&&C>mt.a1.AUTOMATIC});return{losslessStatus:e,bitrateLevel:t,flags:w,internetBandwidth:y,playingVia:{channelIsLossless:b,channel:v},losslessCompatibleDevice:d}}const ht=()=>{const{losslessCompatibleDevice:e,playingVia:t,internetBandwidth:i}=yt();return(0,b.jsxs)("div",{children:[(0,b.jsx)(nt,{metric:O.Ru.get("web-player.pigeon.audio-quality.lossless-compatible-device"),label:e?O.Ru.get("hifi.yes"):O.Ru.get("hifi.no"),severity:e?it.PASSING:it.NEEDS_ATTENTION}),(0,b.jsx)(nt,{metric:O.Ru.get("hifi.playingVia"),label:(()=>{const{channel:e}=t;switch(e){case rt.Downloads:return O.Ru.get("local-files.source.downloads");case rt.Internet:return O.Ru.get("hifi.networkConnection");case rt.Spotify_Connect:return O.Ru.get("spotify-connect");default:return""}})(),severity:t.channelIsLossless?it.PASSING:it.NEEDS_ATTENTION}),(0,b.jsx)(nt,{metric:O.Ru.get("hifi.internetBandwidth"),label:(()=>{switch(i){case ot.Good:return O.Ru.get("hifi.good");case ot.Poor:return O.Ru.get("hifi.poor");case ot.Unknown:default:return O.Ru.get("hifi.unknown")}})(),severity:(()=>{switch(i){case ot.Good:return it.PASSING;case ot.Poor:return it.NEEDS_ATTENTION;case ot.Unknown:default:return it.UNKNOWN}})()})]})};var ft=i(46909);const jt={[st.Listen_Offline]:()=>({type:"info",title:O.Ru.get("web-player.pigeon.help-cards.listen-offline.title"),message:O.Ru.get("web-player.pigeon.help-cards.listen-offline.body")}),[st.Connect_Explanation]:()=>({type:"info",title:O.Ru.get("web-player.pigeon.help-cards.connect-explanation.title"),message:(0,b.jsx)(c.E,{as:"p",variant:"bodySmall",semanticColor:"textSubdued",children:O.Ru.get("web-player.pigeon.help-cards.connect-explanation.body",(0,b.jsx)(ft.g,{size:"xsmall",alignmentBaseline:"baseline"}))})}),[st.Bluetooth_Degrades_Lossless]:()=>({type:"info",title:O.Ru.get("web-player.pigeon.help-cards.bluetooth-degrades-lossless.title"),message:O.Ru.get("web-player.pigeon.help-cards.bluetooth-degrades-lossless.body")}),[st.Opt_Out_Of_Downgrade]:()=>({type:"error",title:O.Ru.get("web-player.pigeon.help-cards.opt-out-of-downgrade.title"),message:O.Ru.get("web-player.pigeon.help-cards.opt-out-of-downgrade.body")}),[st.Poor_Bandwidth_Interferes]:()=>({type:"error",title:O.Ru.get("web-player.pigeon.help-cards.poor-bandwidth-interferes.title"),message:O.Ru.get("web-player.pigeon.help-cards.poor-bandwidth-interferes.body")}),[st.Default_To_Very_High]:()=>({type:"error",title:O.Ru.get("web-player.pigeon.help-cards.default-to-very-high.title"),message:O.Ru.get("web-player.pigeon.help-cards.default-to-very-high.body")}),[st.Need_To_Redownload]:()=>({type:"error",title:O.Ru.get("web-player.pigeon.help-cards.need-to-redownload.title"),message:O.Ru.get("web-player.pigeon.help-cards.need-to-redownload.body")}),[st.Lossless_Unavailable]:()=>({type:"error",title:O.Ru.get("web-player.pigeon.help-cards.lossless-unavailable.title"),message:O.Ru.get("web-player.pigeon.help-cards.lossless-unavailable.body")}),[st.Update_Setting]:()=>({type:"error",title:O.Ru.get("web-player.pigeon.help-cards.update-settings.title"),message:O.Ru.get("web-player.pigeon.help-cards.update-settings.body")})},St="BFsg6KnXzCo_ZKKekrFC",Ct="OIOUgecXCtVCX_DzOsR4",wt="qcU9Wt2Ly1y44H_lC327",Nt=()=>{const{toPreviousView:e}=(0,n.useContext)(E),t=(0,Se.A)(),i=ve(t),a=(()=>{const{flags:e}=yt(),t=[];return e.forEach((e=>{if(jt[e]){const{type:i,message:n,title:a}=jt[e]();"info"===i?t.push({id:e,text:n,title:a,type:qe.INFO}):t.push({id:e,text:n,title:a??"",type:qe.ERROR})}})),t})(),s=a.some(Ye),r=a.filter(s?Ye:ze);return(0,b.jsx)(y,{onBack:e,children:(0,b.jsxs)("div",{className:St,children:[(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:O.Ru.get("web-player.pigeon.overview-card.title")}),(0,b.jsx)(c.E,{variant:"titleMedium",semanticColor:"textBrightAccent",children:i.titleFull||i.title}),(0,b.jsx)("div",{className:Ct,children:i.bitrateDetails?.map(((e,t)=>(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBrightAccent",children:e},`bitrate-details-${t}`)))}),(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBrightAccent"}),(0,b.jsx)("div",{className:wt,children:(0,b.jsx)(ht,{})}),r.map((e=>(0,b.jsx)(Ke,{card:e},e.id)))]})})};var Et=i(55095);const Rt=({subtitles:e})=>(0,b.jsx)(b.Fragment,{children:e.map(((e,t)=>(0,b.jsx)(c.E,{semanticColor:"textSubdued",variant:"bodySmall",children:e},`subtitle-${t}`)))}),It="ZExuZhVAKsqOBfFdR6Js",kt="G5KBejq8q3GSZxhHs9be",At="WG0sT27gl2zSvisQcgHS",Lt="iUbPCgoUSkOoOVEo5wnr",Tt="NCUCNjFgGqpox8ttJKch",Dt=({title:e,isLossless:t})=>(0,b.jsxs)("div",{className:kt,children:[(0,b.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:e}),t&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:"•"}),(0,b.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBrightAccent",children:O.Ru.get("web-player.pigeon.audio-quality.lossless.highest")})]})]});var Ot=i(28233);const _t=({onClick:e,quality:t,playQuality:i,maxQuality:n})=>{const{title:a,subtitles:s}=(e=>{switch(e){case mt.a1.LOSSLESS:return{title:O.Ru.get("web-player.pigeon.audio-quality.lossless"),subtitles:[O.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-1"),O.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-2")]};case mt.a1.VERY_HIGH:return{title:O.Ru.get("web-player.pigeon.audio-quality.very-high.label"),subtitles:[O.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate-details.subtitle")]};case mt.a1.HIGH:return{title:O.Ru.get("web-player.pigeon.audio-quality.high.label"),subtitles:[O.Ru.get("web-player.pigeon.audio-quality.high.bitrate-details.subtitle")]};case mt.a1.MEDIUM:return{title:O.Ru.get("web-player.pigeon.audio-quality.normal.label"),subtitles:[O.Ru.get("web-player.pigeon.audio-quality.normal.bitrate-details.subtitle")]};case mt.a1.LOW:return{title:O.Ru.get("web-player.pigeon.audio-quality.low.label"),subtitles:[O.Ru.get("web-player.pigeon.audio-quality.low.bitrate-details.subtitle")]};default:return{title:O.Ru.get("web-player.pigeon.audio-quality.unknown.label"),subtitles:null}}})(t);if(null===a||null===s)return null;const r=i===t,o=t===mt.a1.LOSSLESS,l=null===n||t<=n;return(0,b.jsx)(q.v,{id:"title",variant:"naked",verticalGap:"2px","aria-disabled":!l,onClick:e,onClickHint:O.Ru.get("web-player.pigeon.quality-settings.option-hint",a),title:(0,b.jsx)(Dt,{title:a,isLossless:o}),subtitle:(0,b.jsx)(Rt,{subtitles:s}),trailing:r?(0,b.jsx)(Et.i,{semanticColor:"textBrightAccent"}):void 0})},Bt=()=>{const{toPreviousView:e}=(0,n.useContext)(E),t=(0,F.l)(),{playingFrom:i}=H(),a=(0,z.t)(),[{data:s},{mutate:r}]=(0,G.K)(a.quality.streamingQuality),[{data:o},{mutate:l}]=(0,G.K)(a.quality.autoAdjustQuality),[{data:u},{mutate:d}]=(0,G.K)(a.quality.remoteQuality),p=(0,Ot.x)();if(void 0===p||void 0===o||void 0===s)return null;let m=s,g=r,v=null;return t&&u&&(m=u.streamingQuality,v=u.maxSupportedQuality,g=e=>d({...u,streamingQuality:e})),(0,b.jsxs)(y,{onBack:e,children:[(0,b.jsxs)("div",{className:Tt,children:[(0,b.jsx)(c.E,{as:"h2",variant:"titleSmall",semanticColor:"textBase",children:O.Ru.get("web-player.pigeon.quality-settings.title")}),(0,b.jsx)(c.E,{semanticColor:"textSubdued",variant:"bodySmall",children:i})]}),(0,b.jsx)("div",{className:It,children:p.sort(((e,t)=>e.quality-t.quality)).map(((e,t)=>(0,b.jsx)(_t,{quality:e.quality,playQuality:m,maxQuality:v,onClick:()=>g(e.quality)},t)))}),(0,b.jsx)(c.E,{children:O.Ru.get("web-player.pigeon.quality-settings.disclaimer")}),(0,b.jsxs)("div",{className:At,children:[(0,b.jsx)(c.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:O.Ru.get("web-player.pigeon.quality-settings.listening-preferences")}),(0,b.jsx)(q.v,{className:Lt,variant:"naked",size:"sm",id:"auto-adjust-quality",horizontalGap:"0px",title:(0,b.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:O.Ru.get("web-player.pigeon.quality-settings.auto-adjust-quality")}),trailing:(0,b.jsx)(Ee.l,{id:"desktop.settings.automatic-downgrade",value:o,onSelected:l,condensed:!0})}),(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:O.Ru.get("web-player.pigeon.quality-settings.auto-adjust-quality.subtitle-1")}),(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:O.Ru.get("web-player.pigeon.quality-settings.auto-adjust-quality.subtitle-2")})]})]})};var Ft=i(24845),Pt=i(99491),Ut=i(36907);const Mt="GYa976HrK40QHF7ZZvwM",Ht="MHROZzo24FoePahYMEFJ",Vt="qQ5CfbxUDYyLgy_O6Gah",qt=({nrSteps:e,currentStep:t,onClick:i})=>(0,b.jsx)("div",{className:Mt,children:Array.from({length:e}).map(((e,n)=>(0,b.jsx)("button",{"aria-label":(0,Ut.v)(`Go to Step ${n+1}`),className:l()(Ht,{[Vt]:t===n}),onClick:()=>i(n)},n)))});var Yt=i(24818),zt=i(16072),Gt=i(57195),Qt=i(38255);const Kt="Vpnd2l8y0SgEYWxGIRzB",Zt="cUTxS9VrHd466oEAGs7_",Wt="JvZLieWRZZQjIU2ElJ2Y",Jt="ub90kjJH_P8M2r1QL_jL",Xt="U3xgLhEWHrv2mb_ZSesP",$t="ZiS7XuaKSNH6O814jzTW",ei="W8RJgFmuCgvRsxpnXMWG",ti="pAYPkrJQFNaLczxADAGc",ii="nBOyGCpnbwg691MCewBj",ni="hr6LueujvRuzxi6lBlVZ",ai="zwfOn0Sx4qfhn2imHyQ9",si="UcHPiDY6dLRbaeY65j16",ri="KsS00iz9PKUXYN0PHhno",oi="h66wSXbM4f8lkj4EppJQ",li=({imageUrl:e,max:t,alt:i=""})=>{const n=(0,Qt.dZ)();return(0,b.jsx)(Gt._,{className:Xt,src:n(e,t),loading:"eager",alt:i})};var ci=i(55122);const ui=({path:e,loop:t=!0})=>(0,b.jsx)(n.Suspense,{fallback:null,children:(0,b.jsx)(ci.o,{loop:t,autoplay:!0,path:e,className:Jt,style:{width:"auto",height:"100%"}})});var di=i(21855);function pi({children:e,variant:t}){const i=(0,n.useRef)(null);return(0,di.i)({ref:i}),(0,b.jsx)(c.E,{variant:t,semanticColor:"textBase",className:ii,tabIndex:-1,ref:i,children:e})}var mi=i(41952);const gi={[mi.E.SMALL]:{titleVariant:"bodyMediumBold",subtitleVariant:"marginalBold",bodyVariant:"bodySmall",containerGap:0,headerGap:0,assetGap:8,subtitleGap:4,titleGap:4,buttonGap:12,assetMaxHeight:165},[mi.E.MEDIUM]:{titleVariant:"titleSmall",subtitleVariant:"marginalBold",bodyVariant:"bodySmall",containerGap:16,headerGap:24,assetGap:24,subtitleGap:12,titleGap:8,buttonGap:24,assetMaxHeight:240},[mi.E.LARGE]:{titleVariant:"titleMedium",subtitleVariant:"bodySmall",bodyVariant:"bodyMedium",containerGap:32,headerGap:32,assetGap:48,subtitleGap:16,titleGap:8,buttonGap:32,assetMaxHeight:320}},vi="AOGvMtDLQNbo94n8r8mu",xi="gf6sr0Z5UAyf7ULRfSFA",bi=({icon:e,text:t,highlighted:i,condensed:n=!1,className:a})=>(0,b.jsxs)("div",{className:l()(vi,a),children:[(0,b.jsx)(e,{size:n?"xsmall":"small",semanticColor:"textBase",className:l()({[xi]:i})}),(0,b.jsx)(c.E,{variant:n?"marginalBold":"bodySmallBold",semanticColor:"textBase",className:l()({[xi]:i}),children:t})]});var yi=i(85586),hi=i(72806);const fi=({onboardingContent:e,onNext:t,onTertiaryClick:i,layout:s="vertical",showLoader:r=!1})=>{const{bodyTitle:o,bodySubtitle:u,bodyText:p,imageUrl:m,lottiePath:g,loopAnimation:v=!0,subtitleIcon:x,buttonText:y,tertiaryButtonText:h}=e,f=(0,yi.y)(),{titleVariant:j,subtitleVariant:S,bodyVariant:C,containerGap:w,headerGap:N,assetGap:E,subtitleGap:R,titleGap:I,buttonGap:k,assetMaxHeight:A}=(0,n.useMemo)((()=>{let e=mi.E.MEDIUM;switch(f){case mi.E.SMALL:e=mi.E.SMALL;break;case mi.E.MEDIUM:e=mi.E.MEDIUM;break;case mi.E.LARGE:e=mi.E.LARGE}return gi[e]}),[f]),L=(0,n.useRef)(null),T=(0,hi.j)();return(0,b.jsx)(Yt.A,{mode:"out-in",children:(0,b.jsx)(a.A,{timeout:T?0:800,classNames:{enter:ai,enterActive:si,exit:ri,exitActive:oi},nodeRef:L,children:(0,b.jsx)("div",{className:Kt,style:{"--onboarding-container-gap":`${w}px`,"--onboarding-asset-gap":`${E}px`,"--onboarding-subtitle-gap":`${R}px`,"--onboarding-title-gap":`${I}px`,"--onboarding-button-gap":`${k}px`,"--onboarding-asset-max-height":`${A}px`,"--onboarding-header-gap":`${N}px`},ref:L,children:(0,b.jsxs)("div",{className:l()(Zt,{[$t]:"horizontal"===s}),children:[(0,b.jsxs)("div",{className:Wt,children:[m?(0,b.jsx)(li,{imageUrl:m,max:A}):null,g?(0,b.jsx)(ui,{path:g,loop:v}):null]}),(0,b.jsxs)("div",{className:ei,children:[(0,b.jsx)(bi,{icon:x,text:u,condensed:f!==mi.E.LARGE,highlighted:!0,className:ti,variant:S}),(0,b.jsx)(pi,{variant:j,children:o}),(0,b.jsx)(c.E,{variant:C,children:p}),(0,b.jsx)("div",{className:ni,children:r?(0,b.jsx)(zt.m,{}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.$,{colorSet:"invertedLight",size:f===mi.E.LARGE?"medium":"small",onClick:t,children:y}),i&&h?(0,b.jsx)(oe.H,{size:f===mi.E.LARGE?"medium":"small",onClick:i,condensed:!0,children:e.tertiaryButtonText}):null]})})]})]})})},o)})};const ji=({variant:e})=>(0,b.jsx)(c.E,{variant:e,semanticColor:"textBase",children:"Spotify"}),Si=()=>[{bodyTitle:O.Ru.get("web-player.pigeon.introduction.step-1.title"),bodySubtitle:"Lossless",bodyText:O.Ru.get("web-player.pigeon.introduction.step-1.subtitle"),subtitleIcon:Ft.Q,buttonText:O.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc00009256c4d947fba90f6244343446ee"},{bodyTitle:O.Ru.get("web-player.pigeon.introduction.step-2.title"),bodySubtitle:"Lossless",bodyText:O.Ru.get("web-player.pigeon.introduction.step-2.subtitle"),subtitleIcon:Ft.Q,buttonText:O.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc00005e4e6fd833f6f5c2cf4f81c1da66"},{bodyTitle:O.Ru.get("web-player.pigeon.introduction.step-3.title"),bodySubtitle:"Lossless",bodyText:O.Ru.get("web-player.pigeon.introduction.step-3.subtitle"),subtitleIcon:Ft.Q,buttonText:O.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc000092564a451c0c1fba3acf8fed995f"},{bodyTitle:O.Ru.get("web-player.pigeon.introduction.step-4.title"),bodySubtitle:"Lossless",bodyText:O.Ru.get("web-player.pigeon.introduction.step-4.subtitle"),subtitleIcon:Ft.Q,buttonText:O.Ru.get("web-player.pigeon.introduction.button.done"),imageUrl:"spotify:image:ab671fcc000092562f3465b95599cdb50e47604e"}],Ci=()=>{const[e,t]=je(),{setCurrentView:i,toPreviousView:a,viewTransitions:s}=(0,n.useContext)(E),{spec:r,logger:o}=(0,_e.r)(Pt.m,{}),l=s[h.DiscoverLossless],{onNext:c,onBack:u,currentStep:d,goTo:p}=function(e){const[t,i]=(0,n.useState)(0),[a,s]=(0,n.useState)(!1),r=(0,n.useCallback)((()=>{t!==e-1?i(t+1):s(!0)}),[t,e]),o=(0,n.useCallback)((()=>{0!==t&&i(t-1),a&&s(!1)}),[t,a]),l=(0,n.useCallback)((t=>{t>=0&&t<e&&i(t),t===e?s(!0):a&&s(!1)}),[e,a]);return{currentStep:t,onNext:r,onBack:o,reachedEnd:a,goTo:l}}(Si().length),m=(0,n.useCallback)((()=>{o.logInteraction(r.closeButtonFactory().hitUiHide()),i(l.continue)}),[o,i,r,l.continue]);return(0,b.jsxs)(y,{titleSlot:(0,b.jsx)(ji,{variant:"bodySmallBold"}),onBack:()=>{o.logInteraction(r.backButtonFactory().hitUiHide()),d>0?u():a()},onClose:m,preventDefaultClose:!0,children:[(0,b.jsx)(fi,{onboardingContent:Si()[d],onNext:()=>{3===d?(o.logInteraction(r.doneButtonFactory().hitUiHide()),t(!0),i(l.continue)):c()}}),(0,b.jsx)(qt,{nrSteps:Si().length,currentStep:d,onClick:p})]})};var wi=i(63573),Ni=i(51043),Ei=i(42594);const Ri=e=>({bodyTitle:O.Ru.get("web-player.puffin.activation-2.title",e.headphoneDevice?.deviceName),bodySubtitle:O.Ru.get("web-player.puffin.signifier-text"),lottiePath:(0,Ei.b)("animations/puffin-onboarding-tour-2.json"),subtitleIcon:Ni.C,buttonText:O.Ru.get("web-player.puffin.activation-2.button-confirm"),tertiaryButtonText:O.Ru.get("web-player.puffin.activation-2.button-cancel"),loopAnimation:!1}),Ii=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(E),{deviceFilterState:i,isMaybeHeadphoneDevice:a,isLoading:s}=(0,$.j)(),r=t[h.ActivationDetection];(0,n.useLayoutEffect)((()=>{i.headphoneDevice||s||!a||e(h.ManualSelection,{showDialogOnBack:!0})}),[i.headphoneDevice,s,a,e]);const o=(0,n.useMemo)((()=>i?.wasAmbiguous),[i]);return(0,b.jsx)(fi,{onboardingContent:Ri(i),onNext:()=>{e(o?r.airpods:r.continue)},onTertiaryClick:()=>{e(r.selectManually)},showLoader:s||!i.headphoneDevice})},ki=()=>{const{deviceFilterState:e,isLoading:t}=(0,$.j)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(E),s=a[h.ActivationIntro],r=(0,n.useCallback)((()=>{e.toggleTuneHeadphones?i(s.continue):i(s.selectManually,{showDialogOnBack:!0})}),[e,i,s.continue,s.selectManually]),o={bodyTitle:O.Ru.get("web-player.puffin.activation-1.title"),bodySubtitle:O.Ru.get("web-player.puffin.signifier-text"),lottiePath:(0,Ei.b)("animations/puffin-onboarding-tour-1.json"),subtitleIcon:Ni.C,buttonText:O.Ru.get("web-player.puffin.activation-1.button")};return(0,b.jsx)(fi,{onboardingContent:o,onNext:r,showLoader:t||!e.audioDevice})};var Ai=i(67843),Li=i(16003);const Ti=e=>{const{deviceFilterState:t}=(0,$.j)(),{setCurrentDevice:i}=te(),a=(0,Ai.vh)(),{setCurrentView:s}=(0,n.useContext)(E),r=(0,n.useCallback)((async()=>{i(t.headphoneDevice,!0);try{await t.setFilterState({specificEnabled:!!t.toggleTuneHeadphones,externalizationEnabled:!!t.toggleTuneStudio})}catch{return void s(h.Error)}((e,t)=>{e.send((0,Li.d)({has_tuner:!!t.toggleTuneHeadphones,filter_brand:t.headphoneDevice?.brand??null,filter_model:t.headphoneDevice?.model??null,was_predicted:!!t.predictedState,headphone_name_over_bluetooth:t.audioDevice?.transportType===_.Yg.BLUETOOTH?t.audioDevice.name:null,external_accessory_mapping_predicted_brand:t.predictedState?.predictedBrand??null,external_accessory_mapping_predicted_model:t.predictedState?.predictedModel??null,was_matched:(t.predictedState?.wasMatched&&!t.headphoneDevice?.isAmbiguous)??!1,was_ambiguous:t.headphoneDevice?.isAmbiguous??!1,was_manually_selected:(t.headphoneDevice?.isAmbiguous||t.headphoneDevice?.wasSelectedManually)??!1}))})(a,t),e()}),[t,a,e,i,s]);return{handleClick:r}},Di=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(E),{spec:i,logger:a}=(0,_e.r)(wi.i,{}),s=t[h.ActivationSignifiers],{handleClick:r}=Ti((()=>{a.logInteraction(i.doneButtonFactory().hitUiHide()),e(s.activate)}));return(0,b.jsx)(fi,{onboardingContent:{bodyTitle:O.Ru.get("web-player.puffin.activation-3.title"),bodySubtitle:O.Ru.get("web-player.puffin.signifier-text"),bodyText:O.Ru.get("web-player.puffin.activation-3.subtitle"),imageUrl:"spotify:image:ab671fcc00005e4ed89275c5e4eef1d432ac3fe2",subtitleIcon:Ni.C,buttonText:O.Ru.get("web-player.puffin.button.done"),loopAnimation:!0},onNext:r})},Oi="FcycLYpZEbmuEClARSPP",_i="NSoA0u_DehEmTu_M20Qn",Bi="fGnSEIwIPGid9ALC9ANP",Fi="ZknipG1So_RdKeJ911k3",Pi=({number:e,message:t})=>(0,b.jsxs)("div",{className:Bi,children:[(0,b.jsx)("div",{className:Fi,children:(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBase",children:e})}),(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:t})]}),Ui=()=>{const{setCurrentView:e}=(0,n.useContext)(E);return(0,b.jsxs)("div",{className:Oi,children:[(0,b.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",children:O.Ru.get("web-player.puffin.device-connection-lost.title")}),(0,b.jsxs)("div",{className:_i,children:[(0,b.jsx)(Pi,{number:1,message:O.Ru.get("web-player.puffin.device-connection-lost.tip-1")}),(0,b.jsx)(Pi,{number:2,message:O.Ru.get("web-player.puffin.device-connection-lost.tip-2")}),(0,b.jsx)(Pi,{number:3,message:O.Ru.get("web-player.puffin.device-connection-lost.tip-3")}),(0,b.jsx)(Pi,{number:4,message:O.Ru.get("web-player.puffin.device-connection-lost.tip-4")})]}),(0,b.jsx)(oe.H,{semanticColor:"textSubdued",onClick:()=>{e(h.Overview)},children:"Still not working"})]})},Mi=()=>{const{removeCurrentDevice:e}=te();return X({title:O.Ru.get("web-player.puffin.activation-dialog.title"),description:O.Ru.get("web-player.puffin.activation-dialog.subtitle"),confirmButtonText:O.Ru.get("web-player.puffin.activation-dialog.button-cancel"),cancelButtonText:O.Ru.get("web-player.puffin.activation-dialog.button-confirm"),onConfirm:()=>{e(!0),(0,Z.I)("SETUP_HEADPHONES_BUTTON")}})},Hi=({type:e})=>{const{isMaybeHeadphoneDevice:t}=(0,$.j)(),{spec:i,logger:a}=(0,_e.r)(wi.i,{}),{triggerDialog:s,dialog:r}=Mi(),o=(0,n.useCallback)((()=>{a.logInteraction(i.closeButtonFactory().hitUiHide()),s(!0)}),[a,i,s]),l=(0,n.useCallback)((()=>{a.logInteraction(i.backButtonFactory().hitUiReveal()),s(!1)}),[a,i,s]);return(0,b.jsx)(y,{titleSlot:(0,b.jsx)(ji,{variant:"bodySmallBold"}),onClose:o,onBack:l,preventDefaultClose:!0,children:t?(0,b.jsxs)(b.Fragment,{children:[r,"intro"===e&&(0,b.jsx)(ki,{}),"detection"===e&&(0,b.jsx)(Ii,{}),"signifiers"===e&&(0,b.jsx)(Di,{})]}):(0,b.jsx)(Ui,{})})};var Vi=i(31600),qi=i(65355),Yi=i(34262),zi=i(6306),Gi=i(51248);const Qi=({device:e,onClick:t,isAirpodDevice:i})=>{const n=i?`${e.model} (${e.releaseYear})`:e.model,a=i?O.Ru.get("web-player.puffin.manual-selection.models-list",e.modelNumbers.join(O.Ru.getSeparator())):e.brand;return(0,b.jsx)(Gi.c,{children:(0,b.jsx)(q.v,{variant:"naked",size:"md",isInteractive:!0,id:e.id,title:(0,b.jsx)(Ne.d,{onClick:()=>{t(e)},children:n}),subtitle:a,trailing:(0,b.jsx)(zi.V,{size:"small",semanticColor:"textSubdued"}),onClick:()=>{t(e)},hoverAnimationDuration:"0s"},e.id)})},Ki="fjltNoIqUMIY7LfgtvCH",Zi="WNi2uq00PuqJnOvv6b6a",Wi="W3HfPxIGTvmPJNItOM5A",Ji="T3zyYZ33nGeJfw6NgwwV",Xi="fr_QT3qQxce_KdFUhktQ",$i="wMsnDxvKohBJOUguxi8p",en="O842FkxrdjAlid2byB9c",tn="E6yKOmbA9ekxMnRhJDnA",nn="sm96uN6u5WGLjNfbT6kF",an="bWJ8TFqqyCV4TqeScz7D",sn="SRl_K6g2YOd8qrpIFij7",rn=({search:e})=>(0,b.jsxs)("div",{className:tn,children:[(0,b.jsx)(c.E,{semanticColor:"textBase",variant:"titleSmall",className:nn,children:O.Ru.get("web-player.puffin.manual-selection.empty.title",(0,b.jsx)("span",{className:an,children:(0,b.jsx)("span",{className:sn,children:e})}))}),(0,b.jsx)(c.E,{semanticColor:"textSubdued",variant:"bodySmall",children:O.Ru.get("web-player.puffin.manual-selection.empty.subtitle")})]}),on={id:"unknown_device",brand:"",model:"",deviceName:"Generic",modelNumbers:[],releaseYear:""},ln=({devices:e,isAirpodsList:t=!1})=>{const{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(E),s=t?a[h.AirpodsSelection]:a[h.ManualSelection],{filter:r,setFilter:o}=(0,n.useContext)(qi.g),{setCurrentDevice:l}=te(),c=(0,n.useCallback)((e=>{const n=e?{...e,wasSelectedManually:!0,isAmbiguous:t}:null;l(n,!0),i(e?.id===on.id?s.notFound:s.continue),o("")}),[t,l,i,s.notFound,s.continue,o]),u=e.filter((({deviceName:e,brand:t,model:i,modelNumbers:n})=>[e,t,i,...n].some((e=>e.toLowerCase().includes(r.toLowerCase())))));return(0,b.jsxs)("div",{className:$i,children:[(0,b.jsx)(Yi.$,{children:u.map((e=>(0,b.jsx)(Qi,{device:e,onClick:c,isAirpodDevice:t},e.id)))}),0===u.length&&(0,b.jsx)(rn,{search:r}),(0,b.jsx)("div",{className:Xi,children:(0,b.jsx)(re.n,{size:"small",onClick:()=>{c(on)},children:O.Ru.get("web-player.puffin.manual-selection.not-found-button")})})]})};var cn=i(16318);const un=()=>{const e=(0,ee.N)(),{data:t,isLoading:i,isError:n}=(0,cn.I)({queryKey:["puffin-devices"],queryFn:async()=>await e.getDevices(),gcTime:18e5,staleTime:6e5});return{data:t??null,loading:i,error:n}},dn=()=>{const{toPreviousView:e}=(0,n.useContext)(E),{data:t}=un(),i=(0,n.useMemo)((()=>t?.filter((e=>"apple"===e.brand.toLowerCase()&&e.model.toLowerCase().includes("airpods")))),[t]);return(0,b.jsx)(y,{onBack:()=>{e()},children:(0,b.jsxs)(qi.s,{uri:"spotify:internal:bettersound",children:[(0,b.jsxs)("div",{className:Zi,children:[(0,b.jsx)("div",{className:Wi}),(0,b.jsxs)("div",{className:Ji,children:[(0,b.jsx)(c.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:O.Ru.get("web-player.puffin.manual-selection.airpods.title")}),(0,b.jsx)(c.E,{variant:"bodySmall",children:O.Ru.get("web-player.puffin.manual-selection.airpods.subtitle")})]}),(0,b.jsx)(Vi.S,{placeholder:O.Ru.get("web-player.puffin.manual-selection.airpods.search-placeholder"),alwaysExpanded:!0,fullWidth:!0,debounceFilterChangeTimeout:0})]}),i?(0,b.jsx)("div",{className:Ki,children:(0,b.jsx)(ln,{devices:i,isAirpodsList:!0})}):(0,b.jsx)("div",{className:en,children:(0,b.jsx)(zt.m,{})})]})})},pn=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(E),i=t[h.IncompatibleHeadphones],{handleClick:a}=Ti((()=>e(i.continue))),{toPreviousView:s}=(0,n.useContext)(E);return(0,b.jsx)(y,{onBack:()=>{s()},titleSlot:(0,b.jsx)(ji,{variant:"bodySmallBold"}),children:(0,b.jsx)(fi,{onboardingContent:{bodyTitle:(0,Ut.v)("These headphones are not compatible with Optimize yet."),bodySubtitle:(0,Ut.v)("Optimize"),bodyText:(0,Ut.v)("Only some devices work with Optimize. We're expanding our compatible devices to support a wider range of headphones."),imageUrl:"spotify:image:ab671fcc000092562c122d1cc442ac4f3c8dbab4",subtitleIcon:Ni.C,buttonText:(0,Ut.v)("Close")},onNext:a})})},mn=()=>{const{toPreviousView:e,viewOptions:t}=(0,n.useContext)(E),{data:i}=un(),{triggerDialog:a,dialog:s}=Mi();return(0,b.jsxs)(y,{onBack:()=>{t?.showDialogOnBack?a():e()},titleSlot:(0,b.jsx)(ji,{variant:"bodySmallBold"}),children:[s,(0,b.jsxs)(qi.s,{uri:"spotify:internal:bettersound",children:[(0,b.jsxs)("div",{className:Zi,children:[(0,b.jsx)("div",{className:Wi}),(0,b.jsxs)("div",{className:Ji,children:[(0,b.jsx)(c.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:O.Ru.get("web-player.puffin.manual-selection.title")}),(0,b.jsx)(c.E,{variant:"bodySmall",children:O.Ru.get("web-player.puffin.manual-selection.subtitle")})]}),(0,b.jsx)(Vi.S,{placeholder:O.Ru.get("web-player.puffin.manual-selection.search-placeholder"),alwaysExpanded:!0,fullWidth:!0,debounceFilterChangeTimeout:0})]}),i?(0,b.jsx)("div",{className:Ki,children:(0,b.jsx)(ln,{devices:i})}):(0,b.jsx)("div",{className:en,children:(0,b.jsx)(zt.m,{})})]})]})};var gn=i(48383),vn=i(91563);const xn=()=>{const{currentView:e}=(0,n.useContext)(E);switch(e){case h.ActivationIntro:return(0,b.jsx)(Hi,{type:"intro"});case h.ActivationDetection:return(0,b.jsx)(Hi,{type:"detection"});case h.ActivationSignifiers:return(0,b.jsx)(Hi,{type:"signifiers"});case h.Error:return(0,b.jsx)(A,{});case h.ManualSelection:return(0,b.jsx)(mn,{});case h.AirpodsSelection:return(0,b.jsx)(dn,{});case h.Overview:return(0,b.jsx)(Pe,{});case h.AudioQualitySettings:return(0,b.jsx)(Bt,{});case h.AudioQualityDetails:return(0,b.jsx)(Nt,{});case h.DiscoverLossless:return(0,b.jsx)(Ci,{});case h.IncompatibleHeadphones:return(0,b.jsx)(pn,{});default:return(0,vn.k)(e),null}},bn=()=>{const{currentView:e}=(0,n.useContext)(E),t=(0,j._Y)(),i=(0,j.XB)(),a=[m.Z.Puffin,m.Z.PuffinActivation,m.Z.PuffinOverlay,m.Z.PuffinActivationOverlay].some((e=>e===i)),s=[h.ActivationIntro,h.ActivationDetection,h.ActivationSignifiers,h.DiscoverLossless,h.ManualSelection,h.AirpodsSelection,h.IncompatibleHeadphones].includes(e),r=[h.ActivationIntro,h.ActivationDetection,h.ActivationSignifiers,h.ManualSelection,h.IncompatibleHeadphones].includes(e);(0,n.useEffect)((()=>{a&&t(r?J.$S.PUFFIN_START_ACTIVATION:J.$S.PUFFIN_FINISH_ACTIVATION)}),[t,r,a]);const o=(0,n.useRef)(null),{breakpoint:c}=(0,gn.c)({[mi.E.SMALL]:0,[mi.E.MEDIUM]:448,[mi.E.LARGE]:780},o);return(0,b.jsx)(Me.w,{className:l()({[x]:s}),ref:o,children:(0,b.jsx)(yi.o.Provider,{value:c,children:(0,b.jsxs)("div",{className:g,children:[(0,b.jsx)(xn,{}),false]})})})},yn=()=>(0,b.jsx)(Ue._,{label:"Puffin",focusTransferId:"PUFFIN",children:(0,b.jsx)(r.s,{Fallback:L,children:(0,b.jsx)(R,{children:(0,b.jsx)(bn,{})})})});var hn=i(5305),fn=i(63370);function jn(e){return e.sort(((e,t)=>t.timestamp-e.timestamp))}function Sn(e,t){return t.some((t=>t.user.uri===e.user.uri))?t:jn([...t,e])}function Cn(e,t){return t.filter((t=>t.user.uri!==e))}var wn=i(12599);var Nn=i(99404),En=i(43130);function Rn(){const e=(0,fn.C)(),t=(0,hn.jE)(),i=["friend-activity"],a=e=>{t.setQueryData(i,((t=[])=>{const i=Array.isArray(e)?e.at(0):e;return i?function(e,t){return jn(t.map((t=>t.user.uri===e.user.uri?e:t)))}(i,t):t}))},{subscribeToFriend:s,unSubscribeFromFriend:r,subscribeAndFetchFeed:o}=function(e){const t=(0,fn.C)(),i=(0,n.useRef)({}),a=(0,n.useRef)(e);a.current=e;const s=(0,n.useCallback)((e=>{const n=(0,wn.o_h)(e)?.username,s=t.subscribeToBuddyActivity(n,(e=>{e&&a.current(e)}));return i.current[e]=s,s}),[t]),r=(0,n.useCallback)((e=>{i.current[e]?.cancel(),delete i.current[e]}),[]),o=(0,n.useCallback)(((e,i,n)=>t.fetchFriendActivityWithSubscriptions(e,i,n)),[t]);return(0,n.useEffect)((()=>{const e=i.current;return()=>{Object.values(e).forEach((e=>{e.cancel()}))}}),[t]),{subscribeToFriend:s,unSubscribeFromFriend:r,subscribeAndFetchFeed:o}}(a),l=(0,n.useRef)();(0,n.useEffect)((()=>()=>l.current?.cancel()),[]);const c=(0,cn.I)({queryKey:i,queryFn:()=>new Promise(((e,t)=>{l.current=o(a,e,t)})).then((e=>jn(e))),staleTime:6e5,gcTime:36e5,refetchInterval:864e5,refetchOnWindowFocus:!1,refetchOnMount:"always",refetchOnReconnect:!0});return(0,En.N)(Nn.mc.OPERATION_COMPLETE,(async n=>{const a=n.data.uris;if(n.data.operation!==Nn.JK.FOLLOW_USER){if(n.data.operation===Nn.JK.UNFOLLOW_USER)for(const e of a)r(e),t.setQueryData(i,((t=[])=>Cn(e,t)))}else for(const n of a){const a=(await e.fetchFriendActivity([n])).at(0);a&&(t.setQueryData(i,((e=[])=>Sn(a,e))),s(n))}})),c}const In=(0,n.lazy)((()=>i.e(7564).then(i.bind(i,79702))));function kn(){const{data:e,error:t,isLoading:i}=Rn();return!(0,vt.n)()||i||t?null:(0,b.jsx)(In,{friends:e??[]})}var An=i(88025),Ln=i(27733);const Tn="device-picker-section-heading",Dn="device-picker-troubleshooting-list";var On=i(81481);const _n="uqXaqvqZq1oSLhXLYRo9",Bn="YuPZ1nUe5BAH7HJworb6",Fn="wWalUsrOkGgHa0u8o86Q",Pn="yNttGX9uUxTih93MKEWB",Un="kD25df_SN_uDB8lhZgQB",Mn="szp7gPJjKd4T69SzCEpF",Hn="E912cqRfb05FrRPFKDZ_",Vn="D7sZlTAybIM02cRvh4sV",qn="xdAVCtEIoo_8z_Ubj7tU",Yn=({foundDevices:e})=>{const t=(0,s.NC)(On.Q5);let i;return i=e?t?(0,Ut.v)("Speakers & Jams"):O.Ru.get("web-player.connect.device-picker.select-another-device"):O.Ru.get("web-player.connect.device-picker.no-devices-found"),(0,b.jsx)("span",{className:Pn,id:Tn,"data-testid":Tn,children:(0,b.jsx)(c.E,{as:"h2",variant:"bodyMediumBold",semanticColor:"textBase",children:i})})};var zn=i(11185),Gn=i(96381),Qn=i(40638),Kn=i(80577),Zn=i(44831),Wn=i(83155),Jn=i(43294),Xn=i(58325),$n=i(3880),ea=i(52110),ta=i(61173),ia=i(62665),na=i(1854),aa=i(80090),sa=i(87098),ra=i(31592),oa=i(89090),la=i(46822);var ca=i(65927);const ua="mFr6W9mwg0p_c7eJlhc_",da="lpPBKkIGJcyWu59iOpsS",pa=({deviceId:e,connectStateDeviceId:t,allowForgetDevice:i,incarnation:n})=>{const a=(0,la.N)(oa.r),s=(0,ie.s)(),{spec:r}=(0,_e.r)(na.d,{}),o=(0,ca.t)(r),l=r.forgetDeviceButtonFactory(),c=(0,ca.t)(l),u=r.deviceIncarnationContainerFactory(),d=(0,ca.t)(u);return i||n?(0,b.jsx)("span",{ref:o,className:da,children:(0,b.jsxs)(aa.W,{children:[i&&(0,b.jsx)(ra.D,{role:"menuitem",leadingIcon:(0,b.jsx)(ia.V,{size:"small"}),onClick:()=>{s.logInteraction(l.hitLogoutFromRemoteDevice({remoteDeviceId:t})),a.logout(e)},elementRef:c,children:O.Ru.get("web-player.connect.context-menu.log-out-of-device")}),n&&(0,b.jsxs)("div",{ref:d,children:[(0,b.jsx)(sa.y,{children:O.Ru.get("web-player.connect.context-menu.incarnation-title")}),n.available.map((i=>{const{icon:r,text:o}=(e=>{switch(e){case"connect":return{icon:(0,b.jsx)(Zn.E,{size:"small"}),text:O.Ru.get("web-player.connect.context-menu.incarnation-connect")};case"cast":return{icon:(0,b.jsx)(ta.m,{size:"small"}),text:O.Ru.get("web-player.connect.context-menu.incarnation-cast")};default:return{}}})(i);return(0,b.jsx)(ra.D,{role:"menuitemradio",leadingIcon:r,onClick:()=>{let r;switch(i){case"cast":r=u.googleCastButtonFactory();break;case"connect":r=u.spotifyConnectButtonFactory()}n.preferred!==i?(r&&s.logInteraction(r.hitChangeRemoteDeviceIncarnation({remoteDeviceId:t})),a.setPreferredIncarnation(e,i)):r&&s.logInteraction(r.hitNoAction())},"aria-checked":n.preferred===i,CheckedIcon:Et.i,children:o},i)}))]})]})}):null};var ma=i(92375);const ga=({title:e,deviceId:t,connectStateDeviceId:i,allowForgetDevice:a,incarnation:s,className:r,onHide:o,onShow:c,spec:u})=>{const[d,p]=(0,n.useState)(!1),m=u.contextMenuButtonFactory({identifier:i}),g=(0,ie.s)(),v=(0,ca.t)(m);return(0,b.jsx)(ea.b,{renderInline:!0,menu:(0,b.jsx)(ma.r,{spec:m,children:(0,b.jsx)(pa,{deviceId:t,connectStateDeviceId:i,allowForgetDevice:a,incarnation:s})}),onShow:()=>{p(!0),c?.()},onHide:()=>{p(!1),o?.()},offset:[0,-8],children:(0,b.jsx)($n.e,{ref:v,size:$n.M.xs,label:O.Ru.get("more.label.context",e),className:l()(ua,r),onClick:e=>{e.stopPropagation(),g.logInteraction(d?m.hitUiHide():m.hitUiReveal())}})})},va=(0,n.createContext)({rowWithMenuOpenIdentifier:null,setRowWithMenuOpenIdentifier:()=>{}}),xa=({children:e})=>{const[t,i]=(0,n.useState)(null),a=(0,n.useMemo)((()=>({rowWithMenuOpenIdentifier:t,setRowWithMenuOpenIdentifier:i})),[t]);return(0,b.jsx)(va.Provider,{value:a,children:e})},ba=e=>e instanceof zn.B.ContainerViewEventFactory.DeviceListEventFactory.RemoteDeviceEventFactory||e instanceof zn.B.ContainerViewEventFactory.DeviceListEventFactory.DisabledDeviceEventFactory||e instanceof zn.B.ContainerViewEventFactory.OffNetworkDeviceListEventFactory.RemoteDeviceEventFactory||e instanceof zn.B.ContainerViewEventFactory.OffNetworkDeviceListEventFactory.DisabledDeviceEventFactory||e instanceof zn.B.ContainerViewEventFactory.OnNetworkDeviceListEventFactory.RemoteDeviceEventFactory,ya=e=>e instanceof zn.B.ContainerViewEventFactory.DeviceListEventFactory.RemoteDeviceEventFactory;var ha=i(99659),fa=i(76851);const ja="AWblt0YATqa_XQaPUDMc",Sa="sX7AwqoSzMeT9qhlEViU",Ca="jIlVu16bmijzUKG6u5VW",wa="ZkuPLR9bss2N7f7thixx",Na="QSZFk1XCj76mVplNmiV1",Ea="O0wmxPM0kfA59paiHqR9",Ra=(0,n.forwardRef)((function({deviceId:e,connectStateDeviceId:t,Icon:i,TechIcon:a,title:s,subtitle:r,canLogout:o,isDisabled:c,incarnation:u,jamSession:d,onClick:p,spec:m},g){const v=(0,j._Y)(),x=(0,ha.HJ)(u),y=o||x,{rowWithMenuOpenIdentifier:h,setRowWithMenuOpenIdentifier:f}=(0,n.useContext)(va),S=(0,ca.t)(ya(m)&&d?.token?m.inPersonListeningSessionFactory({identifier:d.sessionId??d.token}):void 0,!!d?.token),C=(0,Qn.YQ)((()=>{p(),v(J.$S.PANEL_CLOSE_CLICK)}),1e3,{leading:!0,trailing:!1}),w=(0,n.useCallback)((e=>{"Enter"===e.key&&C()}),[C]),N=(0,b.jsx)(pa,{deviceId:e,connectStateDeviceId:t,allowForgetDevice:o,incarnation:x?u:void 0}),E=d?.participants.find((e=>e.id===d.sessionOwnerId))?.displayName,R=d?.jamType===fa.H.NEARBY_JAM?(0,b.jsx)(Kn.C,{"data-testid":"sub-nearby-jam-icon",semanticColor:"textBrightAccent",size:"small"}):(0,b.jsx)(Zn.E,{"data-testid":"sub-jam-icon",semanticColor:"textBrightAccent",size:"small"}),I=E&&!d.isSessionOwner?(0,b.jsxs)("div",{className:Sa,ref:S,children:[R,(0,b.jsx)(Wn.j,{semanticColor:"textBrightAccent",lineClamp:1,children:O.Ru.get("web-player.social-connect.broadcasting.bradcasting-device-subtitle",{host:E})})]}):(0,b.jsxs)("div",{className:Sa,children:[a&&(0,b.jsx)(a,{className:Ca,semanticColor:"textSubdued","data-testid":"sub-icon",role:"presentation",size:"small"}),r&&(0,b.jsx)(Wn.j,{semanticColor:"textSubdued",lineClamp:1,children:r})]});return(0,b.jsx)(Jn.h,{menu:N,children:(0,b.jsx)(Gi.c,{onKeyDown:w,onClick:C,className:l()(wa,{[Ea]:h===e}),children:(0,b.jsx)(q.v,{id:e,ref:g,"data-testid":"device-picker-row-sidepanel",media:(0,b.jsx)(i,{semanticColor:c?"textSubdued":"textBase","data-testid":"main-icon",role:"presentation"}),onClick:()=>{},onClickHint:O.Ru.get("web-player.connect.device-picker.connect-to-device"),title:(0,b.jsx)("span",{className:ja,children:(0,b.jsx)(Xn.Zp,{label:s,renderInline:!0,children:(0,b.jsx)(Ne.d,{"data-testid":"list-row-title",lineClamp:1,semanticColor:c?"textSubdued":"textBase",dir:"auto",children:s})})}),subtitle:I,trailing:y&&ba(m)&&(0,b.jsx)(ga,{title:s,deviceId:e,connectStateDeviceId:t,allowForgetDevice:o,incarnation:x?u:void 0,spec:m,className:l()(Na),onShow:()=>{f(e)},onHide:()=>{f(null)}})})})})})),Ia=({position:e,deviceId:t,connectStateDeviceId:i,deviceName:n,deviceType:a,deviceModelName:s,isGroup:r,disabledReason:o,canLogout:l,spec:c})=>{const u=(0,ha.tf)(a,r),{helpText:d}=(0,ha.uY)(o,(0,ha.p2)(a,s)),p=c.disabledDeviceFactory({identifier:i,position:e,reason:o??"null"}),m=(0,ca.t)(p),g=(0,D.wA)();return(0,b.jsx)(Ra,{deviceId:t,connectStateDeviceId:i,ref:m,isDisabled:!0,disabledReason:o,Icon:u,title:n,subtitle:d,canLogout:l,onClick:()=>{o===U.bU.RESTRICTED&&g((0,Gn.yx)(t))},spec:p})};var ka=i(3633);const Aa=({isDisabled:e=!1,spec:t})=>{const i=(0,D.wA)(),n=t.containerViewFactory().deviceListFactory().castPlaceholderFactory(),a=(0,ca.t)(n),s=(0,ha.$A)(U.bq.CAST_AUDIO,"disconnected"),r=(0,ie.s)();return(0,b.jsx)(Ra,{deviceId:"cast-placeholder",connectStateDeviceId:"cast-placeholder",ref:a,Icon:s,title:O.Ru.get("web-player.connect.device-picker.google-cast-devices"),supportsHiFi:!1,onClick:()=>{r.logInteraction(n.hitUiReveal()),i((0,ka.Ym)())},isDisabled:e,spec:n})};var La=i(60523);const Ta=({deviceId:e,connectStateDeviceId:t,deviceName:i,supportsHiFi:n,spec:a})=>{const s=(0,ie.s)(),r=a.localDeviceFactory(),o=(0,ha.tf)(U.bq.COMPUTER,!1),l=(0,La.D)();return(0,b.jsx)(Ra,{deviceId:e,connectStateDeviceId:t,Icon:o,title:i,supportsHiFi:n,onClick:()=>{const{interactionId:t,pageInstanceId:i}=s.logInteraction(r.hitPullPlaybackToLocalDevice());l.transferPlayback(e,{interactionId:t,pageInstanceId:i})},spec:r})},Da=()=>{const[e,t]=(0,fe.x)("connect-picker-recent-transfers",{});return{registerTransferAttempt:(0,n.useCallback)((i=>{t({...e,[i]:(new Date).getTime()})}),[e,t]),recentTransfersMap:e}};var Oa=i(91780),_a=i(62145),Ba=i(83441),Fa=i(43122),Pa=i(91773),Ua=i(17354);const Ma=({position:e,deviceId:t,connectStateDeviceId:i,deviceName:n,deviceType:a,isGroup:r,supportsHiFi:o,canLogout:l,incarnation:c,jamSession:u,spec:d})=>{const p=(0,ie.s)(),m=d.remoteDeviceFactory({identifier:i,position:e}),g=(0,ha.tf)(a,r);let v,x;(0,ha.Mp)(a)&&(v=(0,ha.$A)(a,"disconnected"),x=O.Ru.get("web-player.connect.device-picker.google-cast"));const y=(0,D.wA)(),{registerTransferAttempt:h}=Da(),f=(0,La.D)(),j=(0,ca.t)(m),S=(0,s.NC)(On.Yr),C=(0,_a.Ad)((e=>{const t=(0,Pa.d)(),i=(0,hn.jE)(),n=(0,s.NC)(On.PE,{loadingValue:!1}),{data:a}=(0,cn.I)({queryKey:["useResolveJamFromConnectDevice",e],queryFn:()=>t.getJoinTokenFromConnectDeviceId(e),enabled:n}),{data:r}=(0,cn.I)({queryKey:["useResolveJamFromConnectDevice",a],queryFn:a?()=>t.getSessionInfo(a):Ba.hT,enabled:!!a});return(0,Ua.c)(Fa.P.SCAN_UPDATE,(()=>{i.invalidateQueries({queryKey:["useResolveJamFromConnectDevice",e]})})),r??null})(i));let w;w=S?u??null:C;return(0,b.jsx)(Ra,{deviceId:t,connectStateDeviceId:i,ref:j,Icon:g,TechIcon:v,title:n,subtitle:x,supportsHiFi:o,canLogout:l,incarnation:c,jamSession:w,onClick:()=>{if(w?.token&&!w.isSessionOwner){ya(m)&&p.logInteraction(m.inPersonListeningSessionFactory({identifier:w.sessionId??w.token}).hitUiReveal());let e=Oa.EL.JOIN_LISTENING_SESSION;w.jamType===fa.H.NEARBY_JAM&&(e=Oa.EL.JOIN_NEARBY_JAM),y((0,Gn.A9)(e,w.token,void 0,{id:t,name:n,type:a,isGroup:r}))}else{const{interactionId:e,pageInstanceId:n}=p.logInteraction(m.hitConnectToRemoteDevice({remoteDeviceId:i}));f.transferPlayback(t,{interactionId:e,pageInstanceId:n}),h(i)}},spec:m})},Ha=()=>(0,xt.o)((e=>(e?.restrictions?.disallowTransferringPlaybackReasons?.length??0)>0));var Va=i(7938);const qa=({devices:e,areWebPlayerCastDevicesAvailable:t=!1,networkHeadingID:i="",spec:n})=>{const a=(0,s.NC)(On.Yr),r=(0,Va.Ek)(),o=Ha(),l=n.containerViewFactory().deviceListFactory(),c=(0,ca.t)(l),u=(e,t)=>{const i=r?O.Ru.get("web-player.connect.device-picker.this-computer"):O.Ru.get("web-player.connect.device-picker.this-web-browser");if(e.isDisabled)return(0,b.jsx)(Ia,{position:e.isLocal?0:t+1,deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:e.isLocal?i:e.name,deviceType:e.isLocal?U.bq.COMPUTER:e.type,deviceModelName:e.modelDisplayName,isGroup:e.isGroup,disabledReason:e.disabledReason,canLogout:!e.isLocalNetwork&&e.supportsLogout,spec:l},e.id);if(e.isLocal&&(e=>e instanceof zn.B.ContainerViewEventFactory.DeviceListEventFactory||e instanceof zn.B.ContainerViewEventFactory.OnNetworkDeviceListEventFactory)(l))return(0,b.jsx)(Ta,{deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:i,supportsHiFi:e.supportsHiFi,spec:l},e.id);let n=null;return a&&(0,_a.HV)(e)?n=e.nearbyJamSession:(0,_a.C7)(e)&&(n=e.jamSession),(0,b.jsx)(Ma,{position:t+1,deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:e.name,deviceType:e.type,isGroup:e.isGroup,supportsHiFi:e.supportsHiFi,canLogout:!e.isLocalNetwork&&e.supportsLogout,incarnation:e.incarnation,jamSession:n,spec:l},e.id)};return(0,b.jsxs)(Yi.$,{circular:!1,ref:c,"aria-labelledby":`${Tn} ${i}`,"data-testid":`devices-list-${i}`,allowsMultipleInteractiveChildrenInItem:!0,children:[e.map(((e,t)=>u(e,t))),t&&(0,b.jsx)(Aa,{isDisabled:o,spec:n})]})},Ya="local-network-heading",za="other-networks-heading",Ga=({localNetworkDevices:e,otherNetworksDevices:t,spec:i})=>{const n=(0,s.NC)(On.Q5),a=e.length>0?O.Ru.get("web-player.connect.device-picker.on-this-network"):O.Ru.get("web-player.connect.device-picker.no-devices-local-network"),r=!n||n&&e.length<=0;return(0,b.jsxs)(b.Fragment,{children:[r&&(0,b.jsx)(c.E,{as:"h3",variant:n?"bodyMedium":"bodySmall",semanticColor:"textSubdued",className:Un,id:Ya,children:a}),e.length>0&&(0,b.jsx)(qa,{devices:e,networkHeadingID:Ya,spec:i}),t.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(c.E,{as:"h3",variant:n?"bodyMedium":"bodySmall",semanticColor:"textSubdued",className:l()(Un,Mn),id:za,children:O.Ru.get("web-player.connect.device-picker.on-other-networks")}),(0,b.jsx)(qa,{devices:t,networkHeadingID:za,spec:i})]})]})};var Qa=i(67326);const Ka=({url:e,linkText:t,handleClick:i,elementRef:n})=>(0,b.jsx)("a",{className:l()(wa),href:e,target:"_blank",ref:n,onClick:i,children:(0,b.jsx)(q.v,{title:t,id:t,isRedundantOnClick:!0,onClick:()=>{},"data-testid":"list-row-external-link",trailing:(0,b.jsx)(Qa.H,{size:"small","data-testid":"icon-external-link",semanticColor:"textSubdued",role:"presentation",autoMirror:!0,"aria-hidden":"true"})})}),Za=({spec:e})=>{const t=`https://www.spotify.com/connect${`?utm_campaign=connect&utm_medium=${(0,Va.Ek)()?"app":"web"}&utm_source=desktop`}`,i=e.containerViewFactory().externalConnectHubLinkFactory(),n=(0,ca.t)(i),a=(0,ie.s)();return(0,b.jsx)(Ka,{url:t,linkText:O.Ru.get("web-player.connect.device-picker.connect-hub-external-link"),elementRef:n,handleClick:()=>{a.logInteraction(i.hitNavigateToExternalUri({destination:t}))}})},Wa="https://support.spotify.com/article/spotify-connect/",Ja=({spec:e})=>{const t=e.containerViewFactory().externalHelpLinkFactory(),i=(0,ca.t)(t),n=(0,ie.s)();return(0,b.jsx)(Ka,{url:Wa,linkText:O.Ru.get("web-player.connect.device-picker.help-external-link"),elementRef:i,handleClick:()=>{n.logInteraction(t.hitNavigateToExternalUri({destination:Wa}))}})};var Xa=i(55114);const $a=[Xa.h.en,Xa.h.enGB],es=()=>{const e=O.Ru.getLocaleForTranslation();return $a.includes(e)};const ts=({devices:e,areWebPlayerCastDevicesAvailable:t})=>{const i=(0,Va.Ek)(),n=Ha(),a=es(),s=!i&&n?e.map((e=>({...e,isDisabled:!0}))):e,{recentTransfersMap:r}=Da(),o=function(e,t){const i=[],n=e.find((e=>e.isLocal));n&&i.push(n);const a=e.filter((e=>!e.isLocal)),{usedDevices:s,unusedDevices:r}=function(e,t){const i=[],n=[];for(const a of e)t[a.sortingId]?i.push({device:a,timestamp:t[a.sortingId]}):n.push(a);return{usedDevices:i,unusedDevices:n}}(a,t);s.sort(((e,t)=>t.timestamp-e.timestamp));for(const e of s)i.push(e.device);const o=i.concat(function(e){return e.sort(((e,t)=>e.isLocal?-1:t.isLocal?1:e.name.toLowerCase().localeCompare(t.name.toLowerCase())))}(r));return o}(s,r),{spec:c}=(0,_e.r)(zn.p,{}),u=o.filter((e=>e.isLocalNetwork)),d=o.filter((e=>!e.isLocalNetwork));return(0,b.jsxs)("div",{className:l()(_n,Bn),children:[(0,b.jsx)("div",{children:i&&d.length>0?(0,b.jsx)(Ga,{localNetworkDevices:u,otherNetworksDevices:d,spec:c}):(0,b.jsx)(qa,{devices:o,areWebPlayerCastDevicesAvailable:t,spec:c})}),(0,b.jsxs)("div",{className:l()(Hn),children:[(0,b.jsx)(Ja,{spec:c}),a&&(0,b.jsx)(Za,{spec:c})]})]})};var is=i(34848),ns=i(10164),as=i(40479);const ss=(0,n.forwardRef)((function({Icon:e,title:t,subtitle:i},n){return(0,b.jsx)(Gi.c,{className:wa,children:(0,b.jsx)(q.v,{id:t,ref:n,"data-testid":"device-picker-row-sidepanel",media:(0,b.jsx)(e,{semanticColor:"textSubdued"}),title:(0,b.jsx)("span",{className:ja,children:(0,b.jsx)(Xn.Zp,{label:t,renderInline:!0,children:(0,b.jsx)(Ne.d,{"data-testid":"list-row-title",lineClamp:1,semanticColor:"textBase",dir:"auto",children:t})})}),subtitle:(0,b.jsx)("div",{className:Sa,children:(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:i})})})})}));var rs=i(86695);const os="Bjx5Gw7p3JoiF4qI6eMQ",ls=()=>{const{deviceFilterState:e,isMaybeHeadphoneDevice:t}=(0,$.j)(),i=(0,ae.j)(),n=(0,Oe.v)(),a=(0,Se.A)(),s=e.currentState.externalizationEnabled||e.currentState.specificEnabled,r=a===ge.Yn.LOSSLESS||a===ge.Yn.LOSSLESS_24;return(0,b.jsxs)("div",{className:os,children:[n&&s&&t&&(0,b.jsx)(Ni.C,{size:"small",semanticColor:"textBrightAccent"}),(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBrightAccent",children:i&&r&&"Lossless"})]})},cs="A3PPnVKE5LH9mT5URPB2",us="cU0IpwDfJzDgQaY4MSXA",ds="dlS4nc0WL68C7_8zwfiS",ps="pdLJBD_CNQ_r5Ad4mZZk",ms="FpmhhFL8lCsiyh3X0fjK",gs="scv87ulfUcibJW8QhCeH",vs="oCa5Np4laJc3s5P2uUqw",xs=({onClick:e})=>{const{deviceName:t,formattedDeviceName:i}=H();return(0,b.jsx)("div",{className:vs,children:(0,b.jsx)(Xn.Zp,{label:i??t,children:(0,b.jsx)(Wn.j,{lineClamp:1,onClick:e,children:(0,b.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:i??t})})})})};var bs=i(74205),ys=i(65956);const hs=({size:e="medium",className:t})=>{const i=(0,hi.j)(),n=(0,ys.k)(e);return(0,b.jsx)(b.Fragment,{children:i?(0,b.jsx)(bs.A,{size:e,semanticColor:"textBrightAccent",className:t,"data-testid":"now-playing-active"}):(0,b.jsx)("img",{className:t,width:n,height:n,alt:"","aria-hidden":"true",src:(0,Ei.b)("images/device-picker-equaliser-animation.webp"),"data-testid":"animated-now-playing"})})};var fs=i(73001);const js=({deviceType:e,isGroup:t,isLocalDevice:i,isPlaying:n})=>{const a=(0,fs.g)();let s;if(n)s=(0,b.jsx)(hs,{});else{const n=(0,ha.tf)(e,t,i?a:null);s=(0,b.jsx)(n,{semanticColor:"textBrightAccent","data-testid":"device-icon",role:"presentation"})}return(0,b.jsxs)("div",{className:ps,children:[(0,b.jsx)("div",{className:ms,children:s}),(0,b.jsx)(Ne.d,{variant:"titleSmall",semanticColor:"textBase",lineClamp:1,children:O.Ru.get("web-player.connect.device-picker.current-device")})]})};var Ss=i(59993),Cs=i(59244),ws=i(54642),Ns=i(43601);const Es=()=>{const{currentDevice:e}=(0,Ns.l)(),{id:t,connectStateId:i,isLocalNetwork:n,supportsLogout:a}=e,r=(0,ws.W)(),o=!n&&a,l=o,{spec:c}=(0,_e.r)(zn.p,{}),u=(0,s.NC)(On.Q5),d=(0,Oe.v)(),p=(0,ae.j)(),{deviceName:m,formattedDeviceName:g}=H(),v=r?Ss.g:zi.V,x=u?Cs.x:v,y=u?"textSubdued":"textBase";return(0,b.jsx)("div",{className:gs,children:d||p?(0,b.jsx)(x,{"aria-label":O.Ru.get("more.label.context",g??m),size:"small",autoMirror:!1,semanticColor:y}):l&&(0,b.jsx)(ga,{title:g??m,deviceId:t,connectStateDeviceId:i,allowForgetDevice:o,spec:c.containerViewFactory().headerFactory().activeDeviceFactory()})})};var Rs=i(14221),Is=i(21527),ks=i(93301),As=i(99993);const Ls=()=>{const e=(0,Pa.d)(),{enqueueSnackbar:t}=(0,ks.d)(),{spec:i,logger:a}=(0,_e.r)(rs.g,{}),[s,r]=(0,n.useState)(As.ez.BROADCAST_STATUS_UNKNOWN),o=s===As.ez.BROADCAST_STATUS_UNKNOWN||s===As.ez.BROADCAST_UNAVAILABLE,l=s===As.ez.BROADCAST_ON;(0,Ua.c)(Fa.P.BROADCAST_STATUS_UPDATE,(({data:e})=>{r(e??As.ez.BROADCAST_STATUS_UNKNOWN)}));const c=(0,n.useCallback)((t=>e.setBroadcastStatus(t?As.ez.BROADCAST_ON:As.ez.BROADCAST_OFF)),[e]),u=(0,Is.n)({mutationFn:c,onMutate:async e=>{const t=s;return r(e?As.ez.BROADCAST_ON:As.ez.BROADCAST_OFF),{prevBroadcastingState:t,allowBroadcasting:e}},onError:(e,i,n)=>{r(n?.prevBroadcastingState??As.ez.BROADCAST_STATUS_UNKNOWN),t(O.Ru.get("error.generic"))}});return{isHidden:o,toggleIsSwitchedOn:l,setToggleState:(0,n.useCallback)((e=>{const t=e?"device_discoverable_off":"device_discoverable_on",n=e?"device_discoverable_on":"device_discoverable_off";a.logInteraction(i.deviceDiscoverableToggleFactory().hitToggleState({stateBeforeToggle:t,stateAfterToggle:n})),u.mutate(e)}),[a,u,i])}},Ts="k5CAXCZwazRLdTWi5mpN",Ds="f2Wgf5OqTaBlTRRKZe9X",Os=()=>{const{isHidden:e,toggleIsSwitchedOn:t,setToggleState:i}=Ls();return e?null:(0,b.jsxs)("div",{className:Ts,children:[(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",as:"label",htmlFor:"jam.broadcasting",className:Ds,children:O.Ru.get("web-player.social-connect.broadcasting.toggle-label")}),(0,b.jsx)(Ee.l,{id:"jam.broadcasting",value:t,onSelected:i,condensed:!0})]})};var _s=i(83656),Bs=i(77112),Fs=i(76428),Ps=i(3784),Us=i(42005);const Ms="device-picker-header",Hs=({isPlaying:e})=>{const{currentDevice:t}=(0,Ns.l)(),{id:i,connectStateId:a,type:r,isLocal:o,isLocalNetwork:c,isGroup:u,incarnation:d,supportsLogout:p}=t,m=(0,Oe.v)(),g=(0,ae.j)(),{togglePuffin:v}=(0,Rs.c)(),{currentSession:x}=(0,Us.D)(),y=(0,Fs.y)(),h=(0,s.NC)(On.PE),f=Boolean(x?.active),j=!f&&y,S=(0,ha.HJ)(d),C=!c&&p,w=C||S,{spec:N,logger:E}=(0,_e.r)(rs.g,{}),{uri:R}=(0,Ps.f)(),I=(0,n.useCallback)((()=>{E.logInteraction(N.createJamButtonFactory().hitUiNavigate({destination:R??""}))}),[E,N,R]),k=(0,b.jsx)(pa,{deviceId:i,connectStateDeviceId:a,allowForgetDevice:C,incarnation:S?d:void 0}),A=m||g,L=(0,b.jsx)(q.v,{className:l()(us,{[ds]:A}),id:Ms,variant:"naked",title:(0,b.jsx)(js,{deviceType:r,isGroup:u,isLocalDevice:o,isPlaying:e}),subtitle:(0,b.jsxs)("div",{className:vs,children:[(0,b.jsx)(xs,{onClick:A?v:void 0}),A&&(0,b.jsx)(ls,{})]}),trailing:(0,b.jsx)(Es,{}),"aria-labelledby":Ms,onClick:A?v:void 0,onClickHint:O.Ru.get("web-player.connect.device-picker.current-device"),body:y&&(0,b.jsxs)(b.Fragment,{children:[h&&(0,b.jsx)(Os,{}),(0,b.jsx)("hr",{className:cs})]}),footer:(0,b.jsxs)(b.Fragment,{children:[j&&(0,b.jsx)(Bs.$,{onClick:I}),f&&h&&(0,b.jsx)(_s.K,{})]})});return w?(0,b.jsx)(Jn.h,{menu:k,children:L}):L},Vs=({isDesktop:e})=>{const t=es(),{spec:i}=(0,_e.r)(zn.p,{}),n=i.containerViewFactory().noDevicesViewFactory(),a=(0,ca.t)(n);return(0,b.jsxs)("div",{ref:a,className:l()(Vn,Bn,_n),"data-testid":Dn,children:[(0,b.jsxs)("ul",{"aria-labelledby":`${Ms} ${Tn}`,className:qn,children:[(0,b.jsx)(ss,{Icon:is.T,title:O.Ru.get("web-player.connect.device-picker.check-wifi"),subtitle:O.Ru.get("web-player.connect.device-picker.check-wifi-subtitle")}),(0,b.jsx)(ss,{Icon:ft.g,title:O.Ru.get("web-player.connect.device-picker.play-from-another"),subtitle:O.Ru.get("web-player.connect.device-picker.play-from-another-subtitle")}),e?(0,b.jsx)(ss,{Icon:ns.H,title:O.Ru.get("web-player.connect.device-picker.restart-speaker"),subtitle:O.Ru.get("web-player.connect.device-picker.restart-speaker-subtitle")}):(0,b.jsx)(ss,{Icon:as.i,title:O.Ru.get("web-player.connect.device-picker.switch-to-app"),subtitle:O.Ru.get("web-player.connect.device-picker.switch-to-app-subtitle")})]}),(0,b.jsxs)("div",{"aria-describedby":Dn,children:[(0,b.jsx)(Ja,{spec:i}),t&&(0,b.jsx)(Za,{spec:i})]})]})},qs=({devices:e,areWebPlayerCastDevicesAvailable:t})=>{const i=Boolean(e.find((e=>!e.isLocal))),n=e.filter((e=>!e.isActive&&e.name.length>0)),a=i||t,s=(0,Va.Ek)();return(0,b.jsxs)("div",{className:l()(Fn,Bn),children:[(0,b.jsx)(Yn,{foundDevices:a}),a?(0,b.jsx)(xa,{children:(0,b.jsx)(ts,{devices:n,areWebPlayerCastDevicesAvailable:t})}):(0,b.jsx)(Vs,{isDesktop:s})]})};var Ys=i(71892),zs=i(54799);const Gs="cuG1_yCuW2Mnw3H6IUYD",Qs=()=>{const{currentDevice:e}=(0,Ns.l)(),{type:t,isLocal:i,isGroup:n}=e,{isPlaying:a}=(0,zs.GK)(),s=(0,fs.g)(),r=(0,Oe.v)(),o=(0,ae.j)(),{togglePuffin:l}=(0,Rs.c)(),{deviceName:c,formattedDeviceName:u}=H(),d=r||o;let p;if(a)p=(0,b.jsx)(hs,{});else{const e=(0,Ys.tf)(t,n,i?s:null);p=(0,b.jsx)(e,{semanticColor:"textBrightAccent","data-testid":"device-icon",role:"presentation"})}return(0,b.jsx)(q.v,{id:"device-picker-header",variant:"naked",size:"md",className:Gs,title:u??c,"data-testid":"device-picker-row-sidepanel",media:p,onClick:d?l:void 0,trailing:(0,b.jsx)(Es,{})})},Ks="G6For7gcz2GTgCkOeJKc",Zs=()=>{const{isHidden:e,toggleIsSwitchedOn:t,setToggleState:i}=Ls();return e?null:(0,b.jsxs)("div",{className:Ks,children:[(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBase",as:"label",htmlFor:"jam.broadcasting",children:O.Ru.get("web-player.connect.device-picker.auto-invite-jam-toggle")}),(0,b.jsx)(Ee.l,{id:"jam.broadcasting",value:t,onSelected:i,condensed:!0})]})};var Ws=i(77312);const Js="fkBkl4cpmR6fFGNpsPZx",Xs=({openQueue:e})=>{const t=(0,Us.D)();return(0,b.jsxs)("div",{className:Js,children:[(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",as:"label",htmlFor:"jam.broadcasting",children:O.Ru.get("web-player.connect.device-picker.start-jam-description")}),(0,b.jsx)(re.n,{onClick:()=>{t.createSession(),e()},iconLeading:Ws.V,size:"small",children:O.Ru.get("web-player.connect.device-picker.start-jam")})]})};var $s=i(21712);const er="rk32VTG0b6NU0RicbiOH",tr=()=>{const e=(0,Us.D)(),{openQueue:t}=(0,$s.R)(),i=e.currentSession?.active?(0,b.jsx)(_s.K,{}):(0,b.jsx)(Xs,{openQueue:t});return(0,b.jsxs)("div",{className:l()(er),children:[(0,b.jsx)(Qs,{}),(0,b.jsx)(Zs,{}),i]})};var ir=i(76151);const nr="Y5BWxTfO9OmenxMup_H7",ar="s0kxKAi2bTiuoEJhkYph",sr="Cdlb8uLk1VIkwKmGBViF",rr=({Icon:e,title:t,subtitle:i,buttonText:n,onClick:a,onDismiss:s})=>{const r=(0,b.jsxs)("div",{className:sr,children:[e&&(0,b.jsx)(e,{semanticColor:"textSubdued",size:"small"}),(0,b.jsx)(c.E,{variant:"bodyMediumBold",color:"baseText",children:t})]});return(0,b.jsx)(q.v,{id:"messageBox",variant:"elevated",size:"lg",className:nr,title:r,subtitle:i,paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,b.jsx)(re.n,{size:"small",onClick:a,children:n}),trailing:(0,b.jsx)(oe.H,{className:ar,semanticColor:"textBase",iconOnly:ir.M,size:"small",onClick:s,condensedAll:!0,"aria-label":O.Ru.get("close")})})},or=e=>{if("object"==typeof e&&"custom"in e)return e.custom;switch(e){case"required":return 1e3;case"high":return 500;case"normal":return 300;case"low":return 100;default:return 0}},lr=()=>{const{deviceFilterState:e}=(0,$.j)(),t=(0,n.useMemo)((()=>e.audioDevice?.id),[e.audioDevice?.id]),[i,a]=(0,fe.x)("onboarding-dismissed:puffin",{}),s=(0,n.useCallback)((()=>{t&&a({...i,[t]:(i[t]??0)+1})}),[t,i,a]);return{isDeviceDismissed:(0,n.useMemo)((()=>!!t&&i[t]>=3),[t,i]),incrementDismissCountForDevice:s}},cr=()=>[(()=>{const e=(0,j._Y)(),{incrementDismissCountForDevice:t,isDeviceDismissed:i}=lr(),{deviceFilterState:n,isMaybeHeadphoneDevice:a}=(0,$.j)(),s=n.isOnboarded,r=a&&!s&&!i;return{id:"puffinDevicePickerUpsell",title:O.Ru.get("web-player.puffin.get-started.title"),subtitle:O.Ru.get("web-player.puffin.get-started.subtitle"),buttonText:O.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm"),onClick:()=>{e(J.$S.PUFFIN_START_ACTIVATION)},onDismiss:()=>{t()},shouldShow:r,priority:"normal"}})()],ur=e=>{const t=e.filter((e=>e.shouldShow)).sort(((e,t)=>{return i=e.priority,n=t.priority,or(i)<or(n)?1:-1;var i,n}));return t[0]?t[0]:null},dr=()=>{const e=cr(),t=ur(e);return null===t?null:(0,b.jsx)(rr,{...t})};var pr=i(23542);const mr="hmVfxvHNFzG0vUNl80tU",gr="TuVVAkUzyLv_yCLzKTqW",vr=()=>{const[e,t]=(0,n.useState)(!0),{deviceFilterState:i,isMaybeHeadphoneDevice:a}=(0,$.j)(),s=i.isOnboarded,{incrementDismissCountForDevice:r,isDeviceDismissed:o}=lr(),l=(0,n.useMemo)((()=>a&&!s&&!o),[o,a,s]),c=(0,j._Y)(),u=(0,n.useCallback)((()=>c(J.$S.PUFFIN_START_ACTIVATION)),[c]),d=(0,n.useCallback)((()=>{r(),t(!1)}),[r]);return l&&e?(0,b.jsx)(q.v,{id:"puffinDevicePickerUpsell",variant:"tinted",size:"lg",className:mr,title:O.Ru.get("web-player.puffin.get-started.title"),subtitle:O.Ru.get("web-player.puffin.get-started.subtitle"),paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,b.jsx)(re.n,{size:"small",onClick:u,children:O.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm")}),trailing:(0,b.jsx)(oe.H,{className:gr,semanticColor:"textSubdued",iconOnly:ir.M,size:"small",onClick:d,condensedAll:!0,"aria-label":O.Ru.get("close")})}):null};var xr=i(38993),br=i(16350),yr=i(3599);function hr(){return(0,la.N)(yr.v)}const fr=()=>{const e=hr(),{devices:t,currentDevice:i}=(0,Ns.l)(),a=(()=>{const e=hr(),[t,i]=(0,n.useState)([]),a=(0,n.useCallback)((()=>{e.getJamDevices().then((e=>i(e)))}),[e]);return(0,Ua.c)(Fa.P.SCAN_UPDATE,(()=>a())),(0,n.useEffect)((()=>a()),[a]),t})(),[s,r]=(0,n.useState)(t.map((e=>(0,_a.gS)(e)))),o=(0,Qn.dh)((()=>{const n=e.combineJamsWithEntities(t,a,i.connectStateId);r(n)}),100,{leading:!1,trailing:!0});return(0,n.useEffect)((()=>o()),[t,a,i,o]),s},jr="h0XG5HZ9x0lYV7JNwhoA",Sr="JHlPg4iOkqbXmXjXwVdo",Cr=()=>{const e=(0,br.O)(),t=(0,Oe.v)(),i=(0,F.l)(),a=(0,pr.C)(),r=(0,s.NC)(On.Yr),o=(0,s.NC)(On.Q5),{devices:c}=(0,Ns.l)(),u=fr(),{isPlaying:d}=(0,zs.GK)(),[g]=(0,j.sV)(),v=(0,n.useRef)(a),x=(0,n.useRef)(g.context.devicePicker?.interactionId);v.current=a,x.current=g.context.devicePicker?.interactionId;const y=(0,D.d4)((e=>e.playback?.castState??window.cast?.framework.CastState.NO_DEVICES_AVAILABLE)),h=(0,xr.Or)(y);return(0,n.useEffect)((()=>()=>{v.current(x.current)}),[x]),(0,n.useEffect)((()=>{e.startActiveDiscovery()}),[e]),(0,b.jsx)(Ue._,{label:O.Ru.get("playback-control.connect-picker"),focusTransferId:"DEVICE-PICKER",children:(0,b.jsxs)(Me.w,{className:l()(jr,{[Sr]:o}),fixedHeader:(0,b.jsx)(p.a,{title:o?(0,Ut.v)("Connect"):O.Ru.get("playback-control.connect-picker"),panel:m.Z.DevicePicker}),children:[o?(0,b.jsx)(tr,{}):(0,b.jsx)(Hs,{isPlaying:d}),o?(0,b.jsx)(dr,{}):t&&!i&&(0,b.jsx)(vr,{}),(0,b.jsx)(qs,{devices:r?u:c.map((e=>(0,_a.gS)(e))),areWebPlayerCastDevicesAvailable:h})]})})},wr=()=>null;var Nr=i(53177),Er=i(96811),Rr=i(67158),Ir=i(81720),kr=i(17495),Ar=i(42551);const Lr=(0,Ar.Mz)([e=>e.ads],(e=>e.embeddedAd)),Tr=(0,Ar.Mz)(Lr,(e=>e?.ad)),Dr=(0,Ar.Mz)(Lr,(e=>e?.isOpen||!1)),Or=(0,Ar.Mz)(Lr,(e=>e?.canShowAd||!1)),_r=(0,Ar.Mz)(Lr,(e=>e?.lastTimeInView));var Br=i(98903),Fr=i(21766),Pr=i(24821);var Ur=i(55405);const Mr=()=>{const e=(0,D.wA)(),t=(0,Br.$)(),i=(0,D.d4)((e=>e.ui.videoPlayer.uiFlags.npv)),a=(0,s.NC)(Ur.Ym5,{loadingValue:!1}),r=(0,s.NC)(Ur._TI),o=(0,xt.o)((e=>e?.item),((e,t)=>e?.uid===t?.uid)),l=(0,D.d4)(Or),c=!!(0,D.d4)(Tr),u=(0,D.d4)(_r),d=(e=>{const t=(0,Fr.Z)(e);return!(!t||e&&!(0,Pr.v)(e))&&t?.uid!==e?.uid})(o),p=(({canShowEmbeddedAd:e,nvpIsActive:t,trackChanged:i,featureEnabled:a,storeHasAd:s,isFocused:r,enoughTimePassedSinceLastRender:o})=>(0,n.useMemo)((()=>!!e&&t&&i&&a&&r&&!s&&o),[e,t,i,a,s,r,o]))({canShowEmbeddedAd:l,nvpIsActive:i,trackChanged:d,featureEnabled:a,storeHasAd:c,isFocused:t,enoughTimePassedSinceLastRender:!u||Date.now()-u>1e3*r});return(0,n.useEffect)((()=>{p&&e((0,kr.PY)())}),[p,e,o]),null};var Hr=i(29584);const Vr=({children:e})=>{const[t,i]=(0,n.useState)(null),a=(0,n.useCallback)((()=>{i(Hr.j.Errored)}),[]),s=(0,n.useMemo)((()=>({state:t,capturePlaybackError:a})),[t,a]);return(0,b.jsx)(Hr.O.Provider,{value:s,children:e})},qr=(0,n.lazy)((()=>Promise.all([i.e(8306),i.e(7177),i.e(7219)]).then(i.bind(i,31328)))),Yr=e=>(0,b.jsx)(Vr,{children:(0,b.jsx)(qr,{...e})});var zr=i(2565),Gr=i(85827),Qr=i(9297);const Kr=()=>(0,b.jsx)(b.Fragment,{});var Zr=i(70884),Wr=i(93758),Jr=i(34524),Xr=i(27184),$r=i(43840),eo=i(86392),to=i(30715),io=i(33882),no=i(44440),ao=i(71468);const so="ykU0u_RLxGVmkHVI7if7",ro="KpPP2M5NXZAY5NwqT1uf",oo=({uri:e})=>{const{spec:t,logger:i}=(0,_e.r)(Wr.t,{}),n=(0,D.wA)(),{data:a}=(0,Jr.S)(e),[s,r]=(0,ao.A)(e);if(!a)return null;const{description:o,name:l,images:c}=a,u=(0,no.t)({avatarImages:c,preferFullBleed:!1});return(0,b.jsxs)(io.M,{name:l,openModal:()=>{const e=t.authorAboutModalButtonFactory().hitUiReveal();i.logInteraction(e),n((0,Gn.Te)({bio:a.description,images:a.images.slice(0,1),name:a.name}))},children:[(0,b.jsx)(eo.R,{cardVariant:u,avatarImageSources:c,header:O.Ru.get("web-player.now-playing-view.author-about.title"),name:l}),(0,b.jsxs)("div",{className:so,children:[(0,b.jsxs)("div",{className:ro,children:[(0,b.jsx)(to.c,{name:l,uri:e,onLinkClick:()=>i.logInteraction(t.authorNameFactory().hitUiNavigate({destination:e}))}),(0,b.jsx)($r.T,{toggleFollow:n=>{n.preventDefault(),n.stopPropagation();const a=s?t.followButtonFactory().hitUnfollow({itemToBeUnfollowed:e}):t.followButtonFactory().hitFollow({itemToBeFollowed:e});i.logInteraction(a),r(!s)},isInLibrary:s})]}),(0,b.jsx)(Xr._,{text:o})]})]})},lo=({item:e})=>{const t=(0,Zr.I)(e.book.uri)?.toURI();return t?(0,b.jsx)(oo,{uri:t}):null};var co=i(12470),uo=i(91919),po=i(52186),mo=i(82527),go=i(77193),vo=i(89548),xo=i(99960),bo=i(5058),yo=i(71813),ho=i(88312),fo=i(20440),jo=i(2259),So=i(75539);var Co=i(66975),wo=i(33876),No=i(499);const Eo="_QEMUk5U16U3CQn0wvbD",Ro="mbkl2P60JUhDqc9qGvp9",Io="Xh6dG3pzi2SS7v4cvZzG",ko="sOdoW26RUwggLToa7xDt",Ao="B_TcBcc1BM2yLgvXbh66",Lo="tRnhyUQiKOxA3z8mUD_U",To="_shxqlkLuB52H1iCh_OQ",Do="hAwePVlxumRNpdOSpwyV";const Oo=n.forwardRef((function({className:e="",segment:t,onClickPlay:i,isPlaying:a},s){const{label:r,Icon:o}=(0,n.useMemo)((()=>function(e){if("TALK"===e.type)return{Icon:xo.L,label:O.Ru.get("playlist.a11y.play",e.title)};const t=e.track.artists?.map((e=>e.name)).join(O.Ru.getSeparator())||"";return{Icon:bo.v,label:O.Ru.get("tracklist.a11y.play",e.track.name,t)}}(t)),[t]),c=(0,n.useCallback)((()=>{i()}),[i]);return(0,b.jsxs)("div",{className:l()(To,e),children:[a?(0,b.jsx)(wo.J,{className:Lo,animated:!0}):(0,b.jsx)("span",{className:Lo,children:(0,b.jsx)(o,{iconSize:16,"aria-hidden":"true"})}),(0,b.jsx)(fo.x,{className:Ao,iconClassName:Do,onClick:c,isPlaying:a,isLocked:!1,playAriaLabel:r,ref:s})]})})),_o=({children:e,onTriggerPlay:t,episodeUri:i,index:n})=>{const{spec:a,logger:s}=(0,_e.r)(yo.f,{}),r=(0,Qn.YQ)((()=>{const e=s.logInteraction(a.segmentItemFactory({uri:i,position:n||0}).doubleHitPlay({itemToBePlayed:i}));t(e)}),No.d,{leading:!0,trailing:!1});return(0,b.jsx)("div",{className:ko,onDoubleClick:r,children:e})},Bo=({segment:e,episodeUri:t,index:i})=>{const{spec:a,logger:s}=(0,_e.r)(yo.f,{}),{isActive:r,isPlaying:o,onClick:l}=(0,Co.L)({episodeUri:t,start:e.start,stop:e.stop}),c={uri:t},u=function(e){const t=[{url:e.track.album.image}];return{type:So.c.TRACK,uri:e.uri,uid:null,provider:null,images:t,name:e.track.name,mediaType:"audio",duration:{milliseconds:0},album:{type:So.c.ALBUM,uri:e.track.album.uri,name:e.track.album.name,images:t},artists:e.track.artists.map((e=>({type:So.c.ARTIST,name:e.name,uri:e.uri})))}}(e),d=a.segmentItemFactory({uri:t,position:i||0}).playbackButtonFactory(),p=(0,n.useCallback)((()=>{l({}),r&&o?s.logInteraction(d.hitPause({itemToBePaused:t})):r&&!o?s.logInteraction(d.hitResume({itemToBeResumed:t})):s.logInteraction(d.hitPlay({itemToBePlayed:t}))}),[t,r,o,s,l,d]);return(0,b.jsxs)(_o,{onTriggerPlay:l,episodeUri:t,children:[(0,b.jsx)(Oo,{segment:e,isActive:r,isPlaying:o,onClickPlay:()=>{p()}}),(0,b.jsx)(jo.d,{context:c,item:u,titleTypeVariant:"bodyMedium",subtitleTypeVariant:"bodySmall",onTitleClick:e=>{s.logInteraction(a.segmentItemFactory({uri:t,position:i||0}).albumLinkFactory({uri:c.uri}).hitUiNavigate({destination:e||""}))},onSubtitleClick:e=>{s.logInteraction(a.segmentItemFactory({uri:t,position:i||0}).artistLinkFactory({uri:e||"",position:0}).hitUiNavigate({destination:e||""}))}})]})},Fo=({segment:e,episodeUri:t,index:i})=>{const{spec:a,logger:s}=(0,_e.r)(yo.f,{}),{isActive:r,isPlaying:o,onClick:l}=(0,Co.L)({episodeUri:t,start:e.start,stop:e.stop}),u=function(e){const t=[];return{type:So.c.UNKNOWN,uri:e.uri,uid:null,provider:null,images:t,name:e.title,mediaType:"audio",duration:{milliseconds:0},album:{type:So.c.ALBUM,uri:e.show.uri,name:e.show.name,images:t},artists:[]}}(e),d=a.segmentItemFactory({uri:t,position:i||0}).playbackButtonFactory(),p=(0,n.useCallback)((()=>{l({}),r&&o?s.logInteraction(d.hitPause({itemToBePaused:t})):r&&!o?s.logInteraction(d.hitResume({itemToBeResumed:t})):s.logInteraction(d.hitPlay({itemToBePlayed:t}))}),[t,r,o,s,l,d]);return(0,b.jsxs)(_o,{onTriggerPlay:l,episodeUri:t,children:[(0,b.jsx)(Oo,{segment:e,isActive:r,isPlaying:o,onClickPlay:()=>{p()}}),(0,b.jsx)(ho.r,{children:(0,b.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:u.name})},u.name)]})};var Po=i(28387),Uo=i(52506);function Mo(e){return!!(0,Uo.o)().getCapabilities().isSupported&&function(e){const t=e.metadata?.["parent_episode.uri"];return!!t&&(0,wn.gHQ)(t)}(e)}var Ho=i(49932);const Vo=(0,Nr.mc)((({item:e})=>{const t=e.metadata?.["parent_episode.uri"],i=function(e){const t=(0,Uo.o)();return(0,n.useCallback)((async(i,n)=>{if(!e)return[];try{return await t.getSegments(e,i,n)}catch(e){return[]}}),[e,t])}(t),[a,s]=(0,n.useState)([]),r=(0,n.useRef)(!1),o=(0,n.useRef)(0),l=(0,n.useCallback)((()=>{const e=o.current;null!==e&&(r.current||(r.current=!0,i(e,10).then((e=>{s((t=>{const i=t.concat(e);return o.current=i.length+1,i})),r.current=!1}))))}),[i]);return(0,n.useEffect)((()=>{s([])}),[e.uri]),t?(0,b.jsxs)(Po.w,{className:Eo,children:[(0,b.jsx)(Po.X,{className:Ro,children:O.Ru.get("music_and_talk.in_this_episode")}),(0,b.jsx)("div",{className:Io,children:(0,b.jsx)(Ho._,{onReachBottom:l,triggerOnInitialLoad:!0,children:a.map(((e,i)=>"MUSIC"===e.type?(0,b.jsx)(Bo,{segment:e,episodeUri:t},`${e.uri}-${i}`):(0,b.jsx)(Fo,{segment:e,episodeUri:t},`${e.uri}-${i}`)))})})]}):null}),{name:"NPVInThisEpisode"});var qo=i(53904),Yo=i(42555),zo=i(46300),Go=i(64875);const Qo="f6_Fu_ei4TIJWR0wzvTk",Ko="TLmzadNIdvV8sYzTuXRg",Zo="MT9De6UrCVQ8Qo6o3ikA",Wo=n.memo((()=>{const{cssStyles:e}=(0,Go.Yc)();return(0,b.jsx)("div",{className:Qo,style:{"--section-background-base":e?.["--section-background-base"]},"aria-hidden":!0,children:(0,b.jsxs)("div",{className:Ko,children:[(0,b.jsx)(zo.Y,{as:"div",variant:"bodyMediumBold",className:Zo,charCount:8,isLoading:!0}),[20,50,25].map(((e,t)=>(0,b.jsx)(zo.Y,{as:"div",variant:"bodySmall",className:Zo,charCount:e,isLoading:!0},t)))]})})}));var Jo=i(60892),Xo=i(89537),$o=i(74868),el=i(29933);const tl=(0,n.lazy)((async()=>{const{TopCommentsCard:e}=await Promise.all([i.e(969),i.e(7668),i.e(2377)]).then(i.bind(i,16658));return{default:e}}));var il=i(15120),nl=i(84792);const al=({item:e,spec:t})=>{const i=(0,n.useCallback)((()=>{}),[]),a=(0,s.NC)(Ur.cgF),r=(0,s.NC)(Ur.xEc),o=(0,il.d)(),l=(0,nl.d)(e.uri)?.episodeOrChapter,c=Mo(e),u={uri:e.uri,numberOfChapters:vo.Kp},{data:d,isLoading:p,error:m}=(0,Xo.X)({queryKey:["queryNpvEpisode",u],staleTime:vo.Ff,gcTime:vo.CD,variables:u});if(p&&e.uri&&!m)return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Wo,{}),(0,b.jsx)(Wo,{})]});const g=(0,uo.SB)(d?.episodeUnionV2),v=(0,uo.lz)(d?.episodeUnionV2);if(!e.uri||!g||p||m)return null;const x=l&&l.type===So.c.EPISODE&&l.transcript&&l.transcript.length>0;return(0,b.jsxs)(ma.r,{spec:t,children:[o&&(0,b.jsx)(n.Suspense,{fallback:null,children:(0,b.jsx)(tl,{uri:g.uri})}),(0,b.jsx)(go.N,{episode:g}),!g.originalEpisode&&(0,b.jsx)(po.c,{episode:g}),(0,b.jsx)($o.F,{episode:g}),!c&&(0,b.jsx)(co.I,{episode:g}),r&&v&&(0,b.jsx)(Yo.m,{coverArt:v.coverArt||void 0,description:v.htmlDescription||"",name:v.name,publisher:v.publisher?.name,uri:v.uri}),x&&(0,b.jsx)(b.Fragment,{children:a?(0,b.jsx)(el.n,{episode:e}):(0,b.jsx)(mo.E,{episodeUri:e.uri})}),c&&(0,b.jsx)(Vo,{item:e}),(0,b.jsx)(Jo.K,{topics:v?.topics.items??[],logTopicNavigation:i}),(0,b.jsx)(qo.A,{})]})},sl=({item:e,spec:t})=>(0,vt.n)()?(0,b.jsx)(al,{item:e,spec:t}):(0,b.jsx)(b.Fragment,{}),rl=()=>(0,b.jsx)(b.Fragment,{});var ol=i(10818),ll=i(93125),cl=i(98978),ul=i(65314),dl=i(48428),pl=i(72322),ml=i(40792),gl=i(27736),vl=i(97708),xl=i(77171),bl=i(86239);const yl="main-nowPlayingView-sectionHeaderSpacing",hl="main-nowPlayingView-lyricsTitle",fl="main-nowPlayingView-lyricsControls",jl="main-nowPlayingView-lyricsGradient",Sl="main-nowPlayingView-lyricsContent",Cl=()=>{const{spec:e,logger:t}=(0,_e.r)(ul.X,{}),{setMode:i}=(0,gl.r)();return(0,b.jsxs)("div",{className:fl,children:[(0,b.jsx)(bl.D,{label:O.Ru.get("web-player.now-playing-view.lyrics.cinema-mode"),onClick:()=>{i(Oa.YU.cinema),t.logInteraction(e.cinemaModeButtonFactory().hitUiReveal()),t.logImpression(e.cinemaModeButtonFactory().impression())},children:(0,b.jsx)(xl.C,{size:"small"})}),(0,b.jsx)(bl.D,{label:O.Ru.get("web-player.now-playing-view.close.lyrics"),onClick:()=>{i(Oa.YU.none),t.logInteraction(e.closeLyricsButtonFactory().hitUiHide())},children:(0,b.jsx)(ir.M,{size:"small"})})]})};var wl=i(97216),Nl=i(48563),El=i(42259);const Rl=(0,Nr.mc)((({item:e})=>{const{spec:t,logger:i}=(0,_e.r)(ul.X,{}),a=(0,n.useRef)(null),{mode:s,setMode:r}=(0,gl.r)(),o=(0,n.useRef)(null),u=(0,n.useRef)(0),{data:d}=(0,ml.J)(),p=(0,xt.o)((e=>e?.nextItems?.[0]),((e,t)=>e?.uri===t?.uri));(0,pl.I)(p?.uri,p?.images);const m=(0,n.useCallback)((()=>{u.current=Date.now()}),[]),g=(0,n.useCallback)((({lineRef:e,isActiveLine:t,shouldAnimateScroll:i,activeLineIndex:n,isFirstLine:s})=>{if(!a.current||!o.current)return;let r;if(e.current&&t?r=e.current?.offsetTop-o.current?.offsetTop-16:s&&n<0&&(r=0),void 0===r)return;const l=o.current?.scrollTop,c=Math.abs(l-r),d=a.current.clientHeight,p=Date.now()-u.current<2e3,m=u.current>0&&c>1*d;if(p||m)return;u.current=0;const g="visible"===document.visibilityState&&i?"smooth":"auto";o.current?.scrollTo({top:r,behavior:g})}),[]);(0,n.useLayoutEffect)((()=>{u.current=0,o.current?.scrollTo({top:0,behavior:"auto"})}),[e.uri]);const v=(0,El.H)(),x=v?.higherContrast;if(!d?.hasLyrics)return null;if(s===Oa.YU.npv){const t=d?.hasLyrics&&!d.isTimeSynced,i={"--lyrics-color-active":x?.textBase.toCSS(Nl.a.RGBA)??(t?cl.ONy:d.colors.activeText),"--lyrics-color-inactive":x?.textSubdued.toCSS(Nl.a.RGBA)??d.colors.text,"--lyrics-color-passed":x?.textBase.toCSS(Nl.a.RGBA)??wl.Q.fromCSS(d.colors.activeText,.7).toCSS(Nl.a.RGBA),"--lyrics-color-background":x?.backgroundBase.toCSS(Nl.a.RGBA)??d.colors.background};return(0,b.jsxs)(Po.w,{className:l()(yl,jl),style:i,ref:a,children:[(0,b.jsx)(Po.X,{action:(0,b.jsx)(Cl,{}),className:hl,children:O.Ru.get("web-player.lyrics.title")}),(0,b.jsxs)("div",{className:Sl,ref:o,onWheel:m,onScroll:m,children:[t&&(0,b.jsx)(c.E,{as:"p",variant:"bodySmall",dir:"auto",style:{color:d.colors.text},children:O.Ru.get("web-player.lyrics.unsynced")}),(0,b.jsx)(dl.x,{trackUri:e.uri,data:d,format:"card",onActiveLineChange:g})]})]})}return(0,b.jsx)(Po.w,{className:yl,children:(0,b.jsx)(Po.X,{action:(0,b.jsx)(vl.n,{onClick:()=>{r(Oa.YU.npv),i.logInteraction(t.showLyricsButtonFactory().hitUiReveal()),i.logImpression(t.showLyricsButtonFactory().impression())},children:O.Ru.get("web-player.now-playing-view.show.lyrics")}),className:hl,children:O.Ru.get("web-player.lyrics.title")})})}),{name:"NPVLyrics"});var Il=i(97701),kl=i(33569),Al=i(9904),Ll=i(74177);const Tl=({item:e,spec:t})=>{const i=(0,s.NC)(Ur.LX5),{loading:n,error:a,data:r}=(0,Ll.i)(e),o=(0,s.NC)(Ur.yux),l=Mo(e);if(n&&e.uri&&!a)return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Wo,{}),(0,b.jsx)(Wo,{}),(0,b.jsx)(Wo,{})]});if(!e.uri||"Artist"!==r?.artistUnion.__typename||"Track"!==r?.trackUnion.__typename||n||a)return null;const{profile:c,stats:u,visuals:d,profile:{externalLinks:p}}=r.artistUnion,{credits:m}=r.trackUnion;return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(ma.r,{spec:t,children:[o&&(0,b.jsx)(Rl,{item:e}),i&&(0,b.jsx)(Al.a,{data:r,item:e}),(0,b.jsx)(ol.F,{artistUri:r.artistUnion.uri,artist:c,stats:u,visuals:d,externalLinks:p.items}),m&&(0,b.jsx)(ll.V,{data:m,trackUri:e.uri}),(0,b.jsx)(kl.I,{artistId:r.artistUnion.id,data:r.artistUnion.goods.concerts}),(0,b.jsx)(Il.J,{artistId:r.artistUnion.id,artistUri:r.artistUnion.uri,merch:r.trackUnion.merch.items}),l&&(0,b.jsx)(Vo,{item:e})]})})},Dl=({item:e,spec:t})=>(0,vt.n)()&&e.artists[0].uri?(0,b.jsx)(Tl,{item:e,spec:t}):(0,b.jsx)(b.Fragment,{});var Ol=i(31889),_l=i(63715),Bl=i(47219);const Fl=({item:e,spec:t})=>(0,Pr.v)(e)&&!e.isLocal?(0,b.jsx)(Dl,{item:e,spec:t}):(0,Pr.v)(e)&&e.isLocal?(0,b.jsx)(rl,{}):(0,Bl.p)(e)?(0,b.jsx)(sl,{item:e,spec:t}):(0,_l.d)(e)?(0,b.jsx)(lo,{item:e}):(0,Ol.N)(e)?(0,b.jsx)(Kr,{}):null;i(61045);const Pl=()=>O.Ru.get("web-player.download-page.other-platforms-current"),Ul=(Pl(),Pl(),"Yl2wNWzQgsRb49UB30No"),Ml="Ko2eaQC7YRLTy1QsIY4Q";function Hl(){(0,s.NC)(Ur.JlR);return(0,b.jsxs)("div",{className:Ul,children:[(0,b.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",className:Ml,children:O.Ru.get("queue.fine-something")}),(0,b.jsx)(d.$,{size:"small",colorSet:"brightAccent",onClick:()=>{document.querySelector("[data-top-bar-search]")?.focus()},children:O.Ru.get("web-player.now-playing-view.empty-state-cta")})]})}var Vl=i(59095),ql=i(26423),Yl=i(44850),zl=i(65621),Gl=i(35763);const Ql="TkDZFBZ0IPbGaHDxeCci",Kl="bBG9E6mmFFC74pSkqU0o",Zl=({ad:e,backgroundColor:t})=>{const i=(0,Gl.H)(e.clickthroughUrl),a=e.metadata?.buttonMessage||O.Ru.get("ad-formats.learnMore");return(0,b.jsx)(Ve.N,{to:i,"data-testid":"ad-companion-card",onClick:()=>{},className:Ql,children:(0,b.jsx)(q.v,{style:{backgroundColor:t},className:Kl,onClickHint:O.Ru.get("ad-formats.learnMore"),variant:"tinted",horizontalGap:(0,Yl.po)("looser"),id:e.adId,title:(0,b.jsx)(Ne.d,{variant:"bodySmallBold",children:e.metadata.advertiser||O.Ru.get("ad-formats.learnMore")}),trailing:(0,b.jsx)(n.Suspense,{fallback:(0,b.jsx)(zi.V,{}),children:e.metadata?.advertiser?(0,b.jsx)(zl.default,{text:a,clickUrl:i,onClick:()=>{}}):(0,b.jsx)(zi.V,{"data-testid":"embedded-ad-cta-button-fallback",semanticColor:"textBase"})})})})};var Wl=i(28835);const Jl="wibNcSZSkSmE1N7F0QbG",Xl="xIrPThBgWj2hMwWDOcVq",$l=()=>{const e=(0,D.wA)();return(0,b.jsxs)("div",{className:Xl,children:[(0,b.jsx)(Wl.v,{colorSet:"overMedia",className:Jl,children:(0,b.jsx)(c.E,{variant:"marginalBold",semanticColor:"textBase",children:O.Ru.get("ad-formats.advertisement")})}),(0,b.jsx)(d.$,{"aria-label":O.Ru.get("ad-formats.dismissAd"),colorSet:"overMedia",iconOnly:ir.M,onClick:()=>{e((0,kr.Xo)())},size:"small"})]})};var ec=i(87983),tc=i(85204);const ic="QRqQ5S1T7WIBTZzJ6cAh",nc=({ad:e})=>{const t=e.display.reduce(((e,t)=>(t.url&&e.push({url:t.url,width:t.width,height:t.height}),e)),[]),i=(0,ec.h)(t??void 0,{desiredSize:384}),n=(0,tc.m)({imageUriOrUrl:i});return(0,b.jsx)(Gt._,{loading:"eager",src:n,className:ic})};var ac=i(88036);const sc="XOqwMsxI9nljlJz4i3za",rc=({ad:e})=>{const t=(0,D.wA)(),i=(0,s.NC)(Ur.vDv),a=(0,ac.z)(e.display[0]?.url,ql.CpN,"colorDark");return(0,n.useEffect)((()=>{const e=setTimeout((()=>{t((0,kr.Xo)())}),1e3*i);return()=>{t((0,kr.Xo)()),clearTimeout(e)}}),[t,i]),(0,b.jsxs)("div",{className:sc,"data-testid":"embedded-ad",children:[(0,b.jsx)($l,{}),(0,b.jsx)(nc,{ad:e}),(0,b.jsx)(Zl,{ad:e,backgroundColor:a})]})};let oc=function(e){return e.CoverArt="cover-art",e.Canvas="canvas",e.None="none",e}({});const lc=({container:e,children:t})=>{const i=(0,D.d4)(Tr),a=e===oc.Canvas,r=e===oc.CoverArt,{canBeDisplayedOverCoverArt:o,canBeDisplayedOverCanvas:l}=((e,t)=>{const i=(0,s.NC)(Ur.MgI,{loadingValue:!0}),a=(0,s.NC)(Ur.Ym5,{loadingValue:!1}),r=(0,D.d4)(Dr);return(0,n.useMemo)((()=>({canBeDisplayedOverCanvas:r&&!i&&a&&e,canBeDisplayedOverCoverArt:r&&a&&t})),[a,r,i,t,e])})(a,r);return i&&e!==oc.None&&(o||l)?(0,b.jsx)(rc,{ad:i}):t};var cc=i(66999),uc=i(52492),dc=i(85856),pc=i(76883);const mc=(0,Nr.mc)((()=>{const e=(0,n.useContext)(Ue.s),t=(0,pc.a)({tryAvoidGraphQLFetching:!1}),i=(0,s.NC)(Ur.yJ8)===Ur.NtL.CANVAS_PLAY_ON_HOVER;return t?.canvas&&e?(0,b.jsx)(dc.Gg,{fileId:t.canvas.fileId,canvasUrl:t.canvas.url,canvasType:t.canvas.type,canvasUri:t.canvas.uri,playerContainerClass:"canvasVideoContainerNPV",playbackType:i?dc.RT.LoopOnHover:dc.RT.LoopOnPlayback,allowAspectRatioFix:!0,mouseHoverRef:e,useContainerMouseOverEvents:!1}):null}),{name:"NPVCanvas"});var gc=i(52945),vc=i(79583),xc=i(4806),bc=i(37136),yc=i(49406),hc=i(17188),fc=i(93850),jc=i(9699),Sc=i(86874),Cc=i(38641),wc=i(25733);const Nc="main-nowPlayingView-nowPlayingWidget",Ec="T5_sYfKJ2efL3n3dFNuN",Rc="bLX5l9C_iEfonbMKiFD_",Ic="sJHheSrjFUt_MAcNrUXQ",kc="hhFdIYRyHsqlCHy7T_8A",Ac="main-nowPlayingView-nowPlayingGrid",Lc="main-nowPlayingView-contextItemInfo",Tc="O5NOY8Xw4NH0IhBZu8tm",Dc="DFvRASpHOFAoziM4w7En",Oc="main-nowPlayingView-coverArtContainer",_c="ylBRlfNqGnzVa4kjUQGP",Bc="E08D6ucrHuPJYzzGO7HG",Fc="hjyiWzPtKHn_5kCe9vyg",Pc="pUIBQ9cykHKYx2A2ZIPA",Uc="_q9LkNJJIpxoOkOFI2Nd",Mc="S6W0kreMgaIXYWSEYHya",Hc="hCImOEZCJwYaSy2r1Xgx",Vc="GY_emVGtuRR8FWeKK9je",qc="main-nowPlayingView-trackInfo",Yc="eEiwEPDfVRD0HKjYM_dq",zc=({item:e,spec:t})=>{const i=(0,ie.s)(),a=(0,n.useCallback)((n=>{const a=n?t.heartButtonFactory().hitLike({itemToBeLiked:e.uri}):t.heartButtonFactory().hitRemoveLike({itemNoLongerLiked:e.uri});i.logInteraction(a)}),[e.uri,i,t]),s=(0,fc.v)(e),r=(0,yi.y)();return s?(0,b.jsx)(hc.g,{uri:e.uri,size:r===mi.E.MEDIUM?"medium":"small",className:kc}):(0,Pr.v)(e)&&!e.isLocal?(0,b.jsx)(bc.b,{uri:e.uri,size:r===mi.E.MEDIUM?vc.t.sm:vc.t.xs,onClick:a,className:kc}):(0,Bl.p)(e)?(0,b.jsx)(xc.b,{uri:e.uri,size:r===mi.E.MEDIUM?vc.t.sm:vc.t.xs,onClick:a,className:kc,condensed:!0}):null},Gc=({context:e,item:t})=>{const{spec:i,logger:n}=(0,_e.r)(Ir.J,{}),{spec:a}=(0,_e.r)(gc.p6,{data:{identifier:gc.gw.DESKTOP}}),s=(0,wc.X)(),r=(0,yi.y)();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(yc.w,{className:l()(Dc,Ic),uri:t.uri,sharingInfo:null,interactionData:{intent:"share",type:"click"},condensedAll:!0,onClick:()=>{n.logInteraction(i.shareButtonFactory({uri:t.uri}).hitCopyToClipboard())},ariaLabel:(0,wn.gHQ)(t.uri)?O.Ru.get("context-menu.copy-episode-link"):O.Ru.get("context-menu.copy-track-link"),size:r===mi.E.MEDIUM?"medium":"small"}),(0,b.jsx)(jc.a,{context:e,item:t,className:l()(Tc,Ec),onClick:()=>{n.logInteraction(a.hideButtonFactory().hitRemoveRecommendation({recommendedItemUri:t.uri,contextUri:e.uri}))}}),s&&(0,Cc.N)(t)?(0,b.jsx)(ma.r,{spec:i,children:(0,b.jsx)("div",{className:Tc,children:(0,b.jsx)(Sc.o,{contextUri:t.metadata?.context_uri??e.uri,id:t.uid??void 0,uri:t.uri,isActive:!0})})}):(0,b.jsx)("div",{className:Tc,children:(0,b.jsx)(zc,{item:t,spec:i})})]})};var Qc=i(49526),Kc=i(6705),Zc=i(52908),Wc=i(91426),Jc=i(71378),Xc=i(49361),$c=i(35397);let eu=function(e){return e[e.NONE=0]="NONE",e[e.COVER_ART=1]="COVER_ART",e[e.VIDEO_OVER_PIP_PLACEHOLDER=2]="VIDEO_OVER_PIP_PLACEHOLDER",e[e.VIDEO_OVER_CONNECT_PLACEHOLDER=3]="VIDEO_OVER_CONNECT_PLACEHOLDER",e[e.CANVAS=4]="CANVAS",e}({});const tu=()=>{const e=(0,Qr.L)(),t=(0,F.l)(),{videoPlayerMode:i}=(0,Xc.d)(),{isSongVideo:n,isSongVideoPlayingVideo:a}=(0,Jc.k)(),s=(0,D.d4)((e=>e.ads?.vto)),{showCanvasInNPV:r}=(0,pc.a)({tryAvoidGraphQLFetching:!0});if(!e)return eu.NONE;const{item:o}=e;return i===$c.Kz.documentPip||i===$c.Kz.pip?eu.VIDEO_OVER_PIP_PLACEHOLDER:o?.type===So.c.AD&&s?.isMinimized&&"audio"!==o?.mediaType?eu.NONE:o?.type!==So.c.EPISODE||"video"!==o?.mediaType&&"mixed"!==o?.mediaType?n&&a?t?eu.VIDEO_OVER_CONNECT_PLACEHOLDER:eu.NONE:r?eu.CANVAS:eu.COVER_ART:t?eu.VIDEO_OVER_CONNECT_PLACEHOLDER:eu.NONE};var iu=i(73481),nu=i(37833);const au=(0,Nr.mc)((({hideContextItemInfo:e=!1})=>{const t=(0,Qr.L)(),i=tu(),{draggable:a,onDragStart:s}=(0,nu.P)(),[r,o]=(0,n.useState)(!0),{spec:c,logger:u}=(0,_e.r)(Ir.J,{}),{spec:d}=(0,_e.r)(Vl.E,{data:{uri:t?.item.uri??"",identifier:$c.Kz.npv}}),{isSongVideo:p}=(0,Jc.k)(),m=i===eu.CANVAS,g=i===eu.COVER_ART,v=(0,D.d4)(Tr),x=(0,D.d4)(Dr),y=(0,n.useRef)(null),h=(0,n.useRef)(null),f=(0,n.useRef)(null),j=!(0,hi.j)(),[S,C]=(0,n.useState)(null);if(j&&m&&y.current&&f.current&&(C(f.current),setTimeout((()=>{C(null)}),600)),y.current=g,h.current=m,f.current=t,null===t)return null;const{context:w,item:N,index:E}=t;return(0,b.jsx)("div",{className:l()(Nc),children:(0,b.jsxs)("div",{className:Ac,children:[(0,b.jsxs)("div",{onClick:()=>m&&o(!r),className:l()(Oc,{[Fc]:m,[Hc]:g,[Pc]:r,[Vc]:x&&v}),children:[(0,b.jsx)(lc,{container:g?oc.CoverArt:oc.None,children:(0,b.jsx)("div",{className:l()(_c,{[Uc]:m}),"aria-hidden":m,"data-testid":"track-visual-enhancement",children:(0,b.jsx)(Qc.h,{context:S?.context||w,item:S?.item||N,index:E,canSwitchVisuals:!0})})}),i===eu.VIDEO_OVER_PIP_PLACEHOLDER&&(0,b.jsx)(Zc.k,{}),i===eu.VIDEO_OVER_CONNECT_PLACEHOLDER&&(0,b.jsx)(Wc.V,{}),(0,b.jsx)(lc,{container:m?oc.Canvas:oc.None,children:(0,b.jsx)("div",{className:l()(Bc,{[Mc]:!m}),"aria-hidden":"true",children:(0,b.jsx)(Jn.h,{menu:(0,b.jsx)(Gr.W,{context:w,item:N,canSwitchVisuals:!0}),children:(0,b.jsx)("div",{draggable:a,onDragStart:e=>{s(e,{itemUris:[N.uri],dragLabelText:(0,cc.r)(N)})},children:m&&(0,b.jsx)(mc,{uri:N.uri})})})})}),(0,b.jsx)(Kc.F,{})]}),p&&(0,b.jsx)(iu.L,{className:m?Yc:"",createImpressionSpec:e=>d.toggleAudioVideoButtonFactory({identifier:e?"switch_to_audio":"switch_to_video"}),onClick:e=>{u.logInteraction(d.toggleAudioVideoButtonFactory({identifier:e}).hitPlay({itemToBePlayed:N.uri}))}}),e?null:(0,b.jsxs)("div",{className:l()(Lc,{[Rc]:m}),children:[(0,b.jsx)(jo.d,{className:l()(qc),context:w,item:N,titleTypeVariant:"titleSmall",subtitleTypeVariant:"bodyMedium",onTitleClick:e=>{u.logInteraction(c.titleFactory({uri:N.uri}).hitUiNavigate({destination:e||""}))},onSubtitleClick:e=>{u.logInteraction(c.artistFactory({uri:N.uri}).hitUiNavigate({destination:e||""}))},referrer:uc.G.NPV}),!(0,Ol.N)(N)&&(0,b.jsx)(Gc,{context:w,item:N})]})]})})}),{name:"NPVHeader"});function su(){return(0,b.jsx)(au,{})}var ru=i(91292),ou=i(61101);const lu=({className:e})=>{const t=(0,n.useRef)(null);(0,Z.X)("NPV_OPEN_CINEMA_MODE_BUTTON",t);const i=(0,ou.l)(),{spec:a,logger:s}=(0,_e.r)(Ir.J,{}),r=(0,n.useCallback)((()=>{i(An.z.NOW_PLAYING_VIEW),s.logInteraction(a.expandNpvButtonFactory().hitUiReveal())}),[s,i,a]);return(0,b.jsx)(Xn.Zp,{label:O.Ru.get("web-player.now-playing-view.cinema-mode.expand"),children:(0,b.jsx)(oe.H,{ref:t,iconOnly:ru.L,size:"small",onClick:r,"aria-label":O.Ru.get("web-player.now-playing-view.cinema-mode.expand"),className:e})})};var cu=i(76702),uu=i(99047),du=i(27004);const pu={context:null,item:null};var mu=i(71373),gu=i(42106),vu=i(77290),xu=i(83531),bu=i(78256),yu=i(78247),hu=i(6725),fu=i(3258);const ju="yvZooOj0rpfRS__cAUCo",Su="k_ndsg7yz9ZAgEmei1n3",Cu="vDev2BqBHloweL24GNHK",wu="IkRGajTjItEFQkRMeH6v",Nu="f2UE9n5nZcbgZrGYTU3r",Eu="nw2W4ZMdICuBo08Tzxg9",Ru="wPHL366l99aluPsMU8Bl",Iu="UAg2mNxhAm_jv0zFjG8z",ku="VjVlpyxDo941sgO2Vc8g";function Au(e){return(0,Pr.v)(e)||(0,hu.v)(e)||(0,Bl.p)(e)||(0,_l.d)(e)?e.name:(0,Ol.N)(e)?"":(0,vn.d)(e)}const Lu=n.memo((({item:e,spec:t})=>{const{ref:i,breakpoint:n}=(0,gn.x)({[mi.E.XSMALL]:0,[mi.E.SMALL]:280,[mi.E.MEDIUM]:320});return(0,b.jsx)("div",{className:Eu,"data-testid":"NPV_Panel_OpenDiv",ref:i,children:e&&(0,b.jsxs)(yi.o.Provider,{value:n,children:[(0,b.jsx)(au,{}),(0,b.jsx)(Fl,{item:e,spec:t}),!(0,Bl.p)(e)&&(0,b.jsx)(qo.A,{})]})})})),Tu=({context:e,item:t,spec:i})=>{const a=(0,xu.SF)();return(0,n.useEffect)((()=>{a.current&&(a.current.scrollTop=0)}),[t?.uri,a]),(0,gu.bJ)(e,t)?(0,b.jsx)(mu.IT,{spec:i}):(0,b.jsx)(Lu,{context:e,item:t,spec:i})},Du=({context:e,item:t,spec:i})=>{const n=(0,Ln.S)();return Mr(),n===An.z.NOW_PLAYING_VIEW?null:(0,b.jsx)(Tu,{context:e,item:t,spec:i})},Ou=()=>tu()===eu.CANVAS,_u=({item:e})=>{const t=(0,n.useRef)(null),i=(0,Qr.L)(),{title:a,link:r}=(0,vu.$)(),o=Ou(),c=(0,s.NC)(Ur.mzn),{spec:u,logger:d}=(0,_e.r)(Ir.J,{}),g=(0,n.useCallback)((()=>{const e=u.closeButtonFactory().hitUiHide();d.logInteraction(e)}),[u,d]);return(0,n.useEffect)((()=>{null!==t.current&&t.current.focus({preventScroll:!0})}),[]),(0,b.jsx)(p.a,{title:a,titleSlot:(0,b.jsx)(p.k,{title:a,panelLinkRef:t,item:e,link:r,variant:"bodyMediumBold",semanticColor:"textBase",className:Su}),link:r,actions:i&&i.context&&(0,b.jsxs)("div",{className:c?Iu:ku,children:[(0,b.jsx)(ea.b,{menu:(0,b.jsx)(Gr.W,{context:i.context,item:e,canSwitchVisuals:!0}),children:(0,b.jsx)(zr.e,{size:"small",condensed:!1,label:O.Ru.get("more.label.context",e?Au(e):""),onClick:()=>{d.logInteraction(u.contextMenuButtonFactory().hitUiReveal())},className:Ru})}),c&&(0,b.jsx)(lu,{className:Ru})]}),panelLinkRef:t,panel:m.Z.NowPlayingView,onClose:g,item:e,className:l()({[ju]:o})})},Bu=({item:e})=>{const t=!!e&&(0,Ol.N)(e);return(0,n.useMemo)((()=>t?null:(0,b.jsx)(_u,{item:e})),[e,t])},Fu=(0,Nr.mc)((({nodeRef:e})=>{const t=!(0,vt.n)(),{context:i,item:n,index:a}=(0,xt.o)((e=>e),Qr.F)||{context:null,item:null,index:null},{spec:r,UBIFragment:o}=(0,_e.r)(Rr.t,{data:{uri:n?n.uri:""}}),c=Ou(),u=!!n&&(0,Ol.N)(n),d=(0,ca.t)(r),p=(()=>{const{item:e,context:t}=(0,Qr.L)()||pu,{isYourDJNarrator:i,hasYourDJMetadata:n}=(0,uu.C)(),a=(0,s.NC)(Ur.yon),r=(0,ac.z)(e?.images?.[0]?.url,ql.l0o,"colorDark");return i&&n?(0,du.p)(t?.metadata?.["narration.background.color"],cu.lZ):a?r:void 0})(),m={"--background-base":p};let g=null;g=(0,fu.O)(i)&&null!==n?t?(0,b.jsx)(su,{}):u?(0,b.jsx)(Yr,{item:n,context:i,index:a}):(0,b.jsx)(Du,{spec:r,context:i,item:n}):(0,b.jsx)(Hl,{});const v={cssStyles:{"--section-background-base":p?"var(--background-tinted-base)":"var(--background-elevated-base)","--section-padding":Er.spacer16,"--section-border-radius":Er.spacer8},headerVariant:"bodyMediumBold"};return(0,b.jsx)(yu.P,{surface:bu.u.NOW_PLAYING,children:(0,b.jsx)(xu.ql.Provider,{value:"now_playing_panel",children:(0,b.jsx)(Go.Tn,{...v,children:(0,b.jsx)(Ue._,{nodeRef:e,label:O.Ru.get("web-player.now-playing-view.label"),style:{...m,...v.cssStyles},itemUri:n?.uri?n.uri:"","data-testid":"now-playing-view-container",className:"NowPlayingView",children:(0,b.jsx)(o,{spec:r,children:(0,b.jsx)(Me.w,{className:l()(wu,{[Nu]:void 0!==p}),fixedHeader:(0,b.jsx)(Bu,{item:n}),scrolledClassName:c?Cu:void 0,ref:d,children:g})})})})})})}),{name:"NPV"}),Pu="vzeIlCPBQJUaqdMZHqHE",Uu="iZgGvu9g2gDlQ1ofJ7rH",Mu="FSZKuoSTDgGwCPXO_qel",Hu="cPpNQwPTiEn9Zegl5Dwz",Vu="p2Yw6bT_O5PW8yGv1R0X",qu="pK7G3_mtRcuFjbhJzm1s",Yu="gVJxtuXo8lHAw8XLKHfQ",zu="BR3H6wavkReGa2xeSeaV",Gu="vXYSi4u1nPutJ_ZkC6mq",Qu=e=>{const t=(0,n.useRef)(null);return(0,b.jsx)(a.A,{in:e.isActive,nodeRef:t,timeout:{enter:e.shouldPlayAnimation?200:0,exit:e.shouldPlayAnimation?300:0},classNames:{enter:e.shouldPlayAnimation?Uu:qu,enterActive:e.shouldPlayAnimation?Mu:Yu,exit:e.shouldPlayAnimation?Hu:zu,exitActive:e.shouldPlayAnimation?Vu:Yu},unmountOnExit:!0,mountOnEnter:!0,children:(0,b.jsx)("div",{className:Pu,children:(0,b.jsx)("div",{className:Gu,ref:t,children:e.children})})})};var Ku=i(45942),Zu=i(55721),Wu=i(83800),Ju=i(18940),Xu=i(23919),$u=i(73153),ed=i(62704),td=i(34824),id=i(11053),nd=i(49402),ad=i(3678);const sd="PddBvUOS0_6f9B21fVGF",rd=({ariaLabel:e,onRemoveItems:t,nrItems:i,columnCount:a,children:s})=>{const r=(0,n.useRef)(null);(0,id.g)(r);const o=(0,nd.d)(t);return(0,b.jsx)(td.R,{firstInteractiveIsWrapper:!0,"aria-label":e,"aria-rowcount":i,"aria-colcount":a,className:sd,ref:r,onKeyDown:o,children:s})},od=({items:e,renderRow:t,...i})=>{const a=(0,n.useCallback)(((t,i)=>e.slice(t,i+1)),[e]);return(0,b.jsx)(ad.k,{resolveItem:ld,getItems:a,nrTracks:e.length,children:(0,b.jsx)(rd,{nrItems:e.length,...i,children:e.map(t)})})};function ld(e){return{uri:e.uri,uid:e.uid??void 0,type:e.type}}var cd=i(84579),ud=i(11973),dd=i(28957),pd=i(31008),md=i(60303),gd=i(44126),vd=i(26449);const xd=({chapter:e,index:t,showTypeLabel:i,...n})=>{const{uid:a,uri:s,type:r,name:o,images:l,book:c}=e,u=(0,cd.E)(e,t),d=(0,vd.Y)(n.section),p=(0,b.jsx)(pd.r,{uri:s,removeFromQueueData:{uid:a??void 0,contextUri:d}}),m=(0,b.jsx)(gd.n,{item:e,tooltipText:c.name,showTypeLabel:i,subtitle:(0,b.jsx)(Jn.h,{menu:(0,b.jsx)(dd.p,{uri:c.uri}),children:(0,b.jsx)(Ve.N,{to:c.uri,stopPropagation:!0,children:c.name})})});return(0,b.jsx)(md.b,{uid:a,uri:s,contextUri:d,id:u,index:t,type:r,title:o,subtitle:m,images:l,dragLabel:o,menu:p,moreButtonLabelName:o,ariaPauseLabel:O.Ru.get("playlist.a11y.pause",o),ariaPlayLabel:O.Ru.get("playlist.a11y.play",o),...n})};var bd=i(27251),yd=i(24673),hd=i(71331),fd=i(18703),jd=i(13323),Sd=i(2344),Cd=i(86839),wd=i(20435),Nd=i(79363);const Ed=(0,n.createContext)(null),Rd=({children:e})=>{const{uri:t}=(0,Nd.H)(),{spec:i,UBIFragment:a}=(0,_e.r)(Cd.i,{data:{identifier:wd.$h.NOWPLAYING_QUEUE,uri:t??""}}),s=(0,n.useMemo)((()=>i.nowPlayingSectionFactory()),[i]),r=(0,n.useMemo)((()=>i.nextInQueueSectionFactory()),[i]),o=(0,n.useMemo)((()=>i.nextFromSectionFactory()),[i]),l=(0,n.useMemo)((()=>({queueSpec:i,nowPlayingSectionSpec:s,nextInQueueSectionSpec:r,nextFromSectionSpec:o})),[i,s,r,o]);return(0,b.jsx)(Ed.Provider,{value:l,children:(0,b.jsx)(a,{spec:i,children:e})})};var Id=i(81745);const kd=()=>{const e=(0,n.useContext)(Ed);if(!e)throw Error("useQueueUBI must be used within a QueuePanelUBIProvider!");const{queued:t}=(0,Nd.H)(),i=(0,ie.s)(),{queueSpec:a,nowPlayingSectionSpec:s,nextInQueueSectionSpec:r,nextFromSectionSpec:o}=e;return{logClearQueue:(0,n.useCallback)((()=>{const e=r.clearQueueButtonFactory().hitRemoveItemsFromQueue({numberOfItemsToRemoveFromQueue:t.length});return i.logInteraction(e)}),[i,r,t.length]),logAddToQueue:(0,n.useCallback)(((e,t)=>{let n;switch(e){case jd.$.NowPlaying:n=s;break;case jd.$.NextInQueue:n=r;break;case jd.$.NextUp:n=o;break;default:return}const a=1===t.length?n.dragAddItemToQueue({itemToAddToQueue:t[0]}):n.dragAddItemsToQueue({numberOfItemsToAddToQueue:t.length});return i.logInteraction(a)}),[i,o,r,s]),logSort:(0,n.useCallback)((e=>{let t;switch(e){case jd.$.NextInQueue:t=r;break;case jd.$.NextUp:t=o;break;case jd.$.NowPlaying:default:return}const n=t.dragSort();return i.logInteraction(n)}),[i,o,r]),logQueuePanelTabChange:(0,n.useCallback)((e=>{if(e!==Id.p.PARTICIPANT_LIST){const t=a.queueHistoryTabFactory({identifier:e===Id.p.QUEUE?"queue":"recently_played"}).hitUiReveal();return i.logInteraction(t)}}),[i,a]),logQueueContextLinkNavigate:(0,n.useCallback)((e=>{const t=o.queueContextLinkFactory().hitUiNavigate({destination:e??""});return i.logInteraction(t)}),[i,o])}};var Ad=i(97341),Ld=i(23426);const Td=(0,n.memo)((function({item:e,...t}){const i=function(e,t){const i=(0,S.z)(),{request:a}=(0,n.useContext)(Ld.j),{logAddToQueue:s,logSort:r}=kd();return(0,n.useCallback)((async(n,o,l)=>{const{contextUri:c,sectionId:u,itemIds:d}=l??{},p=t===jd.$.NowPlaying,m=Sd.v===c&&!p,g=n[hd.fl.ALBUMS]?.at(0),v=Object.values(n).flat();let x=[];if(g){const{trackUris:e}=await(0,Ad.s)(g,0,a);x=e.map((e=>({uri:e,uid:null})))}else x=m&&d?.length?d.map((e=>({uri:"",uid:e}))):Object.values(n).flat().map((e=>({uri:e,uid:null})))??[];const b=m&&u===jd.$.NowPlaying;let y;if(y=o===fd.Nz.BEFORE?{before:{uri:e.uri,uid:e.uid??null}}:{after:{uri:e.uri,uid:e.uid??null}},m&&!b)t&&r(t),i.reorderQueue(x,y);else{let e;t&&(e=s(t,v)),p?i.addToQueue(x,{interactionId:e?.interactionId}):i.insertIntoQueue(x,y,{interactionId:e?.interactionId})}}),[e.uid,e.uri,s,r,i,a,t])}(e,t.section);switch(e.type){case So.c.TRACK:return(0,b.jsx)(yd.e,{track:e,onDrop:i,...t});case So.c.EPISODE:return(0,b.jsx)(bd.I,{episode:e,onDrop:i,...t});case So.c.CHAPTER:return(0,b.jsx)(xd,{chapter:e,onDrop:i,...t});case So.c.AD:return(0,b.jsx)(ud.Y,{ad:e,onDrop:i,...t});case So.c.UNKNOWN:return null;default:return(0,vn.k)(e),null}}));var Dd=i(42668);const Od=(0,n.memo)((function({item:e,...t}){const{usePlayContextItem:i}=(0,Dd.P)({uri:e.uri,pages:[{items:[e]}]},{featureIdentifier:"history"});return(0,b.jsx)(Td,{item:e,...t,usePlayContextItem:i})})),_d=({items:e})=>{const t=(0,n.useCallback)(((e,t)=>(0,b.jsx)(Od,{item:e,index:t},(0,cd.E)(e,t))),[]);return(0,b.jsx)(od,{items:e,ariaLabel:O.Ru.get("view.recently-played"),renderRow:t,columnCount:Sd.$})};var Bd=i(46915),Fd=i(3413);const Pd=()=>{const{isLoading:e,data:t}=(0,Fd.a)();return e?null:t?.items.length?(0,b.jsx)(_d,{items:t.items}):(0,b.jsx)(Bd.H,{})};var Ud=i(68832);const Md=(e,t)=>!t?.didQueueChangeSignificantly,Hd=(e,t,i)=>{Md(0,i?.current)?(0,Ud.oz)({onUpdate:t=>{e.style.opacity=t.toString()}}):e.style.opacity="1"},Vd=(e,t,i,n)=>{Md(0,n?.current)?(0,Ud.oz)({onUpdate:t=>{e.style.opacity=(1-Number(t)).toString()},onComplete:i}):i()},qd=({hideEnteringElements:e,animateEnteringElements:t,animateExitingElements:i,animateFlippedElements:n})=>{e(),i(),n(),t()};var Yd=i(8741);function zd(e){const t=(0,n.useRef)(e);return(0,n.useMemo)((()=>{const i=new Map,n=Qd(t.current,i),a=Qd(e,i),s=(0,Yd.I)(n,a),r=s>16||s>=Math.max(Gd(e),Gd(t.current));return t.current=e,r}),[e])}function Gd(e){return Number(!!e?.current)+(e?.queued.length??0)+(e?.nextUp.length??0)}function Qd({current:e,nextUp:t=[],queued:i=[]},n){let a="";return[[e],t,i].forEach((e=>{e.forEach((e=>{e?.uid&&(n.has(e.uid)||n.set(e.uid,String.fromCharCode(65+n.size)),a+=n.get(e.uid))})),e.length&&(a+=" ")})),a}var Kd=i(1855);const Zd=({current:e,queued:t,nextUp:i,children:a})=>{const s=(0,n.useMemo)((()=>[e,...t,...i].filter(Kd.P).map(cd.E).join("")),[e,i,t]),r={didQueueChangeSignificantly:zd({current:e,nextUp:i,queued:t})};return(0,b.jsx)(Ud.ZI,{flipKey:s,handleEnterUpdateDelete:qd,decisionData:r,children:a})},Wd=({children:e,...t})=>(0,hi.j)()?(0,b.jsx)(b.Fragment,{children:e}):(0,b.jsx)(Zd,{...t,children:e}),Jd=({children:e,...t})=>(0,hi.j)()?(0,b.jsx)(b.Fragment,{children:e}):(0,b.jsx)(Ud.lf,{shouldFlip:Md,...t,children:e});var Xd=i(98833),$d=i(78651);const ep=[hd.fl.TRACKS,hd.fl.LOCAL_TRACKS,hd.fl.EPISODES,hd.fl.CHAPTERS,hd.fl.ALBUMS],tp=({uri:e,items:t,ariaLabel:i,section:a,showTypeLabel:s,decoratedQueuedByUsersByUsername:r})=>{const o=(0,S.z)(),l=(0,n.useCallback)((e=>{o.removeFromQueue(e)}),[o]),{usePlayContextItem:c}=(0,Xd.b)(e,a),u=(0,n.useCallback)(((e,t)=>{const i=(0,cd.E)(e,t);return(0,b.jsx)(Jd,{flipId:e.metadata?.original_uid??i,onAppear:Hd,onExit:Vd,translate:!0,children:(0,b.jsx)("div",{className:$d.A.listRowWrapper,children:(0,b.jsx)(Td,{item:e,index:t,usePlayContextItem:c,section:a,allowedDropMimeTypes:ep,showTypeLabel:s,queuedBy:r?.[e.metadata?.queued_by??""]})})},i)}),[r,a,s,c]);return(0,b.jsx)(od,{items:t,renderRow:u,columnCount:Sd.$,ariaLabel:i,onRemoveItems:l})};var ip=i(60813);const np="u842BXnznGeq38O3DUTQ",ap="NWVZ_rxlezZ8xTHlMg4Y",sp="Oae51evvT5DrqTupCiZ2",rp="LFdMliaHVgrpBcqNKHU3",op="IeeqYq0Ozrndd6STmrRk",lp="NljerwmGshDHsI7rIvWl",cp=({nrQueuedItems:e})=>{const t=(0,S.z)(),{logClearQueue:i}=kd(),[a,s]=(0,n.useState)(!1),r=(0,n.useCallback)((()=>{s(!1)}),[]),o=(0,n.useCallback)((()=>{i(),t.clearQueue(),s(!1)}),[i,t]),l=(0,n.useCallback)((()=>{s(!0)}),[]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(oe.H,{size:"small",onClick:l,className:op,condensed:!0,children:O.Ru.get("queue.clear-queue")}),(0,b.jsx)(ip.p,{itemCount:e,isOpen:a,onClose:r,onConfirm:o})]})};var up=i(86082);const dp=({queueSection:e,title:t,trailingButton:i})=>{const a=(0,n.useRef)(null),s=(0,up.K)({ref:a});return(0,b.jsx)(Jd,{flipId:`section-header-${e}`,onAppear:Hd,onExit:Vd,translate:!0,children:(0,b.jsxs)("div",{className:rp,children:[(0,b.jsx)(Xn.Zp,{label:t,disabled:!s,children:(0,b.jsx)(c.E,{as:"h2",variant:"bodyMediumBold",semanticColor:"textBase",className:lp,ref:a,children:t})}),i]})})};var pp=i(80043),mp=i(24792),gp=i(31491);const vp=new mp.l("decorateQueuedByUsers","query","1b71b9895bad207fdac0df7ebad17c790260519f853a069ee05f20e51c08636e",null);function xp(e){const{currentSession:t}=(0,Us.D)(),i=Array.from(new Set(e.map((e=>e?.metadata?.queued_by||null)).filter(Kd.P))).sort().map((e=>(0,wn.Qjr)(e).toURI())),{data:a}=(s={userUris:i},r={gcTime:36e5,staleTime:18e5,enabled:!!i.length,placeholderData:Ba.rX},(0,gp.I)(vp,s,r));var s,r;const o=(0,n.useMemo)((()=>Object.fromEntries(a?.users?.map((e=>{return"User"===e.__typename?[e.username,(t=e,{type:So.c.USER,...t,images:t.avatar?.sources??[]})]:null;var t})).filter(Kd.P)??[])),[a]);return t?.active?o:{}}var bp=i(83132),yp=i(15514);const hp=()=>{const e=(0,Nd.H)(),{uri:t,description:i,current:a,nextUp:s,queued:r,isEmpty:o,hasQueuedTracks:l,hasNextTracks:c}=e,{logQueueContextLinkNavigate:u}=kd(),d=xp([a,...s,...r]),p=(0,n.useMemo)((()=>new Set([a,...r,...s].filter(Kd.P).map((({type:e})=>e))).size>1),[a,s,r]),{currentSession:m}=(0,Us.D)(),g=(0,Fs.y)();return o?(0,b.jsx)(pp.K,{}):(0,b.jsxs)(Wd,{...e,children:[(0,b.jsx)(bp.Z,{className:sp}),(0,b.jsxs)("div",{className:np,children:[a&&(0,b.jsxs)("div",{className:ap,children:[(0,b.jsx)(dp,{queueSection:jd.$.NowPlaying,title:O.Ru.get("queue.now-playing")}),(0,b.jsx)(tp,{ariaLabel:O.Ru.get("queue.now-playing"),uri:t,items:a?[a]:[],section:jd.$.NowPlaying,showTypeLabel:p,decoratedQueuedByUsersByUsername:d})]}),!m?.active&&g&&(0,b.jsx)(yp.p,{localStorageKey:"dismissStartJamButtonFromQueue"}),l&&(0,b.jsxs)("div",{className:ap,children:[(0,b.jsx)(dp,{queueSection:jd.$.NextInQueue,title:O.Ru.get("queue.next-in-queue"),trailingButton:(0,b.jsx)(cp,{nrQueuedItems:r.length})}),(0,b.jsx)(tp,{ariaLabel:O.Ru.get("queue.next-in-queue"),uri:t,items:r,section:jd.$.NextInQueue,showTypeLabel:p,decoratedQueuedByUsersByUsername:d})]}),c&&(0,b.jsxs)("div",{className:ap,children:[(0,b.jsx)(dp,{queueSection:jd.$.NextUp,title:i&&!(0,Nd.K)(a)&&t?(0,b.jsxs)(b.Fragment,{children:[O.Ru.get("queue.next-from")," ",(0,b.jsx)(Ve.N,{to:t,onClick:()=>{u(t)},children:i})]}):O.Ru.get("queue.next-up")},i),(0,b.jsx)(tp,{ariaLabel:O.Ru.get("queue.next-up"),uri:t,items:s,section:jd.$.NextUp,showTypeLabel:p})]})]})]})};var fp=i(80076),jp=i(17871),Sp=i(98637),Cp=i(12565);const wp="AjjTyUrCO3pZ365KtTXW",Np="pGtUoenc5OobLi8CscJ6",Ep="cArVcLcQ85q_9QSLGYGX",Rp="lDtXv1VCrs0PHHSuH5uO",Ip="ukjUoaLSzKyRcwoOQw9V",kp="yQwBNeetmAr0a0OTR8t3",Ap="fzB4RXxTp0rlpNQlSuu9",Lp=({sessionMember:e,showRemoveButton:t,onClickMember:i,onClickRemove:n,index:a})=>{const{currentSession:s}=(0,Us.D)(),{displayName:r,images:o,username:l,uri:c}=(0,Cp.c)(e);return(0,b.jsx)(Jn.h,{menu:(0,b.jsx)(Sp.B,{uri:c}),children:(0,b.jsx)(q.v,{id:`${a}`,variant:"naked",className:Ip,title:(0,b.jsx)(Ne.d,{lineClamp:1,children:r}),media:(0,b.jsx)("div",{role:"button",onClick:i,onKeyDown:i,tabIndex:-1,children:(0,b.jsx)(jp.e,{images:o,userIconSize:"medium",width:48,displayName:r,username:l,label:r})}),subtitle:s?.sessionOwnerId===e.id?O.Ru.get("web-player.social-connect.participant-list.host"):O.Ru.get("web-player.social-connect.participant-list.guest"),onClick:i,trailing:t&&(0,b.jsx)(re.n,{size:"small",className:kp,onClick:n,"aria-label":O.Ru.get("web-player.social-connect.participant-list.remove-guest-accessible-label",{displayName:r}),children:O.Ru.get("web-player.social-connect.participant-list.remove-guest")})})})};var Tp=i(98731),Dp=i(89503),Op=i(7840),_p=i(10622);const Bp=()=>{const e=(0,Pa.d)(),t=(0,D.wA)(),i=(0,Op.g)(),a=(0,Tp.Z)(),{currentSession:s,kickAllParticipants:r}=(0,Us.D)(),{setQueueView:o}=(0,fp.m)(),{logUserClick:l,logRemoveClick:u}=(0,Dp.T)(),p=(0,n.useCallback)((()=>{s?.joinSessionShortLink&&a(s?.joinSessionShortLink)}),[a,s?.joinSessionShortLink]),m=(0,n.useCallback)(((e,i)=>{u(e),t((0,Gn.A9)(Oa.EL.REMOVE_PARTICIPANT,void 0,i))}),[t,u]),g=(0,n.useCallback)(((e,t)=>{const n=(0,wn.Qjr)(t.username);l(e,n.toURI()),i(n.toURLPath(!0))}),[l,i]),v=(0,n.useCallback)((()=>{r(s?.sessionId)}),[s?.sessionId,r]),x=(0,_p.T4)(e);return s&&x?(0,b.jsxs)("div",{className:wp,children:[(0,b.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",children:O.Ru.get("web-player.social-connect.participant-list.title")}),(0,b.jsxs)("div",{className:Np,children:[(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:O.Ru.get("web-player.social-connect.participant-list.subtitle")}),(0,b.jsx)(re.n,{size:"small",onClick:p,className:Ep,children:O.Ru.get("web-player.social-connect.invite-button")})]}),(0,b.jsx)("div",{className:Rp,children:s.sessionMembers.map(((t,i)=>(0,b.jsx)(Lp,{index:i,sessionMember:t,showRemoveButton:(0,_p.kt)(e,(0,wn.Qjr)(t.username).toURI()),onClickRemove:()=>m(i,t),onClickMember:()=>g(i,t)},i)))}),s.isSessionOwner&&s.sessionMembers.length>1&&(0,b.jsx)(d.$,{colorSet:"invertedLight",size:"small",onClick:v,children:O.Ru.get("web-player.social-connect.participant-list.remove-all-guests")}),(0,b.jsx)(c.E,{variant:"marginal",semanticColor:"textSubdued",className:Ap,children:O.Ru.get("web-player.social-connect.participant-list.visibility-info")})]}):(o(fp.p.QUEUE),null)};var Fp=i(53167);const Pp="BZj_r1yzmmragvivUCrw",Up="hpzTKCoO0rllEslIOMPo",Mp="TeBVsFnI9PMHYL9ynJx9",Hp="ZDR7q1cqU2yaYjemuy9Z",Vp="OLB2ghxc09Kz8k_93eIu",qp=()=>{const{currentQueueView:e,setQueueView:t}=(0,Id.m)(),i=(0,Fp.y)(),{logQueuePanelTabChange:a}=kd(),s=(0,n.useMemo)((()=>i?{titleSlot:e!==Id.p.PARTICIPANT_LIST?(0,b.jsx)(Ju.t,{currentTab:e,onTabChange:e=>{e===(0,$u.c)(Id.p.HISTORY)?(a(Id.p.HISTORY),t(Id.p.HISTORY)):(a(Id.p.QUEUE),t(Id.p.QUEUE))},className:Mp,children:(0,b.jsxs)(Xu.w,{"aria-label":"",className:Hp,children:[(0,b.jsx)($u.V,{"aria-selected":e===Id.p.QUEUE,label:O.Ru.get("playback-control.queue"),value:Id.p.QUEUE}),(0,b.jsx)($u.V,{"aria-selected":e===Id.p.HISTORY,label:O.Ru.get("view.recently-played"),value:Id.p.HISTORY})]})}):(0,b.jsx)(oe.H,{iconLeading:Ss.g,onClick:()=>t(Id.p.QUEUE),size:"small",condensed:!0,className:Vp,children:O.Ru.get("web-player.social-connect.participant-list.back-to-queue")})}:{title:O.Ru.get("playback-control.queue")}),[i,a,t,e]);return(0,b.jsx)(Ue._,{label:O.Ru.get("playback-control.queue"),focusTransferId:"QUEUE-HISTORY-PANEL",children:(0,b.jsx)(Me.w,{fixedHeader:(0,b.jsx)(p.a,{className:Pp,panel:m.Z.Queue,...s}),children:(0,b.jsx)("div",{className:Up,children:e!==Id.p.PARTICIPANT_LIST?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ed.K,{value:"queue",children:e===Id.p.QUEUE&&(0,b.jsx)(hp,{})}),(0,b.jsx)(ed.K,{value:"history",children:e===Id.p.HISTORY&&(0,b.jsx)(Pd,{})})]}):(0,b.jsx)(Bp,{})})})})},Yp=(0,n.memo)((function(){return(0,b.jsx)(Rd,{children:(0,b.jsx)(qp,{})})}));var zp=i(14076),Gp=i(32724);const Qp=(0,n.memo)((()=>{const e=(0,s.NC)(Ur.ZDY),t=(0,Zu.X)(),i=(0,Ku._)(),o=function(){const e=(0,n.useRef)(m.Z.NowPlayingView),t=(0,j.XB)();return(0,n.useEffect)((()=>{e.current=t}),[t]),(0,n.useCallback)((i=>{const n=e.current===m.Z.NowPlayingView,a=t===m.Z.NowPlayingView;return i.some((i=>n&&t===i||a&&e.current===i))}),[t])}(),l=(0,Ln.S)()===An.z.NOW_PLAYING_VIEW,c=(0,n.useRef)(null),u=e&&t===m.Z.Disabled;return(0,b.jsxs)(r.s,{onError:e=>{(0,zp.Jy)(e,"PanelSection"),i((0,Wu.MQ)(m.Z.Disabled))},children:[(0,b.jsx)(a.A,{nodeRef:c,in:t===m.Z.NowPlayingView||u,exit:m.v.includes(t),timeout:{enter:0,exit:300},unmountOnExit:!0,mountOnEnter:!0,children:(0,b.jsx)(Gp.f,{enabled:!u,children:(0,b.jsx)(Fu,{nodeRef:c})})}),t===m.Z.BuddyFeed?(0,b.jsx)(kn,{}):null,(0,b.jsx)(Qu,{isActive:t===m.Z.BuddyFeedOverlay,shouldPlayAnimation:!l&&o([m.Z.BuddyFeedOverlay]),children:(0,b.jsx)(kn,{})}),t===m.Z.Queue?(0,b.jsx)(Yp,{}):null,(0,b.jsx)(Qu,{isActive:t===m.Z.QueueOverlay,shouldPlayAnimation:!l&&o([m.Z.QueueOverlay]),children:(0,b.jsx)(Yp,{})}),t===m.Z.Puffin||t===m.Z.PuffinActivation?(0,b.jsx)(yn,{}):null,(0,b.jsx)(Qu,{isActive:t===m.Z.PuffinActivationOverlay||t===m.Z.PuffinOverlay,shouldPlayAnimation:!l&&o([m.Z.PuffinActivationOverlay,m.Z.PuffinOverlay]),children:(0,b.jsx)(yn,{})}),t===m.Z.DevicePicker?(0,b.jsx)(Cr,{}):null,(0,b.jsx)(Qu,{isActive:t===m.Z.DevicePickerOverlay,shouldPlayAnimation:!l&&o([m.Z.DevicePickerOverlay]),children:(0,b.jsx)(Cr,{})}),wr?(0,b.jsxs)(b.Fragment,{children:[t===m.Z.Euterpe?(0,b.jsx)(wr,{}):null,(0,b.jsx)(Qu,{isActive:t===m.Z.Euterpe,shouldPlayAnimation:o([m.Z.Euterpe]),children:(0,b.jsx)(wr,{})})]}):null]})}))},66975:(e,t,i)=>{i.d(t,{L:()=>o});var n=i(30758),a=i(42668),s=i(11957),r=i(69796);function o({episodeUri:e,start:t,stop:i}){const{togglePlay:o,triggerPlay:l,isPlaying:c,isActive:u}=(0,a.P)({uri:e},{featureIdentifier:"episode"}),d=(0,s.o)((e=>(0,r.s)(e)??0)),p=u&&function(e,t,i){return i>=e&&i<t}(t,i,d),m=c&&p;return{onClick:(0,n.useCallback)((e=>{p?o({seekTo:t,loggingParams:e}):l({seekTo:t,loggingParams:e})}),[p,t,o,l]),isPlaying:m,isActive:p}}},66999:(e,t,i)=>{i.d(t,{r:()=>n.r});var n=i(96203)},67880:(e,t,i)=>{i.d(t,{_:()=>f,s:()=>h});var n=i(30758),a=i(97500),s=i.n(a),r=i(62411),o=i(58652),l=i(88025),c=i(78631),u=i(27733),d=i(37953),p=i(46628);const m="ffFwfKcPDbmAPLXzxzKq",g="jD_TVjbjclUwewP7P9e8",v="nZaXB942idDuiFv4bKNk",x="Fwe5dGEAgs_VFp4SPrzv",b="gchSBzolAjaPDHD1q0rA";var y=i(86070);const h=(0,n.createContext)(null),f=({label:e,style:t,focusTransferId:i,children:a,className:f,nodeRef:j})=>{const S=(0,n.useRef)(null),C=j??S,w=(0,u.S)(),N=(0,c.h)(),E=(0,r.d4)((e=>e.ui?.fullscreenMode?.isOpen??!1)),R=(0,d.XB)(),I=w===l.z.NOW_PLAYING_VIEW;return(0,o.X)(i??null,C),(0,y.jsx)(h.Provider,{value:C,children:(0,y.jsx)("aside",{"aria-label":e,className:s()(m,f,{[v]:I,[b]:E,[x]:N,[g]:R!==p.Z.Disabled&&R!==p.Z.NowPlayingView}),style:t,id:"Desktop_PanelContainer_Id",ref:C,tabIndex:-1,children:a})})}},69107:(e,t,i)=>{i.d(t,{t:()=>s});var n=i(46822),a=i(11338);function s(){return(0,n.N)(a.Z)}},70884:(e,t,i)=>{i.d(t,{I:()=>p});var n=i(99101),a=i(12599);var s=i(89723),r=i(69107),o=i(5305),l=i(16318),c=i(30758),u=i(59567),d=i(88308);function p(e){const t=function(e,t,i){const n=(0,r.t)(),a=(0,o.jE)(),p=(0,c.useMemo)((()=>Array.isArray(e)?e:[e]),[e]),m=(0,c.useMemo)((()=>Array.isArray(t)?t:[t]),[t]),g=(0,d.lB)((()=>["use-metadata-extensions",p,m]),[p,m]),v=(0,c.useCallback)((()=>{a.invalidateQueries({queryKey:g})}),[a,g]);(0,c.useEffect)((()=>n.getEvents().addListener(u.C.EXPIRE,(e=>{m.includes(e.data.extensionKind)&&e.data.entityUris.some((e=>p.includes(e)))&&v()}))),[n,p,m,v]);const x=(0,c.useCallback)((i=>{const n=i.map((e=>e.extensions));let a;return a=(0,s.yQ)(t)&&"string"==typeof e?n?.at(0)?.[t]:(0,s.yQ)(t)&&"string"!=typeof e?n.map((e=>e[t])):(0,s.yQ)(t)||"string"!=typeof e?n:n.at(0),a}),[e,t]);return(0,l.I)({...i,queryKey:g,queryFn:()=>n.fetch(p,m),select:x})}(e,s.UH.IDENTITY_TRAIT,{staleTime:36e5,gcTime:72e5,enabled:(0,n.H)()}).data?.contributors.at(0)?.uri;return function(e){const t=(0,a.o_h)(e);return(0,a.Exu)(t)?t:null}(t)}},77112:(e,t,i)=>{i.d(t,{$:()=>p});var n=i(30758),a=i(62411),s=i(57221),r=i(77312),o=i(17640),l=i(96381),c=i(28994),u=i(91780),d=i(86070);const p=({onClick:e})=>{const t=(0,a.wA)(),i=(0,c.Y)(),p=(0,n.useCallback)((async()=>{try{e(),await i()}catch(e){t((0,l.A9)(u.EL.ERROR))}}),[i,t,e]);return(0,d.jsx)(s.$,{iconLeading:r.V,size:"small",onClick:p,children:o.Ru.get("web-player.social-connect.menu-action.title")})}},89503:(e,t,i)=>{i.d(t,{T:()=>o});var n=i(30758),a=i(38916),s=i(5141),r=i(86070);const o=()=>{const{spec:e,logger:t,UBIFragment:i}=(0,s.r)(a.I,{});return{logUserClick:(0,n.useCallback)(((i,n)=>{t.logInteraction(e.participantListFactory().participantListRowFactory({position:i}).userLinkFactory().hitUiNavigate({destination:n}))}),[t,e]),logRemoveClick:(0,n.useCallback)((i=>{t.logInteraction(e.participantListFactory().participantListRowFactory({position:i}).removeButtonFactory().hitUiReveal())}),[t,e]),UBIFragmentWithSpec:(0,n.useCallback)((t=>(0,r.jsx)(i,{spec:e,...t})),[i,e])}}},98903:(e,t,i)=>{i.d(t,{$:()=>a});var n=i(30758);const a=()=>{const[e,t]=(0,n.useState)(document.hasFocus());return(0,n.useEffect)((()=>{function e(){t(!0)}function i(){t(!1)}return window.addEventListener("focus",e),window.addEventListener("blur",i),()=>{window.removeEventListener("focus",e),window.removeEventListener("blur",i)}}),[]),e}}}]);
//# sourceMappingURL=dwp-panel-section.js.map