"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[319],{1148:(e,t,i)=>{i.d(t,{a:()=>c});var n=i(5305),a=i(16318),s=i(12299),r=i(77817),l=i(30758);const o=["play-history-contents"];function c(){const e=(0,r.q)(),t=(0,n.jE)();return function(e,t){const i=(0,r.q)();(0,l.useEffect)((()=>i.getEvents().addListener(e,t)),[e,t,i])}(s.X.UPDATE,(e=>t.setQueryData(o,e.data))),(0,a.I)({queryKey:o,queryFn:()=>e.getContents(),gcTime:3e5,staleTime:0})}},5070:(e,t,i)=>{i.d(t,{c:()=>l});var n=i(30758),a=i(38398),s=i(21153),r=i(43996);function l(e,t){const i=(0,s.d)(),l=(0,r.J)(t),o=(0,a.a)();(0,n.useEffect)((()=>i.getBroadcastingEvents().addListener(e,(e=>{o()&&l(e)}))),[i,l,e,o])}},8371:(e,t,i)=>{i.d(t,{w:()=>b});var n=i(30758),a=i(97500),s=i.n(a),r=i(35152),l=i(27893),o=i(9286),c=i(743);const u="AAdBM1nhG73supMfnYX7",d="W3E0IT3_STcazjTeyOJa",p="mdMUqcSHFw1lZIcYEblu",m="cZCuJDjrGA2QMXja_Sua",g="zduvaX0Ioxqd5ypeWoAf";var v=i(86070);const x=({fixedHeader:e,scrollNodeRef:t,children:i,scrolledClassName:n})=>{const a=(0,o.y)(t);return(0,v.jsxs)("div",{className:s()(u),children:[(0,v.jsx)("div",{className:s()(d,{[n??p]:a}),children:e}),i]})},b=n.forwardRef((({children:e,className:t,fixedHeader:i,scrolledClassName:a},o)=>{const d=(0,n.useRef)(null);(0,l.g)(d);const p=(0,n.useMemo)((()=>({scrollNodeRef:d})),[d]),b=(0,v.jsx)(c.bi.Provider,{value:p,children:(0,v.jsx)(r.a,{className:m,scrollNodeRef:d,children:(0,v.jsx)("div",{ref:o,className:s()(u,g,t),children:e})})});return i?(0,v.jsx)(x,{fixedHeader:i,scrollNodeRef:d,scrolledClassName:a,children:b}):b}))},13886:(e,t,i)=>{i.d(t,{P:()=>n});const n=()=>!1},19494:(e,t,i)=>{i.d(t,{PanelSection:()=>Bm});var n=i(30758),a=i(94079),s=i(93960),r=i(18587),l=i(97500),o=i.n(l),c=i(77812),u=(i(19339),i(61902)),d=i(82499),p=i(44502),m=i(39736);const g="Xq5xnpTOsoPxFR95BkTU",v="N7OMJte9T4Lv7DDX16ky",x="NJATxQbY2o4sl0BHxU3T";var b=i(86070);const h=({children:e,className:t,...i})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.a,{panel:m.Z.Puffin,className:o()(v,t),...i}),e]});let y=function(e){return e.Overview="overview",e.ActivationIntro="activationIntro",e.ActivationDetection="activationDetection",e.ActivationSignifiers="activationSignifiers",e.Error="error",e.ManualSelection="manualSelection",e.AirpodsSelection="airpodsSelection",e.AudioQualitySettings="audioQualitySettings",e.AudioQualityDetails="audioQualityDetails",e.DiscoverLossless="discoverLossless",e.IncompatibleHeadphones="incompatibleHeadphones",e}({}),C=function(e){return e.GetStarted="getStarted",e.OnError="onError",e.SelectManually="selectManually",e.Continue="continue",e.Close="close",e.Activate="activate",e.SetupNewDevice="setupNewDevice",e.NotFound="notFound",e.Settings="settings",e.OnboardLossless="onboardLossless",e.Details="details",e.Airpods="airpods",e}({});var f=i(64232),j=i(65882);const S=[y.ActivationIntro,y.ActivationDetection,y.ActivationSignifiers,y.ManualSelection,y.AirpodsSelection],w=e=>{const t=(0,n.useRef)(!1),i=(0,j.z)(),a=(0,f.XB)();(0,n.useEffect)((()=>{const n=i.getState()?.isPaused,s=(r=e,l=a,S.includes(r)&&(l===m.Z.PuffinActivation||l===m.Z.PuffinActivationOverlay));var r,l;!s||n||t.current?!s&&n&&t.current&&(i.resume({featureIdentifier:"birdhouse"}),t.current=!1):(i.pause({featureIdentifier:"birdhouse"}),t.current=!0)}),[a,e,i])},N={[y.Overview]:{[C.GetStarted]:y.ActivationIntro,[C.OnError]:y.Error,[C.SelectManually]:y.ManualSelection,[C.Settings]:y.AudioQualitySettings,[C.OnboardLossless]:y.DiscoverLossless,[C.Details]:y.AudioQualityDetails},[y.ActivationIntro]:{[C.Close]:y.Overview,[C.OnError]:y.Error,[C.Continue]:y.ActivationDetection,[C.SelectManually]:y.ManualSelection,[C.Activate]:y.Overview},[y.ActivationDetection]:{[C.SelectManually]:y.ManualSelection,[C.Airpods]:y.AirpodsSelection,[C.Close]:y.Overview,[C.OnError]:y.Error,[C.Continue]:y.ActivationSignifiers},[y.ActivationSignifiers]:{[C.Close]:y.Overview,[C.OnError]:y.Error,[C.Activate]:y.Overview},[y.ManualSelection]:{[C.Continue]:y.ActivationSignifiers,[C.Close]:y.Overview,[C.OnError]:y.Error,[C.NotFound]:y.IncompatibleHeadphones},[y.AirpodsSelection]:{[C.Continue]:y.ActivationSignifiers,[C.Close]:y.Overview,[C.OnError]:y.Error,[C.NotFound]:y.Error},[y.DiscoverLossless]:{[C.Continue]:y.Overview},[y.AudioQualitySettings]:{},[y.AudioQualityDetails]:{},[y.Error]:{},[y.IncompatibleHeadphones]:{[C.Close]:y.Overview,[C.OnError]:y.Error,[C.Continue]:y.Overview}},E=(0,n.createContext)({currentView:y.Overview,viewTransitions:N,setCurrentView:()=>{},toPreviousView:()=>{},viewOptions:null}),R=({children:e})=>{const t=(0,f.XB)(),[i,a]=(0,n.useState)((()=>(e=>[{view:e===m.Z.PuffinActivation||e===m.Z.PuffinActivationOverlay?y.ActivationDetection:y.Overview,options:{}}])(t))),s=(0,n.useCallback)(((e,t)=>{e===y.Overview?a([{view:e,options:t??{}}]):a((i=>[...i,{view:e,options:t??{}}]))}),[]),r=(0,n.useCallback)((()=>{a((e=>e.slice(0,-1)))}),[]);if(0===i.length)throw new Error("Puffin view state stack should never be empty");const{view:l,options:o}=i.at(-1);w(l);const c=(0,n.useMemo)((()=>({currentView:l,viewOptions:o,setCurrentView:s,toPreviousView:r,viewTransitions:N})),[l,s,r,o]);return(0,b.jsx)(E.Provider,{value:c,children:e})},k="EqLKhgGIINyN_LINFjl1",I="OyIY0v1_h3UWgLlxyPHL",L=({resetError:e})=>{const{toPreviousView:t,setCurrentView:i}=(0,n.useContext)(E);return(0,b.jsx)(h,{onBack:()=>{t()},children:(0,b.jsxs)("div",{className:k,children:[(0,b.jsx)(u.b,{size:"xlarge",semanticColor:"textBase"}),(0,b.jsxs)("div",{className:I,children:[(0,b.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",children:"Something went wrong"}),(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:"We couldnâ€™t turn on your headphone tools."})]}),(0,b.jsx)(d.$,{colorSet:"invertedLight",size:"medium",onClick:()=>{e?.(),i(y.Overview)},children:"Retry"})]})})},A=({resetError:e})=>(0,b.jsx)(L,{resetError:e});var T=i(12580),D=i(62411),O=i(79252),_=i(48391),B=i(56957),F=i(26729),U=i(70961),P=i(71726),H=i(13478);const M=()=>{const e=(0,D.d4)((e=>e.platform.isDesktop)),t=(0,B.b)(),i=(0,_.lS)(t),{isPlayingRemotely:a,remoteDeviceName:s,isConnected:r}=(0,U.v)((e=>{const t=(0,F.V)(e);return{isPlayingRemotely:t.isPlayingRemotely,remoteDeviceName:t.remoteDevice?.name,isConnected:t.connectionStatus===P.zP.CONNECTED}}),H.a),l=(0,n.useMemo)((()=>e?O.Ru.get("web-player.connect.device-picker.this-computer"):O.Ru.get("web-player.connect.device-picker.this-web-browser")),[e]),o=(0,n.useMemo)((()=>{if(t)return e?O.Ru.get("web-player.connect.device-picker.from-this-computer",{device_name:t.name}):O.Ru.get("web-player.connect.device-picker.from-this-web-browser",{device_name:t.name})}),[e,t]);if(s&&a&&r)return{deviceName:s,playingFrom:s};if(t?.transportType===_.Yg.AIRPLAY||t?.transportType===_.Yg.BLUETOOTH&&t?.terminalType===_.FI.SPEAKERS)return{deviceName:t?.name,playingFrom:l,formattedDeviceName:o};if(i){if(t?.transportType===_.Yg.BUILT_IN||t?.transportType===_.Yg.USB)return{deviceName:O.Ru.get("web-player.puffin.wired-connection"),playingFrom:l};if(t?.name&&t?.terminalType===_.FI.HEADPHONES)return{deviceName:t?.name,playingFrom:l,formattedDeviceName:o}}return{deviceName:l,playingFrom:l}},V=()=>{const{deviceName:e}=M();return(0,b.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",children:e})};var z=i(13886),q=i(53514),Y=i(74513),G=i(50597),Q=i(66912);const Z=({onClick:e})=>{const{playingFrom:t}=M(),i=(0,G.t)(),[{data:n}]=(0,Q.K)(i.quality.streamingQuality);return void 0===n?null:(0,b.jsx)(q.v,{id:"qualitySetting",variant:"naked",title:O.Ru.get("desktop.settings.streamingQuality"),leading:(0,b.jsx)(Y.s,{size:"small"}),subtitle:t,onClick:e,padding:"0px 12px"})};var K=i(96536),W=i(74520),J=i(65624),X=i(66108);const $=({title:e,description:t,confirmButtonText:i="OK",cancelButtonText:a="Cancel",onConfirm:s,onClose:r})=>{const{setCurrentView:l}=(0,n.useContext)(E),o=(0,f._Y)(),[c,u]=(0,n.useState)(!1),d=(0,n.useRef)(!1);return{dialog:c?(0,b.jsx)(J.T,{onClose:()=>{u(!1),r?.()},onConfirm:()=>{s(),d.current?o(X.$S.PUFFIN_BUTTON_CLICK):l(y.Overview)},titleText:e,"aria-label":e,descriptionText:t,cancelText:a,confirmText:i}):null,triggerDialog:(e=!1)=>{d.current=e,u(!0)}}};var ee=i(72599),te=i(37913);const ie=()=>{const e=(0,te.N)();return{setCurrentDevice:(0,n.useCallback)(((t,i)=>{e.setCurrentDevice(t,i)}),[e]),removeCurrentDevice:(0,n.useCallback)((t=>{e.removeCurrentDevice(t)}),[e])}};var ne=i(15845);const ae=({spec:e})=>{const t=(0,ne.s)(),i=(0,n.useRef)(null),{removeCurrentDevice:a}=ie(),{deviceFilterState:s}=(0,ee.j)();(0,W.X)("RESET_HEADPHONES_BUTTON",i);const{triggerDialog:r,dialog:l}=$({title:O.Ru.get("web-player.puffin.reset-headphones.dialog.title"),description:O.Ru.get("web-player.puffin.reset-headphones.dialog.subtitle"),confirmButtonText:O.Ru.get("web-player.puffin.reset-headphones.dialog.confirm"),onConfirm:()=>{a(!0),(0,W.I)("SETUP_HEADPHONES_BUTTON")},onClose:()=>{(0,W.I)("RESET_HEADPHONES_BUTTON")}});return s.isOnboarded?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(q.v,{id:"resetHeadphonesButton",ref:i,variant:"naked",title:O.Ru.get("web-player.puffin.reset-headphones.menu-item"),leading:(0,b.jsx)(K.x,{size:"small"}),onClick:i=>{t.logInteraction(e.resetHeadphonesButtonFactory().hitUiReveal()),i.preventDefault(),r(!1)},padding:"0px 12px"}),l]}):null};var se=i(48240);const re=({isPlayingRemotely:e,spec:t})=>{const i=(0,ne.s)(),{setCurrentView:a,viewTransitions:s}=(0,n.useContext)(E),r=s[y.Overview],l=(0,z.P)(),o=(0,se.j)();return(0,b.jsxs)("div",{children:[o&&(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(Z,{onClick:()=>{i.logInteraction(t.qualitySettingsButtonFactory().hitUiReveal()),a(r.settings)}})}),!e&&!l&&(0,b.jsx)(ae,{spec:t})]})},le=()=>null;var oe=i(33160),ce=i(10728);const ue="k4f1o0jOMnxv6OS8dC7p",de="PYLIWbzDyJA6Mbh2EQQg",pe="r3oTh3jKov0cW3m5qF1N",me=({title:e,subtitle:t,buttonLabel:i,onClick:a,dismissButtonLabel:s,onDismissClick:r,focusTransferKey:l=null})=>{const o=(0,n.useRef)(null);return(0,W.X)(l,o),(0,b.jsx)(q.v,{variant:"naked",size:"lg",id:"getStarted",className:ue,title:e,subtitle:t,paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,b.jsxs)("div",{className:de,children:[(0,b.jsx)(oe.n,{size:"small",onClick:a,ref:o,children:(0,b.jsx)(c.E,{variant:"bodySmallBold",children:i})}),s&&r&&(0,b.jsx)(ce.H,{className:pe,size:"small",onClick:r,children:(0,b.jsx)(c.E,{variant:"bodySmallBold",children:s})})]})})};var ge=i(11926),ve=i(57743),xe=i(41423);const be=e=>{switch(e){case xe.Yn.LOSSLESS_24:return{title:O.Ru.get("web-player.pigeon.audio-quality.lossless"),titleFull:O.Ru.get("web-player.pigeon.audio-quality.lossless-24.label"),bitrateLabel:O.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate"),bitrateDetails:[O.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-1"),O.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-2")]};case xe.Yn.LOSSLESS:return{title:O.Ru.get("web-player.pigeon.audio-quality.lossless"),titleFull:O.Ru.get("web-player.pigeon.audio-quality.lossless-16.label"),bitrateLabel:O.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate"),bitrateDetails:[O.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate-details-1"),O.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate-details-2")]};case xe.Yn.VERY_HIGH:return{title:O.Ru.get("web-player.pigeon.audio-quality.very-high.label"),bitrateLabel:O.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate"),bitrateDetails:[O.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate-details")]};case xe.Yn.HIGH:return{title:O.Ru.get("web-player.pigeon.audio-quality.high.label"),bitrateLabel:O.Ru.get("web-player.pigeon.audio-quality.high.bitrate"),bitrateDetails:[O.Ru.get("web-player.pigeon.audio-quality.high.bitrate-details")]};case xe.Yn.NORMAL:return{title:O.Ru.get("web-player.pigeon.audio-quality.normal.label"),bitrateLabel:O.Ru.get("web-player.pigeon.audio-quality.normal.bitrate"),bitrateDetails:[O.Ru.get("web-player.pigeon.audio-quality.normal.bitrate-details")]};case xe.Yn.LOW:return{title:O.Ru.get("web-player.pigeon.audio-quality.low.label"),bitrateLabel:O.Ru.get("web-player.pigeon.audio-quality.low.bitrate"),bitrateDetails:[O.Ru.get("web-player.pigeon.audio-quality.low.bitrate-details")]};case xe.Yn.UNKNOWN:default:return{title:O.Ru.get("web-player.pigeon.audio-quality.unknown.label"),bitrateLabel:null}}},he="SsVVyvM7DIniTIOjJFuM",ye="dHDe0DUG4UkEeM8p5PEa",Ce="T49oF8shvnsadykMrogA",fe=({quality:e,onClick:t})=>{const i=be(e),n=[xe.Yn.VERY_HIGH,xe.Yn.HIGH,xe.Yn.NORMAL,xe.Yn.LOW];e===xe.Yn.LOSSLESS_24?n.unshift(xe.Yn.LOSSLESS_24):n.unshift(xe.Yn.LOSSLESS);const a=e===xe.Yn.UNKNOWN?"textBase":"textBrightAccent";return(0,b.jsxs)(ge.a,{as:"button",variant:"tinted",className:he,onClick:t,children:[(0,b.jsx)(q.v,{id:"quality",size:"lg",pretitle:O.Ru.get("web-player.pigeon.overview-card.title"),titleGap:ve.v4,title:(0,b.jsx)(c.E,{variant:"titleSmall",semanticColor:a,children:i.titleFull||i.title}),paddingInlineStart:"0px",paddingInlineEnd:"0px",variant:"naked"}),(0,b.jsx)("div",{children:n.map(((t,i)=>{const n=be(t),a=t===e,s=a?"textBrightAccent":"textSubdued";return(0,b.jsx)(q.v,{id:n.title,size:"sm",paddingInlineStart:"0px",paddingInlineEnd:"0px",media:(0,b.jsx)("div",{className:o()(ye,{[Ce]:a})}),title:(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:s,children:n.title}),trailing:(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:s,children:n.bitrateLabel}),variant:"naked"},i)}))})]})};var je=i(67307),Se=i(60715),we=i(14895);const Ne="DkXvfK4ARoLCRa6fJghA",Ee=({quality:e,onClick:t})=>{const i=be(e);return(0,b.jsx)(q.v,{id:"qualityV2",variant:"tinted",verticalGap:"2px",paddingInlineStart:"16px",paddingInlineEnd:"16px",pretitle:(0,we.v)("File quality in"),title:null,footer:(0,b.jsx)(q.v,{id:"qualityV2Settings",paddingBlockStart:"0px",paddingBlockEnd:"0px",paddingInlineStart:"0px",paddingInlineEnd:"0px",variant:"naked",size:"md",title:(0,b.jsx)(je.d,{lineClamp:2,variant:"titleSmall",children:(0,b.jsxs)("div",{className:Ne,children:[(0,b.jsx)(Se.A,{size:"medium"}),(0,b.jsx)(c.E,{variant:"titleSmall",children:i.titleFull||i.title})]})}),subtitle:(0,b.jsx)(b.Fragment,{children:i.bitrateDetails?.map(((e,t)=>(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:e},`bitrate-details-${t}`)))}),trailing:(0,b.jsx)(ce.H,{size:"small",iconOnly:Y.s,onClick:t,label:O.Ru.get("keyboard.shortcuts.description.goToPreferences")})})})};var Re=i(76137);const ke=()=>(0,Re.x)("onboarding-dismissed:lossless",!1);var Ie=i(33924),Le=i(25445);const Ae=({spec:e})=>{const t=(0,ne.s)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(E),s=a[y.Overview],r=(0,se.j)(),l=(0,Le.A)(),o=(0,Ie.g)(),c=(0,z.P)(),[u]=ke();return r?(0,b.jsxs)(b.Fragment,{children:[!u&&(0,b.jsx)(me,{title:O.Ru.get("web-player.pigeon.get-started.title"),subtitle:O.Ru.get("web-player.pigeon.get-started.subtitle"),buttonLabel:O.Ru.get("web-player.pigeon.get-started.button"),onClick:()=>{t.logInteraction(e.losslessOnboardingButtonFactory().hitUiReveal()),i(s.onboardLossless)}}),c?(0,b.jsx)(Ee,{quality:l,onClick:()=>{o("/preferences?highlight=audio-quality")}}):(0,b.jsx)(fe,{quality:l,onClick:()=>{t.logInteraction(e.audioQualityCardFactory().hitUiReveal()),i(s.details)}})]}):null},Te=({isError:e})=>e?(0,b.jsx)(q.v,{id:"filterError",variant:"tinted",paddingBlockStart:"12px",paddingBlockEnd:"12px",paddingInlineStart:"16px",paddingInlineEnd:"16px",leading:(0,b.jsx)(u.b,{semanticColor:"textSubdued",size:"small"}),title:O.Ru.get("web-player.puffin.error-troubleshooting")}):null;var De=i(64439);const Oe="jvVll3Ia4Nrq9Fsd78Fo",_e="d_HhOkLKxYpYKpP2gQy7",Be="fLp9X9keK84drMHcmOFW",Fe=({currentDeviceState:e,spec:t})=>{const i=(0,ne.s)(),a=(0,n.useCallback)((()=>{i.logInteraction(t.optimizeToggleFactory().hitUiElementToggle()),e.toggleTuneHeadphones?.()}),[e,i,t]),s=null!==e.toggleTuneHeadphones,{specificRestricted:r,processingCapabilitiesRestricted:l}=e.contentRestrictions,o=(0,n.useMemo)((()=>r||l?O.Ru.get("web-player.puffin.enhancement-unavailable.content-restriction"):(s||O.Ru.get("web-player.puffin.listening-with.filters.specific-subtitle-unavailable"),O.Ru.get("web-player.puffin.listening-with.filters.specific-subtitle"))),[s,l,r]);return(0,b.jsx)("div",{className:Oe,children:(0,b.jsx)(q.v,{variant:"naked",size:"md",id:"headphones",className:_e,disabled:r||l||!s,title:(0,b.jsx)(je.d,{className:Be,children:O.Ru.get("web-player.puffin.listening-with.filters.specific-title")}),subtitle:o,trailing:(0,b.jsx)(De.l,{id:"headphoneTunes",onSelected:a,disabled:r||l,value:e.currentState.specificEnabled,condensed:!0})})})},Ue="bLEXMWOER6nmfeLfBRIN",Pe=({spec:e})=>{const t=(0,ne.s)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(E),s=a[y.Overview],{deviceFilterState:r}=(0,ee.j)(),l=r.isOnboarded;return(0,b.jsx)(q.v,{id:"listeningWith",variant:"tinted",pretitle:O.Ru.get("web-player.puffin.listening-with.model"),horizontalGap:"0px",paddingBlockStart:"12px",paddingBlockEnd:"12px",paddingInlineStart:"16px",paddingInlineEnd:"16px",className:Ue,trailing:(0,b.jsx)(oe.n,{size:"small",onClick:()=>{t.logInteraction(e.changeModelButtonFactory().hitUiReveal()),i(s.selectManually)},children:(0,b.jsx)(c.E,{variant:"bodySmallBold",children:O.Ru.get("web-player.puffin.listening-with.change-model")})}),footer:l&&(0,b.jsx)(Fe,{currentDeviceState:r,spec:e}),title:(0,b.jsx)(je.d,{lineClamp:2,children:r.headphoneDevice?.deviceName??O.Ru.get("web-player.puffin.listening-with.placeholder-model")})})};var He=i(76321),Me=i(15428);const Ve="r2vYR6suFxgB5_dQhF_5",ze="u1TzXrhJQWI79pWRWFVG",qe=({spec:e})=>{const t=(0,ne.s)(),i=(0,n.useRef)(null),{removeCurrentDevice:a}=ie(),{deviceFilterState:s}=(0,ee.j)();(0,W.X)("RESET_HEADPHONES_BUTTON",i);const{triggerDialog:r,dialog:l}=$({title:O.Ru.get("web-player.puffin.reset-headphones.dialog.title"),description:O.Ru.get("web-player.puffin.reset-headphones.dialog.subtitle"),confirmButtonText:O.Ru.get("web-player.puffin.reset-headphones.dialog.confirm"),onConfirm:()=>{a(!0),(0,W.I)("SETUP_HEADPHONES_BUTTON")},onClose:()=>{(0,W.I)("RESET_HEADPHONES_BUTTON")}});return s.isOnboarded?(0,b.jsxs)("div",{className:Ve,children:[(0,b.jsx)("div",{className:ze,children:(0,b.jsx)(ce.H,{onClick:i=>{t.logInteraction(e.resetHeadphonesButtonFactory().hitUiReveal()),i.preventDefault(),r(!1)},iconLeading:K.x,size:"small",children:(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBase",children:(0,we.v)("Remove headphones")})})}),l]}):null},Ye="zGQ0s1caxUyi77kMOS_z",Ge="Ea60f3xHEWIFAM3mTuq2",Qe=({spec:e})=>{const t=(0,ne.s)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(E),s=a[y.Overview],{deviceFilterState:r}=(0,ee.j)(),l=r.isOnboarded,o=r.currentState.externalizationEnabled||r.currentState.specificEnabled;return(0,b.jsx)(q.v,{id:"listeningWith",variant:"tinted",horizontalGap:"0px",paddingBlockStart:"12px",paddingBlockEnd:"12px",paddingInlineStart:"16px",paddingInlineEnd:"16px",className:Ye,pretitle:(0,we.v)("Selected model"),title:(0,b.jsx)(je.d,{lineClamp:2,children:(0,b.jsxs)("div",{className:Ge,children:[o?(0,b.jsx)(He.C,{size:"medium"}):(0,b.jsx)(Me.r,{size:"medium"}),(0,b.jsx)(c.E,{variant:"titleSmall",children:r.headphoneDevice?.deviceName??O.Ru.get("web-player.puffin.listening-with.placeholder-model")})]})}),trailing:(0,b.jsx)(ce.H,{size:"small",onClick:()=>{t.logInteraction(e.changeModelButtonFactory().hitUiReveal()),i(s.selectManually)},iconOnly:Y.s}),footer:l&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Fe,{currentDeviceState:r,spec:e}),(0,b.jsx)(qe,{spec:e})]})})},Ze=({spec:e})=>{const{setCurrentView:t,viewTransitions:i}=(0,n.useContext)(E),a=i[y.Overview],{deviceFilterState:s,isMaybeHeadphoneDevice:r,isError:l,isLoading:o}=(0,ee.j)(),c=(0,ne.s)(),{triggerDialog:u,dialog:d,isHiddenByUser:p}=(()=>{const{deviceFilterState:e}=(0,ee.j)(),t=e.audioDevice?.id,[i,a]=(0,Re.x)("puffin-hide-get-started",[]),s=(0,n.useMemo)((()=>!!t&&i.includes(t)),[t,i]),r=(0,n.useCallback)((()=>{if(t){const e=[...i,t].slice(-50);a(e)}}),[t,a,i]);return{...$({title:O.Ru.get("web-player.puffin.dismiss-get-started.title"),description:O.Ru.get("web-player.puffin.dismiss-get-started.body"),confirmButtonText:O.Ru.get("hifi.yes"),cancelButtonText:O.Ru.get("web-player.puffin.dismiss-get-started.cancel"),onConfirm:()=>{r()}}),isHiddenByUser:s}})(),m=(0,z.P)(),g=s.isOnboarded,v=r&&!g&&!p,x=(0,n.useCallback)((()=>{c.logInteraction(e.setupHeadphonesButtonFactory().hitUiReveal()),s.audioDevice?t(a.getStarted):t(a.selectManually,{showDialogOnBack:!0})}),[c,e,s.audioDevice,t,a.getStarted,a.selectManually]);return r?l||o?(0,b.jsx)(Te,{isError:l}):(0,b.jsxs)(b.Fragment,{children:[d,g&&(m?(0,b.jsx)(Qe,{spec:e}):(0,b.jsx)(Pe,{spec:e})),v&&(0,b.jsx)(me,{title:O.Ru.get("web-player.puffin.get-started.title"),subtitle:O.Ru.get("web-player.puffin.get-started.subtitle"),buttonLabel:O.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm"),onClick:x,dismissButtonLabel:O.Ru.get("web-player.puffin.upsell.enhance-headphones.not-headphones"),onDismissClick:u,focusTransferKey:"SETUP_HEADPHONES_BUTTON"})]}):null};var Ke=i(89040),We=i(3161);const Je="TJAbLKl8aSWZqWk4EFkk",Xe=X.$S.DEVICE_PICKER_BUTTON_CLICK,$e=()=>{const e=(0,F.l)(),{panelSend:t}=(0,f.AI)(m.Z.DevicePicker,m.Z.DevicePickerOverlay),i=(0,z.P)(),a=(0,se.j)(),s=(0,Ke.v)(),{spec:r,logger:l}=(0,We.r)(T.R,{}),o=!e&&s,c=(0,n.useCallback)((()=>{l.logInteraction(r.backButtonFactory().hitUiReveal()),t(Xe)}),[l,t,r]);return(0,b.jsx)(h,{onBack:c,onClose:()=>{l.logInteraction(r.closeButtonFactory().hitUiHide())},children:(0,b.jsxs)("div",{className:Je,children:[(0,b.jsx)(V,{}),i&&(0,b.jsx)(le,{}),a&&(0,b.jsx)(Ae,{spec:r}),o&&(0,b.jsx)(Ze,{spec:r}),(0,b.jsx)(re,{isPlayingRemotely:e,spec:r})]})})};var et=i(51038),tt=i(8371),it=i(61528),nt=i(58206);let at=function(e){return e.INFO="INFO",e.ERROR="ERROR",e}({});function st(e){return e.type===at.ERROR}function rt(e){return e.type===at.INFO}var lt=i(23499);const ot="UPAv6TbmqM79jDLYgiad",ct=({card:{type:e,id:t,title:i,text:n}})=>(0,b.jsx)(q.v,{id:t,className:ot,variant:"tinted",leading:e===at.ERROR?(0,b.jsx)(it.Z,{size:"small",semanticColor:"textWarning"}):null,title:(0,b.jsx)(je.d,{variant:"bodyMedium",children:i}),body:"string"==typeof n?(0,b.jsx)(lt.y,{LinkComponent:nt.N,source:n,splitter:/\|/g,semanticColor:"textSubdued",variant:"mesto"}):n});var ut=i(16523),dt=i(91756);const pt="GdqxZ88oz8MtwHaBnwgb",mt="Q4TWj1C8EEkH_beo9jI8",gt="slKZiyNh_zlnTSEo8VG7",vt="ichtbB4QY2SKusRio97a",xt="xTMuOBwhiZlpUZtnm0M6";let bt=function(e){return e[e.PASSING=0]="PASSING",e[e.NEEDS_ATTENTION=1]="NEEDS_ATTENTION",e[e.UNKNOWN=2]="UNKNOWN",e}({});const ht=({metric:e,label:t,severity:i})=>(0,b.jsxs)("div",{className:o()(pt,{[vt]:i===bt.UNKNOWN}),children:[(()=>{switch(i){case bt.PASSING:return(0,b.jsx)(ut.k,{size:"large",className:mt,semanticColor:"textBase"});case bt.NEEDS_ATTENTION:return(0,b.jsx)(it.Z,{size:"large",className:gt,semanticColor:"textWarning"});case bt.UNKNOWN:return(0,b.jsx)(dt.N,{size:"large",className:gt,semanticColor:"textBase"});default:return null}})(),(0,b.jsxs)("div",{className:xt,children:[(0,b.jsx)(c.E,{as:"p",variant:"bodyMedium",semanticColor:"textBase",children:e}),(0,b.jsx)(c.E,{as:"p",semanticColor:"textSubdued",variant:"bodySmall",children:t})]})]});let yt=function(e){return e.bitrateLevel="bitrateLevel",e.targetBitrateLevel="targetBitrateLevel",e.targetBitrateAvailable="targetBitrateAvailable",e.strategy="strategy",e.isLocal="isLocal",e.autoAdjust="autoAdjust",e.deviceSupported="deviceSupported",e}({}),Ct=function(e){return e.Bluetooth_Degrades_Lossless="Bluetooth_Degrades_Lossless",e.Connect_Explanation="Connect_Explanation",e.Default_To_Very_High="Default_To_Very_High",e.Need_To_Redownload="Need_To_Redownload",e.Opt_Out_Of_Downgrade="Opt_Out_Of_Downgrade",e.Poor_Bandwidth_Interferes="Poor_Bandwidth_Interferes",e.Lossless_Unavailable="Lossless_Unavailable",e.Listen_Offline="Listen_Offline",e.Update_Setting="Update_Setting",e}({}),ft=function(e){return e[e.Internet=0]="Internet",e[e.Spotify_Connect=1]="Spotify_Connect",e[e.Downloads=2]="Downloads",e}({}),jt=function(e){return e.Good="good",e.Poor="poor",e.Unknown="unknown",e.Unavailable="unavailable",e}({});const St=[{criteria:{online:!0,autoAdjust:!1,trackLosslessAvailable:!0},result:Ct.Opt_Out_Of_Downgrade},{criteria:{online:!0,streamingLossless:!1,targetingLossless:!0,deviceCompatible:!0,internetBandwidth:jt.Poor,trackLosslessAvailable:!0},result:Ct.Poor_Bandwidth_Interferes},{criteria:{online:!0,autoAdjust:!0,streamingLossless:!1,targetingLossless:!1,deviceCompatible:!0,internetBandwidth:jt.Poor,trackLosslessAvailable:!0},result:Ct.Default_To_Very_High},{criteria:{online:!0,streamingLossless:!1,bitrateStrategy:[xe.ZT.OFFLINED_FILE],trackLosslessAvailable:!0},result:Ct.Need_To_Redownload},{criteria:{online:!0,targetingLossless:!0,trackLosslessAvailable:!1},result:Ct.Lossless_Unavailable},{criteria:{online:!0,isSetStreamingQualityLessThanLossless:!0},result:Ct.Update_Setting}];const wt=[{criteria:{bitrateLevel:[xe.Yn.LOSSLESS],strategy:[xe.ZT.BEST_MATCHING,xe.ZT.BACKEND_ADVISED,xe.ZT.CACHED_FILE],deviceSupported:!0,autoAdjust:!0},result:jt.Good},{criteria:{bitrateLevel:[xe.Yn.LOW,xe.Yn.NORMAL,xe.Yn.HIGH,xe.Yn.VERY_HIGH],targetBitrateLevel:[xe.Yn.LOW,xe.Yn.NORMAL,xe.Yn.HIGH,xe.Yn.VERY_HIGH],strategy:[xe.ZT.BEST_MATCHING,xe.ZT.CACHED_FILE],deviceSupported:!0,autoAdjust:!0},result:jt.Good},{criteria:{bitrateLevel:[xe.Yn.LOW,xe.Yn.NORMAL,xe.Yn.HIGH,xe.Yn.VERY_HIGH],targetBitrateLevel:[xe.Yn.LOSSLESS],strategy:[xe.ZT.BEST_MATCHING,xe.ZT.BACKEND_ADVISED,xe.ZT.CACHED_FILE],targetBitrateAvailable:!0,deviceSupported:!0,autoAdjust:!0},result:jt.Poor},{criteria:{bitrateLevel:[xe.Yn.LOW,xe.Yn.NORMAL,xe.Yn.HIGH,xe.Yn.VERY_HIGH],targetBitrateLevel:[xe.Yn.LOW,xe.Yn.NORMAL,xe.Yn.HIGH,xe.Yn.VERY_HIGH],strategy:[xe.ZT.BACKEND_ADVISED],deviceSupported:!0,autoAdjust:!0},result:jt.Poor},{criteria:{bitrateLevel:[xe.Yn.LOW,xe.Yn.NORMAL,xe.Yn.HIGH,xe.Yn.VERY_HIGH],targetBitrateLevel:[xe.Yn.LOSSLESS],targetBitrateAvailable:!1,deviceSupported:!0,autoAdjust:!0},result:jt.Unavailable},{criteria:{autoAdjust:!1},result:jt.Unknown},{criteria:{deviceSupported:!1},result:jt.Unknown}],Nt=[{criteria:{bitrateLevel:[xe.Yn.LOSSLESS,xe.Yn.LOSSLESS_24],deviceSupported:!0},result:!0},{criteria:{bitrateLevel:[xe.Yn.UNKNOWN,xe.Yn.LOW,xe.Yn.NORMAL,xe.Yn.HIGH,xe.Yn.VERY_HIGH],strategy:[xe.ZT.BEST_MATCHING,xe.ZT.BACKEND_ADVISED,xe.ZT.CACHED_FILE],targetBitrateLevel:[xe.Yn.LOSSLESS,xe.Yn.LOSSLESS_24],targetBitrateAvailable:!0,deviceSupported:!0},result:!0},{criteria:{bitrateLevel:[xe.Yn.UNKNOWN,xe.Yn.LOW,xe.Yn.NORMAL,xe.Yn.HIGH,xe.Yn.VERY_HIGH],strategy:[xe.ZT.OFFLINED_FILE],targetBitrateLevel:[xe.Yn.LOSSLESS,xe.Yn.LOSSLESS_24],targetBitrateAvailable:!0,deviceSupported:!0},result:!1},{criteria:{strategy:[xe.ZT.BEST_MATCHING,xe.ZT.BACKEND_ADVISED,xe.ZT.CACHED_FILE],targetBitrateAvailable:!0,deviceSupported:!0},result:!1},{criteria:{deviceSupported:!1},result:!0},{criteria:{bitrateLevel:[xe.Yn.UNKNOWN,xe.Yn.LOW,xe.Yn.NORMAL,xe.Yn.HIGH,xe.Yn.VERY_HIGH],targetBitrateLevel:[xe.Yn.LOSSLESS,xe.Yn.LOSSLESS_24],targetBitrateAvailable:!1,deviceSupported:!0},result:!0},{criteria:{targetBitrateLevel:[xe.Yn.LOSSLESS,xe.Yn.LOSSLESS_24]},result:!0}],Et=(e,t)=>{for(const[i,n]of Object.entries(t.criteria))if(i===yt.bitrateLevel){if(!n.includes(e[yt.bitrateLevel]))return!1}else if(i===yt.targetBitrateLevel){if(!n.includes(e[yt.targetBitrateLevel]))return!1}else if(i===yt.strategy){if(!n.includes(e[yt.strategy]))return!1}else{if(!n===e[i])return!1}return!0},Rt=e=>[xe.Yn.LOSSLESS,xe.Yn.LOSSLESS_24].includes(e);var kt=i(42310),It=i(96571),Lt=i(81882),At=i(92505);const Tt={losslessStatus:xe.p4.NONE,bitrateLevel:xe.Yn.UNKNOWN,targetBitrateLevel:xe.Yn.UNKNOWN,targetBitrateAvailable:!1,strategy:xe.ZT.UNKNOWN};function Dt(){const{losslessStatus:e,bitrateLevel:t,targetBitrateLevel:i,targetBitrateAvailable:a,strategy:s}=(0,At.o)((e=>({...Tt,...e?.playbackQuality??null})),H.a),r=(0,F.l)(),l=(0,G.t)(),[{data:o}]=(0,Q.K)(l.quality.streamingQuality),[{data:c}]=(0,Q.K)(l.quality.remoteQuality),u=(0,U.v)((e=>e.activeDevice)),d=(0,n.useMemo)((()=>null!==u&&u.losslessSupport?u.losslessSupport:{fullySupported:!1,deviceSupported:!1,userEligible:!1}),[u]).deviceSupported,{settings:{values:p}}=(0,It.t0)(),m=p["audio.allow_downgrade"],g=u?.isLocal||!1;let v;v=g?s===xe.ZT.CACHED_FILE||s===xe.ZT.OFFLINED_FILE?ft.Downloads:ft.Internet:ft.Spotify_Connect;const x={bitrateLevel:t,targetBitrateLevel:i,targetBitrateAvailable:a,strategy:s,isLocal:g,deviceSupported:d,autoAdjust:m},b=(e=>{for(const t of Nt)if(Et(e,t))return t.result;return!(!Rt(e[yt.bitrateLevel])&&!Rt(e[yt.targetBitrateLevel]))})(x),h=(e=>{for(const t of wt)if(Et(e,t))return t.result;return e[yt.strategy]===xe.ZT.BACKEND_ADVISED?jt.Poor:jt.Good})(x),y=(0,Lt.n)(),C=Rt(i)&&a,f=Rt(t),j=Rt(i),S=r?c?.streamingQuality:o,w=function({online:e,streamingLossless:t,targetingLossless:i,strategy:n,trackLosslessAvailable:a,autoAdjust:s,internetBandwidth:r,losslessCompatibleDevice:l,isLocal:o,isSetStreamingQualityLessThanLossless:c}){const u=[Ct.Listen_Offline,Ct.Connect_Explanation,Ct.Bluetooth_Degrades_Lossless];for(const d of St){const{criteria:p,result:m}=d;p.online===e&&(void 0!==p.autoAdjust&&p.autoAdjust!==s||void 0!==p.streamingLossless&&p.streamingLossless!==t||void 0!==p.targetingLossless&&p.targetingLossless!==i||void 0!==p.deviceCompatible&&p.deviceCompatible!==l||void 0!==p.bitrateStrategy&&!1===o||(void 0===p.bitrateStrategy||void 0!==n&&p.bitrateStrategy.includes(n))&&(void 0!==p.internetBandwidth&&p.internetBandwidth!==r||void 0!==p.trackLosslessAvailable&&p.trackLosslessAvailable!==a||void 0!==p.isSetStreamingQualityLessThanLossless&&p.isSetStreamingQualityLessThanLossless!==c||u.push(m)))}return u}({online:y,streamingLossless:f,targetingLossless:j,strategy:s,trackLosslessAvailable:C,autoAdjust:m,internetBandwidth:h,losslessCompatibleDevice:d,isLocal:g,isSetStreamingQualityLessThanLossless:!!S&&S<kt.a1.LOSSLESS&&S>kt.a1.AUTOMATIC});return{losslessStatus:e,bitrateLevel:t,flags:w,internetBandwidth:h,playingVia:{channelIsLossless:b,channel:v},losslessCompatibleDevice:d}}const Ot=()=>{const{losslessCompatibleDevice:e,playingVia:t,internetBandwidth:i}=Dt();return(0,b.jsxs)("div",{children:[(0,b.jsx)(ht,{metric:O.Ru.get("web-player.pigeon.audio-quality.lossless-compatible-device"),label:e?O.Ru.get("hifi.yes"):O.Ru.get("hifi.no"),severity:e?bt.PASSING:bt.NEEDS_ATTENTION}),(0,b.jsx)(ht,{metric:O.Ru.get("hifi.playingVia"),label:(()=>{const{channel:e}=t;switch(e){case ft.Downloads:return O.Ru.get("local-files.source.downloads");case ft.Internet:return O.Ru.get("hifi.networkConnection");case ft.Spotify_Connect:return O.Ru.get("spotify-connect");default:return""}})(),severity:t.channelIsLossless?bt.PASSING:bt.NEEDS_ATTENTION}),(0,b.jsx)(ht,{metric:O.Ru.get("hifi.internetBandwidth"),label:(()=>{switch(i){case jt.Good:return O.Ru.get("hifi.good");case jt.Poor:return O.Ru.get("hifi.poor");case jt.Unknown:default:return O.Ru.get("hifi.unknown")}})(),severity:(()=>{switch(i){case jt.Good:return bt.PASSING;case jt.Poor:return bt.NEEDS_ATTENTION;case jt.Unknown:default:return bt.UNKNOWN}})()})]})};var _t=i(22603);const Bt={[Ct.Listen_Offline]:()=>({type:"info",title:O.Ru.get("web-player.pigeon.help-cards.listen-offline.title"),message:O.Ru.get("web-player.pigeon.help-cards.listen-offline.body")}),[Ct.Connect_Explanation]:()=>({type:"info",title:O.Ru.get("web-player.pigeon.help-cards.connect-explanation.title"),message:(0,b.jsx)(c.E,{as:"p",variant:"bodySmall",semanticColor:"textSubdued",children:O.Ru.get("web-player.pigeon.help-cards.connect-explanation.body",(0,b.jsx)(_t.g,{size:"xsmall",alignmentBaseline:"baseline"}))})}),[Ct.Bluetooth_Degrades_Lossless]:()=>({type:"info",title:O.Ru.get("web-player.pigeon.help-cards.bluetooth-degrades-lossless.title"),message:O.Ru.get("web-player.pigeon.help-cards.bluetooth-degrades-lossless.body")}),[Ct.Opt_Out_Of_Downgrade]:()=>({type:"error",title:O.Ru.get("web-player.pigeon.help-cards.opt-out-of-downgrade.title"),message:O.Ru.get("web-player.pigeon.help-cards.opt-out-of-downgrade.body")}),[Ct.Poor_Bandwidth_Interferes]:()=>({type:"error",title:O.Ru.get("web-player.pigeon.help-cards.poor-bandwidth-interferes.title"),message:O.Ru.get("web-player.pigeon.help-cards.poor-bandwidth-interferes.body")}),[Ct.Default_To_Very_High]:()=>({type:"error",title:O.Ru.get("web-player.pigeon.help-cards.default-to-very-high.title"),message:O.Ru.get("web-player.pigeon.help-cards.default-to-very-high.body")}),[Ct.Need_To_Redownload]:()=>({type:"error",title:O.Ru.get("web-player.pigeon.help-cards.need-to-redownload.title"),message:O.Ru.get("web-player.pigeon.help-cards.need-to-redownload.body")}),[Ct.Lossless_Unavailable]:()=>({type:"error",title:O.Ru.get("web-player.pigeon.help-cards.lossless-unavailable.title"),message:O.Ru.get("web-player.pigeon.help-cards.lossless-unavailable.body")}),[Ct.Update_Setting]:()=>({type:"error",title:O.Ru.get("web-player.pigeon.help-cards.update-settings.title"),message:O.Ru.get("web-player.pigeon.help-cards.update-settings.body")})},Ft="BFsg6KnXzCo_ZKKekrFC",Ut="OIOUgecXCtVCX_DzOsR4",Pt="qcU9Wt2Ly1y44H_lC327",Ht=()=>{const{toPreviousView:e}=(0,n.useContext)(E),t=(0,Le.A)(),i=be(t),a=(()=>{const{flags:e}=Dt(),t=[];return e.forEach((e=>{if(Bt[e]){const{type:i,message:n,title:a}=Bt[e]();"info"===i?t.push({id:e,text:n,title:a,type:at.INFO}):t.push({id:e,text:n,title:a??"",type:at.ERROR})}})),t})(),s=a.some(st),r=a.filter(s?st:rt);return(0,b.jsx)(h,{onBack:e,children:(0,b.jsxs)("div",{className:Ft,children:[(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:O.Ru.get("web-player.pigeon.overview-card.title")}),(0,b.jsx)(c.E,{variant:"titleMedium",semanticColor:"textBrightAccent",children:i.titleFull||i.title}),(0,b.jsx)("div",{className:Ut,children:i.bitrateDetails?.map(((e,t)=>(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBrightAccent",children:e},`bitrate-details-${t}`)))}),(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBrightAccent"}),(0,b.jsx)("div",{className:Pt,children:(0,b.jsx)(Ot,{})}),r.map((e=>(0,b.jsx)(ct,{card:e},e.id)))]})})};var Mt=i(50345);const Vt=({subtitles:e})=>(0,b.jsx)(b.Fragment,{children:e.map(((e,t)=>(0,b.jsx)(c.E,{semanticColor:"textSubdued",variant:"bodySmall",children:e},`subtitle-${t}`)))}),zt="ZExuZhVAKsqOBfFdR6Js",qt="G5KBejq8q3GSZxhHs9be",Yt="WG0sT27gl2zSvisQcgHS",Gt="iUbPCgoUSkOoOVEo5wnr",Qt="NCUCNjFgGqpox8ttJKch",Zt=({title:e,isLossless:t})=>(0,b.jsxs)("div",{className:qt,children:[(0,b.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:e}),t&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:"â€¢"}),(0,b.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBrightAccent",children:O.Ru.get("web-player.pigeon.audio-quality.lossless.highest")})]})]});var Kt=i(58749);const Wt=({onClick:e,quality:t,playQuality:i,maxQuality:n})=>{const{title:a,subtitles:s}=(e=>{switch(e){case kt.a1.LOSSLESS:return{title:O.Ru.get("web-player.pigeon.audio-quality.lossless"),subtitles:[O.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-1"),O.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-2")]};case kt.a1.VERY_HIGH:return{title:O.Ru.get("web-player.pigeon.audio-quality.very-high.label"),subtitles:[O.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate-details.subtitle")]};case kt.a1.HIGH:return{title:O.Ru.get("web-player.pigeon.audio-quality.high.label"),subtitles:[O.Ru.get("web-player.pigeon.audio-quality.high.bitrate-details.subtitle")]};case kt.a1.MEDIUM:return{title:O.Ru.get("web-player.pigeon.audio-quality.normal.label"),subtitles:[O.Ru.get("web-player.pigeon.audio-quality.normal.bitrate-details.subtitle")]};case kt.a1.LOW:return{title:O.Ru.get("web-player.pigeon.audio-quality.low.label"),subtitles:[O.Ru.get("web-player.pigeon.audio-quality.low.bitrate-details.subtitle")]};default:return{title:O.Ru.get("web-player.pigeon.audio-quality.unknown.label"),subtitles:null}}})(t);if(null===a||null===s)return null;const r=i===t,l=t===kt.a1.LOSSLESS,o=null===n||t<=n;return(0,b.jsx)(q.v,{id:"title",variant:"naked",verticalGap:"2px","aria-disabled":!o,onClick:e,onClickHint:O.Ru.get("web-player.pigeon.quality-settings.option-hint",a),title:(0,b.jsx)(Zt,{title:a,isLossless:l}),subtitle:(0,b.jsx)(Vt,{subtitles:s}),trailing:r?(0,b.jsx)(Mt.i,{semanticColor:"textBrightAccent"}):void 0})},Jt=()=>{const{toPreviousView:e}=(0,n.useContext)(E),t=(0,F.l)(),{playingFrom:i}=M(),a=(0,G.t)(),[{data:s},{mutate:r}]=(0,Q.K)(a.quality.streamingQuality),[{data:l},{mutate:o}]=(0,Q.K)(a.quality.autoAdjustQuality),[{data:u},{mutate:d}]=(0,Q.K)(a.quality.remoteQuality),p=(0,Kt.x)();if(void 0===p||void 0===l||void 0===s)return null;let m=s,g=r,v=null;return t&&u&&(m=u.streamingQuality,v=u.maxSupportedQuality,g=e=>d({...u,streamingQuality:e})),(0,b.jsxs)(h,{onBack:e,children:[(0,b.jsxs)("div",{className:Qt,children:[(0,b.jsx)(c.E,{as:"h2",variant:"titleSmall",semanticColor:"textBase",children:O.Ru.get("web-player.pigeon.quality-settings.title")}),(0,b.jsx)(c.E,{semanticColor:"textSubdued",variant:"bodySmall",children:i})]}),(0,b.jsx)("div",{className:zt,children:p.sort(((e,t)=>e.quality-t.quality)).map(((e,t)=>(0,b.jsx)(Wt,{quality:e.quality,playQuality:m,maxQuality:v,onClick:()=>g(e.quality)},t)))}),(0,b.jsx)(c.E,{children:O.Ru.get("web-player.pigeon.quality-settings.disclaimer")}),(0,b.jsxs)("div",{className:Yt,children:[(0,b.jsx)(c.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:O.Ru.get("web-player.pigeon.quality-settings.listening-preferences")}),(0,b.jsx)(q.v,{className:Gt,variant:"naked",size:"sm",id:"auto-adjust-quality",horizontalGap:"0px",title:(0,b.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:O.Ru.get("web-player.pigeon.quality-settings.auto-adjust-quality")}),trailing:(0,b.jsx)(De.l,{id:"desktop.settings.automatic-downgrade",value:l,onSelected:o,condensed:!0})}),(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:O.Ru.get("web-player.pigeon.quality-settings.auto-adjust-quality.subtitle-1")}),(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:O.Ru.get("web-player.pigeon.quality-settings.auto-adjust-quality.subtitle-2")})]})]})};var Xt=i(53575),$t=i(19857);const ei="GYa976HrK40QHF7ZZvwM",ti="MHROZzo24FoePahYMEFJ",ii="qQ5CfbxUDYyLgy_O6Gah",ni=({nrSteps:e,currentStep:t,onClick:i})=>(0,b.jsx)("div",{className:ei,children:Array.from({length:e}).map(((e,n)=>(0,b.jsx)("button",{"aria-label":(0,we.v)(`Go to Step ${n+1}`),className:o()(ti,{[ii]:t===n}),onClick:()=>i(n)},n)))});var ai=i(24818),si=i(67630),ri=i(57147),li=i(78115);const oi="Vpnd2l8y0SgEYWxGIRzB",ci="cUTxS9VrHd466oEAGs7_",ui="JvZLieWRZZQjIU2ElJ2Y",di="ub90kjJH_P8M2r1QL_jL",pi="U3xgLhEWHrv2mb_ZSesP",mi="ZiS7XuaKSNH6O814jzTW",gi="W8RJgFmuCgvRsxpnXMWG",vi="pAYPkrJQFNaLczxADAGc",xi="nBOyGCpnbwg691MCewBj",bi="hr6LueujvRuzxi6lBlVZ",hi="zwfOn0Sx4qfhn2imHyQ9",yi="UcHPiDY6dLRbaeY65j16",Ci="KsS00iz9PKUXYN0PHhno",fi="h66wSXbM4f8lkj4EppJQ",ji=({imageUrl:e,max:t,alt:i=""})=>{const n=(0,li.dZ)();return(0,b.jsx)(ri._,{className:pi,src:n(e,t),loading:"eager",alt:i})};var Si=i(98270);const wi=({path:e,loop:t=!0})=>(0,b.jsx)(n.Suspense,{fallback:null,children:(0,b.jsx)(Si.o,{loop:t,autoplay:!0,path:e,className:di,style:{width:"auto",height:"100%"}})});var Ni=i(89323);function Ei({children:e,variant:t}){const i=(0,n.useRef)(null);return(0,Ni.i)({ref:i}),(0,b.jsx)(c.E,{variant:t,semanticColor:"textBase",className:xi,tabIndex:-1,ref:i,children:e})}var Ri=i(52748);const ki={[Ri.E.SMALL]:{titleVariant:"bodyMediumBold",subtitleVariant:"marginalBold",bodyVariant:"bodySmall",containerGap:0,headerGap:0,assetGap:8,subtitleGap:4,titleGap:4,buttonGap:12,assetMaxHeight:165},[Ri.E.MEDIUM]:{titleVariant:"titleSmall",subtitleVariant:"marginalBold",bodyVariant:"bodySmall",containerGap:16,headerGap:24,assetGap:24,subtitleGap:12,titleGap:8,buttonGap:24,assetMaxHeight:240},[Ri.E.LARGE]:{titleVariant:"titleMedium",subtitleVariant:"bodySmall",bodyVariant:"bodyMedium",containerGap:32,headerGap:32,assetGap:48,subtitleGap:16,titleGap:8,buttonGap:32,assetMaxHeight:320}},Ii="AOGvMtDLQNbo94n8r8mu",Li="gf6sr0Z5UAyf7ULRfSFA",Ai=({icon:e,text:t,highlighted:i,condensed:n=!1,className:a})=>(0,b.jsxs)("div",{className:o()(Ii,a),children:[(0,b.jsx)(e,{size:n?"xsmall":"small",semanticColor:"textBase",className:o()({[Li]:i})}),(0,b.jsx)(c.E,{variant:n?"marginalBold":"bodySmallBold",semanticColor:"textBase",className:o()({[Li]:i}),children:t})]});var Ti=i(33782),Di=i(30298);const Oi=({onboardingContent:e,onNext:t,onTertiaryClick:i,layout:s="vertical",showLoader:r=!1})=>{const{bodyTitle:l,bodySubtitle:u,bodyText:p,imageUrl:m,lottiePath:g,loopAnimation:v=!0,subtitleIcon:x,buttonText:h,tertiaryButtonText:y}=e,C=(0,Ti.y)(),{titleVariant:f,subtitleVariant:j,bodyVariant:S,containerGap:w,headerGap:N,assetGap:E,subtitleGap:R,titleGap:k,buttonGap:I,assetMaxHeight:L}=(0,n.useMemo)((()=>{let e=Ri.E.MEDIUM;switch(C){case Ri.E.SMALL:e=Ri.E.SMALL;break;case Ri.E.MEDIUM:e=Ri.E.MEDIUM;break;case Ri.E.LARGE:e=Ri.E.LARGE}return ki[e]}),[C]),A=(0,n.useRef)(null),T=(0,Di.j)();return(0,b.jsx)(ai.A,{mode:"out-in",children:(0,b.jsx)(a.A,{timeout:T?0:800,classNames:{enter:hi,enterActive:yi,exit:Ci,exitActive:fi},nodeRef:A,children:(0,b.jsx)("div",{className:oi,style:{"--onboarding-container-gap":`${w}px`,"--onboarding-asset-gap":`${E}px`,"--onboarding-subtitle-gap":`${R}px`,"--onboarding-title-gap":`${k}px`,"--onboarding-button-gap":`${I}px`,"--onboarding-asset-max-height":`${L}px`,"--onboarding-header-gap":`${N}px`},ref:A,children:(0,b.jsxs)("div",{className:o()(ci,{[mi]:"horizontal"===s}),children:[(0,b.jsxs)("div",{className:ui,children:[m?(0,b.jsx)(ji,{imageUrl:m,max:L}):null,g?(0,b.jsx)(wi,{path:g,loop:v}):null]}),(0,b.jsxs)("div",{className:gi,children:[(0,b.jsx)(Ai,{icon:x,text:u,condensed:C!==Ri.E.LARGE,highlighted:!0,className:vi,variant:j}),(0,b.jsx)(Ei,{variant:f,children:l}),(0,b.jsx)(c.E,{variant:S,children:p}),(0,b.jsx)("div",{className:bi,children:r?(0,b.jsx)(si.m,{}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.$,{colorSet:"invertedLight",size:C===Ri.E.LARGE?"medium":"small",onClick:t,children:h}),i&&y?(0,b.jsx)(ce.H,{size:C===Ri.E.LARGE?"medium":"small",onClick:i,condensed:!0,children:e.tertiaryButtonText}):null]})})]})]})})},l)})};const _i=({variant:e})=>(0,b.jsx)(c.E,{variant:e,semanticColor:"textBase",children:"Spotify"}),Bi=()=>[{bodyTitle:O.Ru.get("web-player.pigeon.introduction.step-1.title"),bodySubtitle:"Lossless",bodyText:O.Ru.get("web-player.pigeon.introduction.step-1.subtitle"),subtitleIcon:Xt.Q,buttonText:O.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc00009256c4d947fba90f6244343446ee"},{bodyTitle:O.Ru.get("web-player.pigeon.introduction.step-2.title"),bodySubtitle:"Lossless",bodyText:O.Ru.get("web-player.pigeon.introduction.step-2.subtitle"),subtitleIcon:Xt.Q,buttonText:O.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc00005e4e6fd833f6f5c2cf4f81c1da66"},{bodyTitle:O.Ru.get("web-player.pigeon.introduction.step-3.title"),bodySubtitle:"Lossless",bodyText:O.Ru.get("web-player.pigeon.introduction.step-3.subtitle"),subtitleIcon:Xt.Q,buttonText:O.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc000092564a451c0c1fba3acf8fed995f"},{bodyTitle:O.Ru.get("web-player.pigeon.introduction.step-4.title"),bodySubtitle:"Lossless",bodyText:O.Ru.get("web-player.pigeon.introduction.step-4.subtitle"),subtitleIcon:Xt.Q,buttonText:O.Ru.get("web-player.pigeon.introduction.button.done"),imageUrl:"spotify:image:ab671fcc000092562f3465b95599cdb50e47604e"}],Fi=()=>{const[e,t]=ke(),{setCurrentView:i,toPreviousView:a,viewTransitions:s}=(0,n.useContext)(E),{spec:r,logger:l}=(0,We.r)($t.m,{}),o=s[y.DiscoverLossless],{onNext:c,onBack:u,currentStep:d,goTo:p}=function(e){const[t,i]=(0,n.useState)(0),[a,s]=(0,n.useState)(!1),r=(0,n.useCallback)((()=>{t!==e-1?i(t+1):s(!0)}),[t,e]),l=(0,n.useCallback)((()=>{0!==t&&i(t-1),a&&s(!1)}),[t,a]),o=(0,n.useCallback)((t=>{t>=0&&t<e&&i(t),t===e?s(!0):a&&s(!1)}),[e,a]);return{currentStep:t,onNext:r,onBack:l,reachedEnd:a,goTo:o}}(Bi().length),m=(0,n.useCallback)((()=>{l.logInteraction(r.closeButtonFactory().hitUiHide()),i(o.continue)}),[l,i,r,o.continue]);return(0,b.jsxs)(h,{titleSlot:(0,b.jsx)(_i,{variant:"bodySmallBold"}),onBack:()=>{l.logInteraction(r.backButtonFactory().hitUiHide()),d>0?u():a()},onClose:m,preventDefaultClose:!0,children:[(0,b.jsx)(Oi,{onboardingContent:Bi()[d],onNext:()=>{3===d?(l.logInteraction(r.doneButtonFactory().hitUiHide()),t(!0),i(o.continue)):c()}}),(0,b.jsx)(ni,{nrSteps:Bi().length,currentStep:d,onClick:p})]})};var Ui=i(19511),Pi=i(69897);const Hi=e=>({bodyTitle:O.Ru.get("web-player.puffin.activation-2.title",e.headphoneDevice?.deviceName),bodySubtitle:O.Ru.get("web-player.puffin.signifier-text"),lottiePath:(0,Pi.b)("animations/puffin-onboarding-tour-2.json"),subtitleIcon:He.C,buttonText:O.Ru.get("web-player.puffin.activation-2.button-confirm"),tertiaryButtonText:O.Ru.get("web-player.puffin.activation-2.button-cancel"),loopAnimation:!1}),Mi=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(E),{deviceFilterState:i,isMaybeHeadphoneDevice:a,isLoading:s}=(0,ee.j)(),r=t[y.ActivationDetection];(0,n.useLayoutEffect)((()=>{i.headphoneDevice||s||!a||e(y.ManualSelection,{showDialogOnBack:!0})}),[i.headphoneDevice,s,a,e]);const l=(0,n.useMemo)((()=>i?.wasAmbiguous),[i]);return(0,b.jsx)(Oi,{onboardingContent:Hi(i),onNext:()=>{e(l?r.airpods:r.continue)},onTertiaryClick:()=>{e(r.selectManually)},showLoader:s||!i.headphoneDevice})},Vi=()=>{const{deviceFilterState:e,isLoading:t}=(0,ee.j)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(E),s=a[y.ActivationIntro],r=(0,n.useCallback)((()=>{e.toggleTuneHeadphones?i(s.continue):i(s.selectManually,{showDialogOnBack:!0})}),[e,i,s.continue,s.selectManually]),l={bodyTitle:O.Ru.get("web-player.puffin.activation-1.title"),bodySubtitle:O.Ru.get("web-player.puffin.signifier-text"),lottiePath:(0,Pi.b)("animations/puffin-onboarding-tour-1.json"),subtitleIcon:He.C,buttonText:O.Ru.get("web-player.puffin.activation-1.button")};return(0,b.jsx)(Oi,{onboardingContent:l,onNext:r,showLoader:t||!e.audioDevice})};var zi=i(45127),qi=i(73115);const Yi=e=>{const{deviceFilterState:t}=(0,ee.j)(),{setCurrentDevice:i}=ie(),a=(0,zi.vh)(),{setCurrentView:s}=(0,n.useContext)(E),r=(0,n.useCallback)((async()=>{i(t.headphoneDevice,!0);try{await t.setFilterState({specificEnabled:!!t.toggleTuneHeadphones,externalizationEnabled:!!t.toggleTuneStudio})}catch{return void s(y.Error)}((e,t)=>{e.send((0,qi.d)({has_tuner:!!t.toggleTuneHeadphones,filter_brand:t.headphoneDevice?.brand??null,filter_model:t.headphoneDevice?.model??null,was_predicted:!!t.predictedState,headphone_name_over_bluetooth:t.audioDevice?.transportType===_.Yg.BLUETOOTH?t.audioDevice.name:null,external_accessory_mapping_predicted_brand:t.predictedState?.predictedBrand??null,external_accessory_mapping_predicted_model:t.predictedState?.predictedModel??null,was_matched:(t.predictedState?.wasMatched&&!t.headphoneDevice?.isAmbiguous)??!1,was_ambiguous:t.headphoneDevice?.isAmbiguous??!1,was_manually_selected:(t.headphoneDevice?.isAmbiguous||t.headphoneDevice?.wasSelectedManually)??!1}))})(a,t),e()}),[t,a,e,i,s]);return{handleClick:r}},Gi=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(E),{spec:i,logger:a}=(0,We.r)(Ui.i,{}),s=t[y.ActivationSignifiers],{handleClick:r}=Yi((()=>{a.logInteraction(i.doneButtonFactory().hitUiHide()),e(s.activate)}));return(0,b.jsx)(Oi,{onboardingContent:{bodyTitle:O.Ru.get("web-player.puffin.activation-3.title"),bodySubtitle:O.Ru.get("web-player.puffin.signifier-text"),bodyText:O.Ru.get("web-player.puffin.activation-3.subtitle"),imageUrl:"spotify:image:ab671fcc00005e4ed89275c5e4eef1d432ac3fe2",subtitleIcon:He.C,buttonText:O.Ru.get("web-player.puffin.button.done"),loopAnimation:!0},onNext:r})},Qi="FcycLYpZEbmuEClARSPP",Zi="NSoA0u_DehEmTu_M20Qn",Ki="fGnSEIwIPGid9ALC9ANP",Wi="ZknipG1So_RdKeJ911k3",Ji=({number:e,message:t})=>(0,b.jsxs)("div",{className:Ki,children:[(0,b.jsx)("div",{className:Wi,children:(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBase",children:e})}),(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:t})]}),Xi=()=>{const{setCurrentView:e}=(0,n.useContext)(E);return(0,b.jsxs)("div",{className:Qi,children:[(0,b.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",children:O.Ru.get("web-player.puffin.device-connection-lost.title")}),(0,b.jsxs)("div",{className:Zi,children:[(0,b.jsx)(Ji,{number:1,message:O.Ru.get("web-player.puffin.device-connection-lost.tip-1")}),(0,b.jsx)(Ji,{number:2,message:O.Ru.get("web-player.puffin.device-connection-lost.tip-2")}),(0,b.jsx)(Ji,{number:3,message:O.Ru.get("web-player.puffin.device-connection-lost.tip-3")}),(0,b.jsx)(Ji,{number:4,message:O.Ru.get("web-player.puffin.device-connection-lost.tip-4")})]}),(0,b.jsx)(ce.H,{semanticColor:"textSubdued",onClick:()=>{e(y.Overview)},children:"Still not working"})]})},$i=()=>{const{removeCurrentDevice:e}=ie();return $({title:O.Ru.get("web-player.puffin.activation-dialog.title"),description:O.Ru.get("web-player.puffin.activation-dialog.subtitle"),confirmButtonText:O.Ru.get("web-player.puffin.activation-dialog.button-cancel"),cancelButtonText:O.Ru.get("web-player.puffin.activation-dialog.button-confirm"),onConfirm:()=>{e(!0),(0,W.I)("SETUP_HEADPHONES_BUTTON")}})},en=({type:e})=>{const{isMaybeHeadphoneDevice:t}=(0,ee.j)(),{spec:i,logger:a}=(0,We.r)(Ui.i,{}),{triggerDialog:s,dialog:r}=$i(),l=(0,n.useCallback)((()=>{a.logInteraction(i.closeButtonFactory().hitUiHide()),s(!0)}),[a,i,s]),o=(0,n.useCallback)((()=>{a.logInteraction(i.backButtonFactory().hitUiReveal()),s(!1)}),[a,i,s]);return(0,b.jsx)(h,{titleSlot:(0,b.jsx)(_i,{variant:"bodySmallBold"}),onClose:l,onBack:o,preventDefaultClose:!0,children:t?(0,b.jsxs)(b.Fragment,{children:[r,"intro"===e&&(0,b.jsx)(Vi,{}),"detection"===e&&(0,b.jsx)(Mi,{}),"signifiers"===e&&(0,b.jsx)(Gi,{})]}):(0,b.jsx)(Xi,{})})};var tn=i(66396),nn=i(93495),an=i(84037),sn=i(26600),rn=i(69684);const ln=({device:e,onClick:t,isAirpodDevice:i})=>{const n=i?`${e.model} (${e.releaseYear})`:e.model,a=i?O.Ru.get("web-player.puffin.manual-selection.models-list",e.modelNumbers.join(O.Ru.getSeparator())):e.brand;return(0,b.jsx)(rn.c,{children:(0,b.jsx)(q.v,{variant:"naked",size:"md",isInteractive:!0,id:e.id,title:(0,b.jsx)(je.d,{onClick:()=>{t(e)},children:n}),subtitle:a,trailing:(0,b.jsx)(sn.V,{size:"small",semanticColor:"textSubdued"}),onClick:()=>{t(e)},hoverAnimationDuration:"0s"},e.id)})},on="fjltNoIqUMIY7LfgtvCH",cn="WNi2uq00PuqJnOvv6b6a",un="W3HfPxIGTvmPJNItOM5A",dn="T3zyYZ33nGeJfw6NgwwV",pn="fr_QT3qQxce_KdFUhktQ",mn="wMsnDxvKohBJOUguxi8p",gn="O842FkxrdjAlid2byB9c",vn="E6yKOmbA9ekxMnRhJDnA",xn="sm96uN6u5WGLjNfbT6kF",bn="bWJ8TFqqyCV4TqeScz7D",hn="SRl_K6g2YOd8qrpIFij7",yn=({search:e})=>(0,b.jsxs)("div",{className:vn,children:[(0,b.jsx)(c.E,{semanticColor:"textBase",variant:"titleSmall",className:xn,children:O.Ru.get("web-player.puffin.manual-selection.empty.title",(0,b.jsx)("span",{className:bn,children:(0,b.jsx)("span",{className:hn,children:e})}))}),(0,b.jsx)(c.E,{semanticColor:"textSubdued",variant:"bodySmall",children:O.Ru.get("web-player.puffin.manual-selection.empty.subtitle")})]}),Cn={id:"unknown_device",brand:"",model:"",deviceName:"Generic",modelNumbers:[],releaseYear:""},fn=({devices:e,isAirpodsList:t=!1})=>{const{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(E),s=t?a[y.AirpodsSelection]:a[y.ManualSelection],{filter:r,setFilter:l}=(0,n.useContext)(nn.g),{setCurrentDevice:o}=ie(),c=(0,n.useCallback)((e=>{const n=e?{...e,wasSelectedManually:!0,isAmbiguous:t}:null;o(n,!0),i(e?.id===Cn.id?s.notFound:s.continue),l("")}),[t,o,i,s.notFound,s.continue,l]),u=e.filter((({deviceName:e,brand:t,model:i,modelNumbers:n})=>[e,t,i,...n].some((e=>e.toLowerCase().includes(r.toLowerCase())))));return(0,b.jsxs)("div",{className:mn,children:[(0,b.jsx)(an.$,{children:u.map((e=>(0,b.jsx)(ln,{device:e,onClick:c,isAirpodDevice:t},e.id)))}),0===u.length&&(0,b.jsx)(yn,{search:r}),(0,b.jsx)("div",{className:pn,children:(0,b.jsx)(oe.n,{size:"small",onClick:()=>{c(Cn)},children:O.Ru.get("web-player.puffin.manual-selection.not-found-button")})})]})};var jn=i(16318);const Sn=()=>{const e=(0,te.N)(),{data:t,isLoading:i,isError:n}=(0,jn.I)({queryKey:["puffin-devices"],queryFn:async()=>await e.getDevices(),gcTime:18e5,staleTime:6e5});return{data:t??null,loading:i,error:n}},wn=()=>{const{toPreviousView:e}=(0,n.useContext)(E),{data:t}=Sn(),i=(0,n.useMemo)((()=>t?.filter((e=>"apple"===e.brand.toLowerCase()&&e.model.toLowerCase().includes("airpods")))),[t]);return(0,b.jsx)(h,{onBack:()=>{e()},children:(0,b.jsxs)(nn.s,{uri:"spotify:internal:bettersound",children:[(0,b.jsxs)("div",{className:cn,children:[(0,b.jsx)("div",{className:un}),(0,b.jsxs)("div",{className:dn,children:[(0,b.jsx)(c.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:O.Ru.get("web-player.puffin.manual-selection.airpods.title")}),(0,b.jsx)(c.E,{variant:"bodySmall",children:O.Ru.get("web-player.puffin.manual-selection.airpods.subtitle")})]}),(0,b.jsx)(tn.S,{placeholder:O.Ru.get("web-player.puffin.manual-selection.airpods.search-placeholder"),alwaysExpanded:!0,fullWidth:!0,debounceFilterChangeTimeout:0})]}),i?(0,b.jsx)("div",{className:on,children:(0,b.jsx)(fn,{devices:i,isAirpodsList:!0})}):(0,b.jsx)("div",{className:gn,children:(0,b.jsx)(si.m,{})})]})})},Nn=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(E),i=t[y.IncompatibleHeadphones],{handleClick:a}=Yi((()=>e(i.continue))),{toPreviousView:s}=(0,n.useContext)(E);return(0,b.jsx)(h,{onBack:()=>{s()},titleSlot:(0,b.jsx)(_i,{variant:"bodySmallBold"}),children:(0,b.jsx)(Oi,{onboardingContent:{bodyTitle:(0,we.v)("These headphones are not compatible with Optimize yet."),bodySubtitle:(0,we.v)("Optimize"),bodyText:(0,we.v)("Only some devices work with Optimize. We're expanding our compatible devices to support a wider range of headphones."),imageUrl:"spotify:image:ab671fcc000092562c122d1cc442ac4f3c8dbab4",subtitleIcon:He.C,buttonText:(0,we.v)("Close")},onNext:a})})},En=()=>{const{toPreviousView:e,viewOptions:t}=(0,n.useContext)(E),{data:i}=Sn(),{triggerDialog:a,dialog:s}=$i();return(0,b.jsxs)(h,{onBack:()=>{t?.showDialogOnBack?a():e()},titleSlot:(0,b.jsx)(_i,{variant:"bodySmallBold"}),children:[s,(0,b.jsxs)(nn.s,{uri:"spotify:internal:bettersound",children:[(0,b.jsxs)("div",{className:cn,children:[(0,b.jsx)("div",{className:un}),(0,b.jsxs)("div",{className:dn,children:[(0,b.jsx)(c.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:O.Ru.get("web-player.puffin.manual-selection.title")}),(0,b.jsx)(c.E,{variant:"bodySmall",children:O.Ru.get("web-player.puffin.manual-selection.subtitle")})]}),(0,b.jsx)(tn.S,{placeholder:O.Ru.get("web-player.puffin.manual-selection.search-placeholder"),alwaysExpanded:!0,fullWidth:!0,debounceFilterChangeTimeout:0})]}),i?(0,b.jsx)("div",{className:on,children:(0,b.jsx)(fn,{devices:i})}):(0,b.jsx)("div",{className:gn,children:(0,b.jsx)(si.m,{})})]})]})};var Rn=i(62363),kn=i(43943);const In=()=>{const{currentView:e}=(0,n.useContext)(E);switch(e){case y.ActivationIntro:return(0,b.jsx)(en,{type:"intro"});case y.ActivationDetection:return(0,b.jsx)(en,{type:"detection"});case y.ActivationSignifiers:return(0,b.jsx)(en,{type:"signifiers"});case y.Error:return(0,b.jsx)(L,{});case y.ManualSelection:return(0,b.jsx)(En,{});case y.AirpodsSelection:return(0,b.jsx)(wn,{});case y.Overview:return(0,b.jsx)($e,{});case y.AudioQualitySettings:return(0,b.jsx)(Jt,{});case y.AudioQualityDetails:return(0,b.jsx)(Ht,{});case y.DiscoverLossless:return(0,b.jsx)(Fi,{});case y.IncompatibleHeadphones:return(0,b.jsx)(Nn,{});default:return(0,kn.k)(e),null}},Ln=()=>{const{currentView:e}=(0,n.useContext)(E),t=(0,f._Y)(),i=(0,f.XB)(),a=[m.Z.Puffin,m.Z.PuffinActivation,m.Z.PuffinOverlay,m.Z.PuffinActivationOverlay].some((e=>e===i)),s=[y.ActivationIntro,y.ActivationDetection,y.ActivationSignifiers,y.DiscoverLossless,y.ManualSelection,y.AirpodsSelection,y.IncompatibleHeadphones].includes(e),r=[y.ActivationIntro,y.ActivationDetection,y.ActivationSignifiers,y.ManualSelection,y.IncompatibleHeadphones].includes(e);(0,n.useEffect)((()=>{a&&t(r?X.$S.PUFFIN_START_ACTIVATION:X.$S.PUFFIN_FINISH_ACTIVATION)}),[t,r,a]);const l=(0,n.useRef)(null),{breakpoint:c}=(0,Rn.c)({[Ri.E.SMALL]:0,[Ri.E.MEDIUM]:448,[Ri.E.LARGE]:780},l);return(0,b.jsx)(tt.w,{className:o()({[x]:s}),ref:l,children:(0,b.jsx)(Ti.o.Provider,{value:c,children:(0,b.jsxs)("div",{className:g,children:[(0,b.jsx)(In,{}),false]})})})},An=()=>(0,b.jsx)(et._,{label:"Puffin",focusTransferId:"PUFFIN",children:(0,b.jsx)(r.s,{Fallback:A,children:(0,b.jsx)(R,{children:(0,b.jsx)(Ln,{})})})});var Tn=i(5305),Dn=i(7446);function On(e){return e.sort(((e,t)=>t.timestamp-e.timestamp))}function _n(e,t){return t.some((t=>t.user.uri===e.user.uri))?t:On([...t,e])}function Bn(e,t){return t.filter((t=>t.user.uri!==e))}var Fn=i(31014);var Un=i(96672),Pn=i(33446);function Hn(){const e=(0,Dn.C)(),t=(0,Tn.jE)(),i=["friend-activity"],a=e=>{t.setQueryData(i,((t=[])=>{const i=Array.isArray(e)?e.at(0):e;return i?function(e,t){return On(t.map((t=>t.user.uri===e.user.uri?e:t)))}(i,t):t}))},{subscribeToFriend:s,unSubscribeFromFriend:r,subscribeAndFetchFeed:l}=function(e){const t=(0,Dn.C)(),i=(0,n.useRef)({}),a=(0,n.useRef)(e);a.current=e;const s=(0,n.useCallback)((e=>{const n=(0,Fn.o_h)(e)?.username,s=t.subscribeToBuddyActivity(n,(e=>{e&&a.current(e)}));return i.current[e]=s,s}),[t]),r=(0,n.useCallback)((e=>{i.current[e]?.cancel(),delete i.current[e]}),[]),l=(0,n.useCallback)(((e,i,n)=>t.fetchFriendActivityWithSubscriptions(e,i,n)),[t]);return(0,n.useEffect)((()=>{const e=i.current;return()=>{Object.values(e).forEach((e=>{e.cancel()}))}}),[t]),{subscribeToFriend:s,unSubscribeFromFriend:r,subscribeAndFetchFeed:l}}(a),o=(0,n.useRef)();(0,n.useEffect)((()=>()=>o.current?.cancel()),[]);const c=(0,jn.I)({queryKey:i,queryFn:()=>new Promise(((e,t)=>{o.current=l(a,e,t)})).then((e=>On(e))),staleTime:6e5,gcTime:36e5,refetchInterval:864e5,refetchOnWindowFocus:!1,refetchOnMount:"always",refetchOnReconnect:!0});return(0,Pn.N)(Un.mc.OPERATION_COMPLETE,(async n=>{const a=n.data.uris;if(n.data.operation!==Un.JK.FOLLOW_USER){if(n.data.operation===Un.JK.UNFOLLOW_USER)for(const e of a)r(e),t.setQueryData(i,((t=[])=>Bn(e,t)))}else for(const n of a){const a=(await e.fetchFriendActivity([n])).at(0);a&&(t.setQueryData(i,((e=[])=>_n(a,e))),s(n))}})),c}const Mn=(0,n.lazy)((()=>i.e(7564).then(i.bind(i,24211))));function Vn(){const{data:e,error:t,isLoading:i}=Hn();return!(0,Lt.n)()||i||t?null:(0,b.jsx)(Mn,{friends:e??[]})}var zn=i(82101),qn=i(4881);const Yn="device-picker-section-heading",Gn="device-picker-troubleshooting-list";var Qn=i(34645);const Zn="uqXaqvqZq1oSLhXLYRo9",Kn="YuPZ1nUe5BAH7HJworb6",Wn="wWalUsrOkGgHa0u8o86Q",Jn="yNttGX9uUxTih93MKEWB",Xn="kD25df_SN_uDB8lhZgQB",$n="szp7gPJjKd4T69SzCEpF",ea="E912cqRfb05FrRPFKDZ_",ta="D7sZlTAybIM02cRvh4sV",ia="xdAVCtEIoo_8z_Ubj7tU",na=({foundDevices:e})=>{const t=(0,s.NC)(Qn.Q5);let i;return i=e?t?(0,we.v)("Speakers & Jams"):O.Ru.get("web-player.connect.device-picker.select-another-device"):O.Ru.get("web-player.connect.device-picker.no-devices-found"),(0,b.jsx)("span",{className:Jn,id:Yn,"data-testid":Yn,children:(0,b.jsx)(c.E,{as:"h2",variant:"bodyMediumBold",semanticColor:"textBase",children:i})})};var aa=i(79720),sa=i(66105),ra=i(40638),la=i(70131),oa=i(82033),ca=i(44765),ua=i(47290),da=i(56962),pa=i(28823),ma=i(90298),ga=i(73763),va=i(69027),xa=i(69364),ba=i(84206),ha=i(23310),ya=i(62316),Ca=i(96678),fa=i(53507);var ja=i(51283);const Sa="mFr6W9mwg0p_c7eJlhc_",wa="lpPBKkIGJcyWu59iOpsS",Na=({deviceId:e,connectStateDeviceId:t,allowForgetDevice:i,incarnation:n})=>{const a=(0,fa.N)(Ca.r),s=(0,ne.s)(),{spec:r}=(0,We.r)(xa.d,{}),l=(0,ja.t)(r),o=r.forgetDeviceButtonFactory(),c=(0,ja.t)(o),u=r.deviceIncarnationContainerFactory(),d=(0,ja.t)(u);return i||n?(0,b.jsx)("span",{ref:l,className:wa,children:(0,b.jsxs)(ba.W,{children:[i&&(0,b.jsx)(ya.D,{role:"menuitem",leadingIcon:(0,b.jsx)(va.V,{size:"small"}),onClick:()=>{s.logInteraction(o.hitLogoutFromRemoteDevice({remoteDeviceId:t})),a.logout(e)},elementRef:c,children:O.Ru.get("web-player.connect.context-menu.log-out-of-device")}),n&&(0,b.jsxs)("div",{ref:d,children:[(0,b.jsx)(ha.y,{children:O.Ru.get("web-player.connect.context-menu.incarnation-title")}),n.available.map((i=>{const{icon:r,text:l}=(e=>{switch(e){case"connect":return{icon:(0,b.jsx)(oa.E,{size:"small"}),text:O.Ru.get("web-player.connect.context-menu.incarnation-connect")};case"cast":return{icon:(0,b.jsx)(ga.m,{size:"small"}),text:O.Ru.get("web-player.connect.context-menu.incarnation-cast")};default:return{}}})(i);return(0,b.jsx)(ya.D,{role:"menuitemradio",leadingIcon:r,onClick:()=>{let r;switch(i){case"cast":r=u.googleCastButtonFactory();break;case"connect":r=u.spotifyConnectButtonFactory()}n.preferred!==i?(r&&s.logInteraction(r.hitChangeRemoteDeviceIncarnation({remoteDeviceId:t})),a.setPreferredIncarnation(e,i)):r&&s.logInteraction(r.hitNoAction())},"aria-checked":n.preferred===i,CheckedIcon:Mt.i,children:l},i)}))]})]})}):null};var Ea=i(16859);const Ra=({title:e,deviceId:t,connectStateDeviceId:i,allowForgetDevice:a,incarnation:s,className:r,onHide:l,onShow:c,spec:u})=>{const[d,p]=(0,n.useState)(!1),m=u.contextMenuButtonFactory({identifier:i}),g=(0,ne.s)(),v=(0,ja.t)(m);return(0,b.jsx)(ma.b,{renderInline:!0,menu:(0,b.jsx)(Ea.r,{spec:m,children:(0,b.jsx)(Na,{deviceId:t,connectStateDeviceId:i,allowForgetDevice:a,incarnation:s})}),onShow:()=>{p(!0),c?.()},onHide:()=>{p(!1),l?.()},offset:[0,-8],children:(0,b.jsx)(pa.e,{ref:v,size:pa.M.xs,label:O.Ru.get("more.label.context",e),className:o()(Sa,r),onClick:e=>{e.stopPropagation(),g.logInteraction(d?m.hitUiHide():m.hitUiReveal())}})})},ka=(0,n.createContext)({rowWithMenuOpenIdentifier:null,setRowWithMenuOpenIdentifier:()=>{}}),Ia=({children:e})=>{const[t,i]=(0,n.useState)(null),a=(0,n.useMemo)((()=>({rowWithMenuOpenIdentifier:t,setRowWithMenuOpenIdentifier:i})),[t]);return(0,b.jsx)(ka.Provider,{value:a,children:e})},La=e=>e instanceof aa.B.ContainerViewEventFactory.DeviceListEventFactory.RemoteDeviceEventFactory||e instanceof aa.B.ContainerViewEventFactory.DeviceListEventFactory.DisabledDeviceEventFactory||e instanceof aa.B.ContainerViewEventFactory.OffNetworkDeviceListEventFactory.RemoteDeviceEventFactory||e instanceof aa.B.ContainerViewEventFactory.OffNetworkDeviceListEventFactory.DisabledDeviceEventFactory||e instanceof aa.B.ContainerViewEventFactory.OnNetworkDeviceListEventFactory.RemoteDeviceEventFactory,Aa=e=>e instanceof aa.B.ContainerViewEventFactory.DeviceListEventFactory.RemoteDeviceEventFactory;var Ta=i(36632),Da=i(46103);const Oa="AWblt0YATqa_XQaPUDMc",_a="sX7AwqoSzMeT9qhlEViU",Ba="jIlVu16bmijzUKG6u5VW",Fa="ZkuPLR9bss2N7f7thixx",Ua="QSZFk1XCj76mVplNmiV1",Pa="O0wmxPM0kfA59paiHqR9",Ha=(0,n.forwardRef)((function({deviceId:e,connectStateDeviceId:t,Icon:i,TechIcon:a,title:s,subtitle:r,canLogout:l,isDisabled:c,incarnation:u,jamSession:d,onClick:p,spec:m},g){const v=(0,f._Y)(),x=(0,Ta.HJ)(u),h=l||x,{rowWithMenuOpenIdentifier:y,setRowWithMenuOpenIdentifier:C}=(0,n.useContext)(ka),j=(0,ja.t)(Aa(m)&&d?.token?m.inPersonListeningSessionFactory({identifier:d.sessionId??d.token}):void 0,!!d?.token),S=(0,ra.YQ)((()=>{p(),v(X.$S.PANEL_CLOSE_CLICK)}),1e3,{leading:!0,trailing:!1}),w=(0,n.useCallback)((e=>{"Enter"===e.key&&S()}),[S]),N=(0,b.jsx)(Na,{deviceId:e,connectStateDeviceId:t,allowForgetDevice:l,incarnation:x?u:void 0}),E=d?.participants.find((e=>e.id===d.sessionOwnerId))?.displayName,R=d?.jamType===Da.H.NEARBY_JAM?(0,b.jsx)(la.C,{"data-testid":"sub-nearby-jam-icon",semanticColor:"textBrightAccent",size:"small"}):(0,b.jsx)(oa.E,{"data-testid":"sub-jam-icon",semanticColor:"textBrightAccent",size:"small"}),k=E&&!d.isSessionOwner?(0,b.jsxs)("div",{className:_a,ref:j,children:[R,(0,b.jsx)(ca.j,{semanticColor:"textBrightAccent",lineClamp:1,children:O.Ru.get("web-player.social-connect.broadcasting.bradcasting-device-subtitle",{host:E})})]}):(0,b.jsxs)("div",{className:_a,children:[a&&(0,b.jsx)(a,{className:Ba,semanticColor:"textSubdued","data-testid":"sub-icon",role:"presentation",size:"small"}),r&&(0,b.jsx)(ca.j,{semanticColor:"textSubdued",lineClamp:1,children:r})]});return(0,b.jsx)(ua.h,{menu:N,children:(0,b.jsx)(rn.c,{onKeyDown:w,onClick:S,className:o()(Fa,{[Pa]:y===e}),children:(0,b.jsx)(q.v,{id:e,ref:g,"data-testid":"device-picker-row-sidepanel",media:(0,b.jsx)(i,{semanticColor:c?"textSubdued":"textBase","data-testid":"main-icon",role:"presentation"}),onClick:()=>{},onClickHint:O.Ru.get("web-player.connect.device-picker.connect-to-device"),title:(0,b.jsx)("span",{className:Oa,children:(0,b.jsx)(da.Zp,{label:s,renderInline:!0,children:(0,b.jsx)(je.d,{"data-testid":"list-row-title",lineClamp:1,semanticColor:c?"textSubdued":"textBase",dir:"auto",children:s})})}),subtitle:k,trailing:h&&La(m)&&(0,b.jsx)(Ra,{title:s,deviceId:e,connectStateDeviceId:t,allowForgetDevice:l,incarnation:x?u:void 0,spec:m,className:o()(Ua),onShow:()=>{C(e)},onHide:()=>{C(null)}})})})})})),Ma=({position:e,deviceId:t,connectStateDeviceId:i,deviceName:n,deviceType:a,deviceModelName:s,isGroup:r,disabledReason:l,canLogout:o,spec:c})=>{const u=(0,Ta.tf)(a,r),{helpText:d}=(0,Ta.uY)(l,(0,Ta.p2)(a,s)),p=c.disabledDeviceFactory({identifier:i,position:e,reason:l??"null"}),m=(0,ja.t)(p),g=(0,D.wA)();return(0,b.jsx)(Ha,{deviceId:t,connectStateDeviceId:i,ref:m,isDisabled:!0,disabledReason:l,Icon:u,title:n,subtitle:d,canLogout:o,onClick:()=>{l===P.bU.RESTRICTED&&g((0,sa.yx)(t))},spec:p})};var Va=i(23133);const za=({isDisabled:e=!1,spec:t})=>{const i=(0,D.wA)(),n=t.containerViewFactory().deviceListFactory().castPlaceholderFactory(),a=(0,ja.t)(n),s=(0,Ta.$A)(P.bq.CAST_AUDIO,"disconnected"),r=(0,ne.s)();return(0,b.jsx)(Ha,{deviceId:"cast-placeholder",connectStateDeviceId:"cast-placeholder",ref:a,Icon:s,title:O.Ru.get("web-player.connect.device-picker.google-cast-devices"),supportsHiFi:!1,onClick:()=>{r.logInteraction(n.hitUiReveal()),i((0,Va.Ym)())},isDisabled:e,spec:n})};var qa=i(88975);const Ya=({deviceId:e,connectStateDeviceId:t,deviceName:i,supportsHiFi:n,spec:a})=>{const s=(0,ne.s)(),r=a.localDeviceFactory(),l=(0,Ta.tf)(P.bq.COMPUTER,!1),o=(0,qa.D)();return(0,b.jsx)(Ha,{deviceId:e,connectStateDeviceId:t,Icon:l,title:i,supportsHiFi:n,onClick:()=>{const{interactionId:t,pageInstanceId:i}=s.logInteraction(r.hitPullPlaybackToLocalDevice());o.transferPlayback(e,{interactionId:t,pageInstanceId:i})},spec:r})},Ga=()=>{const[e,t]=(0,Re.x)("connect-picker-recent-transfers",{});return{registerTransferAttempt:(0,n.useCallback)((i=>{t({...e,[i]:(new Date).getTime()})}),[e,t]),recentTransfersMap:e}};var Qa=i(57160),Za=i(10477),Ka=i(83441),Wa=i(83886),Ja=i(21153),Xa=i(5070);const $a=({position:e,deviceId:t,connectStateDeviceId:i,deviceName:n,deviceType:a,isGroup:r,supportsHiFi:l,canLogout:o,incarnation:c,jamSession:u,spec:d})=>{const p=(0,ne.s)(),m=d.remoteDeviceFactory({identifier:i,position:e}),g=(0,Ta.tf)(a,r);let v,x;(0,Ta.Mp)(a)&&(v=(0,Ta.$A)(a,"disconnected"),x=O.Ru.get("web-player.connect.device-picker.google-cast"));const h=(0,D.wA)(),{registerTransferAttempt:y}=Ga(),C=(0,qa.D)(),f=(0,ja.t)(m),j=(0,s.NC)(Qn.Yr),S=(0,Za.Ad)((e=>{const t=(0,Ja.d)(),i=(0,Tn.jE)(),n=(0,s.NC)(Qn.$4,{loadingValue:!1}),{data:a}=(0,jn.I)({queryKey:["useResolveJamFromConnectDevice",e],queryFn:()=>t.getJoinTokenFromConnectDeviceId(e),enabled:n}),{data:r}=(0,jn.I)({queryKey:["useResolveJamFromConnectDevice",a],queryFn:a?()=>t.getSessionInfo(a):Ka.hT,enabled:!!a});return(0,Xa.c)(Wa.P.SCAN_UPDATE,(()=>{i.invalidateQueries({queryKey:["useResolveJamFromConnectDevice",e]})})),r??null})(i));let w;w=j?u??null:S;return(0,b.jsx)(Ha,{deviceId:t,connectStateDeviceId:i,ref:f,Icon:g,TechIcon:v,title:n,subtitle:x,supportsHiFi:l,canLogout:o,incarnation:c,jamSession:w,onClick:()=>{if(w?.token&&!w.isSessionOwner){Aa(m)&&p.logInteraction(m.inPersonListeningSessionFactory({identifier:w.sessionId??w.token}).hitUiReveal());let e=Qa.EL.JOIN_LISTENING_SESSION;w.jamType===Da.H.NEARBY_JAM&&(e=Qa.EL.JOIN_NEARBY_JAM),h((0,sa.A9)(e,w.token,void 0,{id:t,name:n,type:a,isGroup:r}))}else{const{interactionId:e,pageInstanceId:n}=p.logInteraction(m.hitConnectToRemoteDevice({remoteDeviceId:i}));C.transferPlayback(t,{interactionId:e,pageInstanceId:n}),y(i)}},spec:m})},es=()=>(0,At.o)((e=>(e?.restrictions?.disallowTransferringPlaybackReasons?.length??0)>0));var ts=i(19454);const is=({devices:e,areWebPlayerCastDevicesAvailable:t=!1,networkHeadingID:i="",spec:n})=>{const a=(0,s.NC)(Qn.Yr),r=(0,ts.Ek)(),l=es(),o=n.containerViewFactory().deviceListFactory(),c=(0,ja.t)(o),u=(e,t)=>{const i=r?O.Ru.get("web-player.connect.device-picker.this-computer"):O.Ru.get("web-player.connect.device-picker.this-web-browser");if(e.isDisabled)return(0,b.jsx)(Ma,{position:e.isLocal?0:t+1,deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:e.isLocal?i:e.name,deviceType:e.isLocal?P.bq.COMPUTER:e.type,deviceModelName:e.modelDisplayName,isGroup:e.isGroup,disabledReason:e.disabledReason,canLogout:!e.isLocalNetwork&&e.supportsLogout,spec:o},e.id);if(e.isLocal&&(e=>e instanceof aa.B.ContainerViewEventFactory.DeviceListEventFactory||e instanceof aa.B.ContainerViewEventFactory.OnNetworkDeviceListEventFactory)(o))return(0,b.jsx)(Ya,{deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:i,supportsHiFi:e.supportsHiFi,spec:o},e.id);let n=null;return a&&(0,Za.HV)(e)?n=e.nearbyJamSession:(0,Za.C7)(e)&&(n=e.jamSession),(0,b.jsx)($a,{position:t+1,deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:e.name,deviceType:e.type,isGroup:e.isGroup,supportsHiFi:e.supportsHiFi,canLogout:!e.isLocalNetwork&&e.supportsLogout,incarnation:e.incarnation,jamSession:n,spec:o},e.id)};return(0,b.jsxs)(an.$,{circular:!1,ref:c,"aria-labelledby":`${Yn} ${i}`,"data-testid":`devices-list-${i}`,allowsMultipleInteractiveChildrenInItem:!0,children:[e.map(((e,t)=>u(e,t))),t&&(0,b.jsx)(za,{isDisabled:l,spec:n})]})},ns="local-network-heading",as="other-networks-heading",ss=({localNetworkDevices:e,otherNetworksDevices:t,spec:i})=>{const n=(0,s.NC)(Qn.Q5),a=e.length>0?O.Ru.get("web-player.connect.device-picker.on-this-network"):O.Ru.get("web-player.connect.device-picker.no-devices-local-network"),r=!n||n&&e.length<=0;return(0,b.jsxs)(b.Fragment,{children:[r&&(0,b.jsx)(c.E,{as:"h3",variant:n?"bodyMedium":"bodySmall",semanticColor:"textSubdued",className:Xn,id:ns,children:a}),e.length>0&&(0,b.jsx)(is,{devices:e,networkHeadingID:ns,spec:i}),t.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(c.E,{as:"h3",variant:n?"bodyMedium":"bodySmall",semanticColor:"textSubdued",className:o()(Xn,$n),id:as,children:O.Ru.get("web-player.connect.device-picker.on-other-networks")}),(0,b.jsx)(is,{devices:t,networkHeadingID:as,spec:i})]})]})};var rs=i(77592);const ls=({url:e,linkText:t,handleClick:i,elementRef:n})=>(0,b.jsx)("a",{className:o()(Fa),href:e,target:"_blank",ref:n,onClick:i,children:(0,b.jsx)(q.v,{title:t,id:t,isRedundantOnClick:!0,onClick:()=>{},"data-testid":"list-row-external-link",trailing:(0,b.jsx)(rs.H,{size:"small","data-testid":"icon-external-link",semanticColor:"textSubdued",role:"presentation",autoMirror:!0,"aria-hidden":"true"})})}),os=({spec:e})=>{const t=`https://www.spotify.com/connect${`?utm_campaign=connect&utm_medium=${(0,ts.Ek)()?"app":"web"}&utm_source=desktop`}`,i=e.containerViewFactory().externalConnectHubLinkFactory(),n=(0,ja.t)(i),a=(0,ne.s)();return(0,b.jsx)(ls,{url:t,linkText:O.Ru.get("web-player.connect.device-picker.connect-hub-external-link"),elementRef:n,handleClick:()=>{a.logInteraction(i.hitNavigateToExternalUri({destination:t}))}})},cs="https://support.spotify.com/article/spotify-connect/",us=({spec:e})=>{const t=e.containerViewFactory().externalHelpLinkFactory(),i=(0,ja.t)(t),n=(0,ne.s)();return(0,b.jsx)(ls,{url:cs,linkText:O.Ru.get("web-player.connect.device-picker.help-external-link"),elementRef:i,handleClick:()=>{n.logInteraction(t.hitNavigateToExternalUri({destination:cs}))}})};var ds=i(83534);const ps=[ds.h.en,ds.h.enGB],ms=()=>{const e=O.Ru.getLocaleForTranslation();return ps.includes(e)};const gs=({devices:e,areWebPlayerCastDevicesAvailable:t})=>{const i=(0,ts.Ek)(),n=es(),a=ms(),s=!i&&n?e.map((e=>({...e,isDisabled:!0}))):e,{recentTransfersMap:r}=Ga(),l=function(e,t){const i=[],n=e.find((e=>e.isLocal));n&&i.push(n);const a=e.filter((e=>!e.isLocal)),{usedDevices:s,unusedDevices:r}=function(e,t){const i=[],n=[];for(const a of e)t[a.sortingId]?i.push({device:a,timestamp:t[a.sortingId]}):n.push(a);return{usedDevices:i,unusedDevices:n}}(a,t);s.sort(((e,t)=>t.timestamp-e.timestamp));for(const e of s)i.push(e.device);const l=i.concat(function(e){return e.sort(((e,t)=>e.isLocal?-1:t.isLocal?1:e.name.toLowerCase().localeCompare(t.name.toLowerCase())))}(r));return l}(s,r),{spec:c}=(0,We.r)(aa.p,{}),u=l.filter((e=>e.isLocalNetwork)),d=l.filter((e=>!e.isLocalNetwork));return(0,b.jsxs)("div",{className:o()(Zn,Kn),children:[(0,b.jsx)("div",{children:i&&d.length>0?(0,b.jsx)(ss,{localNetworkDevices:u,otherNetworksDevices:d,spec:c}):(0,b.jsx)(is,{devices:l,areWebPlayerCastDevicesAvailable:t,spec:c})}),(0,b.jsxs)("div",{className:o()(ea),children:[(0,b.jsx)(us,{spec:c}),a&&(0,b.jsx)(os,{spec:c})]})]})};var vs=i(48498),xs=i(97230),bs=i(7609);const hs=(0,n.forwardRef)((function({Icon:e,title:t,subtitle:i},n){return(0,b.jsx)(rn.c,{className:Fa,children:(0,b.jsx)(q.v,{id:t,ref:n,"data-testid":"device-picker-row-sidepanel",media:(0,b.jsx)(e,{semanticColor:"textSubdued"}),title:(0,b.jsx)("span",{className:Oa,children:(0,b.jsx)(da.Zp,{label:t,renderInline:!0,children:(0,b.jsx)(je.d,{"data-testid":"list-row-title",lineClamp:1,semanticColor:"textBase",dir:"auto",children:t})})}),subtitle:(0,b.jsx)("div",{className:_a,children:(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:i})})})})}));var ys=i(24405);const Cs="Bjx5Gw7p3JoiF4qI6eMQ",fs=()=>{const{deviceFilterState:e,isMaybeHeadphoneDevice:t}=(0,ee.j)(),i=(0,se.j)(),n=(0,Ke.v)(),a=(0,Le.A)(),s=e.currentState.externalizationEnabled||e.currentState.specificEnabled,r=a===xe.Yn.LOSSLESS||a===xe.Yn.LOSSLESS_24;return(0,b.jsxs)("div",{className:Cs,children:[n&&s&&t&&(0,b.jsx)(He.C,{size:"small",semanticColor:"textBrightAccent"}),(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBrightAccent",children:i&&r&&"Lossless"})]})},js="A3PPnVKE5LH9mT5URPB2",Ss="cU0IpwDfJzDgQaY4MSXA",ws="dlS4nc0WL68C7_8zwfiS",Ns="pdLJBD_CNQ_r5Ad4mZZk",Es="FpmhhFL8lCsiyh3X0fjK",Rs="scv87ulfUcibJW8QhCeH",ks="oCa5Np4laJc3s5P2uUqw",Is=({onClick:e})=>{const{deviceName:t,formattedDeviceName:i}=M();return(0,b.jsx)("div",{className:ks,children:(0,b.jsx)(da.Zp,{label:i??t,children:(0,b.jsx)(ca.j,{lineClamp:1,onClick:e,children:(0,b.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:i??t})})})})};var Ls=i(53224);const As=({size:e="medium",className:t})=>{const i=(0,Di.j)(),n=(0,Ls.k)(e);return(0,b.jsx)(b.Fragment,{children:i?(0,b.jsx)(Se.A,{size:e,semanticColor:"textBrightAccent",className:t,"data-testid":"now-playing-active"}):(0,b.jsx)("img",{className:t,width:n,height:n,alt:"","aria-hidden":"true",src:(0,Pi.b)("images/device-picker-equaliser-animation.webp"),"data-testid":"animated-now-playing"})})};var Ts=i(94677);const Ds=({deviceType:e,isGroup:t,isLocalDevice:i,isPlaying:n})=>{const a=(0,Ts.g)();let s;if(n)s=(0,b.jsx)(As,{});else{const n=(0,Ta.tf)(e,t,i?a:null);s=(0,b.jsx)(n,{semanticColor:"textBrightAccent","data-testid":"device-icon",role:"presentation"})}return(0,b.jsxs)("div",{className:Ns,children:[(0,b.jsx)("div",{className:Es,children:s}),(0,b.jsx)(je.d,{variant:"titleSmall",semanticColor:"textBase",lineClamp:1,children:O.Ru.get("web-player.connect.device-picker.current-device")})]})};var Os=i(55055),_s=i(6726),Bs=i(14422),Fs=i(84277);const Us=()=>{const{currentDevice:e}=(0,Fs.l)(),{id:t,connectStateId:i,isLocalNetwork:n,supportsLogout:a}=e,r=(0,Bs.W)(),l=!n&&a,o=l,{spec:c}=(0,We.r)(aa.p,{}),u=(0,s.NC)(Qn.Q5),d=(0,Ke.v)(),p=(0,se.j)(),{deviceName:m,formattedDeviceName:g}=M(),v=r?Os.g:sn.V,x=u?_s.x:v,h=u?"textSubdued":"textBase";return(0,b.jsx)("div",{className:Rs,children:d||p?(0,b.jsx)(x,{"aria-label":O.Ru.get("more.label.context",g??m),size:"small",autoMirror:!1,semanticColor:h}):o&&(0,b.jsx)(Ra,{title:g??m,deviceId:t,connectStateDeviceId:i,allowForgetDevice:l,spec:c.containerViewFactory().headerFactory().activeDeviceFactory()})})};var Ps=i(27766),Hs=i(21527),Ms=i(35953),Vs=i(84621);const zs=()=>{const e=(0,Ja.d)(),{enqueueSnackbar:t}=(0,Ms.d)(),{spec:i,logger:a}=(0,We.r)(ys.g,{}),[s,r]=(0,n.useState)(Vs.ez.BROADCAST_STATUS_UNKNOWN),l=s===Vs.ez.BROADCAST_STATUS_UNKNOWN||s===Vs.ez.BROADCAST_UNAVAILABLE,o=s===Vs.ez.BROADCAST_ON;(0,Xa.c)(Wa.P.BROADCAST_STATUS_UPDATE,(({data:e})=>{r(e??Vs.ez.BROADCAST_STATUS_UNKNOWN)}));const c=(0,n.useCallback)((t=>e.setBroadcastStatus(t?Vs.ez.BROADCAST_ON:Vs.ez.BROADCAST_OFF)),[e]),u=(0,Hs.n)({mutationFn:c,onMutate:async e=>{const t=s;return r(e?Vs.ez.BROADCAST_ON:Vs.ez.BROADCAST_OFF),{prevBroadcastingState:t,allowBroadcasting:e}},onError:(e,i,n)=>{r(n?.prevBroadcastingState??Vs.ez.BROADCAST_STATUS_UNKNOWN),t(O.Ru.get("error.generic"))}});return{isHidden:l,toggleIsSwitchedOn:o,setToggleState:(0,n.useCallback)((e=>{const t=e?"device_discoverable_off":"device_discoverable_on",n=e?"device_discoverable_on":"device_discoverable_off";a.logInteraction(i.deviceDiscoverableToggleFactory().hitToggleState({stateBeforeToggle:t,stateAfterToggle:n})),u.mutate(e)}),[a,u,i])}},qs="k5CAXCZwazRLdTWi5mpN",Ys="f2Wgf5OqTaBlTRRKZe9X",Gs=()=>{const{isHidden:e,toggleIsSwitchedOn:t,setToggleState:i}=zs();return e?null:(0,b.jsxs)("div",{className:qs,children:[(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",as:"label",htmlFor:"jam.broadcasting",className:Ys,children:O.Ru.get("web-player.social-connect.broadcasting.toggle-label")}),(0,b.jsx)(De.l,{id:"jam.broadcasting",value:t,onSelected:i,condensed:!0})]})};var Qs=i(21395),Zs=i(71516),Ks=i(99920),Ws=i(77908),Js=i(66225);const Xs="device-picker-header",$s=({isPlaying:e})=>{const{currentDevice:t}=(0,Fs.l)(),{id:i,connectStateId:a,type:r,isLocal:l,isLocalNetwork:c,isGroup:u,incarnation:d,supportsLogout:p}=t,m=(0,Ke.v)(),g=(0,se.j)(),{togglePuffin:v}=(0,Ps.c)(),{currentSession:x}=(0,Js.D)(),h=(0,Ks.y)(),y=(0,s.NC)(Qn.$4),C=Boolean(x?.active),f=!C&&h,j=(0,Ta.HJ)(d),S=!c&&p,w=S||j,{spec:N,logger:E}=(0,We.r)(ys.g,{}),{uri:R}=(0,Ws.f)(),k=(0,n.useCallback)((()=>{E.logInteraction(N.createJamButtonFactory().hitUiNavigate({destination:R??""}))}),[E,N,R]),I=(0,b.jsx)(Na,{deviceId:i,connectStateDeviceId:a,allowForgetDevice:S,incarnation:j?d:void 0}),L=m||g,A=(0,b.jsx)(q.v,{className:o()(Ss,{[ws]:L}),id:Xs,variant:"naked",title:(0,b.jsx)(Ds,{deviceType:r,isGroup:u,isLocalDevice:l,isPlaying:e}),subtitle:(0,b.jsxs)("div",{className:ks,children:[(0,b.jsx)(Is,{onClick:L?v:void 0}),L&&(0,b.jsx)(fs,{})]}),trailing:(0,b.jsx)(Us,{}),"aria-labelledby":Xs,onClick:L?v:void 0,onClickHint:O.Ru.get("web-player.connect.device-picker.current-device"),body:h&&(0,b.jsxs)(b.Fragment,{children:[y&&(0,b.jsx)(Gs,{}),(0,b.jsx)("hr",{className:js})]}),footer:(0,b.jsxs)(b.Fragment,{children:[f&&(0,b.jsx)(Zs.$,{onClick:k}),C&&y&&(0,b.jsx)(Qs.K,{})]})});return w?(0,b.jsx)(ua.h,{menu:I,children:A}):A},er=({isDesktop:e})=>{const t=ms(),{spec:i}=(0,We.r)(aa.p,{}),n=i.containerViewFactory().noDevicesViewFactory(),a=(0,ja.t)(n);return(0,b.jsxs)("div",{ref:a,className:o()(ta,Kn,Zn),"data-testid":Gn,children:[(0,b.jsxs)("ul",{"aria-labelledby":`${Xs} ${Yn}`,className:ia,children:[(0,b.jsx)(hs,{Icon:vs.T,title:O.Ru.get("web-player.connect.device-picker.check-wifi"),subtitle:O.Ru.get("web-player.connect.device-picker.check-wifi-subtitle")}),(0,b.jsx)(hs,{Icon:_t.g,title:O.Ru.get("web-player.connect.device-picker.play-from-another"),subtitle:O.Ru.get("web-player.connect.device-picker.play-from-another-subtitle")}),e?(0,b.jsx)(hs,{Icon:xs.H,title:O.Ru.get("web-player.connect.device-picker.restart-speaker"),subtitle:O.Ru.get("web-player.connect.device-picker.restart-speaker-subtitle")}):(0,b.jsx)(hs,{Icon:bs.i,title:O.Ru.get("web-player.connect.device-picker.switch-to-app"),subtitle:O.Ru.get("web-player.connect.device-picker.switch-to-app-subtitle")})]}),(0,b.jsxs)("div",{"aria-describedby":Gn,children:[(0,b.jsx)(us,{spec:i}),t&&(0,b.jsx)(os,{spec:i})]})]})},tr=({devices:e,areWebPlayerCastDevicesAvailable:t})=>{const i=Boolean(e.find((e=>!e.isLocal))),n=e.filter((e=>!e.isActive&&e.name.length>0)),a=i||t,s=(0,ts.Ek)();return(0,b.jsxs)("div",{className:o()(Wn,Kn),children:[(0,b.jsx)(na,{foundDevices:a}),a?(0,b.jsx)(Ia,{children:(0,b.jsx)(gs,{devices:n,areWebPlayerCastDevicesAvailable:t})}):(0,b.jsx)(er,{isDesktop:s})]})},ir=()=>{const{currentDevice:e}=(0,Fs.l)(),{formattedDeviceName:t}=M(),i=(()=>{const e=(0,Le.A)(),t=(0,se.j)();return(0,n.useMemo)((()=>{const i=e===xe.Yn.LOSSLESS||e===xe.Yn.LOSSLESS_24;return t&&i?O.Ru.get("web-player.pigeon.audio-quality.lossless"):null}),[e,t])})(),a=O.Ru.get("web-player.connect.device-picker.this-computer");let s;(0,Ta.Mp)(e.type)&&(s=O.Ru.get("web-player.connect.device-picker.google-cast"));const r=[(t??null)&&a,s??null,i].filter(Boolean).join(" â€¢ ");return(0,b.jsx)(ca.j,{semanticColor:"textSubdued",lineClamp:1,children:r})};var nr=i(79464),ar=i(30767),sr=i(36499);const rr="cuG1_yCuW2Mnw3H6IUYD",lr=()=>{const{currentDevice:e}=(0,Fs.l)(),{type:t,isLocal:i,isGroup:n}=e,{isPlaying:a}=(0,sr.GK)(),s=(0,Ts.g)(),r=(0,Ke.v)(),l=(0,se.j)(),{togglePuffin:o}=(0,Ps.c)(),{deviceName:c}=M(),u=r||l,d=(0,ar.K)(),p=a?As:r&&d?He.C:(0,nr.tf)(t,n,i?s:null);return(0,b.jsx)(q.v,{id:"device-picker-header",variant:"naked",size:"md",className:rr,title:c,"data-testid":"device-picker-row-sidepanel",media:(0,b.jsx)(p,{semanticColor:"textBrightAccent","data-testid":"device-icon",role:"presentation"}),onClick:u?o:void 0,trailing:(0,b.jsx)(Us,{}),subtitle:(0,b.jsx)(ir,{})})},or="G6For7gcz2GTgCkOeJKc",cr=()=>{const{isHidden:e,toggleIsSwitchedOn:t,setToggleState:i}=zs();return e?null:(0,b.jsxs)("div",{className:or,children:[(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBase",as:"label",htmlFor:"jam.broadcasting",children:O.Ru.get("web-player.connect.device-picker.auto-invite-jam-toggle")}),(0,b.jsx)(De.l,{id:"jam.broadcasting",value:t,onSelected:i,condensed:!0})]})};var ur=i(55914);const dr="fkBkl4cpmR6fFGNpsPZx",pr=({openQueue:e})=>{const t=(0,Js.D)(),{uri:i}=(0,Ws.f)(),{spec:a,logger:s}=(0,We.r)(ys.g,{}),r=(0,n.useCallback)((()=>{s.logInteraction(a.createJamButtonFactory().hitUiNavigate({destination:i??""}))}),[s,a,i]);return(0,b.jsxs)("div",{className:dr,children:[(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",as:"label",htmlFor:"jam.broadcasting",children:O.Ru.get("web-player.connect.device-picker.start-jam-description")}),(0,b.jsx)(oe.n,{onClick:()=>{r(),t.createSession(),e()},iconLeading:ur.V,size:"small",children:O.Ru.get("web-player.connect.device-picker.start-jam")})]})};var mr=i(34506);const gr="rk32VTG0b6NU0RicbiOH",vr=()=>{const e=(0,Js.D)(),{openQueue:t}=(0,mr.R)(),i=e.currentSession?.active?(0,b.jsx)(Qs.K,{}):(0,b.jsx)(pr,{openQueue:t});return(0,b.jsxs)("div",{className:o()(gr),"aria-label":O.Ru.get("web-player.connect.device-picker.current-device"),role:"group",children:[(0,b.jsx)(lr,{}),(0,b.jsx)(cr,{}),i]})};var xr=i(80013);const br="Y5BWxTfO9OmenxMup_H7",hr="s0kxKAi2bTiuoEJhkYph",yr="Cdlb8uLk1VIkwKmGBViF",Cr=({Icon:e,title:t,subtitle:i,buttonText:a,onClick:s,onDismiss:r})=>{const{spec:l}=(0,We.r)(aa.p,{}),o=l.containerViewFactory().messageBoxViewFactory({identifier:t}),u=(0,ne.s)(),d=(0,n.useCallback)((()=>{u.logInteraction(o.dismissMessageBoxFactory().hitUiHide()),r()}),[u,o,r]),p=(0,n.useCallback)((()=>{u.logInteraction(o.recommendedActionButtonFactory().hitUiHide()),s()}),[u,o,s]),m=(0,b.jsxs)("div",{className:yr,children:[e&&(0,b.jsx)(e,{semanticColor:"textSubdued",size:"small"}),(0,b.jsx)(c.E,{variant:"bodyMediumBold",color:"baseText",children:t})]});return(0,b.jsx)(q.v,{id:"messageBox",variant:"elevated",size:"lg",className:br,title:m,subtitle:i,paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,b.jsx)(oe.n,{size:"small",onClick:p,children:a}),trailing:(0,b.jsx)(ce.H,{className:hr,semanticColor:"textBase",iconOnly:xr.M,size:"small",onClick:d,condensedAll:!0,"aria-label":O.Ru.get("close")})})},fr=e=>{if("object"==typeof e&&"custom"in e)return e.custom;switch(e){case"required":return 1e3;case"high":return 500;case"normal":return 300;case"low":return 100;default:return 0}},jr=()=>{const{deviceFilterState:e}=(0,ee.j)(),t=(0,n.useMemo)((()=>e.audioDevice?.id),[e.audioDevice?.id]),[i,a]=(0,Re.x)("onboarding-dismissed:puffin",{}),s=(0,n.useCallback)((()=>{t&&a({...i,[t]:(i[t]??0)+1})}),[t,i,a]);return{isDeviceDismissed:(0,n.useMemo)((()=>!!t&&i[t]>=3),[t,i]),incrementDismissCountForDevice:s}},Sr=()=>[(()=>{const e=(0,f._Y)(),{incrementDismissCountForDevice:t,isDeviceDismissed:i}=jr(),{deviceFilterState:n,isMaybeHeadphoneDevice:a}=(0,ee.j)(),s=n.isOnboarded,r=a&&!s&&!i;return{id:"puffinDevicePickerUpsell",title:O.Ru.get("web-player.puffin.get-started.title"),subtitle:O.Ru.get("web-player.puffin.get-started.subtitle"),buttonText:O.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm"),onClick:()=>{e(X.$S.PUFFIN_START_ACTIVATION)},onDismiss:()=>{t()},shouldShow:r,priority:"normal"}})()],wr=e=>{const t=e.filter((e=>e.shouldShow)).sort(((e,t)=>{return i=e.priority,n=t.priority,fr(i)<fr(n)?1:-1;var i,n}));return t[0]?t[0]:null};var Nr=i(83660),Er=i(7954);const Rr=()=>{const{currentDevice:e}=(0,Fs.l)(),t=Sr(),i=wr(t),[a,s]=(0,n.useState)(e.isLocal&&null!==i);if((0,Er.W)(Nr.P.UPDATE,(()=>s(e.isLocal&&null!==i))),null===i||!a)return null;return(0,b.jsx)(Cr,{...i,onDismiss:()=>{i.onDismiss(),s(!1)}})};var kr=i(91787);const Ir="hmVfxvHNFzG0vUNl80tU",Lr="TuVVAkUzyLv_yCLzKTqW",Ar=()=>{const[e,t]=(0,n.useState)(!0),{deviceFilterState:i,isMaybeHeadphoneDevice:a}=(0,ee.j)(),s=i.isOnboarded,{incrementDismissCountForDevice:r,isDeviceDismissed:l}=jr(),o=(0,n.useMemo)((()=>a&&!s&&!l),[l,a,s]),c=(0,f._Y)(),u=(0,n.useCallback)((()=>c(X.$S.PUFFIN_START_ACTIVATION)),[c]),d=(0,n.useCallback)((()=>{r(),t(!1)}),[r]);return o&&e?(0,b.jsx)(q.v,{id:"puffinDevicePickerUpsell",variant:"tinted",size:"lg",className:Ir,title:O.Ru.get("web-player.puffin.get-started.title"),subtitle:O.Ru.get("web-player.puffin.get-started.subtitle"),paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,b.jsx)(oe.n,{size:"small",onClick:u,children:O.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm")}),trailing:(0,b.jsx)(ce.H,{className:Lr,semanticColor:"textSubdued",iconOnly:xr.M,size:"small",onClick:d,condensedAll:!0,"aria-label":O.Ru.get("close")})}):null};var Tr=i(48861),Dr=i(18154),Or=i(62737);function _r(){return(0,fa.N)(Or.v)}const Br=()=>{const e=_r(),{devices:t,currentDevice:i}=(0,Fs.l)(),a=(()=>{const e=_r(),[t,i]=(0,n.useState)([]),a=(0,n.useCallback)((()=>{e.getJamDevices().then((e=>i(e)))}),[e]);return(0,Xa.c)(Wa.P.SCAN_UPDATE,(()=>a())),(0,n.useEffect)((()=>a()),[a]),t})(),[s,r]=(0,n.useState)(t.map((e=>(0,Za.gS)(e)))),l=(0,ra.dh)((()=>{const n=e.combineJamsWithEntities(t,a,i.connectStateId);r(n)}),100,{leading:!1,trailing:!0});return(0,n.useEffect)((()=>l()),[t,a,i,l]),s},Fr="h0XG5HZ9x0lYV7JNwhoA",Ur="JHlPg4iOkqbXmXjXwVdo",Pr="jEsh5c0FZojBDcUF990w",Hr=()=>{const e=(0,Dr.O)(),t=(0,Ke.v)(),i=(0,F.l)(),a=(0,kr.C)(),r=(0,s.NC)(Qn.Yr),l=(0,s.NC)(Qn.Q5),{devices:c}=(0,Fs.l)(),u=Br(),{isPlaying:d}=(0,sr.GK)(),[g]=(0,f.sV)(),v=(0,n.useRef)(a),x=(0,n.useRef)(g.context.devicePicker?.interactionId);v.current=a,x.current=g.context.devicePicker?.interactionId;const h=(0,D.d4)((e=>e.playback?.castState??window.cast?.framework.CastState.NO_DEVICES_AVAILABLE)),y=(0,Tr.Or)(h);return(0,n.useEffect)((()=>()=>{v.current(x.current)}),[x]),(0,n.useEffect)((()=>{e.startActiveDiscovery()}),[e]),(0,b.jsx)(et._,{label:O.Ru.get("playback-control.connect-picker"),focusTransferId:"DEVICE-PICKER",children:(0,b.jsx)(tt.w,{className:o()(Fr,{[Ur]:l}),fixedHeader:(0,b.jsx)(p.a,{title:l?(0,we.v)("Connect"):O.Ru.get("playback-control.connect-picker"),panel:m.Z.DevicePicker}),children:(0,b.jsxs)("div",{role:"group",className:Pr,children:[l?(0,b.jsx)(vr,{}):(0,b.jsx)($s,{isPlaying:d}),l?(0,b.jsx)(Rr,{}):t&&!i&&(0,b.jsx)(Ar,{}),(0,b.jsx)(tr,{devices:r?u:c.map((e=>(0,Za.gS)(e))),areWebPlayerCastDevicesAvailable:y})]})})})},Mr=()=>null;var Vr=i(53177),zr=i(85799),qr=i(83808),Yr=i(41654),Gr=i(95147),Qr=i(42551);const Zr=(0,Qr.Mz)([e=>e.ads],(e=>e.embeddedAd)),Kr=(0,Qr.Mz)(Zr,(e=>e?.ad)),Wr=(0,Qr.Mz)(Zr,(e=>e?.isOpen||!1)),Jr=(0,Qr.Mz)(Zr,(e=>e?.canShowAd||!1)),Xr=(0,Qr.Mz)(Zr,(e=>e?.lastTimeInView));var $r=i(61211),el=i(23898),tl=i(12689);const il=e=>{const t=(0,el.Z)(e);return!(!t||e&&!(0,tl.v)(e))&&t?.uid!==e?.uid};var nl=i(17145);const al=()=>{const e=(0,D.wA)(),t=(0,$r.$)(),i=(0,D.d4)((e=>e.ui.videoPlayer.uiFlags.npv)),a=(0,s.NC)(nl.Ym5,{loadingValue:!1}),r=(0,s.NC)(nl._TI),l=(0,At.o)((e=>e?.item),((e,t)=>e?.uid===t?.uid)),o=(0,D.d4)(Jr),c=!!(0,D.d4)(Kr),u=(0,D.d4)(Xr),d=(({canShowEmbeddedAd:e,nvpIsActive:t,trackChanged:i,featureEnabled:a,storeHasAd:s,isFocused:r,enoughTimePassedSinceLastRender:l})=>(0,n.useMemo)((()=>!!e&&t&&i&&a&&r&&!s&&l),[e,t,i,a,s,r,l]))({canShowEmbeddedAd:o,nvpIsActive:i,trackChanged:il(l),featureEnabled:a,storeHasAd:c,isFocused:t,enoughTimePassedSinceLastRender:!u||Date.now()-u>1e3*r});return(0,n.useEffect)((()=>{d&&e((0,Gr.PY)())}),[d,e,l]),null};var sl=i(52276);const rl=({children:e})=>{const[t,i]=(0,n.useState)(null),a=(0,n.useCallback)((()=>{i(sl.j.Errored)}),[]),s=(0,n.useMemo)((()=>({state:t,capturePlaybackError:a})),[t,a]);return(0,b.jsx)(sl.O.Provider,{value:s,children:e})},ll=(0,n.lazy)((()=>Promise.all([i.e(6411),i.e(1164),i.e(4917)]).then(i.bind(i,41318)))),ol=e=>(0,b.jsx)(rl,{children:(0,b.jsx)(ll,{...e})});var cl=i(24313),ul=i(25695),dl=i(81421);const pl=()=>(0,b.jsx)(b.Fragment,{});var ml=i(11024),gl=i(22152),vl=i(94124),xl=i(59232),bl=i(2160),hl=i(79175),yl=i(45474),Cl=i(25228),fl=i(19792);const jl="ykU0u_RLxGVmkHVI7if7",Sl="KpPP2M5NXZAY5NwqT1uf",wl=({uri:e})=>{const{spec:t,logger:i}=(0,We.r)(ml.t,{}),n=(0,D.wA)(),{data:a}=(0,gl.S)(e),[s,r]=(0,fl.A)(e);if(!a)return null;const{description:l,name:o,images:c}=a,u=(0,Cl.t)({avatarImages:c,preferFullBleed:!1});return(0,b.jsxs)(yl.M,{name:o,openModal:()=>{const e=t.authorAboutModalButtonFactory().hitUiReveal();i.logInteraction(e),n((0,sa.Te)({bio:a.description,images:a.images.slice(0,1),name:a.name}))},children:[(0,b.jsx)(bl.R,{cardVariant:u,avatarImageSources:c,header:O.Ru.get("web-player.now-playing-view.author-about.title"),name:o}),(0,b.jsxs)("div",{className:jl,children:[(0,b.jsxs)("div",{className:Sl,children:[(0,b.jsx)(hl.c,{name:o,uri:e,onLinkClick:()=>i.logInteraction(t.authorNameFactory().hitUiNavigate({destination:e}))}),(0,b.jsx)(xl.T,{toggleFollow:n=>{n.preventDefault(),n.stopPropagation();const a=s?t.followButtonFactory().hitUnfollow({itemToBeUnfollowed:e}):t.followButtonFactory().hitFollow({itemToBeFollowed:e});i.logInteraction(a),r(!s)},isInLibrary:s})]}),(0,b.jsx)(vl._,{text:l})]})]})},Nl=({item:e})=>{const t=e.book.authors.at(0)?.uri;return t?(0,b.jsx)(wl,{uri:t}):null};var El=i(69042),Rl=i(85547),kl=i(54541),Il=i(5603),Ll=i(65853),Al=i(1328),Tl=i(76226),Dl=i(65012),Ol=i(40075),_l=i(86238),Bl=i(35748),Fl=i(26879),Ul=i(1263);var Pl=i(54059),Hl=i(53936),Ml=i(96231);const Vl="_QEMUk5U16U3CQn0wvbD",zl="mbkl2P60JUhDqc9qGvp9",ql="Xh6dG3pzi2SS7v4cvZzG",Yl="sOdoW26RUwggLToa7xDt",Gl="B_TcBcc1BM2yLgvXbh66",Ql="tRnhyUQiKOxA3z8mUD_U",Zl="_shxqlkLuB52H1iCh_OQ",Kl="hAwePVlxumRNpdOSpwyV";const Wl=n.forwardRef((function({className:e="",segment:t,onClickPlay:i,isPlaying:a},s){const{label:r,Icon:l}=(0,n.useMemo)((()=>function(e){if("TALK"===e.type)return{Icon:Tl.L,label:O.Ru.get("playlist.a11y.play",e.title)};const t=e.track.artists?.map((e=>e.name)).join(O.Ru.getSeparator())||"";return{Icon:Dl.v,label:O.Ru.get("tracklist.a11y.play",e.track.name,t)}}(t)),[t]),c=(0,n.useCallback)((()=>{i()}),[i]);return(0,b.jsxs)("div",{className:o()(Zl,e),children:[a?(0,b.jsx)(Hl.J,{className:Ql,animated:!0}):(0,b.jsx)("span",{className:Ql,children:(0,b.jsx)(l,{iconSize:16,"aria-hidden":"true"})}),(0,b.jsx)(Bl.x,{className:Gl,iconClassName:Kl,onClick:c,isPlaying:a,isLocked:!1,playAriaLabel:r,ref:s})]})})),Jl=({children:e,onTriggerPlay:t,episodeUri:i,index:n})=>{const{spec:a,logger:s}=(0,We.r)(Ol.f,{}),r=(0,ra.YQ)((()=>{const e=s.logInteraction(a.segmentItemFactory({uri:i,position:n||0}).doubleHitPlay({itemToBePlayed:i}));t(e)}),Ml.d,{leading:!0,trailing:!1});return(0,b.jsx)("div",{className:Yl,onDoubleClick:r,children:e})},Xl=({segment:e,episodeUri:t,index:i})=>{const{spec:a,logger:s}=(0,We.r)(Ol.f,{}),{isActive:r,isPlaying:l,onClick:o}=(0,Pl.L)({episodeUri:t,start:e.start,stop:e.stop}),c={uri:t},u=function(e){const t=[{url:e.track.album.image}];return{type:Ul.c.TRACK,uri:e.uri,uid:null,provider:null,images:t,name:e.track.name,mediaType:"audio",duration:{milliseconds:0},album:{type:Ul.c.ALBUM,uri:e.track.album.uri,name:e.track.album.name,images:t},artists:e.track.artists.map((e=>({type:Ul.c.ARTIST,name:e.name,uri:e.uri})))}}(e),d=a.segmentItemFactory({uri:t,position:i||0}).playbackButtonFactory(),p=(0,n.useCallback)((()=>{o({}),r&&l?s.logInteraction(d.hitPause({itemToBePaused:t})):r&&!l?s.logInteraction(d.hitResume({itemToBeResumed:t})):s.logInteraction(d.hitPlay({itemToBePlayed:t}))}),[t,r,l,s,o,d]);return(0,b.jsxs)(Jl,{onTriggerPlay:o,episodeUri:t,children:[(0,b.jsx)(Wl,{segment:e,isActive:r,isPlaying:l,onClickPlay:()=>{p()}}),(0,b.jsx)(Fl.d,{context:c,item:u,titleTypeVariant:"bodyMedium",subtitleTypeVariant:"bodySmall",onTitleClick:e=>{s.logInteraction(a.segmentItemFactory({uri:t,position:i||0}).albumLinkFactory({uri:c.uri}).hitUiNavigate({destination:e||""}))},onSubtitleClick:e=>{s.logInteraction(a.segmentItemFactory({uri:t,position:i||0}).artistLinkFactory({uri:e||"",position:0}).hitUiNavigate({destination:e||""}))}})]})},$l=({segment:e,episodeUri:t,index:i})=>{const{spec:a,logger:s}=(0,We.r)(Ol.f,{}),{isActive:r,isPlaying:l,onClick:o}=(0,Pl.L)({episodeUri:t,start:e.start,stop:e.stop}),u=function(e){const t=[];return{type:Ul.c.UNKNOWN,uri:e.uri,uid:null,provider:null,images:t,name:e.title,mediaType:"audio",duration:{milliseconds:0},album:{type:Ul.c.ALBUM,uri:e.show.uri,name:e.show.name,images:t},artists:[]}}(e),d=a.segmentItemFactory({uri:t,position:i||0}).playbackButtonFactory(),p=(0,n.useCallback)((()=>{o({}),r&&l?s.logInteraction(d.hitPause({itemToBePaused:t})):r&&!l?s.logInteraction(d.hitResume({itemToBeResumed:t})):s.logInteraction(d.hitPlay({itemToBePlayed:t}))}),[t,r,l,s,o,d]);return(0,b.jsxs)(Jl,{onTriggerPlay:o,episodeUri:t,children:[(0,b.jsx)(Wl,{segment:e,isActive:r,isPlaying:l,onClickPlay:()=>{p()}}),(0,b.jsx)(_l.z,{title:u.name,children:(0,b.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:u.name})},u.name)]})};var eo=i(13659),to=i(81126);function io(e){return!!(0,to.o)().getCapabilities().isSupported&&function(e){const t=e.metadata?.["parent_episode.uri"];return!!t&&(0,Fn.gHQ)(t)}(e)}var no=i(86672);const ao=(0,Vr.mc)((({item:e})=>{const t=e.metadata?.["parent_episode.uri"],i=function(e){const t=(0,to.o)();return(0,n.useCallback)((async(i,n)=>{if(!e)return[];try{return await t.getSegments(e,i,n)}catch(e){return[]}}),[e,t])}(t),[a,s]=(0,n.useState)([]),r=(0,n.useRef)(!1),l=(0,n.useRef)(0),o=(0,n.useCallback)((()=>{const e=l.current;null!==e&&(r.current||(r.current=!0,i(e,10).then((e=>{s((t=>{const i=t.concat(e);return l.current=i.length+1,i})),r.current=!1}))))}),[i]);return(0,n.useEffect)((()=>{s([])}),[e.uri]),t?(0,b.jsxs)(eo.w,{className:Vl,children:[(0,b.jsx)(eo.X,{className:zl,children:O.Ru.get("music_and_talk.in_this_episode")}),(0,b.jsx)("div",{className:ql,children:(0,b.jsx)(no._,{onReachBottom:o,triggerOnInitialLoad:!0,children:a.map(((e,i)=>"MUSIC"===e.type?(0,b.jsx)(Xl,{segment:e,episodeUri:t},`${e.uri}-${i}`):(0,b.jsx)($l,{segment:e,episodeUri:t},`${e.uri}-${i}`)))})})]}):null}),{name:"NPVInThisEpisode"});var so=i(41388),ro=i(19573),lo=i(76696),oo=i(20554);const co="f6_Fu_ei4TIJWR0wzvTk",uo="TLmzadNIdvV8sYzTuXRg",po="MT9De6UrCVQ8Qo6o3ikA",mo=n.memo((()=>{const{cssStyles:e}=(0,oo.Yc)();return(0,b.jsx)("div",{className:co,style:{"--section-background-base":e?.["--section-background-base"]},"aria-hidden":!0,children:(0,b.jsxs)("div",{className:uo,children:[(0,b.jsx)(lo.Y,{as:"div",variant:"bodyMediumBold",className:po,charCount:8,isLoading:!0}),[20,50,25].map(((e,t)=>(0,b.jsx)(lo.Y,{as:"div",variant:"bodySmall",className:po,charCount:e,isLoading:!0},t)))]})})}));var go=i(2737),vo=i(42091),xo=i(83069),bo=i(55398);const ho=(0,n.lazy)((async()=>{const{TopCommentsCard:e}=await Promise.resolve().then(i.bind(i,52037));return{default:e}}));var yo=i(1108),Co=i(39132);const fo=({item:e,spec:t})=>{const i=(0,n.useCallback)((()=>{}),[]),a=(0,s.NC)(nl.cgF),r=(0,s.NC)(nl.xEc),l=(0,yo.d)(),o=(0,Co.d)(e.uri)?.episodeOrChapter,c=io(e),u={uri:e.uri,numberOfChapters:Al.Kp},{data:d,isLoading:p,error:m}=(0,vo.X)({queryKey:["queryNpvEpisode",u],staleTime:Al.Ff,gcTime:Al.CD,variables:u});if(p&&e.uri&&!m)return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(mo,{}),(0,b.jsx)(mo,{})]});const g=(0,Rl.SB)(d?.episodeUnionV2),v=(0,Rl.lz)(d?.episodeUnionV2);if(!e.uri||!g||p||m)return null;const x=o&&o.type===Ul.c.EPISODE&&o.transcript&&o.transcript.length>0;return(0,b.jsxs)(Ea.r,{spec:t,children:[l&&(0,b.jsx)(n.Suspense,{fallback:null,children:(0,b.jsx)(ho,{uri:g.uri})}),(0,b.jsx)(Ll.N,{episode:g}),!g.originalEpisode&&(0,b.jsx)(kl.c,{episode:g}),(0,b.jsx)(xo.F,{episode:g}),!c&&(0,b.jsx)(El.I,{episode:g}),r&&v&&(0,b.jsx)(ro.m,{coverArt:v.coverArt||void 0,description:v.htmlDescription||"",name:v.name,publisher:v.publisher?.name,uri:v.uri}),x&&(0,b.jsx)(b.Fragment,{children:a?(0,b.jsx)(bo.n,{episode:e}):(0,b.jsx)(Il.E,{episodeUri:e.uri})}),c&&(0,b.jsx)(ao,{item:e}),(0,b.jsx)(go.K,{topics:v?.topics.items??[],logTopicNavigation:i}),(0,b.jsx)(so.A,{})]})},jo=({item:e,spec:t})=>(0,Lt.n)()?(0,b.jsx)(fo,{item:e,spec:t}):(0,b.jsx)(b.Fragment,{}),So=()=>(0,b.jsx)(b.Fragment,{});var wo=i(44101),No=i(34933),Eo=i(25408),Ro=i(15793),ko=i(1196),Io=i(71076),Lo=i(5106);const Ao="main-nowPlayingView-sectionHeaderSpacing",To="main-nowPlayingView-lyricsTitle",Do="main-nowPlayingView-lyricsControls",Oo="y2ayfytLUMyeb3dafZmy",_o="xVOR38GuCNnraHeE56VZ",Bo="Rp8WpXLxe4HlMlQ79OLY",Fo="main-nowPlayingView-lyricsGradient",Uo="main-nowPlayingView-lyricsContent",Po=()=>{const{mode:e,setMode:t}=(0,Lo.r)();return(0,b.jsxs)("div",{className:Oo,children:[e===Qa.YU.npv&&(0,b.jsx)(d.$,{label:O.Ru.get("web-player.now-playing-view.lyrics.show-less"),colorSet:"invertedLight",size:"small",onClick:()=>{t(Qa.YU.static)},children:O.Ru.get("web-player.now-playing-view.lyrics.show-less")}),e===Qa.YU.static&&(0,b.jsx)(d.$,{label:O.Ru.get("web-player.now-playing-view.lyrics.show-more"),colorSet:"invertedLight",size:"small",onClick:()=>{t(Qa.YU.npv)},children:O.Ru.get("web-player.now-playing-view.lyrics.show-more")})]})};var Ho=i(30952),Mo=i(50132),Vo=i(80479);const zo=(0,n.memo)((()=>(0,b.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,b.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0.25 3C0.25 2.0335 1.0335 1.25 2 1.25H5.375V2.75H2C1.86193 2.75 1.75 2.86193 1.75 3V5.42857H0.25V3ZM14 2.75H10.625V1.25H14C14.9665 1.25 15.75 2.0335 15.75 3V5.42857H14.25V3C14.25 2.86193 14.1381 2.75 14 2.75ZM1.75 10.5714V13C1.75 13.1381 1.86193 13.25 2 13.25H5.375V14.75H2C1.0335 14.75 0.25 13.9665 0.25 13V10.5714H1.75ZM14.25 13V10.5714H15.75V13C15.75 13.9665 14.9665 14.75 14 14.75H10.625V13.25H14C14.1381 13.25 14.25 13.1381 14.25 13Z",fill:"currentColor"})}))),qo=()=>{const{setMode:e}=(0,Lo.r)(),t=(0,n.useCallback)((()=>{e(Qa.YU.none)}),[e]);return(0,b.jsx)(ya.D,{role:"menuitem",onClick:t,children:O.Ru.get("web-player.now-playing-view.lyrics.hide-option")})},Yo=()=>(0,b.jsx)(ba.W,{children:(0,b.jsx)(qo,{})}),Go=()=>{const{spec:e,logger:t}=(0,We.r)(Mo.X,{}),i=(0,ja.t)(e.cinemaModeButtonFactory()),{setMode:a}=(0,Lo.r)(),s=(0,n.useRef)(null);return(0,W.X)("NPV_OPEN_CINEMA_LYRICS",s,3e3),(0,b.jsx)("div",{ref:i,className:Do,children:(0,b.jsx)(Vo.D,{ref:s,label:O.Ru.get("web-player.now-playing-view.lyrics.cinema-mode"),onClick:()=>{a(Qa.YU.cinema),t.logInteraction(e.cinemaModeButtonFactory().hitUiReveal())},children:(0,b.jsx)(zo,{})})})},Qo=()=>(0,b.jsx)("div",{className:Do,children:(0,b.jsx)(ma.b,{placement:"bottom-end",menu:(0,b.jsx)(Yo,{}),children:(0,b.jsx)(cl.e,{size:"small",condensed:!1,label:O.Ru.get("more")})})}),Zo=()=>{const{spec:e,logger:t}=(0,We.r)(Mo.X,{}),i=(0,ja.t)(e.showLyricsButtonFactory()),{setMode:n}=(0,Lo.r)();return(0,b.jsx)("div",{ref:i,className:Do,children:(0,b.jsx)(Vo.D,{label:O.Ru.get("web-player.now-playing-view.show.lyrics"),onClick:()=>{n(Qa.YU.npv),t.logInteraction(e.showLyricsButtonFactory().hitUiReveal())},children:(0,b.jsx)(Ho.r,{size:"small"})})})};var Ko=i(74549),Wo=i(97143),Jo=i(30911);const Xo=(0,Vr.mc)((({item:e})=>{const t=(0,n.useRef)(null),{mode:i}=(0,Lo.r)(),a=(0,n.useRef)(null),s=(0,n.useRef)(0),{data:r}=(0,Io.J)(),l=(0,At.o)((e=>e?.nextItems?.[0]),((e,t)=>e?.uri===t?.uri));(0,ko.I)(l?.uri,l?.images);const u=(0,n.useCallback)((()=>{s.current=Date.now()}),[]),d=(0,n.useCallback)((({lineRef:e,isActiveLine:n,shouldAnimateScroll:r,activeLineIndex:l,isFirstLine:o})=>{if(i===Qa.YU.static)return;if(!t.current||!a.current)return;let c;if(e.current&&n?c=e.current?.offsetTop-a.current?.offsetTop-16:o&&l<0&&(c=0),void 0===c)return;const u=a.current?.scrollTop,d=Math.abs(u-c),p=t.current.clientHeight,m=Date.now()-s.current<2e3,g=s.current>0&&d>1*p;if(m||g)return;s.current=0;const v="visible"===document.visibilityState&&r?"smooth":"auto";a.current?.scrollTo({top:c,behavior:v})}),[i]);(0,n.useLayoutEffect)((()=>{s.current=0,a.current?.scrollTo({top:0,behavior:"auto"})}),[e.uri]);const p=(0,Jo.H)(),m=p?.higherContrast;if(!r?.hasLyrics)return null;const g=r?.hasLyrics&&!r.isTimeSynced,v={"--lyrics-color-active":m?.textBase.toCSS(Wo.a.RGBA)??(g?Eo.ONy:r.colors.activeText),"--lyrics-color-inactive":m?.textSubdued.toCSS(Wo.a.RGBA)??r.colors.text,"--lyrics-color-passed":m?.textBase.toCSS(Wo.a.RGBA)??Ko.Q.fromCSS(r.colors.activeText,.7).toCSS(Wo.a.RGBA),"--lyrics-color-background":m?.backgroundBase.toCSS(Wo.a.RGBA)??r.colors.background};return i===Qa.YU.npv?(0,b.jsxs)(eo.w,{className:o()(Ao,Fo),style:v,ref:t,children:[(0,b.jsx)(eo.X,{action:(0,b.jsx)(Go,{}),className:To,children:O.Ru.get("web-player.lyrics.title")}),(0,b.jsx)(Po,{}),(0,b.jsxs)("div",{className:Uo,ref:a,onWheel:u,onScroll:u,children:[g&&(0,b.jsx)(c.E,{as:"p",variant:"bodySmall",dir:"auto",style:{color:r.colors.text},children:O.Ru.get("web-player.lyrics.unsynced")}),(0,b.jsx)(Ro.x,{trackUri:e.uri,data:r,format:"card",onActiveLineChange:d})]})]}):i===Qa.YU.static?(0,b.jsxs)(eo.w,{className:o()(Ao,Fo,_o),ref:t,style:v,children:[(0,b.jsx)(eo.X,{action:(0,b.jsx)(Qo,{}),className:To,children:O.Ru.get("web-player.now-playing-view.lyrics.title-preview")}),(0,b.jsx)(Po,{}),(0,b.jsx)("div",{className:Uo,ref:a,onWheel:u,onScroll:u,children:(0,b.jsx)(Ro.x,{trackUri:e.uri,data:{...r,isTimeSynced:!1},format:"card",onActiveLineChange:d})})]}):(0,b.jsx)(eo.w,{className:o()(Ao,Fo,Bo),style:v,children:(0,b.jsx)(eo.X,{action:(0,b.jsx)(Zo,{}),children:O.Ru.get("web-player.lyrics.title")})})}),{name:"NPVLyrics"});var $o=i(96170),ec=i(13425),tc=i(92655),ic=i(91900);const nc=({item:e,spec:t})=>{const i=(0,s.NC)(nl.LX5),{loading:n,error:a,data:r}=(0,ic.i)(e),l=(0,s.NC)(nl.yux),o=io(e);if(n&&e.uri&&!a)return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(mo,{}),(0,b.jsx)(mo,{}),(0,b.jsx)(mo,{})]});if(!e.uri||"Artist"!==r?.artistUnion.__typename||"Track"!==r?.trackUnion.__typename||n||a)return null;const{profile:c,stats:u,visuals:d,profile:{externalLinks:p}}=r.artistUnion,{credits:m}=r.trackUnion;return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(Ea.r,{spec:t,children:[l&&(0,b.jsx)(Xo,{item:e}),i&&(0,b.jsx)(tc.a,{data:r,item:e}),(0,b.jsx)(wo.F,{artistUri:r.artistUnion.uri,artist:c,stats:u,visuals:d,externalLinks:p.items}),m&&(0,b.jsx)(No.V,{data:m,trackUri:e.uri}),(0,b.jsx)(ec.I,{artistId:r.artistUnion.id,data:r.artistUnion.goods.concerts}),(0,b.jsx)($o.J,{artistId:r.artistUnion.id,artistUri:r.artistUnion.uri,merch:r.trackUnion.merch.items}),o&&(0,b.jsx)(ao,{item:e})]})})},ac=({item:e,spec:t})=>(0,Lt.n)()&&e.artists[0].uri?(0,b.jsx)(nc,{item:e,spec:t}):(0,b.jsx)(b.Fragment,{});var sc=i(63365),rc=i(55),lc=i(37639);const oc=({item:e,spec:t})=>(0,tl.v)(e)&&!e.isLocal?(0,b.jsx)(ac,{item:e,spec:t}):(0,tl.v)(e)&&e.isLocal?(0,b.jsx)(So,{}):(0,lc.p)(e)?(0,b.jsx)(jo,{item:e,spec:t}):(0,rc.d)(e)?(0,b.jsx)(Nl,{item:e}):(0,sc.N)(e)?(0,b.jsx)(pl,{}):null;var cc=i(73138),uc=i(44891),dc=i(42435),pc=i(44529);const mc=({className:e="",width:t=196,height:i=59})=>(0,b.jsxs)("svg",{width:t,height:i,viewBox:"0 0 196 59",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:e,children:[(0,b.jsx)("path",{d:"M30.4234 0.444092C24.6972 0.444092 19.0996 2.14836 14.3385 5.34137C9.57745 8.53438 5.86676 13.0727 3.67575 18.3824C1.48474 23.692 0.911825 29.5346 2.02946 35.171C3.14709 40.8075 5.90506 45.9848 9.95459 50.048C14.0041 54.1113 19.1633 56.878 24.7796 57.9984C30.396 59.1187 36.2172 58.5423 41.5072 56.3421C46.7971 54.1419 51.3181 50.4166 54.4984 45.6375C57.6787 40.8584 59.3755 35.24 59.3741 29.493C59.3714 21.7884 56.3201 14.4003 50.8912 8.95292C45.4623 3.50559 38.1001 0.445011 30.4234 0.444092ZM43.6991 42.352C43.5758 42.5554 43.4137 42.7323 43.2221 42.8727C43.0305 43.0132 42.8132 43.1143 42.5827 43.1704C42.3521 43.2265 42.1128 43.2364 41.8785 43.1995C41.6441 43.1627 41.4193 43.0799 41.2168 42.9557C34.4199 38.792 25.8633 37.8448 15.7855 40.1556C15.5545 40.2087 15.3152 40.2156 15.0815 40.1759C14.8477 40.1362 14.6241 40.0506 14.4233 39.9242C14.0177 39.6688 13.7299 39.2621 13.6231 38.7937C13.5702 38.5618 13.5633 38.3217 13.6029 38.0871C13.6424 37.8525 13.7277 37.6281 13.8537 37.4265C13.9797 37.225 14.144 37.0503 14.3373 36.9125C14.5305 36.7747 14.7489 36.6765 14.98 36.6234C26.0085 34.0939 35.4709 35.1834 43.101 39.8642C43.3032 39.9879 43.4792 40.1505 43.6187 40.3426C43.7582 40.5347 43.8587 40.7525 43.9142 40.9836C43.9698 41.2147 43.9794 41.4545 43.9425 41.6893C43.9055 41.9241 43.8229 42.1493 43.6991 42.352ZM47.2428 34.4409C47.0877 34.6954 46.8841 34.9166 46.6436 35.092C46.4031 35.2673 46.1305 35.3932 45.8414 35.4625C45.5523 35.5318 45.2524 35.5431 44.959 35.4959C44.6655 35.4486 44.3842 35.3436 44.1313 35.1869C36.3491 30.3882 24.4874 28.9968 15.2808 31.8004C14.9941 31.8986 14.6906 31.9379 14.3884 31.9159C14.0862 31.8939 13.7916 31.811 13.522 31.6723C13.2523 31.5336 13.0133 31.3419 12.8191 31.1085C12.6249 30.8751 12.4795 30.6049 12.3915 30.3139C12.3035 30.023 12.2748 29.7172 12.307 29.4149C12.3393 29.1126 12.4318 28.8198 12.5792 28.5541C12.7265 28.2885 12.9256 28.0553 13.1647 27.8684C13.4037 27.6816 13.6778 27.545 13.9705 27.4667C24.4839 24.2641 37.5556 25.8151 46.4925 31.3251C46.7457 31.4801 46.966 31.6838 47.1408 31.9243C47.3155 32.1648 47.4413 32.4376 47.511 32.727C47.5807 33.0163 47.5928 33.3166 47.5468 33.6107C47.5008 33.9048 47.3975 34.1869 47.2428 34.4409ZM47.547 26.2037C38.2125 20.652 22.821 20.1281 13.9117 22.8415C13.2241 23.0504 12.4819 22.9765 11.8484 22.6362C11.215 22.2959 10.7422 21.717 10.534 21.0268C10.3259 20.3366 10.3995 19.5917 10.7386 18.956C11.0776 18.3202 11.6545 17.8457 12.3422 17.6368C22.5686 14.514 39.5677 15.1247 50.3128 21.5264C50.9303 21.8945 51.3769 22.4938 51.5542 23.1923C51.7315 23.8908 51.6251 24.6314 51.2583 25.2512C50.8916 25.871 50.2945 26.3192 49.5985 26.4972C48.9025 26.6751 48.1645 26.5683 47.547 26.2002V26.2037Z"}),(0,b.jsx)("path",{d:"M80.2385 27.2689C75.2394 26.0718 74.3612 25.2322 74.3612 23.4522C74.3612 21.7867 75.9239 20.6764 78.2472 20.6764C80.5013 20.6764 82.7415 21.5265 85.0821 23.2822C85.1547 23.3303 85.2427 23.3492 85.3286 23.335C85.4145 23.3209 85.4919 23.2747 85.5453 23.2058L87.9861 19.736C88.0308 19.6663 88.049 19.5828 88.0376 19.5007C88.0262 19.4186 87.9858 19.3433 87.9239 19.2884C85.2133 17.0732 81.8079 15.8942 78.3128 15.9609C72.9161 15.9609 69.1443 19.2225 69.1443 23.8755C69.1443 28.8615 72.3975 30.6277 78.0155 31.9913C82.8003 33.0981 83.6093 34.0246 83.6093 35.6796C83.6093 37.5152 81.974 38.6567 79.35 38.6567C76.4321 38.6567 74.0501 37.6713 71.3984 35.357C71.3317 35.3013 71.2465 35.2728 71.1599 35.2772C71.1163 35.2801 71.0738 35.2921 71.0351 35.3124C70.9964 35.3327 70.9624 35.3609 70.9351 35.3951L68.197 38.6637C68.1421 38.7285 68.1146 38.8123 68.1204 38.8973C68.1262 38.9822 68.1649 39.0615 68.2281 39.1182C71.2412 41.8652 75.1687 43.3825 79.2394 43.3721C85.0544 43.3721 88.8124 40.1834 88.8124 35.2459C88.8124 31.0614 86.3301 28.754 80.2385 27.2689Z"}),(0,b.jsx)("path",{d:"M101.988 22.321C99.4675 22.321 97.4001 23.3169 95.6922 25.3571V23.0601C95.6881 22.9746 95.6526 22.8937 95.5926 22.8328C95.5326 22.772 95.4524 22.7355 95.3672 22.7305H90.8728C90.7877 22.7355 90.7074 22.772 90.6474 22.8328C90.5874 22.8937 90.552 22.9746 90.5479 23.0601V48.5976C90.552 48.6831 90.5874 48.7641 90.6474 48.8249C90.7074 48.8858 90.7877 48.9222 90.8728 48.9273H95.3499C95.4351 48.9222 95.5153 48.8858 95.5753 48.8249C95.6353 48.7641 95.6708 48.6831 95.6749 48.5976V40.5373C96.4489 41.4553 97.4173 42.1883 98.5094 42.6829C99.6015 43.1775 100.79 43.4213 101.988 43.3964C106.672 43.3964 111.416 39.7775 111.416 32.8587C111.416 25.94 106.655 22.321 101.988 22.321ZM106.192 32.8587C106.192 36.3806 104.031 38.8406 100.933 38.8406C97.8357 38.8406 95.5643 36.2695 95.5643 32.8587C95.5643 29.448 97.8737 26.8769 100.951 26.8769C104.028 26.8769 106.192 29.3924 106.192 32.8587Z"}),(0,b.jsx)("path",{d:"M123.55 22.321C117.518 22.321 112.792 26.9809 112.792 32.9351C112.792 38.8337 117.486 43.4346 123.478 43.4346C129.531 43.4346 134.271 38.7886 134.271 32.8587C134.271 26.9289 129.562 22.321 123.55 22.321ZM123.55 38.8788C120.342 38.8788 117.922 36.2903 117.922 32.8587C117.922 29.4271 120.259 26.915 123.478 26.915C126.696 26.915 129.141 29.4931 129.141 32.9351C129.141 36.3771 126.79 38.8788 123.55 38.8788Z"}),(0,b.jsx)("path",{d:"M147.153 22.7305H142.23V17.675C142.225 17.5895 142.189 17.509 142.128 17.4488C142.067 17.3886 141.987 17.353 141.902 17.3488H137.428C137.385 17.3484 137.342 17.3565 137.302 17.3727C137.263 17.3888 137.226 17.4128 137.196 17.4431C137.165 17.4735 137.141 17.5096 137.124 17.5494C137.108 17.5892 137.099 17.6319 137.099 17.675V22.7305H134.946C134.86 22.7355 134.78 22.7719 134.72 22.8328C134.66 22.8936 134.625 22.9746 134.621 23.0601V26.9219C134.621 27.0084 134.655 27.0914 134.716 27.1526C134.777 27.2137 134.859 27.2481 134.946 27.2481H137.099V37.241C137.099 41.2764 139.101 43.3235 143.049 43.3235C144.515 43.3607 145.963 43.0011 147.243 42.2826C147.292 42.2527 147.333 42.2111 147.362 42.1614C147.391 42.1117 147.407 42.0556 147.409 41.9981V38.3167C147.407 38.2607 147.393 38.2059 147.365 38.157C147.338 38.108 147.3 38.0664 147.253 38.0356C147.204 38.0076 147.149 37.9929 147.093 37.9929C147.036 37.9929 146.981 38.0076 146.932 38.0356C146.12 38.4574 145.218 38.6753 144.304 38.6706C142.87 38.6706 142.23 38.0148 142.23 36.5506V27.2481H147.153C147.196 27.2486 147.239 27.2405 147.278 27.2243C147.318 27.2081 147.355 27.1841 147.385 27.1538C147.416 27.1235 147.44 27.0874 147.456 27.0476C147.473 27.0078 147.481 26.9651 147.481 26.9219V23.0601C147.477 22.974 147.441 22.8926 147.381 22.8317C147.32 22.7707 147.239 22.7347 147.153 22.7305Z"}),(0,b.jsx)("path",{d:"M164.315 22.7513V22.1302C164.315 20.3016 165.006 19.4897 166.579 19.4897C167.439 19.4996 168.292 19.6568 169.099 19.9547C169.148 19.9717 169.201 19.9765 169.252 19.9687C169.303 19.9608 169.352 19.9405 169.393 19.9096C169.436 19.8794 169.471 19.8394 169.495 19.7929C169.519 19.7464 169.532 19.6948 169.531 19.6424V15.8569C169.529 15.7869 169.506 15.7194 169.464 15.663C169.423 15.6067 169.366 15.5642 169.3 15.5411C168.093 15.1733 166.837 14.9931 165.576 15.0068C161.445 15.0068 159.26 17.3419 159.26 21.7589V22.7097H157.11C157.021 22.7141 156.937 22.7526 156.876 22.8172C156.815 22.8818 156.781 22.9675 156.781 23.0566V26.922C156.781 26.9651 156.79 27.0078 156.806 27.0476C156.823 27.0874 156.847 27.1235 156.878 27.1538C156.908 27.1842 156.944 27.2081 156.984 27.2243C157.024 27.2405 157.067 27.2486 157.11 27.2481H159.26V42.6574C159.257 42.7019 159.264 42.7466 159.279 42.7886C159.294 42.8306 159.317 42.8691 159.348 42.9016C159.378 42.9341 159.415 42.96 159.456 42.9777C159.497 42.9954 159.541 43.0045 159.585 43.0044H164.062C164.151 42.9999 164.234 42.9614 164.296 42.8968C164.357 42.8322 164.391 42.7465 164.391 42.6574V27.2481H168.567L174.97 42.6539C174.244 44.2743 173.528 44.597 172.55 44.597C171.682 44.5766 170.833 44.338 170.081 43.903C170.042 43.8808 169.999 43.8671 169.954 43.8629C169.909 43.8586 169.864 43.8638 169.821 43.8782C169.778 43.8926 169.739 43.9158 169.706 43.9464C169.673 43.977 169.646 44.0142 169.628 44.0557L168.111 47.3971C168.075 47.4724 168.07 47.5585 168.097 47.6373C168.123 47.7162 168.179 47.7818 168.252 47.8204C169.708 48.6484 171.357 49.0724 173.03 49.0487C176.335 49.0487 178.164 47.5047 179.772 43.3479L187.54 23.2232C187.558 23.173 187.564 23.1194 187.558 23.0665C187.552 23.0135 187.534 22.9627 187.506 22.9179C187.474 22.875 187.434 22.84 187.387 22.8153C187.34 22.7906 187.289 22.7771 187.236 22.7756H182.579C182.512 22.7776 182.446 22.7993 182.391 22.8382C182.336 22.877 182.293 22.9312 182.268 22.9942L177.497 36.679L172.266 22.963C172.243 22.9008 172.201 22.8472 172.147 22.8094C172.093 22.7716 172.028 22.7513 171.962 22.7513H164.315Z"}),(0,b.jsx)("path",{d:"M154.365 22.7305H149.891C149.71 22.7305 149.562 22.878 149.562 23.0601V42.6574C149.562 42.8394 149.71 42.987 149.891 42.987H154.365C154.546 42.987 154.693 42.8394 154.693 42.6574V23.0601C154.693 22.878 154.546 22.7305 154.365 22.7305Z"}),(0,b.jsx)("path",{d:"M152.152 13.8062C151.517 13.8055 150.895 13.9941 150.367 14.348C149.838 14.7019 149.426 15.2053 149.182 15.7945C148.939 16.3836 148.875 17.032 148.999 17.6576C149.122 18.2832 149.428 18.8579 149.878 19.3089C150.327 19.7599 150.9 20.067 151.523 20.1913C152.146 20.3155 152.792 20.2514 153.379 20.007C153.966 19.7626 154.468 19.3489 154.821 18.8183C155.173 18.2877 155.361 17.664 155.361 17.0262C155.361 16.1722 155.023 15.3532 154.421 14.7493C153.819 14.1455 153.003 13.8062 152.152 13.8062Z"}),(0,b.jsx)("path",{d:"M191.364 29.0316C190.74 29.0302 190.13 28.8432 189.611 28.4942C189.092 28.1452 188.688 27.6498 188.45 27.0706C188.212 26.4914 188.15 25.8543 188.272 25.2398C188.394 24.6253 188.695 24.0608 189.136 23.6177C189.578 23.1746 190.14 22.8727 190.753 22.7501C191.365 22.6275 192 22.6898 192.577 22.9289C193.154 23.1681 193.648 23.5735 193.995 24.094C194.343 24.6144 194.529 25.2266 194.531 25.8533C194.531 26.6962 194.197 27.5046 193.603 28.1007C193.009 28.6967 192.204 29.0316 191.364 29.0316ZM191.381 23.0081C190.817 23.0026 190.264 23.1656 189.792 23.4765C189.32 23.7874 188.951 24.232 188.732 24.7539C188.513 25.2758 188.453 25.8514 188.56 26.4074C188.668 26.9635 188.938 27.4749 189.335 27.8766C189.733 28.2783 190.241 28.5522 190.795 28.6635C191.348 28.7748 191.922 28.7184 192.443 28.5015C192.964 28.2846 193.41 27.917 193.722 27.4454C194.035 26.9739 194.201 26.4197 194.199 25.8533C194.201 25.4805 194.13 25.1109 193.989 24.7658C193.849 24.4207 193.642 24.1069 193.38 23.8424C193.118 23.578 192.806 23.3682 192.463 23.225C192.12 23.0818 191.753 23.008 191.381 23.0081ZM192.073 26.176L192.961 27.4285H192.221L191.419 26.28H190.728V27.4285H190.099V24.1114H191.571C192.339 24.1114 192.847 24.507 192.847 25.1697C192.857 25.4011 192.785 25.6286 192.645 25.8124C192.505 25.9963 192.305 26.125 192.08 26.176H192.073ZM191.54 24.6805H190.721V25.7214H191.54C191.948 25.7214 192.194 25.5202 192.194 25.1975C192.194 24.8748 191.955 24.6805 191.547 24.6805H191.54Z"})]});var gc=i(93105);const vc="Ez4qKWmsDLh3iWdsnhKb",xc="El6RgUu_hnfYFJu47_6O",bc="ekcURLG5sTWx5S7E_Ul_",hc="_ChTSMj9kopaozdg25FG",yc=(0,n.forwardRef)((({spec:e,logger:t},i)=>{const a=(0,zi.mv)(),s=a.operatingSystem===gc.f.macOS?(0,Pi.b)("images/download-page-image-mac.png"):(0,Pi.b)("images/download-page-image.png");const{downloadUrl:r}=(0,pc.z)(),l=(0,n.useCallback)((()=>{t.logInteraction(e.buttonDownloadFactory().hitNavigateToExternalUri({destination:r})),window.open(r,"_blank")}),[r,t,e]);return(0,b.jsxs)("div",{className:vc,ref:i,children:[(0,b.jsx)(mc,{className:xc,height:27,width:99}),(0,b.jsx)("div",{className:bc,style:{"--background-image":`url(${s})`}}),(0,b.jsxs)("div",{className:hc,children:[(0,b.jsx)(c.E,{variant:"titleMedium",semanticColor:"textBase",children:O.Ru.get("web-player.now-playing-view.web2desktop-funnel.title",{device:(0,dc.e)(a.operatingSystem)})}),(0,b.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:O.Ru.get("web-player.now-playing-view.web2desktop-funnel.subtitle")}),(0,b.jsx)(d.$,{size:"medium",colorSet:"brightAccent",onClick:l,style:{alignSelf:"flex-start"},"aria-label":O.Ru.get("web-player.now-playing-view.web2desktop-funnel.button"),children:O.Ru.get("web-player.now-playing-view.web2desktop-funnel.button")})]})]})})),Cc="Yl2wNWzQgsRb49UB30No",fc="Ko2eaQC7YRLTy1QsIY4Q";function jc(){const e=(0,uc.K)(),{spec:t,logger:i}=(0,We.r)(cc.l,{}),a=(0,ja.t)(t),s=(0,n.useCallback)((()=>{i.logInteraction(t.buttonSearchFactory().hitFocusInputField()),document.querySelector("[data-top-bar-search]")?.focus()}),[i,t]);return e?(0,b.jsx)(yc,{spec:t,ref:a,logger:i}):(0,b.jsxs)("div",{className:Cc,ref:a,children:[(0,b.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",className:fc,children:O.Ru.get("queue.fine-something")}),(0,b.jsx)(d.$,{size:"small",colorSet:"brightAccent",onClick:s,children:O.Ru.get("web-player.now-playing-view.empty-state-cta")})]})}var Sc=i(25745),wc=i(75773),Nc=i(11440),Ec=i(53115),Rc=i(30275),kc=i(63673),Ic=i(45315),Lc=i(55995);const Ac="KHaAkbA62j5I7pcLsDAx",Tc="Zaorh8_jZ8Vlyn3v2N3B",Dc="jKvr1cqkZZXpH5z92z9b",Oc="peN_VMHSmvTVUx9rneyY",_c=({context:e,item:t,index:i,isVisible:n})=>{const{spec:a,logger:s}=(0,We.r)(Yr.J,{}),{draggable:r,onDragStart:l}=(0,Lc.P)(),{ref:c,inView:u}=(0,wc.Wx)({threshold:.5,initialInView:!0});return(0,b.jsx)("div",{className:o()(Ac,{[Tc]:n}),"data-testid":"minimized-track-visual-enhancement",children:(0,b.jsx)(ua.h,{menu:(0,b.jsx)(ul.W,{context:e,item:t}),children:(0,b.jsx)("div",{draggable:r&&(0,tl.v)(t),onDragStart:e=>{l(e,{itemUris:[t.uri],dragLabelText:(0,Ic.r)(t)})},ref:c,children:(0,b.jsx)(kc.R,{uri:e.uri,owner:e.metadata?.context_owner,children:(0,b.jsx)(Rc.e,{context:t.type===Ul.c.TRACK?t.album:e,item:t,index:i,isVisible:!0,onClick:()=>{s.logInteraction(a.coverArtFactory({uri:t.uri}).hitUiNavigate({destination:t.type===Ul.c.TRACK?t.album.uri:t.uri}))},adEventReason:Nc.c.COVER_ART,children:(0,b.jsx)(Ec.b,{className:o()(Dc,{[Oc]:u}),images:t.images??[],type:t.type,maxSize:56,desiredLabel:"small"})})})})})})};var Bc=i(42205),Fc=i(29012),Uc=i(57268),Pc=i(33775);const Hc="TkDZFBZ0IPbGaHDxeCci",Mc="bBG9E6mmFFC74pSkqU0o",Vc=({ad:e,backgroundColor:t,onClick:i})=>{const a=(0,Pc.H)(e.clickthroughUrl),s=e.metadata?.buttonMessage||O.Ru.get("ad-formats.learnMore");return(0,b.jsx)(nt.N,{to:a,"data-testid":"ad-companion-card",onClick:i,className:Hc,children:(0,b.jsx)(q.v,{style:{backgroundColor:t},className:Mc,onClickHint:O.Ru.get("ad-formats.learnMore"),variant:"tinted",horizontalGap:(0,Uc.po)("looser"),id:e.adId,title:(0,b.jsx)(je.d,{variant:"bodySmallBold",children:e.metadata.advertiser||O.Ru.get("ad-formats.learnMore")}),trailing:(0,b.jsx)(n.Suspense,{fallback:(0,b.jsx)(sn.V,{}),children:e.metadata?.advertiser?(0,b.jsx)(d.$,{colorSet:"invertedLight",size:"small",children:s}):(0,b.jsx)(sn.V,{"data-testid":"embedded-ad-cta-button-fallback",semanticColor:"textBase"})})})})};var zc=i(88969);const qc="wibNcSZSkSmE1N7F0QbG",Yc="xIrPThBgWj2hMwWDOcVq",Gc=({onDismiss:e})=>(0,b.jsxs)("div",{className:Yc,children:[(0,b.jsx)(zc.v,{colorSet:"overMedia",className:qc,children:(0,b.jsx)(c.E,{variant:"marginalBold",semanticColor:"textBase",children:O.Ru.get("ad-formats.advertisement")})}),(0,b.jsx)(d.$,{"aria-label":O.Ru.get("ad-formats.dismissAd"),colorSet:"overMedia",iconOnly:xr.M,onClick:e,size:"small"})]});var Qc=i(74891),Zc=i(25688);const Kc="YPTXM8u2OcJuJskm6uwv",Wc="QRqQ5S1T7WIBTZzJ6cAh",Jc=({ad:e,onClick:t,onLoad:i,onError:n})=>{const a=e.display.reduce(((e,t)=>(t.url&&e.push({url:t.url,width:t.width,height:t.height}),e)),[]),s=(0,Qc.h)(a??void 0,{desiredSize:384}),r=(0,Zc.m)({imageUriOrUrl:s});return(0,b.jsx)(nt.N,{to:e.clickthroughUrl,onClick:t,className:Kc,"data-testid":"embedded-ad-creative-link",children:(0,b.jsx)(ri._,{loading:"eager",src:r,className:Wc,onLoad:i,onError:n})})};var Xc=i(17984);const $c="XOqwMsxI9nljlJz4i3za",eu=({ad:e})=>{const t=(0,D.wA)(),i=(0,n.useRef)(null),{adEventLogger:a,embeddedNPVAdEventLogger:r,embeddedAdErrorLogger:l}=(0,Fc.CO)(),o=(0,n.useRef)(!1),c=(0,n.useRef)(!1),{context:u,item:d}=(0,At.o)((e=>e),dl.F)||{context:null,item:null},p=(0,n.useCallback)((()=>{a.log("dismissed",e),t((0,Gr.Xo)())}),[e,a,t]),m=(0,n.useCallback)((()=>{o.current||(a.log("viewed",e),r.log("start",e,{context_uri:u?.uri,track_uri:d?.uri}),o.current=!0)}),[e,a,u?.uri,r,d?.uri]),g=(0,n.useCallback)((()=>{a.log("errored",e,{event_reason:"creative load error"}),l.log("error",e,{error_message:"creative load error"}),t((0,Gr.Xo)())}),[e,a,t,l]),v=(0,n.useCallback)((()=>{a.log("clicked",e),r.log("click",e,{context_uri:u?.uri,track_uri:d?.uri}),t((0,Gr.Xo)())}),[e,a,r,u?.uri,d?.uri,t]),x=(0,s.NC)(nl.vDv),h=(0,Xc.z)(e.display[0]?.url,Bc.CpN,"colorDark");return(0,n.useEffect)((()=>{const n=setTimeout((async()=>{if(i.current){const e=i.current.animate([{opacity:1,transform:"translateY(0)"},{opacity:0,transform:"translateY(-100%)"}],{duration:350,fill:"forwards",easing:"ease-out"});await e.finished,t((0,Gr.Xo)())}else t((0,Gr.Xo)())}),1e3*x);return()=>{t((0,Gr.Xo)()),a.log("ended",e),r.log("end",e,{context_uri:u?.uri,track_uri:d?.uri}),c.current=!0,clearTimeout(n)}}),[e,a,u?.uri,t,r,d?.uri,x]),(0,b.jsxs)("div",{ref:i,className:$c,"data-testid":"embedded-ad",children:[(0,b.jsx)(Gc,{onDismiss:p}),(0,b.jsx)(Jc,{ad:e,onClick:v,onLoad:m,onError:g}),(0,b.jsx)(Vc,{ad:e,backgroundColor:h,onClick:v})]})};var tu=i(45664),iu=i(98635),nu=i(55696);const au=(0,Vr.mc)((()=>{const e=(0,n.useContext)(et.s),t=(0,nu.a)({tryAvoidGraphQLFetching:!1}),i=(0,s.NC)(nl.yJ8)===nl.NtL.CANVAS_PLAY_ON_HOVER;return t?.canvas&&e?(0,b.jsx)(iu.Gg,{fileId:t.canvas.fileId,canvasUrl:t.canvas.url,canvasType:t.canvas.type,canvasUri:t.canvas.uri,playerContainerClass:"canvasVideoContainerNPV",playbackType:i?iu.RT.LoopOnHover:iu.RT.LoopOnPlayback,allowAspectRatioFix:!0,mouseHoverRef:e,useContainerMouseOverEvents:!1}):null}),{name:"NPVCanvas"});var su=i(28007),ru=i(24771),lu=i(49530),ou=i(76540),cu=i(20613),uu=i(45944),du=i(56526),pu=i(64175),mu=i(87287),gu=i(87565),vu=i(49873);const xu="main-nowPlayingView-nowPlayingWidget",bu="T5_sYfKJ2efL3n3dFNuN",hu="bLX5l9C_iEfonbMKiFD_",yu="sJHheSrjFUt_MAcNrUXQ",Cu="hhFdIYRyHsqlCHy7T_8A",fu="main-nowPlayingView-nowPlayingGrid",ju="main-nowPlayingView-contextItemInfo",Su="O5NOY8Xw4NH0IhBZu8tm",wu="DFvRASpHOFAoziM4w7En",Nu="main-nowPlayingView-coverArtContainer",Eu="ylBRlfNqGnzVa4kjUQGP",Ru="E08D6ucrHuPJYzzGO7HG",ku="hjyiWzPtKHn_5kCe9vyg",Iu="pUIBQ9cykHKYx2A2ZIPA",Lu="_q9LkNJJIpxoOkOFI2Nd",Au="S6W0kreMgaIXYWSEYHya",Tu="hCImOEZCJwYaSy2r1Xgx",Du="GY_emVGtuRR8FWeKK9je",Ou="main-nowPlayingView-trackInfo",_u="eEiwEPDfVRD0HKjYM_dq",Bu=({item:e,spec:t})=>{const i=(0,ne.s)(),a=(0,n.useCallback)((n=>{const a=n?t.heartButtonFactory().hitLike({itemToBeLiked:e.uri}):t.heartButtonFactory().hitRemoveLike({itemNoLongerLiked:e.uri});i.logInteraction(a)}),[e.uri,i,t]),s=(0,du.v)(e),r=(0,Ti.y)();return s?(0,b.jsx)(uu.g,{uri:e.uri,size:r===Ri.E.MEDIUM?"medium":"small",className:Cu}):(0,tl.v)(e)&&!e.isLocal?(0,b.jsx)(ou.b,{uri:e.uri,size:r===Ri.E.MEDIUM?ru.t.sm:ru.t.xs,onClick:a,className:Cu}):(0,lc.p)(e)?(0,b.jsx)(lu.b,{uri:e.uri,size:r===Ri.E.MEDIUM?ru.t.sm:ru.t.xs,onClick:a,className:Cu,condensed:!0}):null},Fu=({context:e,item:t})=>{const{spec:i,logger:n}=(0,We.r)(Yr.J,{}),{spec:a}=(0,We.r)(su.p6,{data:{identifier:su.gw.DESKTOP}}),s=(0,vu.X)(),r=(0,Ti.y)();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(cu.w,{className:o()(wu,yu),uri:t.uri,sharingInfo:null,interactionData:{intent:"share",type:"click"},condensedAll:!0,onClick:()=>{n.logInteraction(i.shareButtonFactory({uri:t.uri}).hitCopyToClipboard())},ariaLabel:(0,Fn.gHQ)(t.uri)?O.Ru.get("context-menu.copy-episode-link"):O.Ru.get("context-menu.copy-track-link"),size:r===Ri.E.MEDIUM?"medium":"small"}),(0,b.jsx)(pu.a,{context:e,item:t,className:o()(Su,bu),onClick:()=>{n.logInteraction(a.hideButtonFactory().hitRemoveRecommendation({recommendedItemUri:t.uri,contextUri:e.uri}))}}),s&&(0,gu.N)(t)?(0,b.jsx)(Ea.r,{spec:i,children:(0,b.jsx)("div",{className:Su,children:(0,b.jsx)(mu.o,{contextUri:t.metadata?.context_uri??e.uri,id:t.uid??void 0,uri:t.uri,isActive:!0})})}):(0,b.jsx)("div",{className:Su,children:(0,b.jsx)(Bu,{item:t,spec:i})})]})};var Uu=i(22421),Pu=i(95026),Hu=i(55416),Mu=i(21902),Vu=i(35763),zu=i(21709),qu=i(87761);let Yu=function(e){return e[e.NONE=0]="NONE",e[e.COVER_ART=1]="COVER_ART",e[e.VIDEO_OVER_PIP_PLACEHOLDER=2]="VIDEO_OVER_PIP_PLACEHOLDER",e[e.VIDEO_OVER_CONNECT_PLACEHOLDER=3]="VIDEO_OVER_CONNECT_PLACEHOLDER",e[e.CANVAS=4]="CANVAS",e}({});const Gu=()=>{const e=(0,dl.L)(),t=(0,F.l)(),{videoPlayerMode:i}=(0,zu.d)(),{isSongVideo:n,isSongVideoPlayingVideo:a}=(0,Vu.k)(),s=(0,D.d4)((e=>e.ads?.vto)),{showCanvasInNPV:r}=(0,nu.a)({tryAvoidGraphQLFetching:!0});if(!e)return Yu.NONE;const{item:l}=e;return i===qu.Kz.documentPip||i===qu.Kz.pip?Yu.VIDEO_OVER_PIP_PLACEHOLDER:l?.type===Ul.c.AD&&s?.isMinimized&&"audio"!==l?.mediaType?Yu.NONE:l?.type!==Ul.c.EPISODE||"video"!==l?.mediaType&&"mixed"!==l?.mediaType?n&&a?t?Yu.VIDEO_OVER_CONNECT_PLACEHOLDER:Yu.NONE:r?Yu.CANVAS:Yu.COVER_ART:t?Yu.VIDEO_OVER_CONNECT_PLACEHOLDER:Yu.NONE};var Qu=i(82718);const Zu=(0,Vr.mc)((({hideContextItemInfo:e=!1})=>{const t=(0,dl.L)(),i=Gu(),{draggable:a,onDragStart:r}=(0,Lc.P)(),[l,c]=(0,n.useState)(!0),{spec:u,logger:d}=(0,We.r)(Yr.J,{}),{spec:p}=(0,We.r)(Sc.E,{data:{uri:t?.item.uri??"",identifier:qu.Kz.npv}}),{isSongVideo:m}=(0,Vu.k)(),g=i===Yu.CANVAS,v=i===Yu.COVER_ART,x=(0,D.d4)(Kr),h=((e,t)=>{const[i,a]=(0,n.useState)(!1),r=(0,n.useRef)(),l=(0,s.NC)(nl.Ym5,{loadingValue:!1}),o=(0,D.d4)(Wr),c=(0,D.d4)(Kr),u=(0,$r.$)(),d=il(t),p=(0,n.useMemo)((()=>Boolean(o&&l&&e)),[e,l,o]),m=(0,n.useCallback)((()=>{r.current&&(clearTimeout(r.current),r.current=null)}),[]);return(0,n.useEffect)((()=>{d&&(m(),a(!1))}),[d,m]),(0,n.useEffect)((()=>p&&c?(r.current=setTimeout((()=>{a(!0)}),2e3),m):(a(!1),()=>{})),[p,m,c,d]),(0,n.useMemo)((()=>Boolean(p&&c&&o&&i&&u)),[p,c,o,i,u])})(v,t?.item),y=(0,n.useRef)(null),C=(0,n.useRef)(null),f=(0,n.useRef)(null),j=!(0,Di.j)(),[S,w]=(0,n.useState)(null);if(j&&g&&y.current&&f.current&&(w(f.current),setTimeout((()=>{w(null)}),600)),y.current=v,C.current=g,f.current=t,null===t)return null;const{context:N,item:E,index:R}=t;return(0,b.jsx)("div",{className:o()(xu),children:(0,b.jsxs)("div",{className:fu,children:[(0,b.jsxs)("div",{onClick:()=>g&&c(!l),className:o()(Nu,{[ku]:g,[Tu]:v,[Iu]:l,[Du]:h}),children:[h&&x&&(0,b.jsx)(eu,{ad:x}),(0,b.jsx)("div",{className:o()(Eu,{[Lu]:g||h}),"aria-hidden":g||h,"data-testid":"track-visual-enhancement",children:(0,b.jsx)(Uu.h,{context:S?.context||N,item:S?.item||E,index:R,canSwitchVisuals:!0,isMinimized:h})}),i===Yu.VIDEO_OVER_PIP_PLACEHOLDER&&(0,b.jsx)(Hu.k,{}),i===Yu.VIDEO_OVER_CONNECT_PLACEHOLDER&&(0,b.jsx)(Mu.V,{}),(0,b.jsx)("div",{className:o()(Ru,{[Au]:!g}),"aria-hidden":"true",children:(0,b.jsx)(ua.h,{menu:(0,b.jsx)(ul.W,{context:N,item:E,canSwitchVisuals:!0}),children:(0,b.jsx)("div",{draggable:a,onDragStart:e=>{r(e,{itemUris:[E.uri],dragLabelText:(0,Ic.r)(E)})},children:g&&(0,b.jsx)(au,{uri:E.uri})})})}),(0,b.jsx)(Pu.F,{})]}),m&&(0,b.jsx)(Qu.L,{className:g?_u:"",createImpressionSpec:e=>p.toggleAudioVideoButtonFactory({identifier:e?"switch_to_audio":"switch_to_video"}),onClick:e=>{d.logInteraction(p.toggleAudioVideoButtonFactory({identifier:e}).hitPlay({itemToBePlayed:E.uri}))}}),e?null:(0,b.jsxs)("div",{className:o()(ju,{[hu]:g}),children:[(0,b.jsx)(_c,{isVisible:h,context:N,item:E,index:R}),(0,b.jsx)(Fl.d,{className:o()(Ou),context:N,item:E,titleTypeVariant:"titleSmall",subtitleTypeVariant:"bodyMedium",onTitleClick:e=>{d.logInteraction(u.titleFactory({uri:E.uri}).hitUiNavigate({destination:e||""}))},onSubtitleClick:e=>{d.logInteraction(u.artistFactory({uri:E.uri}).hitUiNavigate({destination:e||""}))},referrer:tu.G.NPV}),!(0,sc.N)(E)&&(0,b.jsx)(Fu,{context:N,item:E})]})]})})}),{name:"NPVHeader"});function Ku(){return(0,b.jsx)(Zu,{})}var Wu=i(46250),Ju=i(60169);const Xu=({className:e})=>{const t=(0,n.useRef)(null);(0,W.X)("NPV_OPEN_CINEMA_MODE_BUTTON",t);const i=(0,Ju.l)(),{spec:a,logger:s}=(0,We.r)(Yr.J,{}),r=(0,n.useCallback)((()=>{i(zn.z.NOW_PLAYING_VIEW),s.logInteraction(a.expandNpvButtonFactory().hitUiReveal())}),[s,i,a]);return(0,b.jsx)(da.Zp,{label:O.Ru.get("web-player.now-playing-view.cinema-mode.expand"),children:(0,b.jsx)(ce.H,{ref:t,iconOnly:Wu.L,size:"small",onClick:r,"aria-label":O.Ru.get("web-player.now-playing-view.cinema-mode.expand"),className:e})})};var $u=i(9994),ed=i(62795),td=i(18264);const id={context:null,item:null};var nd=i(35907),ad=i(35270),sd=i(61502),rd=i(743),ld=i(25219),od=i(35827),cd=i(4945),ud=i(88174);const dd="yvZooOj0rpfRS__cAUCo",pd="k_ndsg7yz9ZAgEmei1n3",md="vDev2BqBHloweL24GNHK",gd="IkRGajTjItEFQkRMeH6v",vd="f2UE9n5nZcbgZrGYTU3r",xd="nw2W4ZMdICuBo08Tzxg9",bd="wPHL366l99aluPsMU8Bl",hd="UAg2mNxhAm_jv0zFjG8z",yd="VjVlpyxDo941sgO2Vc8g";function Cd(e){return(0,tl.v)(e)||(0,cd.v)(e)||(0,lc.p)(e)||(0,rc.d)(e)?e.name:(0,sc.N)(e)?"":(0,kn.d)(e)}const fd=n.memo((({item:e,spec:t})=>{const{ref:i,breakpoint:n}=(0,Rn.x)({[Ri.E.XSMALL]:0,[Ri.E.SMALL]:280,[Ri.E.MEDIUM]:320});return(0,b.jsx)("div",{className:xd,"data-testid":"NPV_Panel_OpenDiv",ref:i,children:e&&(0,b.jsxs)(Ti.o.Provider,{value:n,children:[(0,b.jsx)(Zu,{}),(0,b.jsx)(oc,{item:e,spec:t}),!(0,lc.p)(e)&&(0,b.jsx)(so.A,{})]})})})),jd=({context:e,item:t,spec:i})=>{const a=(0,rd.SF)();return(0,n.useEffect)((()=>{a.current&&(a.current.scrollTop=0)}),[t?.uri,a]),(0,ad.bJ)(e,t)?(0,b.jsx)(nd.IT,{spec:i}):(0,b.jsx)(fd,{context:e,item:t,spec:i})},Sd=({context:e,item:t,spec:i})=>{const n=(0,qn.S)();return al(),n===zn.z.NOW_PLAYING_VIEW?null:(0,b.jsx)(jd,{context:e,item:t,spec:i})},wd=()=>Gu()===Yu.CANVAS,Nd=({item:e})=>{const t=(0,n.useRef)(null),i=(0,dl.L)(),{title:a,link:r}=(0,sd.$)(),l=wd(),c=(0,s.NC)(nl.mzn),{spec:u,logger:d}=(0,We.r)(Yr.J,{}),g=(0,n.useCallback)((()=>{const e=u.closeButtonFactory().hitUiHide();d.logInteraction(e)}),[u,d]);return(0,n.useEffect)((()=>{null!==t.current&&t.current.focus({preventScroll:!0})}),[]),(0,b.jsx)(p.a,{title:a,titleSlot:(0,b.jsx)(p.k,{title:a,panelLinkRef:t,item:e,link:r,variant:"bodyMediumBold",semanticColor:"textBase",className:pd}),link:r,actions:i&&i.context&&(0,b.jsxs)("div",{className:c?hd:yd,children:[(0,b.jsx)(ma.b,{menu:(0,b.jsx)(ul.W,{context:i.context,item:e,canSwitchVisuals:!0}),children:(0,b.jsx)(cl.e,{size:"small",condensed:!1,label:O.Ru.get("more.label.context",e?Cd(e):""),onClick:()=>{d.logInteraction(u.contextMenuButtonFactory().hitUiReveal())},className:bd})}),c&&(0,b.jsx)(Xu,{className:bd})]}),panelLinkRef:t,panel:m.Z.NowPlayingView,onClose:g,item:e,className:o()({[dd]:l})})},Ed=({item:e})=>{const t=!!e&&(0,sc.N)(e);return(0,n.useMemo)((()=>t?null:(0,b.jsx)(Nd,{item:e})),[e,t])},Rd=(0,Vr.mc)((({nodeRef:e})=>{const t=!(0,Lt.n)(),{context:i,item:n,index:a}=(0,At.o)((e=>e),dl.F)||{context:null,item:null,index:null},{spec:r,UBIFragment:l}=(0,We.r)(qr.t,{data:{uri:n?n.uri:""}}),c=wd(),u=!!n&&(0,sc.N)(n),d=(0,ja.t)(r),p=(()=>{const{item:e,context:t}=(0,dl.L)()||id,{isYourDJNarrator:i,hasYourDJMetadata:n}=(0,ed.C)(),a=(0,s.NC)(nl.yon),r=(0,Xc.z)(e?.images?.[0]?.url,Bc.l0o,"colorDark");return i&&n?(0,td.p)(t?.metadata?.["narration.background.color"],$u.lZ):a?r:void 0})(),m={"--background-base":p};let g=null;g=(0,ud.O)(i)&&null!==n?t?(0,b.jsx)(Ku,{}):u?(0,b.jsx)(ol,{item:n,context:i,index:a}):(0,b.jsx)(Sd,{spec:r,context:i,item:n}):(0,b.jsx)(jc,{});const v={cssStyles:{"--section-background-base":p?"var(--background-tinted-base)":"var(--background-elevated-base)","--section-padding":zr.spacer16,"--section-border-radius":zr.spacer8},headerVariant:"bodyMediumBold"};return(0,b.jsx)(od.P,{surface:ld.u.NOW_PLAYING,children:(0,b.jsx)(rd.ql.Provider,{value:"now_playing_panel",children:(0,b.jsx)(oo.Tn,{...v,children:(0,b.jsx)(et._,{nodeRef:e,label:O.Ru.get("web-player.now-playing-view.label"),style:{...m,...v.cssStyles},itemUri:n?.uri?n.uri:"","data-testid":"now-playing-view-container",className:"NowPlayingView",children:(0,b.jsx)(l,{spec:r,children:(0,b.jsx)(tt.w,{className:o()(gd,{[vd]:void 0!==p}),fixedHeader:(0,b.jsx)(Ed,{item:n}),scrolledClassName:c?md:void 0,ref:d,children:g})})})})})})}),{name:"NPV"}),kd="vzeIlCPBQJUaqdMZHqHE",Id="iZgGvu9g2gDlQ1ofJ7rH",Ld="FSZKuoSTDgGwCPXO_qel",Ad="cPpNQwPTiEn9Zegl5Dwz",Td="p2Yw6bT_O5PW8yGv1R0X",Dd="pK7G3_mtRcuFjbhJzm1s",Od="gVJxtuXo8lHAw8XLKHfQ",_d="BR3H6wavkReGa2xeSeaV",Bd="vXYSi4u1nPutJ_ZkC6mq",Fd=e=>{const t=(0,n.useRef)(null);return(0,b.jsx)(a.A,{in:e.isActive,nodeRef:t,timeout:{enter:e.shouldPlayAnimation?200:0,exit:e.shouldPlayAnimation?300:0},classNames:{enter:e.shouldPlayAnimation?Id:Dd,enterActive:e.shouldPlayAnimation?Ld:Od,exit:e.shouldPlayAnimation?Ad:_d,exitActive:e.shouldPlayAnimation?Td:Od},unmountOnExit:!0,mountOnEnter:!0,children:(0,b.jsx)("div",{className:kd,children:(0,b.jsx)("div",{className:Bd,ref:t,children:e.children})})})};var Ud=i(21127),Pd=i(83821),Hd=i(78692),Md=i(57805),Vd=i(8503),zd=i(42132),qd=i(34090),Yd=i(24292),Gd=i(99969),Qd=i(32961),Zd=i(44626);const Kd="PddBvUOS0_6f9B21fVGF",Wd=({ariaLabel:e,onRemoveItems:t,nrItems:i,columnCount:a,children:s})=>{const r=(0,n.useRef)(null);(0,Gd.g)(r);const l=(0,Qd.d)(t);return(0,b.jsx)(Yd.R,{firstInteractiveIsWrapper:!0,"aria-label":e,"aria-rowcount":i,"aria-colcount":a,className:Kd,ref:r,onKeyDown:l,children:s})},Jd=({items:e,renderRow:t,...i})=>{const a=(0,n.useCallback)(((t,i)=>e.slice(t,i+1)),[e]);return(0,b.jsx)(Zd.k,{resolveItem:Xd,getItems:a,nrTracks:e.length,children:(0,b.jsx)(Wd,{nrItems:e.length,...i,children:e.map(t)})})};function Xd(e){return{uri:e.uri,uid:e.uid??void 0,type:e.type}}var $d=i(82223),ep=i(59641),tp=i(77599),ip=i(45804),np=i(55407),ap=i(74817),sp=i(61981);const rp=({chapter:e,index:t,showTypeLabel:i,...n})=>{const{uid:a,uri:s,type:r,name:l,images:o,book:c}=e,u=(0,$d.E)(e,t),d=(0,sp.Y)(n.section),p=(0,b.jsx)(ip.r,{uri:s,removeFromQueueData:{uid:a??void 0,contextUri:d}}),m=(0,b.jsx)(ap.n,{item:e,tooltipText:c.name,showTypeLabel:i,subtitle:(0,b.jsx)(ua.h,{menu:(0,b.jsx)(tp.p,{uri:c.uri}),children:(0,b.jsx)(nt.N,{to:c.uri,stopPropagation:!0,children:c.name})})});return(0,b.jsx)(np.b,{uid:a,uri:s,contextUri:d,id:u,index:t,type:r,title:l,subtitle:m,images:o,dragLabel:l,menu:p,moreButtonLabelName:l,ariaPauseLabel:O.Ru.get("playlist.a11y.pause",l),ariaPlayLabel:O.Ru.get("playlist.a11y.play",l),...n})};var lp=i(53207),op=i(82797),cp=i(20535),up=i(47331),dp=i(30951),pp=i(85388),mp=i(40305),gp=i(46233),vp=i(18463);const xp=(0,n.createContext)(null),bp=({children:e})=>{const{uri:t}=(0,vp.H)(),{spec:i,UBIFragment:a}=(0,We.r)(mp.i,{data:{identifier:gp.$h.NOWPLAYING_QUEUE,uri:t??""}}),s=(0,n.useMemo)((()=>i.nowPlayingSectionFactory()),[i]),r=(0,n.useMemo)((()=>i.nextInQueueSectionFactory()),[i]),l=(0,n.useMemo)((()=>i.nextFromSectionFactory()),[i]),o=(0,n.useMemo)((()=>({queueSpec:i,nowPlayingSectionSpec:s,nextInQueueSectionSpec:r,nextFromSectionSpec:l})),[i,s,r,l]);return(0,b.jsx)(xp.Provider,{value:o,children:(0,b.jsx)(a,{spec:i,children:e})})};var hp=i(26429);const yp=()=>{const e=(0,n.useContext)(xp);if(!e)throw Error("useQueueUBI must be used within a QueuePanelUBIProvider!");const{queued:t}=(0,vp.H)(),i=(0,ne.s)(),{queueSpec:a,nowPlayingSectionSpec:s,nextInQueueSectionSpec:r,nextFromSectionSpec:l}=e;return{logClearQueue:(0,n.useCallback)((()=>{const e=r.clearQueueButtonFactory().hitRemoveItemsFromQueue({numberOfItemsToRemoveFromQueue:t.length});return i.logInteraction(e)}),[i,r,t.length]),logAddToQueue:(0,n.useCallback)(((e,t)=>{let n;switch(e){case dp.$.NowPlaying:n=s;break;case dp.$.NextInQueue:n=r;break;case dp.$.NextUp:n=l;break;default:return}const a=1===t.length?n.dragAddItemToQueue({itemToAddToQueue:t[0]}):n.dragAddItemsToQueue({numberOfItemsToAddToQueue:t.length});return i.logInteraction(a)}),[i,l,r,s]),logSort:(0,n.useCallback)((e=>{let t;switch(e){case dp.$.NextInQueue:t=r;break;case dp.$.NextUp:t=l;break;case dp.$.NowPlaying:default:return}const n=t.dragSort();return i.logInteraction(n)}),[i,l,r]),logQueuePanelTabChange:(0,n.useCallback)((e=>{if(e!==hp.p.PARTICIPANT_LIST){const t=a.queueHistoryTabFactory({identifier:e===hp.p.QUEUE?"queue":"recently_played"}).hitUiReveal();return i.logInteraction(t)}}),[i,a]),logQueueContextLinkNavigate:(0,n.useCallback)((e=>{const t=l.queueContextLinkFactory().hitUiNavigate({destination:e??""});return i.logInteraction(t)}),[i,l])}};var Cp=i(65753),fp=i(52094);const jp=(0,n.memo)((function({item:e,...t}){const i=function(e,t){const i=(0,j.z)(),{request:a}=(0,n.useContext)(fp.j),{logAddToQueue:s,logSort:r}=yp();return(0,n.useCallback)((async(n,l,o)=>{const{contextUri:c,sectionId:u,itemIds:d}=o??{},p=t===dp.$.NowPlaying,m=pp.v===c&&!p,g=n[cp.fl.ALBUMS]?.at(0),v=Object.values(n).flat();let x=[];if(g){const{trackUris:e}=await(0,Cp.s)(g,0,a);x=e.map((e=>({uri:e,uid:null})))}else x=m&&d?.length?d.map((e=>({uri:"",uid:e}))):Object.values(n).flat().map((e=>({uri:e,uid:null})))??[];const b=m&&u===dp.$.NowPlaying;let h;if(h=l===up.Nz.BEFORE?{before:{uri:e.uri,uid:e.uid??null}}:{after:{uri:e.uri,uid:e.uid??null}},m&&!b)t&&r(t),i.reorderQueue(x,h);else{let e;t&&(e=s(t,v)),p?i.addToQueue(x,{interactionId:e?.interactionId}):i.insertIntoQueue(x,h,{interactionId:e?.interactionId})}}),[e.uid,e.uri,s,r,i,a,t])}(e,t.section);switch(e.type){case Ul.c.TRACK:return(0,b.jsx)(op.e,{track:e,onDrop:i,...t});case Ul.c.EPISODE:return(0,b.jsx)(lp.I,{episode:e,onDrop:i,...t});case Ul.c.CHAPTER:return(0,b.jsx)(rp,{chapter:e,onDrop:i,...t});case Ul.c.AD:return(0,b.jsx)(ep.Y,{ad:e,onDrop:i,...t});case Ul.c.UNKNOWN:return null;default:return(0,kn.k)(e),null}}));var Sp=i(24848);const wp=(0,n.memo)((function({item:e,...t}){const{usePlayContextItem:i}=(0,Sp.P)({uri:e.uri,pages:[{items:[e]}]},{featureIdentifier:"history"});return(0,b.jsx)(jp,{item:e,...t,usePlayContextItem:i})})),Np=({items:e})=>{const t=(0,n.useCallback)(((e,t)=>(0,b.jsx)(wp,{item:e,index:t},(0,$d.E)(e,t))),[]);return(0,b.jsx)(Jd,{items:e,ariaLabel:O.Ru.get("view.recently-played"),renderRow:t,columnCount:pp.$})};var Ep=i(49943),Rp=i(1148);const kp=()=>{const{isLoading:e,data:t}=(0,Rp.a)();return e?null:t?.items.length?(0,b.jsx)(Np,{items:t.items}):(0,b.jsx)(Ep.H,{})};var Ip=i(68832);const Lp=(e,t)=>!t?.didQueueChangeSignificantly,Ap=(e,t,i)=>{Lp(0,i?.current)?(0,Ip.oz)({onUpdate:t=>{e.style.opacity=t.toString()}}):e.style.opacity="1"},Tp=(e,t,i,n)=>{Lp(0,n?.current)?(0,Ip.oz)({onUpdate:t=>{e.style.opacity=(1-Number(t)).toString()},onComplete:i}):i()},Dp=({hideEnteringElements:e,animateEnteringElements:t,animateExitingElements:i,animateFlippedElements:n})=>{e(),i(),n(),t()};var Op=i(8741);function _p(e){const t=(0,n.useRef)(e);return(0,n.useMemo)((()=>{const i=new Map,n=Fp(t.current,i),a=Fp(e,i),s=(0,Op.I)(n,a),r=s>16||s>=Math.max(Bp(e),Bp(t.current));return t.current=e,r}),[e])}function Bp(e){return Number(!!e?.current)+(e?.queued.length??0)+(e?.nextUp.length??0)}function Fp({current:e,nextUp:t=[],queued:i=[]},n){let a="";return[[e],t,i].forEach((e=>{e.forEach((e=>{e?.uid&&(n.has(e.uid)||n.set(e.uid,String.fromCharCode(65+n.size)),a+=n.get(e.uid))})),e.length&&(a+=" ")})),a}var Up=i(88251);const Pp=({current:e,queued:t,nextUp:i,children:a})=>{const s=(0,n.useMemo)((()=>[e,...t,...i].filter(Up.P).map($d.E).join("")),[e,i,t]),r={didQueueChangeSignificantly:_p({current:e,nextUp:i,queued:t})};return(0,b.jsx)(Ip.ZI,{flipKey:s,handleEnterUpdateDelete:Dp,decisionData:r,children:a})},Hp=({children:e,...t})=>(0,Di.j)()?(0,b.jsx)(b.Fragment,{children:e}):(0,b.jsx)(Pp,{...t,children:e}),Mp=({children:e,...t})=>(0,Di.j)()?(0,b.jsx)(b.Fragment,{children:e}):(0,b.jsx)(Ip.lf,{shouldFlip:Lp,...t,children:e});var Vp=i(70813),zp=i(78651);const qp=[cp.fl.TRACKS,cp.fl.LOCAL_TRACKS,cp.fl.EPISODES,cp.fl.CHAPTERS,cp.fl.ALBUMS],Yp=({uri:e,items:t,ariaLabel:i,section:a,showTypeLabel:s,decoratedQueuedByUsersByUsername:r})=>{const l=(0,j.z)(),o=(0,n.useCallback)((e=>{l.removeFromQueue(e)}),[l]),{usePlayContextItem:c}=(0,Vp.b)(e,a),u=(0,n.useCallback)(((e,t)=>{const i=(0,$d.E)(e,t);return(0,b.jsx)(Mp,{flipId:e.metadata?.original_uid??i,onAppear:Ap,onExit:Tp,translate:!0,children:(0,b.jsx)("div",{className:zp.A.listRowWrapper,children:(0,b.jsx)(jp,{item:e,index:t,usePlayContextItem:c,section:a,allowedDropMimeTypes:qp,showTypeLabel:s,queuedBy:r?.[e.metadata?.queued_by??""]})})},i)}),[r,a,s,c]);return(0,b.jsx)(Jd,{items:t,renderRow:u,columnCount:pp.$,ariaLabel:i,onRemoveItems:o})};var Gp=i(52339);const Qp="u842BXnznGeq38O3DUTQ",Zp="NWVZ_rxlezZ8xTHlMg4Y",Kp="Oae51evvT5DrqTupCiZ2",Wp="LFdMliaHVgrpBcqNKHU3",Jp="IeeqYq0Ozrndd6STmrRk",Xp="NljerwmGshDHsI7rIvWl",$p=({nrQueuedItems:e})=>{const t=(0,j.z)(),{logClearQueue:i}=yp(),[a,s]=(0,n.useState)(!1),r=(0,n.useCallback)((()=>{s(!1)}),[]),l=(0,n.useCallback)((()=>{i(),t.clearQueue(),s(!1)}),[i,t]),o=(0,n.useCallback)((()=>{s(!0)}),[]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ce.H,{size:"small",onClick:o,className:Jp,condensed:!0,children:O.Ru.get("queue.clear-queue")}),(0,b.jsx)(Gp.p,{itemCount:e,isOpen:a,onClose:r,onConfirm:l})]})};var em=i(49246);const tm=({queueSection:e,title:t,trailingButton:i})=>{const a=(0,n.useRef)(null),s=(0,em.K)({ref:a});return(0,b.jsx)(Mp,{flipId:`section-header-${e}`,onAppear:Ap,onExit:Tp,translate:!0,children:(0,b.jsxs)("div",{className:Wp,children:[(0,b.jsx)(da.Zp,{label:t,disabled:!s,children:(0,b.jsx)(c.E,{as:"h2",variant:"bodyMediumBold",semanticColor:"textBase",className:Xp,ref:a,children:t})}),i]})})};var im=i(81807),nm=i(5820),am=i(33031);const sm=new nm.l("decorateQueuedByUsers","query","1b71b9895bad207fdac0df7ebad17c790260519f853a069ee05f20e51c08636e",null);function rm(e){const{currentSession:t}=(0,Js.D)(),i=Array.from(new Set(e.map((e=>e?.metadata?.queued_by||null)).filter(Up.P))).sort().map((e=>(0,Fn.Qjr)(e).toURI())),{data:a}=(s={userUris:i},r={gcTime:36e5,staleTime:18e5,enabled:!!i.length,placeholderData:Ka.rX},(0,am.I)(sm,s,r));var s,r;const l=(0,n.useMemo)((()=>Object.fromEntries(a?.users?.map((e=>{return"User"===e.__typename?[e.username,(t=e,{type:Ul.c.USER,...t,images:t.avatar?.sources??[]})]:null;var t})).filter(Up.P)??[])),[a]);return t?.active?l:{}}var lm=i(16674),om=i(53284);const cm=()=>{const e=(0,vp.H)(),{uri:t,description:i,current:a,nextUp:s,queued:r,isEmpty:l,hasQueuedTracks:o,hasNextTracks:c}=e,{logQueueContextLinkNavigate:u}=yp(),d=rm([a,...s,...r]),p=(0,n.useMemo)((()=>new Set([a,...r,...s].filter(Up.P).map((({type:e})=>e))).size>1),[a,s,r]),{currentSession:m}=(0,Js.D)(),g=(0,Ks.y)();return l?(0,b.jsx)(im.K,{}):(0,b.jsxs)(Hp,{...e,children:[(0,b.jsx)(lm.Z,{className:Kp}),(0,b.jsxs)("div",{className:Qp,children:[a&&(0,b.jsxs)("div",{className:Zp,children:[(0,b.jsx)(tm,{queueSection:dp.$.NowPlaying,title:O.Ru.get("queue.now-playing")}),(0,b.jsx)(Yp,{ariaLabel:O.Ru.get("queue.now-playing"),uri:t,items:a?[a]:[],section:dp.$.NowPlaying,showTypeLabel:p,decoratedQueuedByUsersByUsername:d})]}),!m?.active&&g&&(0,b.jsx)(om.p,{localStorageKey:"dismissStartJamButtonFromQueue"}),o&&(0,b.jsxs)("div",{className:Zp,children:[(0,b.jsx)(tm,{queueSection:dp.$.NextInQueue,title:O.Ru.get("queue.next-in-queue"),trailingButton:(0,b.jsx)($p,{nrQueuedItems:r.length})}),(0,b.jsx)(Yp,{ariaLabel:O.Ru.get("queue.next-in-queue"),uri:t,items:r,section:dp.$.NextInQueue,showTypeLabel:p,decoratedQueuedByUsersByUsername:d})]}),c&&(0,b.jsxs)("div",{className:Zp,children:[(0,b.jsx)(tm,{queueSection:dp.$.NextUp,title:i&&!(0,vp.K)(a)&&t?(0,b.jsxs)(b.Fragment,{children:[O.Ru.get("queue.next-from")," ",(0,b.jsx)(nt.N,{to:t,onClick:()=>{u(t)},children:i})]}):O.Ru.get("queue.next-up")},i),(0,b.jsx)(Yp,{ariaLabel:O.Ru.get("queue.next-up"),uri:t,items:s,section:dp.$.NextUp,showTypeLabel:p})]})]})]})};var um=i(24224),dm=i(39919),pm=i(82221),mm=i(11937);const gm="AjjTyUrCO3pZ365KtTXW",vm="pGtUoenc5OobLi8CscJ6",xm="cArVcLcQ85q_9QSLGYGX",bm="lDtXv1VCrs0PHHSuH5uO",hm="ukjUoaLSzKyRcwoOQw9V",ym="yQwBNeetmAr0a0OTR8t3",Cm="fzB4RXxTp0rlpNQlSuu9",fm=({sessionMember:e,showRemoveButton:t,onClickMember:i,onClickRemove:n,index:a})=>{const{currentSession:s}=(0,Js.D)(),{displayName:r,images:l,username:o,uri:c}=(0,mm.c)(e);return(0,b.jsx)(ua.h,{menu:(0,b.jsx)(pm.B,{uri:c}),children:(0,b.jsx)(q.v,{id:`${a}`,variant:"naked",className:hm,title:(0,b.jsx)(je.d,{lineClamp:1,children:r}),media:(0,b.jsx)("div",{role:"button",onClick:i,onKeyDown:i,tabIndex:-1,children:(0,b.jsx)(dm.e,{images:l,userIconSize:"medium",width:48,displayName:r,username:o,label:r})}),subtitle:s?.sessionOwnerId===e.id?O.Ru.get("web-player.social-connect.participant-list.host"):O.Ru.get("web-player.social-connect.participant-list.guest"),onClick:i,trailing:t&&(0,b.jsx)(oe.n,{size:"small",className:ym,onClick:n,"aria-label":O.Ru.get("web-player.social-connect.participant-list.remove-guest-accessible-label",{displayName:r}),children:O.Ru.get("web-player.social-connect.participant-list.remove-guest")})})})};var jm=i(17407),Sm=i(97235),wm=i(37066);const Nm=()=>{const e=(0,Ja.d)(),t=(0,D.wA)(),i=(0,Ie.g)(),a=(0,jm.Z)(),{currentSession:s,kickAllParticipants:r}=(0,Js.D)(),{setQueueView:l}=(0,um.m)(),{logUserClick:o,logRemoveClick:u}=(0,Sm.T)(),p=(0,n.useCallback)((()=>{s?.joinSessionShortLink&&a(s?.joinSessionShortLink)}),[a,s?.joinSessionShortLink]),m=(0,n.useCallback)(((e,i)=>{u(e),t((0,sa.A9)(Qa.EL.REMOVE_PARTICIPANT,void 0,i))}),[t,u]),g=(0,n.useCallback)(((e,t)=>{const n=(0,Fn.Qjr)(t.username);o(e,n.toURI()),i(n.toURLPath(!0))}),[o,i]),v=(0,n.useCallback)((()=>{r(s?.sessionId)}),[s?.sessionId,r]),x=(0,wm.T4)(e);return s&&x?(0,b.jsxs)("div",{className:gm,children:[(0,b.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",children:O.Ru.get("web-player.social-connect.participant-list.title")}),(0,b.jsxs)("div",{className:vm,children:[(0,b.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:O.Ru.get("web-player.social-connect.participant-list.subtitle")}),(0,b.jsx)(oe.n,{size:"small",onClick:p,className:xm,children:O.Ru.get("web-player.social-connect.invite-button")})]}),(0,b.jsx)("div",{className:bm,children:s.sessionMembers.map(((t,i)=>(0,b.jsx)(fm,{index:i,sessionMember:t,showRemoveButton:(0,wm.kt)(e,(0,Fn.Qjr)(t.username).toURI()),onClickRemove:()=>m(i,t),onClickMember:()=>g(i,t)},i)))}),s.isSessionOwner&&s.sessionMembers.length>1&&(0,b.jsx)(d.$,{colorSet:"invertedLight",size:"small",onClick:v,children:O.Ru.get("web-player.social-connect.participant-list.remove-all-guests")}),(0,b.jsx)(c.E,{variant:"marginal",semanticColor:"textSubdued",className:Cm,children:O.Ru.get("web-player.social-connect.participant-list.visibility-info")})]}):(l(um.p.QUEUE),null)};var Em=i(16491);const Rm="BZj_r1yzmmragvivUCrw",km="hpzTKCoO0rllEslIOMPo",Im="TeBVsFnI9PMHYL9ynJx9",Lm="ZDR7q1cqU2yaYjemuy9Z",Am="OLB2ghxc09Kz8k_93eIu",Tm=()=>{const{currentQueueView:e,setQueueView:t}=(0,hp.m)(),i=(0,Em.y)(),{logQueuePanelTabChange:a}=yp(),s=(0,n.useMemo)((()=>i?{titleSlot:e!==hp.p.PARTICIPANT_LIST?(0,b.jsx)(Md.t,{currentTab:e,onTabChange:e=>{e===(0,zd.c)(hp.p.HISTORY)?(a(hp.p.HISTORY),t(hp.p.HISTORY)):(a(hp.p.QUEUE),t(hp.p.QUEUE))},className:Im,children:(0,b.jsxs)(Vd.w,{"aria-label":"",className:Lm,children:[(0,b.jsx)(zd.V,{"aria-selected":e===hp.p.QUEUE,label:O.Ru.get("playback-control.queue"),value:hp.p.QUEUE}),(0,b.jsx)(zd.V,{"aria-selected":e===hp.p.HISTORY,label:O.Ru.get("view.recently-played"),value:hp.p.HISTORY})]})}):(0,b.jsx)(ce.H,{iconLeading:Os.g,onClick:()=>t(hp.p.QUEUE),size:"small",condensed:!0,className:Am,children:O.Ru.get("web-player.social-connect.participant-list.back-to-queue")})}:{title:O.Ru.get("playback-control.queue")}),[i,a,t,e]);return(0,b.jsx)(et._,{label:O.Ru.get("playback-control.queue"),focusTransferId:"QUEUE-HISTORY-PANEL",children:(0,b.jsx)(tt.w,{fixedHeader:(0,b.jsx)(p.a,{className:Rm,panel:m.Z.Queue,...s}),children:(0,b.jsx)("div",{className:km,children:e!==hp.p.PARTICIPANT_LIST?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(qd.K,{value:"queue",children:e===hp.p.QUEUE&&(0,b.jsx)(cm,{})}),(0,b.jsx)(qd.K,{value:"history",children:e===hp.p.HISTORY&&(0,b.jsx)(kp,{})})]}):(0,b.jsx)(Nm,{})})})})},Dm=(0,n.memo)((function(){return(0,b.jsx)(bp,{children:(0,b.jsx)(Tm,{})})}));var Om=i(8465),_m=i(96944);const Bm=(0,n.memo)((()=>{const e=(0,s.NC)(nl.ZDY),t=(0,Pd.X)(),i=(0,Ud._)(),l=function(){const e=(0,n.useRef)(m.Z.NowPlayingView),t=(0,f.XB)();return(0,n.useEffect)((()=>{e.current=t}),[t]),(0,n.useCallback)((i=>{const n=e.current===m.Z.NowPlayingView,a=t===m.Z.NowPlayingView;return i.some((i=>n&&t===i||a&&e.current===i))}),[t])}(),o=(0,qn.S)()===zn.z.NOW_PLAYING_VIEW,c=(0,n.useRef)(null),u=e&&t===m.Z.Disabled;return(0,b.jsxs)(r.s,{onError:e=>{(0,Om.Jy)(e,"PanelSection"),i((0,Hd.MQ)(m.Z.Disabled))},children:[(0,b.jsx)(a.A,{nodeRef:c,in:t===m.Z.NowPlayingView||u,exit:m.v.includes(t),timeout:{enter:0,exit:300},unmountOnExit:!0,mountOnEnter:!0,children:(0,b.jsx)(_m.f,{enabled:!u,children:(0,b.jsx)(Rd,{nodeRef:c})})}),t===m.Z.BuddyFeed?(0,b.jsx)(Vn,{}):null,(0,b.jsx)(Fd,{isActive:t===m.Z.BuddyFeedOverlay,shouldPlayAnimation:!o&&l([m.Z.BuddyFeedOverlay]),children:(0,b.jsx)(Vn,{})}),t===m.Z.Queue?(0,b.jsx)(Dm,{}):null,(0,b.jsx)(Fd,{isActive:t===m.Z.QueueOverlay,shouldPlayAnimation:!o&&l([m.Z.QueueOverlay]),children:(0,b.jsx)(Dm,{})}),t===m.Z.Puffin||t===m.Z.PuffinActivation?(0,b.jsx)(An,{}):null,(0,b.jsx)(Fd,{isActive:t===m.Z.PuffinActivationOverlay||t===m.Z.PuffinOverlay,shouldPlayAnimation:!o&&l([m.Z.PuffinActivationOverlay,m.Z.PuffinOverlay]),children:(0,b.jsx)(An,{})}),t===m.Z.DevicePicker?(0,b.jsx)(Hr,{}):null,(0,b.jsx)(Fd,{isActive:t===m.Z.DevicePickerOverlay,shouldPlayAnimation:!o&&l([m.Z.DevicePickerOverlay]),children:(0,b.jsx)(Hr,{})}),Mr?(0,b.jsxs)(b.Fragment,{children:[t===m.Z.Euterpe?(0,b.jsx)(Mr,{}):null,(0,b.jsx)(Fd,{isActive:t===m.Z.Euterpe,shouldPlayAnimation:l([m.Z.Euterpe]),children:(0,b.jsx)(Mr,{})})]}):null]})}))},22152:(e,t,i)=>{i.d(t,{S:()=>o});var n=i(16318),a=i(95799),s=i(98717),r=i(37439),l=i(83223);function o(e){const t=(0,l.t)();return(0,n.I)({queryKey:["author",e],queryFn:async()=>t.fetch([e??""],[s.UH.IDENTITY_TRAIT,s.UH.VISUAL_IDENTITY_TRAIT,s.UH.AVAILABLE_RELEASES]).then((([e])=>function({uri:e,extensions:{[s.UH.IDENTITY_TRAIT]:t,[s.UH.VISUAL_IDENTITY_TRAIT]:i,[s.UH.AVAILABLE_RELEASES]:n}}){return t?{uri:e,name:t.name,description:t.description,images:((i?.sixteenByNineCoverImage?.instances??i?.squareCoverImage?.instances)?.map((({size:e,flatFile:t})=>({url:t?.cdnUrl??"",label:c[e]}))).filter((e=>!!e.url))??[]).slice(0,1),availableBooksUris:n?.availableReleases.map((e=>e.uri))??[],dynamicColors:(0,a.V)(i?.squareCoverImage?.extractedColorSet)}:null}(e))),staleTime:0,gcTime:36e5,enabled:!!e})}const c={[r.hJ.IMAGE_SIZE_UNSPECIFIED]:"standard",[r.hJ.IMAGE_SIZE_SMALL]:"small",[r.hJ.IMAGE_SIZE_DEFAULT]:"standard",[r.hJ.IMAGE_SIZE_LARGE]:"large",[r.hJ.IMAGE_SIZE_XLARGE]:"xlarge",[r.hJ.IMAGE_SIZE_XXLARGE]:"xlarge",[r.hJ.UNRECOGNIZED]:"standard"}},22421:(e,t,i)=>{i.d(t,{h:()=>w});var n=i(97500),a=i.n(n),s=i(75773),r=i(41654),l=i(11440),o=i(47290),c=i(53115),u=i(25695),d=i(30275),p=i(63673),m=i(45315),g=i(55995),v=i(37639),x=i(12689),b=i(3161),h=i(1263);const y="URfgKDbFQpKuN8ZjGdui",C="e3hKZQOHyxgax_X0Rb1E",f="main-nowPlayingView-coverArt",j="SwS3WdCPfdr1uOOksVEB";var S=i(86070);const w=({context:e,item:t,index:i,canSwitchVisuals:n=!1,isMinimized:w=!1})=>{const{spec:N,logger:E}=(0,b.r)(r.J,{}),{draggable:R,onDragStart:k}=(0,g.P)(),{ref:I,inView:L}=(0,s.Wx)({threshold:.5,initialInView:!0});return(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(o.h,{menu:(0,S.jsx)(u.W,{context:e,item:t,canSwitchVisuals:n}),children:(0,S.jsx)("div",{draggable:R&&((0,x.v)(t)||(0,v.p)(t)),onDragStart:e=>{k(e,{itemUris:[t.uri],dragLabelText:(0,m.r)(t)})},ref:I,className:a()(y,{[C]:w}),children:(0,S.jsx)(p.R,{uri:e.uri,owner:e.metadata?.context_owner,children:(0,S.jsx)(d.e,{context:t.type===h.c.TRACK?t.album:e,item:t,index:i,isVisible:!0,onClick:()=>{E.logInteraction(N.coverArtFactory({uri:t.uri}).hitUiNavigate({destination:t.type===h.c.TRACK?t.album.uri:t.uri}))},adEventReason:l.c.COVER_ART,children:(0,S.jsx)(c.b,{className:a()(f,{[j]:L}),images:t.images??[],type:t.type,maxSize:w?56:384,desiredLabel:w?"small":"xlarge"})})})})})})}},24292:(e,t,i)=>{i.d(t,{R:()=>m});var n=i(30758),a=i(7189),s=i(86113);function r(e,t,i=!1){if(!e)return void console.error("No list element found. Canceling moving focus");if(!(0,s.fk)(e))return;const n=e.querySelector('[tabindex="0"]');t===a.O.UP&&(0,s.MS)(n,l(e,n,a.O.UP,i)),t===a.O.DOWN&&(0,s.MS)(n,l(e,n,a.O.DOWN,i)),t===a.O.RIGHT&&(0,s.MS)(n,o(n,a.O.RIGHT,i)),t===a.O.LEFT&&(0,s.MS)(n,o(n,a.O.LEFT,i)),t===a.O.HOME&&(0,s.MS)(n,c(a.O.HOME,i)??n),t===a.O.END&&(0,s.MS)(n,c(a.O.END,i)??n)}function l(e,t,i,n=!1){const r=t.closest('li[role="row"]');if(!r)return t;let l=r;const c=Array.from(e.querySelectorAll('li[role="row"]')),u=Array.from(r.querySelectorAll(s.nu)),d=c.indexOf(r);if(d<0)return t;const p=(n&&t!==u[0]||!n&&t!==r)&&!(t instanceof HTMLLIElement);if(i===a.O.UP){if(document.activeElement===e){l=c[c.length-1];return(n?l.querySelector(s.nu):l)??t}if(p)return o(t,a.O.LEFT,n);let i=d-1;if(-1===i)return t;l=c[i],i-=1}else if(i===a.O.DOWN){if(document.activeElement===e){l=c[0];return(n?l.querySelector(s.nu):l)??t}if(p)return o(t,a.O.RIGHT,n);let i=d+1;if(i===c.length)return t;l=c[i],i+=1}return(n?l.querySelector(s.nu):l)??t}function o(e,t,i=!1){const n=e.closest('li[role="row"]');if(!n)return e;let r=e;const l=Array.from(n.querySelectorAll(s.nu)),o=l.indexOf(e);let c=0;if(t===a.O.RIGHT&&o-1!==l.length)c=o+1;else{if(t===a.O.LEFT&&-1===o)return n;if(t===a.O.LEFT&&0!==o)c=o-1;else if(t===a.O.LEFT&&0===o){return(i?n.querySelector(s.nu):n)??n}}return r=l.at(c),r??e}function c(e,t=!1){const{currentFocus:i,listEl:n}=function(){const e=document.activeElement,t=e?.closest("ul");return((0,a.I)(e)||e instanceof HTMLLIElement)&&t?{currentFocus:e,listEl:t}:{currentFocus:null,listEl:null}}();if(null===i||null===n)return null;const r=i.closest('li[role="row"]');if(!r)return i;const l=Array.from(n.querySelectorAll('li[role="row"]')),o=Array.from(r.querySelectorAll(s.nu));if(l.indexOf(r)<0)return i;const c=t&&i===o[0]||!t&&i===r;if(e===a.O.HOME){if(c){return(t?l[0].querySelector(s.nu):l[0])??i}return(t?o[1]:o[0])??i}if(e===a.O.END){if(c){return(t?l[l.length-1].querySelector(s.nu):l[l.length-1])??i}return o[o.length-1]??i}return i}var u=i(73160),d=i(86906),p=i(86070);const m=(0,n.forwardRef)((({onKeyDown:e,children:t,firstInteractiveIsWrapper:i=!1,...l},o)=>{const c=(0,d.N)(o);(0,u.R)(c);const m=(0,n.useCallback)((t=>{c.current?.contains(t.target)&&("ArrowUp"!==t.key&&"ArrowDown"!==t.key&&"Home"!==t.key&&"End"!==t.key||t.preventDefault(),"ArrowUp"!==t.key&&"ArrowDown"!==t.key||document.documentElement.classList.remove("no-focus-outline"),"ArrowUp"===t.key&&r(c.current,a.O.UP,i),"ArrowDown"===t.key&&r(c.current,a.O.DOWN,i),"ArrowRight"===t.key&&r(c.current,a.O.RIGHT,i),"ArrowLeft"===t.key&&r(c.current,a.O.LEFT,i),"Home"===t.key&&r(c.current,a.O.HOME,i),"End"===t.key&&r(c.current,a.O.END,i),e?.(t))}),[i,c,e]),g=(0,n.useCallback)((e=>{if(!c.current)return;const t=e.target,i=c.current.querySelector('[tabindex="0"]');t.closest('li[role="row"]')&&t!==i&&(0,s.MS)(i,t,{preventScroll:!0})}),[c]);return(0,p.jsx)("ul",{role:"treegrid",ref:c,onKeyDown:m,onFocus:g,tabIndex:0,...l,children:t})}))},44502:(e,t,i)=>{i.d(t,{a:()=>V,k:()=>H});var n=i(30758),a=i(97500),s=i.n(a),r=i(77812),l=i(55055),o=i(61760),c=i(80013),u=i(93960),d=i(41654),p=i(31014),m=i(79252),g=i(70773),v=i(47290),x=i(62398),b=i(56962),h=i(58206),y=i(86238),C=i(19315),f=i(64232),j=i(66108),S=i(39736),w=i(55995),N=i(17145),E=i(63365),R=i(3161);const k="eTT681T6oUKXsIMiP8pT",I="gwmgu53xszgwAXxqLT0h",L="fNXmHtlrj4UVWmhQrJ_5",A="XOSSUjLDKk9RRmiX_UWa",T="KILnOHUdx4pspVEoJ7kq",D="XNFZdOLgMlx491fEWdYJ",O="icNf66tgG3uxDMbCCIaN",_="NmIQ4hxBcXT8Bd7Abwdi",B="rkIl3GXeAGoK2gIX2zuj",F="j9Ey7DzF10wbxpBIVtcb";var U=i(86070);const P=({title:e,variant:t,semanticColor:i})=>(0,U.jsx)(y.z,{title:e,children:(0,U.jsx)(r.E,{as:"h1",dir:"auto",variant:t,semanticColor:i,children:e||""})},e||""),H=({link:e,title:t,item:i,panelLinkRef:n,variant:a,semanticColor:r,className:l})=>{const{spec:o,logger:c}=(0,R.r)(d.J,{}),m=(0,p.o_h)(e),g=m?.toURI(),b=!(!g||!t),y=b?[g]:[],C=(0,x.H)(g),j=(0,f.XB)().split("_").join(" "),{draggable:S,onDragStart:E}=(0,w.P)({itemUris:y,dragLabelText:t??""}),L=(0,u.NC)(N.mzn);return(0,U.jsx)(v.h,{menu:C,children:(0,U.jsx)("div",{className:s()(k,l,{[F]:L}),children:e&&t?(0,U.jsx)(h.N,{ref:n,"aria-label":`${j} link`,draggable:S&&b,onDragStart:b?E:void 0,to:e,search:i?`?uid=${i.uid}&uri=${i.uri}`:void 0,className:I,onClick:()=>{c.logInteraction(o.contextLinkFactory().hitUiNavigate({destination:e||""}))},children:(0,U.jsx)(P,{title:t,variant:a,semanticColor:r})}):(0,U.jsx)(P,{title:t,variant:a,semanticColor:r})})})},M=j.$S.PANEL_CLOSE_CLICK,V=({link:e,title:t,titleSlot:i,actions:a,onClose:r,className:d,panelLinkRef:p,preventDefaultClose:v=!1,onBack:x,item:h,titleVariant:y="bodyMediumBold",titleSemanticColor:j="textBase"})=>{const w=(0,f._Y)(),R=(0,f.Ev)(M),k=(0,u.NC)(N.mzn),I=(0,f.XB)()===S.Z.NowPlayingView&&k,F=(0,C.h)(),P=(0,n.useCallback)((()=>{r?.(),v||w(M)}),[r,v,w]),V=null!==h&&(0,E.N)(h);return(0,U.jsx)(n.Suspense,{fallback:null,children:(0,U.jsxs)("div",{className:s()(L,d,{[T]:k}),children:[x&&(0,U.jsx)("span",{className:s()(O,_),children:(0,U.jsx)(b.Zp,{label:m.Ru.get("desktop.login.Back"),children:(0,U.jsx)(g.a,{ariaLabel:m.Ru.get("desktop.login.Back"),size:"sm",onClick:x,icon:l.g})})}),k&&(0,U.jsx)(g.a,{icon:o.t,size:"sm",onClick:P,ariaLabel:m.Ru.get("web-player.now-playing-view.hide"),className:B}),i||(0,U.jsx)(H,{title:t,panelLinkRef:p,item:h,link:e,variant:y,semanticColor:j}),(0,U.jsxs)("span",{className:s()(O,A),children:[a,!V&&!I&&!F&&(0,U.jsx)("div",{"data-testid":"PanelHeader_CloseButton",children:(0,U.jsx)(b.Zp,{label:m.Ru.get("close"),children:(0,U.jsx)(g.a,{ariaLabel:m.Ru.get("close"),className:D,size:"sm",onClick:P,icon:c.M,disabled:!R})})})]})]})})}},45315:(e,t,i)=>{i.d(t,{r:()=>n.r});var n=i(65703)},49943:(e,t,i)=>{i.d(t,{H:()=>o});var n=i(48392),a=i(77812),s=i(79252),r=i(1080),l=i(86070);const o=()=>(0,l.jsxs)("div",{className:r.A.emptyContainer,children:[(0,l.jsx)(n.q,{size:"xxlarge","aria-hidden":"true"}),(0,l.jsxs)("div",{className:r.A.titleContainer,children:[(0,l.jsx)(a.E,{as:"h1",variant:"titleMedium",semanticColor:"textBase",children:s.Ru.get("history.empty-title")}),(0,l.jsx)("p",{children:s.Ru.get("history.empty-description")})]})]})},51038:(e,t,i)=>{i.d(t,{_:()=>C,s:()=>y});var n=i(30758),a=i(97500),s=i.n(a),r=i(62411),l=i(74520),o=i(82101),c=i(19315),u=i(4881),d=i(64232),p=i(39736);const m="ffFwfKcPDbmAPLXzxzKq",g="jD_TVjbjclUwewP7P9e8",v="nZaXB942idDuiFv4bKNk",x="Fwe5dGEAgs_VFp4SPrzv",b="gchSBzolAjaPDHD1q0rA";var h=i(86070);const y=(0,n.createContext)(null),C=({label:e,style:t,focusTransferId:i,children:a,className:C,nodeRef:f})=>{const j=(0,n.useRef)(null),S=f??j,w=(0,u.S)(),N=(0,c.h)(),E=(0,r.d4)((e=>e.ui?.fullscreenMode?.isOpen??!1)),R=(0,d.XB)(),k=w===o.z.NOW_PLAYING_VIEW;return(0,l.X)(i??null,S),(0,h.jsx)(y.Provider,{value:S,children:(0,h.jsx)("aside",{"aria-label":e,className:s()(m,C,{[v]:k,[b]:E,[x]:N,[g]:R!==p.Z.Disabled&&R!==p.Z.NowPlayingView}),style:t,id:"Desktop_PanelContainer_Id",ref:S,tabIndex:-1,children:a})})}},52276:(e,t,i)=>{i.d(t,{O:()=>s,j:()=>a});var n=i(30758);let a=function(e){return e[e.Errored=0]="Errored",e}({});const s=(0,n.createContext)({state:null,capturePlaybackError:()=>{}})},53284:(e,t,i)=>{i.d(t,{p:()=>b});var n=i(30758),a=i(77812),s=i(10728),r=i(80013),l=i(79252),o=i(35953),c=i(71516),u=i(42851),d=i(76137);const p="pIxPdfuNasUDLbEDmuK_",m="T5TwrUTf23N311rgrEAc",g="BTwQUS5iBiiOBgdda2Zi",v="lu2OTpzgQ6hv6AYWXMNQ";var x=i(86070);const b=({localStorageKey:e,onDismiss:t})=>{const[i,b]=(0,d.x)(e,!1),{logStartJam:h}=(0,u.O)(),{enqueueSnackbar:y}=(0,o.d)(),C=(0,n.useCallback)((()=>{b(!0),t&&t(),y(l.Ru.get("web-player.social-connect.promotion.how-to-start-a-jam-reminder"),{autoHideDuration:5e3})}),[y,t,b]);return i?(0,x.jsx)(x.Fragment,{}):(0,x.jsxs)("div",{className:p,children:[(0,x.jsxs)("div",{className:m,children:[(0,x.jsx)(a.E,{as:"p",variant:"bodySmall",semanticColor:"textSubdued",children:l.Ru.get("web-player.social-connect.invitation-modal.subtitle")}),(0,x.jsx)(s.H,{iconOnly:r.M,className:g,"aria-label":l.Ru.get("close"),onClick:C,size:"small"})]}),(0,x.jsx)("div",{className:v,children:(0,x.jsx)(c.$,{onClick:h})})]})}},54059:(e,t,i)=>{i.d(t,{L:()=>l});var n=i(30758),a=i(24848),s=i(92505),r=i(16440);function l({episodeUri:e,start:t,stop:i}){const{togglePlay:l,triggerPlay:o,isPlaying:c,isActive:u}=(0,a.P)({uri:e},{featureIdentifier:"episode"}),d=(0,s.o)((e=>(0,r.s)(e)??0)),p=u&&function(e,t,i){return i>=e&&i<t}(t,i,d),m=c&&p;return{onClick:(0,n.useCallback)((e=>{p?l({seekTo:t,loggingParams:e}):o({seekTo:t,loggingParams:e})}),[p,t,l,o]),isPlaying:m,isActive:p}}},58749:(e,t,i)=>{i.d(t,{x:()=>s});var n=i(16318),a=i(50597);function s(){const e=(0,a.t)();return(0,n.I)({queryKey:["settings-formats"],queryFn:()=>e.quality.getFormats(),gcTime:36e5,staleTime:6e5}).data}},61211:(e,t,i)=>{i.d(t,{$:()=>a});var n=i(30758);const a=()=>{const[e,t]=(0,n.useState)(document.hasFocus());return(0,n.useEffect)((()=>{function e(){t(!0)}function i(){t(!1)}return window.addEventListener("focus",e),window.addEventListener("blur",i),()=>{window.removeEventListener("focus",e),window.removeEventListener("blur",i)}}),[]),e}},63673:(e,t,i)=>{i.d(t,{R:()=>n.R});var n=i(66611)},64175:(e,t,i)=>{i.d(t,{a:()=>n.a});var n=i(41205)},71076:(e,t,i)=>{i.d(t,{J:()=>n.J});var n=i(15113)},71516:(e,t,i)=>{i.d(t,{$:()=>p});var n=i(30758),a=i(62411),s=i(82499),r=i(55914),l=i(79252),o=i(66105),c=i(94224),u=i(57160),d=i(86070);const p=({onClick:e})=>{const t=(0,a.wA)(),i=(0,c.Y)(),p=(0,n.useCallback)((async()=>{try{e(),await i()}catch(e){t((0,o.A9)(u.EL.ERROR))}}),[i,t,e]);return(0,d.jsx)(s.$,{iconLeading:r.V,size:"small",onClick:p,children:l.Ru.get("web-player.social-connect.menu-action.title")})}},81126:(e,t,i)=>{i.d(t,{o:()=>s});var n=i(29835),a=i(53507);function s(){return(0,a.N)(n.g)}},83223:(e,t,i)=>{i.d(t,{t:()=>s});var n=i(53507),a=i(53742);function s(){return(0,n.N)(a.Z)}},88975:(e,t,i)=>{i.d(t,{D:()=>s});var n=i(78620),a=i(53507);function s(){return(0,a.N)(n.x)}},95026:(e,t,i)=>{i.d(t,{F:()=>d});var n=i(30758),a=i(53177),s=i(64232),r=i(39736),l=i(21709),o=i(87761);const c="KrBYgWLGb5aRHjoD_prX";var u=i(86070);const d=(0,a.mc)((()=>{const{setVideoPlayerUIFlag:e}=(0,l.d)(),t=(0,s.XB)();return(0,n.useEffect)((()=>(t===r.Z.NowPlayingView&&e(o.nP.npv,!0),()=>{e(o.nP.npv,!1)})),[t,e]),(0,u.jsx)("div",{id:"VideoPlayerNpv_ReactPortal",className:c})}),{name:"NPVVideoContainer"})},97235:(e,t,i)=>{i.d(t,{T:()=>l});var n=i(30758),a=i(39954),s=i(3161),r=i(86070);const l=()=>{const{spec:e,logger:t,UBIFragment:i}=(0,s.r)(a.I,{});return{logUserClick:(0,n.useCallback)(((i,n)=>{t.logInteraction(e.participantListFactory().participantListRowFactory({position:i}).userLinkFactory().hitUiNavigate({destination:n}))}),[t,e]),logRemoveClick:(0,n.useCallback)((i=>{t.logInteraction(e.participantListFactory().participantListRowFactory({position:i}).removeButtonFactory().hitUiReveal())}),[t,e]),UBIFragmentWithSpec:(0,n.useCallback)((t=>(0,r.jsx)(i,{spec:e,...t})),[i,e])}}}}]);
//# sourceMappingURL=dwp-panel-section.js.map