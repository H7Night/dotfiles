"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[3322],{21636:(e,t,i)=>{i.d(t,{NowPlayingBar:()=>ns});var a=i(30758),s=i(97500),n=i.n(s),o=i(62411),r=i(94079),c=i(75322),l=i(17369),u=i(77676),d=i(29174);const m="dz_h98rH9nZCwfPdnKgr",g="rAfV2jB_HMM9Xtr0Rqvn",p="XkXPpDRWozMF6G8_GlLQ";var v=i(86070);const b=a.memo((function(e){const{handleClick:t}=e,i=d.Ru.get("pta.bottom-bar.title"),a=d.Ru.get("fta.bottom-bar.subtitle"),s=d.Ru.get("fta.sign-up-free");return(0,v.jsxs)("div",{className:m,onClick:t,"data-testid":"signup-bar",children:[(0,v.jsxs)("div",{className:g,children:[(0,v.jsx)(l.E,{as:"p",variant:"bodySmallBold",children:i}),(0,v.jsx)(l.E,{as:"p",variant:"bodyMedium",dangerouslySetInnerHTML:{__html:a}})]}),(0,v.jsx)(u.$,{colorSet:"invertedLight",onClick:t,className:p,children:s})]})}));var y=i(84706),h=i(33009),k=i(30934),x=i(93727),C=i(29660),N=i(74760),j=i(1473),f=i(17154);const S="gqYYMz8DkhaT3e44LcHQ",I="VX33mI2V_jRA7hRBI9_0",A=({remoteDeviceName:e,remoteDeviceType:t,connectionStatus:i,omitConnectionStateText:a=!1})=>{const{spec:s,logger:n}=(0,f.r)(k.s,{}),{triggerRef:o,toggleDevicePicker:r,isPickerOpen:c}=(0,C.z)(),u=(0,N.$A)(t,i),m=i===j.zP.CONNECTED?d.Ru.get("web-player.connect.bar.connected-state",{device_name:e}):d.Ru.get("web-player.connect.bar.connecting-state",{device_name:e});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(u,{size:"small",className:I,role:"presentation",semanticColor:"essentialBase"}),(0,v.jsx)(h.Y,{component:"button",onClick:()=>{const e=s.activeDeviceButtonFactory(),{interactionId:t}=n.logInteraction(c?e.hitUiHide():e.hitUiReveal()),i=c;r(t),i||(0,x.I)("DEVICE-PICKER")},ref:o,className:S,children:(0,v.jsx)(l.E,{variant:"bodySmallBold","aria-live":"polite",semanticColor:"textBase",children:a&&i===j.zP.CONNECTED?e:m})})]})},P="nQSM_BrSHJ4Cp3XSuLOF",D=()=>(0,v.jsxs)("svg",{width:"1",height:"16",viewBox:"0 0 1 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",role:"separator",className:P,children:[(0,v.jsx)("g",{id:"separator",clipPath:"url(#clip0_491_88335)",children:(0,v.jsx)("rect",{id:"Rectangle 111112858",width:"1",height:"16",rx:"0.5",fill:"var(--essential-base)"})}),(0,v.jsx)("defs",{children:(0,v.jsx)("clipPath",{id:"clip0_491_88335",children:(0,v.jsx)("rect",{width:"1",height:"16",fill:"white"})})})]});var w=i(2035),T=i(32002),E=i(82836),R=i(93211),B=i(41097);const O="main-connectBar-connectBar",_="main-connectBar-connected",F="main-connectBar-connecting",L=function(){const{isPlayingRemotely:e,connectionStatus:t,remoteDeviceName:i,remoteDeviceType:a}=(0,E.v)((e=>{const t=(0,T.V)(e);return{isPlayingRemotely:t.isPlayingRemotely,connectionStatus:t.connectionStatus,remoteDeviceName:t.remoteDevice?.name,remoteDeviceType:t.remoteDevice?.type}}),B.a),s=(0,R.g)(),o=e&&i&&a;if(!o&&!s)return null;const r=t===j.zP.CONNECTED||s,c=t===j.zP.CONNECTING&&!s;return(0,v.jsxs)("div",{className:n()(O,{"encore-bright-accent-set":r,[_]:r,[F]:c}),children:[s&&(0,v.jsx)(w.K,{}),s&&o&&(0,v.jsx)(D,{}),o&&(0,v.jsx)(A,{connectionStatus:t,remoteDeviceName:i,remoteDeviceType:a,omitConnectionStateText:s})]})},U=()=>(0,v.jsx)(a.Suspense,{fallback:null,children:(0,v.jsx)(L,{})});var M=i(41588),V=i(33720),z=i(52276),K=i(6481),q=i(9098),H=i(5082),G=i(43123),W=i(5956);var Y=i(40638),Z=i(13932),Q=i(29462),X=i(62139),$=i(35638),J=i(68443);const ee="main-genericButton-button",te="main-genericButton-buttonActive",ie="main-genericButton-buttonActiveDot",ae=(0,a.forwardRef)(((e,t)=>{const i=e.isActive??!1,a=n()(ee,{[te]:i||e.isActiveNoIndicator,[ie]:i},e.className);return(0,v.jsx)(J.Zp,{label:e.label,children:(0,v.jsx)($.H,{ref:t,style:e.style,"aria-label":e.label,size:"small",className:a,disabled:e.disabled,iconOnly:e.icon,onClick:e.onToggle,"data-testid":e.testId,"data-active":i.toString(),"aria-pressed":i,"data-restore-focus-key":e.restoreFocusKey,"aria-describedby":e.ariaDescribedby})})}));var se=i(63850),ne=i(13232),oe=i(31592);const re=({className:e="",disabledClassName:t="",onClick:i})=>{const s=(0,X.lZ)(),o=(0,W.o)((e=>e?.hasContext??!1)),r=(0,V.l)(),c=!o,{toggleFullScreen:l,isInFullScreen:u}=(0,oe.H)({refOrElement:document.body,shouldWakeLockScreen:!0}),m=(0,a.useCallback)((()=>{const e=u?M.z.CLOSED:M.z.NOW_PLAYING_VIEW;l(),setTimeout((()=>{r(e)}),1)}),[u,r,l]),g=(0,a.useCallback)((async()=>{o&&(i?.(!0),m())}),[o,i,m]),p=u?se.z:ne.T,b=u?d.Ru.get("web-player.cinema-mode.fullscreen.exit"):d.Ru.get("web-player.cinema-mode.fullscreen.enter"),y=n()(e,{[t]:c});return s?(0,v.jsx)(ae,{onToggle:g,className:y,icon:p,label:b,disabled:c,testId:"fullscreen-mode-button"}):null},ce=(0,a.memo)(re);var le=i(35188),ue=i(78054),de=i(95434);var me=i(42177),ge=i(18132);const pe="connect-message-nudge",ve="O8rZyzX8hHFyZlCUJq0c",be=({onClose:e,onMouseEnter:t,onMouseLeave:i,onClick:a,impressionCallback:s,message:n})=>(0,v.jsx)("div",{ref:s,onMouseEnter:t,onMouseLeave:i,onClick:a,children:(0,v.jsx)(ge.z,{onClose:t=>{t.stopPropagation(),e?.()},isAllowedDuringCinemaMode:!0,className:ve,maxWidth:336,children:(0,v.jsx)(l.E,{id:pe,as:"p",variant:"bodyMedium",semanticColor:"textBase",children:n})})});var ye=i(75201),he=i(36044);const ke=(e=ye.C)=>{const t=(0,o.Pj)(),{isActive:i}=e(),a=(0,he.h)();return document.hasFocus()&&!i&&!(({ui:e,ads:t},i)=>e.blockUserDialog.isOpen||e.connectDevicePicker.isOpen||e.deleteFolderDialog.isOpen||e.deletePlaylistDialog.isOpen||e.fullscreenMode.isOpen||e.improvedSignupPromptDialog.isOpen||e.keyboardShortcutsHelpModal.isOpen||e.leavePlaylistDialog.isOpen||e.offlineDeviceLimitReachedDialog.isOpen||e.playbackNotSupportedErrorDialog.isOpen||e.premiumDialog.isOpen||!0===t.billboard?.isOpen&&!t.billboard.isMinimized||!1===t.vto?.isHidden&&!1===t.vto?.isMinimized||i)(t.getState(),a.current.length>0)};var xe=i(44314);var Ce=i(44483),Ne=i(93896),je=i(33633),fe=i(10635),Se=i(53129),Ie=i(11761),Ae=i(93510),Pe=i(49772);const De=e=>{const t=(0,a.useRef)(),i=(0,a.useRef)(),s=(0,a.useRef)(!1),n=(0,Se.z)(),o=(0,Ne.Z)(),{spec:r,logger:c}=(0,f.r)(xe.w,{}),l=(0,a.useRef)(null),u=(0,a.useCallback)((()=>{c.logInteraction(r.djVoiceUnsupportedNudgeFactory().closeButtonFactory().hitUiHide())}),[r,c]),m=(0,a.useCallback)((e=>{e&&l.current!==e&&c.logImpression(r.djVoiceUnsupportedNudgeFactory().impression()),l.current=e}),[r,c]),g=(0,a.useCallback)((()=>{const e=n.getState(),t=o.getActiveDevice();return!(e=>e?.isLocal??!1)(t)&&(0,Pe.yc)(e,"spotify:playlist:37i9dQZF1EYkqdzj48dyYq")!==Ae.i.NOT_ACTIVE&&!(e=>Boolean(e?.supportsDJNarration))(t??void 0)}),[n,o]),p=(0,a.useCallback)((()=>{g()&&e({nudgeType:"message-only-nudge",message:d.Ru.get("web-player.connect.nudge.dj-voice-unavailable"),onClose:u,impressionCallback:m})}),[e,g,u,m]),v=(0,a.useCallback)((e=>{e.data.action===fe.Ik.PLAY&&(s.current=!0)}),[]);(0,Ie.p)(fe.gd.ACTION,v);const b=(0,a.useCallback)((e=>{s.current&&(0,Pe.uW)(e.data)===Ae.i.PLAYING&&(t.current=e.data?.context.uri,p(),t.current=void 0,s.current=!1)}),[p]);(0,Ie.p)(fe.gd.UPDATE,b);const y=(0,a.useCallback)((e=>{const t=e.data?.activeDevice;t&&!t.isLocal&&i.current!==t.connectStateId&&p(),i.current=t?.connectStateId}),[p]);(0,je.W)(Ce.P.UPDATE,y)};i(24929);var we=i(26038);const Te=e=>e.some((e=>e.isLocalNetwork&&!e.isDisabled&&(e=>{switch(e.type){case j.bq.AUDIO_DONGLE:case j.bq.AVR:case j.bq.CAST_AUDIO:case j.bq.CAST_VIDEO:case j.bq.GAME_CONSOLE:case j.bq.SPEAKER:case j.bq.STB:case j.bq.TV:return!0;default:return!1}})(e)));var Ee=i(42045),Re=i(72661),Be=i(84040);const Oe=new Date(0).toISOString(),_e=["shift+alt+f10"],Fe=e=>{const t=(0,a.useRef)(),i=(0,a.useRef)(!1),s=(0,a.useRef)(!1),n=(0,o.Pj)(),r=(0,Se.z)(),c=(0,Ne.Z)(),l=(0,Re.V)(),[u,m]=(0,Be.x)("connect-nudge-triggered-at",Oe),g=(0,a.useRef)(null),{spec:p,logger:v}=(0,f.r)(xe.w,{}),b=(0,a.useCallback)((()=>{v.logInteraction(p.connectFromDevicePickerNudgeFactory().hitNoAction())}),[p,v]),y=(0,a.useCallback)((()=>{v.logInteraction(p.connectFromDevicePickerNudgeFactory().closeButtonFactory().hitUiHide())}),[p,v]),h=(0,a.useCallback)((e=>{e&&g.current!==e&&v.logImpression(p.connectFromDevicePickerNudgeFactory().impression()),g.current=e}),[p,v]);(0,Ee.f)(_e,(async()=>{const{platform:{isDeveloperMode:e}}=n.getState();if(e){const e=new Date;e.setHours(e.getHours()-8),m(e.toISOString())}}));const k=(0,a.useCallback)((()=>{const e=r.getState(),t=c.getActiveDevice(),i=c.getDevices(),a=l.getDefaultDevice(),s=new Date(u);s.setHours(s.getHours()+8);return s<=new Date&&(e=>e?.isLocal??!1)(t)&&!(0,Pe.A3)(e)&&Te(i)&&(e=>!e||!(e.terminalType===we.FI.HEADPHONES||e.terminalType===we.FI.SPEAKERS&&(e.transportType===we.Yg.BLUETOOTH||e.transportType===we.Yg.USB)))(a)}),[r,l,u,c]),x=(0,a.useCallback)((()=>{if(k()){e({nudgeType:"message-only-nudge",message:d.Ru.get("web-player.connect.nudge.listen-to-speaker"),impressionCallback:h,onClick:b,onClose:y});const t=(new Date).toISOString();m(t)}}),[e,k,m,b,y,h]),C=(0,a.useCallback)((e=>{e.data.action===fe.Ik.PLAY?i.current=!0:e.data.action===fe.Ik.RESUME&&(s.current=!0)}),[]);(0,Ie.p)(fe.gd.ACTION,C);const N=(0,a.useCallback)((e=>{i.current&&(0,Pe.uW)(e.data)===Ae.i.PLAYING?(t.current=e.data?.context.uri,x(),t.current=void 0,i.current=!1):s.current&&!1===e.data?.isPaused&&(t.current=e.data?.context.uri,x(),t.current=void 0,s.current=!1)}),[x]);(0,Ie.p)(fe.gd.UPDATE,N)},Le=e=>{Fe(e),De(e)};var Ue=i(56168);const Me=()=>{const e=(0,a.useRef)(),t=(0,a.useRef)(!1),i=(0,a.useRef)(!1),s=(0,o.wA)(),n=(0,o.d4)((e=>e.ui.connectNudge.isOpen)),r=(0,o.d4)((e=>e.ui.connectDevicePicker.isOpen)),c=(0,a.useCallback)((()=>{i.current&&(clearTimeout(e.current),i.current=!1),s((0,Ue.Yp)())}),[s]),l=(0,a.useCallback)((()=>{i.current=!1,t.current||c()}),[c]),u=(0,a.useCallback)((()=>{e.current=window.setTimeout(l,8e3),s((0,Ue.dK)()),i.current=!0}),[s,l]),d=(0,a.useCallback)((e=>{t.current=e,e||i.current||c()}),[c]);return(0,a.useEffect)((()=>{r&&c()}),[r,c]),(0,a.useMemo)((()=>({hideNudge:c,showNudge:u,setShouldKeepShowingNudge:d,isNudgeVisible:n})),[c,u,d,n])},Ve=({children:e,useNudgeTriggers:t=Le,useToggleNudgeWithTimer:i=Me,useCanShowNudge:s=ke,disabled:n=!1})=>{const{showNudge:o,hideNudge:r,setShouldKeepShowingNudge:c,isNudgeVisible:l}=i(),[u,d]=(0,a.useState)(null),m=s();(0,a.useEffect)((()=>{l&&!m&&r()}),[m,r,l]),t((e=>!(l||!m)&&(d(e),o(),!0)));const g=(0,a.useCallback)((e=>{if(!e)return(0,v.jsx)(v.Fragment,{});return(0,v.jsx)(be,{onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),...e,onClose:()=>{e?.onClose?.(),r()}})}),[r,c]);return(0,v.jsx)(me.E,{isVisible:Boolean(u?.message)&&l&&!n,content:g(u),children:e})};var ze=i(615),Ke=i(51185),qe=i(98746);const He=()=>{const{remoteDeviceType:e,remoteDeviceIsGroup:t,connectionStatus:i}=(0,E.v)((e=>{const t=(0,T.V)(e);return{remoteDeviceType:t.remoteDevice?.type,remoteDeviceIsGroup:t.remoteDevice?.isGroup,connectionStatus:t.connectionStatus}}),B.a),s=(0,ue.g)(),{isActive:n}=(0,ze.AI)(Ke.Z.DevicePickerOverlay),{canTogglePanel:o,isActive:r,togglePanel:c}=(0,de.C)(),{spec:l,logger:u}=(0,f.r)(le.p,{}),m=(0,a.useCallback)((()=>{const{interactionId:e}=u.logInteraction(function(e,t,i){return {interactionId:null,pageInstanceId:null};let a;return a=t===j.zP.CONNECTING?e.connectingButtonFactory():t===j.zP.CONNECTED?e.connectedButtonFactory():e.notConnectedButtonFactory(),i?a.hitUiHide():a.hitUiReveal()}(l,i,r));c(e)}),[i,c,r,l,u]),{currentDevice:g}=(0,qe.l)(),{isLocal:p}=g,b=(0,a.useMemo)((()=>(0,N.tf)(e,t,p?s:null)),[s,p,t,e]);return(0,v.jsx)(Ve,{children:(0,v.jsx)(ae,{isActive:r,disabled:!o,onToggle:m,label:d.Ru.get("playback-control.connect-picker"),icon:b,restoreFocusKey:n?Ke.Z.DevicePickerOverlay:Ke.Z.DevicePicker,ariaDescribedby:pe})})};var Ge=i(72904),We=i(65045),Ye=i(5206),Ze=i(7436);const Qe=We.$S.PUFFIN_BUTTON_CLICK,Xe=We.$S.DEVICE_PICKER_BUTTON_CLICK,$e=()=>{const{isPuffinPanelActive:e}=(0,Ze.c)(),{isActive:t,panelSend:i}=(0,ze.AI)(Ke.Z.DevicePicker,Ke.Z.DevicePickerOverlay),s=(0,ze.Ev)(Qe),{remoteDeviceType:n,remoteDeviceisGroup:o}=(0,E.v)((e=>{const t=(0,T.V)(e);return{remoteDeviceType:t.remoteDevice?.type,remoteDeviceisGroup:t.remoteDevice?.isGroup}}),B.a),r=(0,ue.g)(),c=r?.audioDevice.terminalType===we.FI.HEADPHONES,l=(0,Ye.K)(),u=t||e,m=l||c,{currentDevice:g}=(0,qe.l)(),{isLocal:p}=g,b=(0,a.useMemo)((()=>l?Ge.C:(0,N.tf)(n,o,p?r:null)),[r,l,o,n,p]);return(0,v.jsx)(Ve,{children:(0,v.jsx)(ae,{isActive:u,isActiveNoIndicator:m,onToggle:()=>{const e=t;i(Xe),e||(0,x.I)("DEVICE-PICKER")},label:d.Ru.get("playback-control.connect-picker"),icon:b,disabled:!s,restoreFocusKey:e?Ke.Z.Puffin:Ke.Z.DevicePicker,ariaDescribedby:pe})})};var Je=i(28873);const et=()=>{const{isAnonymous:e}=(0,o.d4)(H.Ht),t=(0,Je.v)();return e?null:t?(0,v.jsx)(a.Suspense,{fallback:null,children:(0,v.jsx)($e,{})}):(0,v.jsx)(He,{})};var tt=i(6938),it=i(10850),at=i(23736),st=i(64768),nt=i(73544),ot=i(80772),rt=i(8558);const ct=a.memo((({onClick:e,className:t,isActive:i,isEnabled:a})=>{const s=a?d.Ru.get("web-player.lyrics.title"):d.Ru.get("web-player.lyrics.noLyrics1"),n=a?e:void 0;return(0,v.jsx)(ae,{className:t,isActive:i,onToggle:n,disabled:!a,label:s,testId:"lyrics-button",icon:it.q})})),lt=a.memo((e=>{const t=Boolean((0,ot.J)().data?.hasLyrics);return(0,v.jsx)(ct,{...e,isEnabled:t,isActive:!1})})),ut=a.memo((e=>{const t=(0,W.o)((e=>e?.item?.uri)),i=Boolean((0,nt.f)(t).hasLyrics);return(0,v.jsx)(ct,{...e,isEnabled:i,isActive:!1})})),dt=a.memo((e=>{const t=(0,z.S)(),{currentVariant:i}=(0,K.r)(),{isActiveNotCinemaMode:a}=(0,st.$)(),{isAnonymous:s}=(0,o.d4)(H.Ht),n=(0,Z.NC)(rt.khs),r=(0,W.o)((e=>{if(e?.item?.uri&&(0,at.U_m)(e?.item?.uri)){return!Boolean(e?.item?.metadata?.["segment.index"])}return!1}));if(s||!r)return null;const c=t===M.z.NOW_PLAYING_VIEW&&"lyrics"===i,l=a||c;return l?(0,v.jsx)(ct,{...e,isActive:l,isEnabled:!0}):n?(0,v.jsx)(lt,{...e}):(0,v.jsx)(ut,{...e})}));var mt=i(85387),gt=i(1197),pt=i(9221);const vt=({onClick:e,className:t})=>{const i=(0,z.S)(),{currentVariant:a,previousVariant:s}=(0,K.r)(),n=(0,tt.F)(),{toggleLyrics:o}=function({referrer:e,onChange:t}){const i=(0,mt.Zp)(),{isActive:a,routeDestination:s}=(0,st.$)(),n=(0,pt.f)(),o=()=>{a||(i(s,{state:{referrer:e}}),t?.(s))},r=()=>{if(a){const e="/",a=n.uri===gt.N6?e:(0,at.o_h)(n.uri)?.toURLPath(!0)??e;i(a),t?.(null)}};return{isActive:a,showLyrics:o,hideLyrics:r,toggleLyrics:()=>{a?r():o()}}}({onChange:e,referrer:"now_playing_bar"}),r=i===M.z.NOW_PLAYING_VIEW;return(0,v.jsx)(dt,{onClick:r?()=>{n("lyrics"===a?s??"artwork":"lyrics")}:o,className:t})};var bt=i(51899);const yt=We.$S.NPV_BUTTON_CLICK,ht=({onClick:e})=>{const{isActive:t,panelSend:i}=(0,ze.AI)(Ke.Z.NowPlayingView),a=(0,ze.Ev)(yt),s=(0,Z.NC)(rt.ZDY),n=(0,z.S)(),o=(0,V.l)(),{item:r}=(0,W.o)((e=>({item:e?.item})),((e,t)=>e.item?.uri===t.item?.uri)),c=!r||!a,l=n===M.z.NOW_PLAYING_VIEW;if(s)return null;const u=t&&!l;return(0,v.jsx)(ae,{isActive:u,disabled:c,onToggle:()=>{e?.(!t),l?((0,x.I)("NPV_OPEN_CINEMA_MODE_BUTTON"),o(M.z.CLOSED),t||i(yt)):i(yt)},icon:bt.d,label:d.Ru.get("web-player.now-playing-view.label"),testId:"control-button-npv",restoreFocusKey:Ke.Z.NowPlayingView})};var kt=i(40145),xt=i(83080),Ct=i(58220),Nt=i(58814),jt=i(93381);const ft=[xt.fl.TRACKS,xt.fl.LOCAL_TRACKS,xt.fl.EPISODES],St=We.$S.QUEUE_BUTTON_CLICK,It=({onClick:e})=>{const{isEnabled:t,isVisible:i}=(()=>{const{isAnonymous:e}=(0,o.d4)(H.Ht);return e?{isVisible:!1}:{isVisible:!0,isEnabled:!0}})(),s=(0,ze.Ev)(St),{isActive:n}=(0,ze.AI)(Ke.Z.Queue,Ke.Z.QueueOverlay),{toggleQueue:r}=(0,jt.R)(),c=(0,a.useCallback)((()=>{t&&(e({mode:"panel",aboutToShow:!n}),r())}),[t,e,n,r]),{className:l,dropPosition:u,...m}=(()=>{const{openQueue:e}=(0,jt.R)(),t=(0,Se.z)(),i=(0,a.useCallback)((()=>{e()}),[e]),s=(0,a.useCallback)((e=>{const{[xt.fl.TRACKS]:i=[],[xt.fl.LOCAL_TRACKS]:a=[],[xt.fl.EPISODES]:s=[]}=e,n=[...i,...a,...s];t.addToQueue(n.map((e=>({uri:e,uid:null}))))}),[t]);return(0,Nt.A)({allowedMimeTypesByDropPosition:{[Ct.Nz.ON]:ft},onDrop:s,onLongDragOver:i})})();return i?(0,v.jsx)("div",{className:l,...m,children:(0,v.jsx)(ae,{icon:kt.j,label:d.Ru.get("playback-control.queue"),onToggle:c,isActive:n,disabled:!t||!s,testId:"control-button-queue",restoreFocusKey:Ke.Z.Queue})}):null};var At=i(23465),Pt=i(92550),Dt=i(80514);const wt=({onClick:e})=>{const{item:t}=(0,Pt.L)()??{},{isActive:i,onClick:a,showButton:s}=(0,Dt.D)({item:t,onClick:e});return t&&s?(0,v.jsx)(ae,{isActive:i,onToggle:a,label:i?d.Ru.get("miniplayer.close"):d.Ru.get("miniplayer.open"),icon:At.F,testId:"pip-toggle-button"}):null};var Tt=i(39184),Et=i(28719);const Rt="main-nowPlayingBar-extraControls",Bt="main-nowPlayingBar-lyricsButton",Ot="main-nowPlayingBar-volumeBar",_t=()=>{const e=(0,Z.NC)(rt.L$q),{spec:t,logger:i,UBIFragment:a}=(0,f.r)(Q.h9,{data:{identifier:Q.gw.DESKTOP}}),s=(0,Y.YQ)((e=>{i.logInteraction(t.volumeBarFactory().dragSetVolume({newVolumePercentage:Math.floor(100*e)}))}),500,{leading:!1,trailing:!0});return(0,v.jsx)(a,{spec:t,children:(0,v.jsxs)("div",{className:Rt,children:[(0,v.jsx)(Et.mA,{onClick:()=>{i.logInteraction(t.djJumpButtonFactory().hitRefreshContent())}}),(0,v.jsx)(ht,{onClick:e=>{e?i.logInteraction(t.npvButtonFactory().hitUiReveal()):i.logInteraction(t.npvButtonFactory().hitUiHide())}}),e===rt.vkU.CONTROL&&(0,v.jsx)(vt,{className:Bt,onClick:e=>{e?i.logInteraction(t.lyricsButtonFactory().hitUiNavigate({destination:e})):i.logInteraction(t.lyricsButtonFactory().hitUiNavigateBack())}}),(0,v.jsx)(It,{onClick:e=>{"main"===e.mode?e.route?i.logInteraction(t.queueButtonFactory().hitUiNavigate({destination:e.route})):i.logInteraction(t.queueButtonFactory().hitUiNavigateBack()):e.aboutToShow?i.logInteraction(t.queueButtonFactory().hitUiReveal()):i.logInteraction(t.queueButtonFactory().hitUiHide())}}),(0,v.jsx)(et,{}),(0,v.jsx)(Tt.M,{className:Ot,onVolumeBarClick:e=>{i.logInteraction(t.volumeBarFactory().hitSetVolume({newVolumePercentage:Math.floor(100*e)}))},onToggleMuteClick:e=>{"muted"===e?i.logInteraction(t.volumeMuteButtonFactory().hitMutePlayback()):"not_muted"===e&&i.logInteraction(t.volumeMuteButtonFactory().hitUnmutePlayback())},onVolumeBarDrag:s}),(0,v.jsx)(wt,{}),(0,v.jsx)(ce,{className:"control-button",disabledClassName:"control-button--disabled",onClick:e=>{e&&i.logInteraction(t.fullscreenButtonFactory().hitUiReveal())}})]})})};var Ft=i(39708),Lt=i(60583),Ut=i(19492);const Mt="yyrJTUPMeLS8qs1a0YJr",Vt=({logoUrl:e})=>e?(0,v.jsx)("div",{className:Mt,"data-testid":"context-ad-logo",children:(0,v.jsx)(Lt.N,{loading:"eager",imgSrc:e,width:56,height:56,type:Ut.c.AD})}):null;var zt=i(70519),Kt=i(34589),qt=i(31284);const Ht=({item:e,context:t,index:i})=>{const{logoImage:a}=(0,zt.b)(e);return(0,v.jsx)(qt.e,{item:e,context:t,index:i,"aria-label":d.Ru.get("ad-formats.advertisement"),adEventReason:Kt.c.AD_LOGO,isVisible:!1,children:(0,v.jsx)(Vt,{logoUrl:a})})};var Gt=i(35655),Wt=i(27871),Yt=i(38975);const Zt=a.memo((function({uri:e,className:t,onClick:i,size:s=Gt.t.xs}){const[n,o]=(0,Yt.A)(e),r=(0,Wt.W)(),c=(0,a.useCallback)((t=>{t.preventDefault(),r({targetUri:e,intent:n?"remove-from-library":"add-to-library",type:"click"}),i&&i(!n),o(!n)}),[r,e,n,i,o]);return(0,v.jsx)(Gt.M,{className:t,size:s,onClick:c,isAdded:!!n,condensed:!0})}));var Qt=i(79769),Xt=i(37739),$t=i(51040);const Jt=({uri:e,isBook:t=!1,size:i=Gt.t.xs,className:s,onClick:n})=>{const{isPreSaved:o,addPresave:r,removePresave:c}=(0,$t.w)({uri:e,isBook:t}),l=(0,a.useCallback)((()=>{o?c():r(),n?.(!o)}),[o,n,c,r]);return(0,v.jsx)(Gt.M,{className:s,size:i,onClick:l,isAdded:!!o,condensed:!0})};var ei=i(53795),ti=i(22853),ii=i(74010),ai=i(62443),si=i(96535),ni=i(45708),oi=i(83552),ri=i(28994),ci=i(18320),li=i(53502),ui=i(12496);function di(e){return(0,ui.v)(e)||(0,li.p)(e)}const mi=We.$S.NPV_BUTTON_CLICK,gi=()=>{const e=(0,V.l)(),t=(0,Z.NC)(rt.wZE),i=(0,z.S)(),s=(0,ze._Y)();return(0,a.useCallback)((()=>{i===M.z.CLOSED?t?e(M.z.NOW_PLAYING_VIEW):s(mi):e(M.z.CLOSED)}),[t,i,s,e])};var pi=i(47731),vi=i(94583),bi=i(43026),yi=i(22521);const hi=({spec:e})=>{const t=(0,bi.s)(),i=(0,Pt.L)(),{draggable:s,onDragStart:n}=(0,vi.P)(),o=(0,z.S)(),r=gi(),{images:c}=(0,pi.u)(i?.item),l=o===M.z.NOW_PLAYING_VIEW,u=(0,a.useCallback)((()=>{r();const i=l?e.hitUiHide():e.hitUiReveal();t.logInteraction(i)}),[l,t,e,r]);if(null===i)return null;const{context:m,item:g}=i;return(0,v.jsx)(si.h,{menu:(0,v.jsx)(oi.W,{context:m,item:g}),children:(0,v.jsx)("div",{draggable:s&&di(g),onDragStart:e=>{n(e,{itemUris:[g.uri],dragLabelText:(0,ci.r)(g)})},children:(0,v.jsx)(ri.R,{uri:m.uri,owner:m.metadata?.context_owner,children:(0,v.jsx)("button",{type:"button","data-testid":"cover-art-button",className:yi.A.coverArtButton,"aria-label":d.Ru.get("web-player.now-playing-view.label"),onClick:u,children:(0,v.jsx)(ni.b,{images:c,type:g.type,size:56,maxSize:56,className:yi.A.coverArt})})})})})};var ki=i(31190),xi=i(70417),Ci=i(10909),Ni=i(28838);const ji="main-coverSlotCollapsed-container",fi="main-coverSlotCollapsed-expandButton",Si=We.$S.NPV_BUTTON_CLICK,Ii=({children:e,className:t,spec:i})=>{const s=(0,bi.s)(),o=(0,ze.Ev)(Si),r=(0,z.S)(),{isActive:c}=(0,ze.AI)(Ke.Z.NowPlayingView),l=(0,Z.NC)(rt.wZE),u=gi(),m=(0,a.useMemo)((()=>{if(l){const e=r===M.z.NOW_PLAYING_VIEW;return{label:e?d.Ru.get("web-player.cinema-mode.minimize"):d.Ru.get("web-player.now-playing-view.cinema-mode.expand"),Icon:e?ki.b:xi.L,isActive:e,isDisabled:!1}}return{label:c?d.Ru.get("npb.collapseCoverArt"):d.Ru.get("npb.expandCoverArt"),Icon:c?Ci.r:Ni.o,isActive:c,isDisabled:!o}}),[l,o,r,c]),g=(0,a.useCallback)((()=>{u();const e=i.coverartArrowFactory(),t=m.isActive?e.hitUiHide():e.hitUiReveal();s.logInteraction(t)}),[s,i,m.isActive,u]);return(0,v.jsxs)("div",{"data-testid":"CoverSlotCollapsed__container",className:n()(ji,t),children:[e,(0,v.jsx)(J.Zp,{label:m.label,children:(0,v.jsx)("button",{className:n()(fi),disabled:m.isDisabled,onClick:g,"aria-label":m.label,"aria-pressed":m.isActive,children:(0,v.jsx)(m.Icon,{iconSize:16})})})]})};var Ai=i(42956),Pi=i(21392),Di=i(55218);var wi=i(98834),Ti=i(52396),Ei=i(94445),Ri=i(75168),Bi=i(55910),Oi=i(45730),_i=i(91030),Fi=i(79530),Li=i(2088),Ui=i(17934),Mi=i(26188);const Vi=({context:e,item:t,onLike:i})=>{const a=(0,Ri.X)(),s=(0,Ei.C)(),n=(0,ti.v)(t);if(a&&s&&(0,Ti.N)(t))return(0,v.jsx)(wi.o,{contextUri:t.metadata?.context_uri??e.uri,id:t.uid??void 0,uri:t.uri,isActive:!0});if(n)return(0,v.jsx)(ei.g,{uri:t.uri,condensed:!0});if((0,ui.v)(t))return t.isLocal?null:(0,v.jsx)(Xt.b,{uri:t.uri,className:"control-button control-button-heart",onClick:i});if((0,li.p)(t))return(0,v.jsx)(Qt.b,{condensed:!0,uri:t.uri,className:"control-button control-button-heart",onClick:i});if((0,Fi.d)(t)){return"trailer"===t?.metadata?.type&&"true"===t?.metadata?.is_pre_release?(0,v.jsx)(Jt,{uri:t.book.uri,isBook:!0,className:"control-button control-button-heart",onClick:i}):(0,v.jsx)(Zt,{uri:t.book.uri,className:"control-button control-button-heart",onClick:i})}return(0,_i.N)(t)||(0,Li.v)(t)?null:(0,Mi.d)(t)},zi=({state:{item:e,context:t,index:i}})=>{!function(e){const t=(0,Di.i)(),i=(0,Pi.X)(e);(0,a.useEffect)((()=>{i&&t.say(i)}),[i,t])}(e);const{videoPlayerMode:s,setVideoPlayerUIFlag:n}=(0,Bi.d)(),{spec:o,logger:r}=(0,f.r)(Ft.p6,{data:{identifier:Ft.gw.DESKTOP}}),c=(0,Pi.P)(e),l=(0,Z.NC)(rt.WAA);(0,a.useEffect)((()=>{n(Oi.nP.nowPlayingBar,l)}),[l,n]);const u=s===Oi.Kz.nowPlayingBar&&l,d=(0,a.useMemo)((()=>o.coverartFactory({uri:e.uri})),[e.uri,o]);return(0,v.jsx)(a.Suspense,{fallback:null,children:(0,v.jsx)("div",{"data-testid":"now-playing-widget",className:yi.A.nowPlaying,role:"contentinfo","aria-label":c,children:(0,v.jsxs)(Ui.r,{spec:o,children:[(0,_i.N)(e)?(0,v.jsx)(Ht,{item:e,context:t,index:i}):(0,v.jsxs)(Ii,{className:yi.A.coverArtCollapsed,spec:d,children:[!u&&(0,v.jsx)(hi,{spec:d}),l&&(0,v.jsx)("div",{id:"VideoPlayerNpb_ReactPortal"})]}),(0,v.jsx)(ii.d,{context:t,className:yi.A.contextItemInfo,item:e,size:"xsmall",enableVideoButton:!0,onTitleClick:t=>{r.logInteraction(o.titleFactory({uri:e.uri}).hitUiNavigate({destination:t||""}))},onSubtitleClick:t=>{r.logInteraction(o.subtitleFactory({uri:e.uri}).hitUiNavigate({destination:t||""}))},referrer:ai.G.NPB}),(0,v.jsxs)("div",{className:yi.A.controls,children:[(0,v.jsx)(Ai.a,{context:t,item:e,onClick:()=>{r.logInteraction(o.hideButtonFactory().hitRemoveRecommendation({recommendedItemUri:e.uri,contextUri:t.uri}))}}),(0,v.jsx)(Vi,{item:e,onLike:t=>{r.logInteraction(t?o.likeButtonFactory({uri:e.uri}).hitLike({itemToBeLiked:e.uri}):o.likeButtonFactory({uri:e.uri}).hitRemoveLike({itemNoLongerLiked:e.uri}))},context:t})]})]})})})},Ki=()=>{const e=(0,Pt.L)();return null===e?(0,v.jsx)("div",{className:n()("now-playing")}):(0,v.jsx)(zi,{state:e})};var qi=i(25215);const Hi="aguQsGoZR9wZeawKGdDh",Gi="ieqOSqJb6kk3bG5XDOHk",Wi=({paused:e,fromSeconds:t})=>{const[i,s]=(0,a.useState)(t);return(0,qi.$)((t=>{s((i=>e?i:i>0?i-1:(t(),i)))}),1e3),(0,v.jsxs)("div",{className:Hi,children:[d.Ru.get("ad-formats.skippable_ads.skip_countdown"),(0,v.jsx)("span",{className:Gi,children:i})]})};var Yi=i(27860);const Zi=({children:e})=>{const t=(0,W.o)((e=>e),((e,t)=>(0,B.a)(e?.restrictions,t?.restrictions)&&e?.item?.uri===t?.item?.uri&&e?.isPaused===t?.isPaused)),i=t?.restrictions.disallowSkippingNextReasons.includes("ad_disallow"),a=t?.isPaused??!1,s=(0,Yi.qc)(t),n=(0,Yi.Tv)(t),r=(0,o.d4)((e=>s?e?.ads?.audio?.info?.skippableAdDelaySeconds:n?e?.ads?.vto?.info?.skippableAdDelaySeconds:void 0));return i&&r?(0,v.jsx)(Wi,{paused:!!a,fromSeconds:r}):(0,v.jsx)(v.Fragment,{children:e})};var Qi=i(90238),Xi=i(16575);var $i=i(35580),Ji=i(98418);const ea=e=>{const[t,i]=(0,a.useState)(new Map),[s,n]=(0,a.useState)(),o=(0,$i.L)(),r=(0,Xi.mr)(),{currentDevice:c}=(0,qe.l)(),l=(0,Ji.vh)(),u=(0,a.useCallback)((()=>{if(!e)return;const a=(({lastRecordedItem:e,setLastRecordedItem:t,recentAds:i,setRecentAds:a,playerStateItem:s,currentDevice:n})=>{let o={isMissingAdData:!1};if(s&&s.uri!==e?.uri){if(e?.type===Ut.c.AD){const t=e?.uri.split(":")[2];i.has(t)?a((e=>{const i=new Map(e);return i.delete(t),i})):o={isMissingAdData:!0,errorMessage:n.isLocal?"primary_device":"secondary_device",adId:t}}t((()=>s))}return o})({lastRecordedItem:s,setLastRecordedItem:n,recentAds:t,setRecentAds:i,playerStateItem:o?.item,currentDevice:c});if(a.isMissingAdData){const{errorMessage:e,adId:t}=a;l.send((0,Qi.G)({error_type:"missing_ad_data",error_message:e,slot:"stream",ad_id:t}))}}),[o,s,t,l,c,e]),d=(0,a.useCallback)((()=>{e&&r&&i((e=>{let i=e;return t.has(r.adId)||(i=new Map(e).set(r.adId,r)),i}))}),[t,r,e]);(0,a.useEffect)((()=>{u()}),[u]),(0,a.useEffect)((()=>{d()}),[d])};var ta=i(29652),ia=i(64612),aa=i(15856),sa=i(25826),na=i(67374),oa=i(52740),ra=i(54932),ca=i(91636),la=i(14210),ua=i(12934);const da="player-controls",ma="player-controls__buttons",ga="player-controls__left",pa="player-controls__right",va=(0,a.memo)((function({item:e}){const t=sa.Q.isPodcastAd(e),i=sa.Q.isSurveyAd(e);return(0,v.jsxs)("div",{"data-testid":"ad-controls",className:ma,children:[(0,v.jsxs)("div",{className:ga,children:[t&&(0,v.jsx)(ua.w,{}),(0,v.jsx)(aa.T,{item:e,isDisabled:i}),t?(0,v.jsx)(oa.h,{}):(0,v.jsx)(ca.d,{})]}),(0,v.jsx)(na.x,{}),(0,v.jsxs)("div",{className:pa,children:[t?(0,v.jsx)(ra.v,{}):(0,v.jsx)(Zi,{children:(0,v.jsx)(la.$,{})}),(0,v.jsx)(ia.t,{item:e,isDisabled:i})]})]})}));var ba=i(36440),ya=i(55912);var ha=i(26145),ka=i(7344),xa=i(67715);var Ca=i(72601),Na=i(41273),ja=i(99171);const fa="JbGNL7qsnWz6EP_3hGvf",Sa="mkROcxw9LM6F2uuwQYjN",Ia="iAOrGKFACLqwN5OOPDOt",Aa=e=>{const{className:t,...i}=e;return(0,v.jsx)("span",{className:Sa,children:(0,v.jsx)(ja.x,{className:n()(t),...i})})};i(32807);var Pa=i(19293),Da=i(65477),wa=i(61919),Ta=i(59328);const Ea=e=>e-Date.now(),Ra=({timestamp:e,format:t=Ta.f})=>{const[i,s]=(0,a.useState)(Ea(e));return(0,a.useEffect)((()=>{s(Ea(e));const t=setInterval((()=>{s(Ea(e))}),1e3);return()=>{clearInterval(t)}}),[e]),(0,v.jsx)(v.Fragment,{children:t(i)})};var Ba=i(90103),Oa=i(61661),_a=i(78648),Fa=i(976);const La=e=>{const{hours:t,minutes:i,seconds:a}=(0,Fa.S)(e);return(0,Oa.j)({h:t>0?t:0,m:i,s:a})},Ua=function({setSleepTimer:e,state:t}){const i=t.type===_a.dq.NONE?_a.Xe:_a.Xe.concat(_a.k1.Off);return(0,v.jsxs)(Pa.W,{children:[(0,v.jsx)(Da.y,{children:(0,v.jsx)("span",{className:Ia,children:t.type!==_a.dq.NONE&&t.timestamp?d.Ru.get("web-player.sleep-timer.player-controls.popover.title.timeleft",(0,v.jsx)(Ra,{timestamp:t.timestamp,format:La})):d.Ru.get("web-player.sleep-timer.player-controls.popover.title")})}),(0,v.jsx)("div",{children:i.map((t=>(0,v.jsx)(wa.D,{onClick:()=>{e(t)},"data-testid":`playback-sleep-timer-option-${t}`,role:"menuitemradio","aria-label":`${t}`,children:(0,Ba.p)(t,Ut.c.EPISODE)},t)))})]})};var Ma=i(3231);const Va=({onClick:e})=>{const t=(0,Z.NC)(rt.GhO),[i,a]=(0,Ma.y)(),s=i.type!==_a.dq.NONE,{timestamp:n}=i;return t?(0,v.jsx)(Na.t,{placement:"top-start",menu:(0,v.jsx)(Ua,{state:i,setSleepTimer:t=>{a(t),e?.(t)}}),children:(e,t,i)=>(0,v.jsx)(J.Zp,{label:d.Ru.get("web-player.sleep-timer.player-controls.button.tooltip"),children:(0,v.jsx)($.H,{ref:i,className:fa,iconLeading:s?Aa:Ca.l,size:"small",onClick:t,role:"checkbox","aria-label":d.Ru.get("web-player.sleep-timer.player-controls.button.tooltip"),"data-testid":"control-button-sleep-timer","aria-checked":s,semanticColor:s?"textBrightAccent":void 0,children:s&&n&&(0,v.jsx)(l.E,{variant:"marginal",semanticColor:"textBrightAccent",children:(0,v.jsx)(Ra,{timestamp:n})})})})}):null};var za=i(19723),Ka=i(82455);const qa=(0,a.memo)((function({isPreview:e}){const{logChangePlaybackSpeed:t,logChangeRepeatMode:i,logChangeShuffleMode:s,logSeekForward:n,logSeekBack:o,logSkipForward:r,logSkipBack:c,logPlayPause:l,logProgressChanged:u,spec:m}=(()=>{const e=(0,Se.z)(),{spec:t,logger:i}=(0,f.r)(ha.kD,{data:{identifier:ha.gw.DESKTOP}});return{logChangePlaybackSpeed:(0,a.useCallback)((a=>{const s=e.getState();s?.item&&i.logInteraction(t.speedControlButtonFactory().hitSetPlaybackSpeed({currentlyPlayedItem:s.item.uri,playbackSpeed:a}))}),[i,e,t]),logChangeShuffleMode:(0,a.useCallback)((e=>{i.logInteraction(e?t.shuffleButtonFactory().hitShuffleEnable():t.shuffleButtonFactory().hitShuffleDisable())}),[i,t]),logChangeRepeatMode:(0,a.useCallback)((e=>{const a={[ka.p.REPEAT_NONE]:t.repeatButtonFactory().hitRepeatDisable(),[ka.p.REPEAT_TRACK]:t.repeatButtonFactory().hitRepeatOneEnable(),[ka.p.REPEAT_CONTEXT]:t.repeatButtonFactory().hitRepeatEnable()};i.logInteraction(a[e])}),[i,t]),logSeekBack:(0,a.useCallback)((e=>{i.logInteraction(t.seekBackButtonFactory().hitSeekByTime({msSeekedOffset:e}))}),[i,t]),logSeekForward:(0,a.useCallback)((e=>{i.logInteraction(t.seekForwardButtonFactory().hitSeekByTime({msSeekedOffset:e}))}),[i,t]),logSkipBack:(0,a.useCallback)((()=>{const a=e.getState();a&&i.logInteraction(t.previousButtonFactory().hitSkipToPrevious({itemToBeSkipped:a.item?.uri||"",positionMs:(0,xa.s)(a)??-1,totalContentMs:a.duration??-1}))}),[i,e,t]),logSkipForward:(0,a.useCallback)((()=>{const a=e.getState();a?.item&&i.logInteraction(t.nextButtonFactory().hitSkipToNext({itemToBeSkipped:a.item.uri,positionMs:(0,xa.s)(a)??-1,totalContentMs:a.duration??-1}))}),[i,e,t]),logPlayPause:(0,a.useCallback)((a=>{const s=e.getState();s?.item&&("resume"===a?i.logInteraction(t?.playPauseButtonFactory().hitResume({itemToBeResumed:s.item.uri})):"pause"===a&&i.logInteraction(t?.playPauseButtonFactory().hitPause({itemToBePaused:s.item.uri})))}),[i,e,t]),logProgressChanged:(0,a.useCallback)(((e,a)=>{switch(a){case"drag":return i.logInteraction(t.progressBarFactory().dragSeekToTime({msToSeekTo:e}));case"hit":return i.logInteraction(t.progressBarFactory().hitSeekToTime({msToSeekTo:e}));default:return(0,Mi.k)(a)}}),[i,t]),spec:t}})();ea((0,Z.NC)(rt.KYh));const g=(0,W.o)((e=>e?.item??void 0),((e,t)=>e?.uri===t?.uri)),p=function(){const e=(0,W.o)((e=>e?.item??void 0),((e,t)=>e?.uri===t?.uri));return(0,li.p)(e)||(0,Fi.d)(e)?"audio"===e.mediaType||"mixed"===e.mediaType:!!(0,_i.N)(e)&&e.isPodcastAd}();return(0,v.jsx)("div",{className:da,"data-testid":"player-controls",dir:"ltr","aria-label":d.Ru.get("playback-control.a11y.landmark-label"),children:(0,v.jsxs)(Ui.r,{spec:m,children:[(0,_i.N)(g)?(0,v.jsx)(va,{item:g}):(0,v.jsxs)("div",{className:ma,"data-testid":"general-controls",children:[(0,v.jsxs)("div",{className:ga,children:[p?(0,v.jsx)(ua.w,{onClick:t}):(0,v.jsx)(Ka.w,{renderEnabled:()=>(0,v.jsx)(za.a,{size:"small"}),renderDisabled:()=>(0,v.jsx)(ya.u,{onClick:s})}),p&&(0,v.jsx)(oa.h,{onClick:o}),(0,v.jsx)(ca.d,{onClick:c})]}),(0,v.jsx)(na.x,{onClick:l}),(0,v.jsxs)("div",{className:pa,children:[(0,v.jsx)(Zi,{children:(0,v.jsx)(la.$,{onClick:r})}),p?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ra.v,{onClick:n}),(0,v.jsx)(Va,{})]}):(0,v.jsx)(ba.s,{onClick:i})]})]}),(0,v.jsx)(ta.x,{isPreview:e,onChange:u})]})})}));var Ha=i(97036),Ga=i(58623),Wa=i(62290);const Ya="main-nowPlayingBar-container",Za="main-nowPlayingBar-nowPlayingBar",Qa="MWD1i_CSJ5N9wRBDpZmX",Xa="k3NVrHXkbfflNdAxpT1_",$a="m8UPWsNtWbdkvBNvqgBN",Ja="aepuRyT82biv_XmkH1eS",es="main-nowPlayingBar-left",ts="main-nowPlayingBar-center",is="main-nowPlayingBar-right",as="K7b2iysmIbvKo8RqRbc5",ss="adzMqeRxU0__wQcuju5q",ns=(0,a.memo)((()=>{const{isAnonymous:e}=(0,o.d4)(H.Ht),t=(0,o.wA)(),i=(0,W.o)((e=>e),((e,t)=>e?.hasContext===t?.hasContext&&e?.item?.uri===t?.item?.uri)),s=(0,y.h)();(()=>{const e=(0,o.d4)(H.Yb),{mode:t,setMode:i}=(0,q.r)(),s=(0,W.o)((e=>e?.item?.uri),((e,t)=>e!==t)),n=(0,z.S)(),r=(0,K.r)(),c=(0,V.l)(),l=n===M.z.NOW_PLAYING_VIEW&&"lyrics"===r.currentVariant;(0,a.useEffect)((()=>{t!==G.YU.none&&e&&t===G.YU.npv&&(i(G.YU.static),l&&c(M.z.CLOSED))}),[e,l,t,c,i,s])})();const l=(0,W.o)((e=>(0,_i.N)(e?.item??void 0))),u=(0,a.useCallback)((e=>{e.stopPropagation(),t((0,c.Ai)())}),[t]),d=()=>(0,v.jsx)(Ha.ql.Provider,{value:"now_playing_bar",children:(0,v.jsxs)("div",{className:e?Qa:Za,children:[(0,v.jsx)("div",{className:es,children:(0,v.jsx)(Ki,{})}),(0,v.jsx)("div",{className:ts,children:(0,v.jsx)(a.Suspense,{fallback:null,children:(0,v.jsx)(qa,{isPreview:e})})}),(0,v.jsx)("div",{className:is,children:(0,v.jsx)(_t,{})})]})});return(0,v.jsx)(Wa.P,{surface:Ga.u.NOW_PLAYING,children:(0,v.jsxs)("footer",{className:n()(Ya,as,{[ss]:s}),"data-testid":"now-playing-bar","data-testadtype":"ad-type-"+(l?"ad":"none"),children:[e?(0,v.jsx)(b,{handleClick:u}):null,e?(0,v.jsx)(r.A,{in:i?.hasContext??!1,timeout:200,classNames:{enter:Xa,enterActive:$a,enterDone:Ja},children:d()}):d(),(0,v.jsx)(U,{})]})})}))},51040:(e,t,i)=>{i.d(t,{w:()=>u});var a=i(30758),s=i(94703),n=i(29174),o=i(26930),r=i(4665),c=i(23514),l=i(17154);const u=({uri:e,isBook:t})=>{const{add:i,remove:u}=(0,c.p)("prerelease"),d=(0,r.o)("prerelease",[e]).at(0),{enqueueSnackbar:m}=(0,o.d)(),{spec:g,logger:p}=(0,l.r)(s.k,{data:{uri:e}});return{isPreSaved:d,addPresave:(0,a.useCallback)((async()=>{p.logInteraction(g.actionBarFactory().preSaveButtonFactory().hitPresave({prereleaseId:e,itemToBePresaved:e,contextUri:e})),await i(e),m(t?n.Ru.get("web-player.prerelease.audiobook_feedback_presaved"):n.Ru.get("web-player.prerelease.album_feedback_presaved"))}),[i,m,t,p,g,e]),removePresave:(0,a.useCallback)((async()=>{p.logInteraction(g.actionBarFactory().preSaveButtonFactory().hitRemovePresave({prereleaseId:e,itemToBeRemovedFromPresaved:e,contextUri:e})),await u(e)}),[p,u,g,e])}}},64768:(e,t,i)=>{i.d(t,{$:()=>n});var a=i(85387);const s="/lyrics",n=()=>{const e=(0,a.zy)(),t=e.pathname.startsWith(s);return{isActive:t,isActiveNotCinemaMode:t&&(!e.state.cinemaState||"closed"===e.state.cinemaState),routeDestination:s}}}}]);
//# sourceMappingURL=dwp-now-playing-bar.js.map