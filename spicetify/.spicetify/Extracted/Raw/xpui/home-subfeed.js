"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[347],{11990:(e,s,n)=>{n.d(s,{k:()=>o});n(32807);var t=n(85387);const o=()=>{const e=(0,t.zy)(),s=new URLSearchParams(e.search);if(!s.has("hpuris"))return null;const n=(s.get("hpuris")||"").split(",").map((e=>`spotify:section:${e}`));return{name:s.get("hpname")??"Shared",uris:n}}},21008:(e,s,n)=>{n.d(s,{HomeSubfeedWithRedirect:()=>q});var t=n(30758),o=n(97500),i=n.n(o),a=n(13932),r=n(58574),c=n(29174),l=n(44917),h=n(37461),d=n(55082),m=n(94286),p=n(83147),u=n(20909),g=n(99996),f=n(10556),x=(n(32807),n(48237)),j=n(62411),y=n(77676),C=n(96150),S=n(53717),_=n(56383),A=n(98180),R=n(8558),b=n(88012),w=n(17934),N=n(99922),$=n(98373),v=n(77621),k=n(86070);const I=(0,t.memo)((({cardCount:e})=>(0,k.jsx)("section",{children:(0,k.jsx)("div",{className:i()(v.A.home,v.A.homepage),children:(0,k.jsx)("div",{className:i()(v.A.homepageContent,"contentSpacing"),children:(0,k.jsx)(u.f,{showAll:!0,cardCount:e,withTitle:!1})})})}))),P=({sectionURIs:e})=>{const s=(0,a.NC)(R.wWq),{data:n,error:o,loading:l,extensions:d}=(0,S.$o)({uris:e,timeZone:(0,_.Ff)(),sp_t:(0,b.v8)("sp_t")??"",sectionItemsLimit:s??10},{gcTime:_.gO,staleTime:_.jl}),p=(0,m.getRequestIdForImpressions)(d),{spec:u}=(0,N.$)(r.Y,{data:{identifier:"home/pinned",uri:"spotify:home:pinned",reason:p??""}}),g=(0,j.d4)((e=>e.session.user)),f=(0,t.useCallback)((()=>{const s=new URL("https://open.spotify.com/home");s.searchParams.set("facet","pinned-by"),s.searchParams.set("hpuris",e.map((e=>e.replace("spotify:section:",""))).join(",")),s.searchParams.set("hpname",g?.display_name??g?.id??""),(0,$.l)(s.toString()),(0,x.M8)(c.Ru.get("feedback.link-copied"))}),[e,g?.display_name,g?.id]);return l?(0,k.jsx)(I,{cardCount:10}):null!==o||"HomeSectionCollection"!==n?.homeSections.__typename?(0,k.jsx)(h.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")}):(0,k.jsx)(w.r,{spec:u,children:(0,k.jsxs)("section",{"data-testid":"home-pin-page",className:i()(v.A.home,v.A.homepageWithCarousels),children:[(0,k.jsx)("div",{className:i()(v.A.homePinButton,"contentSpacing"),children:(0,k.jsx)(y.$,{iconLeading:C.C,onClick:f,size:"small",children:"Share your home"})}),(0,k.jsx)("div",{className:i()(v.A.homepageContent,"contentSpacing"),children:n.homeSections.sections.map(((e,s)=>"HomeSection"!==e.__typename?null:(0,k.jsx)(A.Q,{section:e,index:s,greeting:null},`${s}-${e.uri}`)))})]})})};var M=n(24622),L=n(11990),H=n(27106),D=n(42980);const T=(0,t.memo)((({cardCount:e})=>(0,k.jsxs)("div",{className:i()(v.A.homepageContent,"contentSpacing"),children:[(0,k.jsx)(l.y,{withTitle:!1}),(0,k.jsx)(u.f,{showAll:!0,cardCount:e,withTitle:!1})]}))),U=()=>{const e=(0,f.f)(),{data:s,loading:n,error:o,extensions:a}=(0,H.f)(),l=(0,t.useRef)(null);(0,d.b)(l);const u=e.replace("-chip",""),{spec:x}=(0,N.$)(r.Y,{data:{identifier:u?`home/${u}`:"",uri:`spotify:home:${u}`,reason:(0,m.getRequestIdForImpressions)(a)??""}}),j=s?.home;if(n)return(0,k.jsx)("section",{"data-testid":"home-subfeed-page",className:i()(v.A.home,v.A.homepageWithCarousels),children:(0,k.jsx)(T,{cardCount:50})});if(null!==o)return(0,k.jsx)(h.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")});if("HomeResponsePayload"!==j?.__typename)return(0,k.jsx)(h.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")});const y=j.sectionContainer.sections.items;return 0===y.length?(0,k.jsx)(h.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")}):(y[0]&&"HomeShortsSectionData"!==y[0]?.data?.__typename&&(e=>s=>"HomeShortsSectionData"===s.data?.__typename||"spotify:section:0JQ5DAnM3wGh0gz1MXnu3N"===s.uri&&"podcasts-chip"===e||("spotify:section:0JQ5DAJvCyzyxqjq31tlEs"===s.uri||"spotify:section:0JQ5DAnM3wGh0gz1MXnucs"===s.uri)&&e===g.e)(e)(y[0])&&(j.sectionContainer.sections.items[0]={...y[0],data:{...y[0].data,__typename:"HomeShortsSectionData"}}),(0,k.jsx)(w.r,{spec:x,children:(0,k.jsx)("section",{ref:l,"data-testid":"home-subfeed-page",className:i()(v.A.home,v.A.homepageWithCarousels),children:(0,k.jsx)("div",{className:i()(v.A.homepageContent,"contentSpacing"),children:(0,k.jsx)(p.g,{container:j.sectionContainer,greeting:null,enableFeedBaseline:!0})})})}))},q=()=>{const e=(0,f.f)(),{shelfURIs:s}=(0,M.T)(),n=(0,L.k)();if((0,a.NC)(R._Ie)){if("pinned-by"===e&&n){const e=n?.uris;return e.length?(0,k.jsx)(P,{sectionURIs:e}):(0,k.jsx)(D.$,{to:"/"})}if("pinned"===e){const e=s;return e.length?(0,k.jsx)(P,{sectionURIs:e}):(0,k.jsx)(D.$,{to:"/"})}}return e?(0,k.jsx)(U,{}):(0,k.jsx)(D.$,{to:"/"})}}}]);
//# sourceMappingURL=home-subfeed.js.map