"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[347],{3372:(e,s,n)=>{n.d(s,{HomeSubfeedWithRedirect:()=>q});var t=n(30758),o=n(97500),i=n.n(o),a=n(33100),r=n(58574),c=n(87579),h=n(65544),l=n(24454),d=n(53605),m=n(61008),p=n(33727),g=n(82552),u=n(63603),f=n(61837),x=n(48237),j=n(62411),C=n(60992),y=n(39482),A=n(12764),S=n(65980),_=n(54458),R=n(74929),b=n(33091),N=n(86851),w=n(89929),$=n(58070),k=n(93601),v=n(86070);const M=(0,t.memo)((({cardCount:e})=>(0,v.jsx)("section",{children:(0,v.jsx)("div",{className:i()(k.A.home,k.A.homepage),children:(0,v.jsx)("div",{className:i()(k.A.homepageContent,"contentSpacing"),children:(0,v.jsx)(g.f,{showAll:!0,cardCount:e,withTitle:!1})})})}))),I=({sectionURIs:e})=>{const s=(0,a.NC)(R.MX4),n=(0,a.NC)(R.wWq),{data:o,error:h,loading:d,extensions:p}=(0,A.$o)({uris:e,timeZone:(0,S.Ff)(),sp_t:(0,b.v8)("sp_t")??"",sectionItemsLimit:n??10},{gcTime:S.gO,staleTime:S.jl}),g=(0,m.getRequestIdForImpressions)(p),{spec:u}=(0,w.$)(r.Y,{data:{identifier:"home/pinned",uri:"spotify:home:pinned",reason:g??""}}),f=(0,j.d4)((e=>e.session.user)),I=(0,t.useCallback)((()=>{const s=new URL("https://open.spotify.com/home");s.searchParams.set("facet","pinned-by"),s.searchParams.set("hpuris",e.map((e=>e.replace("spotify:section:",""))).join(",")),s.searchParams.set("hpname",f?.display_name??f?.id??""),(0,$.l)(s.toString()),(0,x.M8)(c.Ru.get("feedback.link-copied"))}),[e,f?.display_name,f?.id]);return d?(0,v.jsx)(M,{cardCount:10}):null!==h||"HomeSectionCollection"!==o?.homeSections.__typename?(0,v.jsx)(l.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")}):(0,v.jsx)(N.r,{spec:u,children:(0,v.jsxs)("section",{"data-testid":"home-pin-page",className:i()(k.A.home,s?k.A.homepageWithCarousels:k.A.homepage),children:[(0,v.jsx)("div",{className:i()(k.A.homePinButton,"contentSpacing"),children:(0,v.jsx)(C.$,{iconLeading:y.C,onClick:I,size:"small",children:"Share your home"})}),(0,v.jsx)("div",{className:i()(k.A.homepageContent,"contentSpacing"),children:o.homeSections.sections.map(((e,s)=>"HomeSection"!==e.__typename?null:(0,v.jsx)(_.Q,{section:e,index:s,greeting:null},`${s}-${e.uri}`)))})]})})};var P=n(56015),L=n(21801),H=n(98048),D=n(39066);const T=(0,t.memo)((({cardCount:e})=>(0,v.jsxs)("div",{className:i()(k.A.homepageContent,"contentSpacing"),children:[(0,v.jsx)(h.y,{withTitle:!1}),(0,v.jsx)(g.f,{showAll:!0,cardCount:e,withTitle:!1})]}))),U=()=>{const e=(0,f.f)(),s=(0,a.NC)(R.MX4),n=(0,a.NC)(R.k4Y),{data:o,loading:h,error:g,extensions:x}=(0,H.f)(),j=(0,t.useRef)(null);(0,d.b)(j);const C=e.replace("-chip",""),{spec:y}=(0,w.$)(r.Y,{data:{identifier:C?`home/${C}`:"",uri:`spotify:home:${C}`,reason:(0,m.getRequestIdForImpressions)(x)??""}}),A=o?.home;if(h)return(0,v.jsx)("section",{"data-testid":"home-subfeed-page",className:i()(k.A.home,s?k.A.homepageWithCarousels:k.A.homepage),children:(0,v.jsx)(T,{cardCount:50})});if(null!==g)return(0,v.jsx)(l.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")});if("HomeResponsePayload"!==A?.__typename)return(0,v.jsx)(l.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")});const S=A.sectionContainer.sections.items;return 0===S.length?(0,v.jsx)(l.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")}):("HomeShortsSectionData"!==S[0]?.data?.__typename&&(e=>s=>"HomeShortsSectionData"===s.data?.__typename||"spotify:section:0JQ5DAnM3wGh0gz1MXnu3N"===s.uri&&"podcasts-chip"===e||("spotify:section:0JQ5DAJvCyzyxqjq31tlEs"===s.uri||"spotify:section:0JQ5DAnM3wGh0gz1MXnucs"===s.uri)&&e===u.e)(e)(S[0])&&(A.sectionContainer.sections.items[0]={...S[0],data:{...S[0].data,__typename:"HomeShortsSectionData"}}),(0,v.jsx)(N.r,{spec:y,children:(0,v.jsx)("section",{ref:j,"data-testid":"home-subfeed-page",className:i()(k.A.home,s?k.A.homepageWithCarousels:k.A.homepage),children:(0,v.jsx)("div",{className:i()(k.A.homepageContent,"contentSpacing"),children:(0,v.jsx)(p.g,{container:A.sectionContainer,greeting:null,enableFeedBaseline:n})})})}))},q=()=>{const e=(0,f.f)(),{shelfURIs:s}=(0,P.T)(),n=(0,L.k)();if((0,a.NC)(R._Ie)){if("pinned-by"===e&&n){const e=n?.uris;return e.length?(0,v.jsx)(I,{sectionURIs:e}):(0,v.jsx)(D.$,{to:"/"})}if("pinned"===e){const e=s;return e.length?(0,v.jsx)(I,{sectionURIs:e}):(0,v.jsx)(D.$,{to:"/"})}}return e?(0,v.jsx)(U,{}):(0,v.jsx)(D.$,{to:"/"})}},21801:(e,s,n)=>{n.d(s,{k:()=>o});var t=n(85387);const o=()=>{const e=(0,t.zy)(),s=new URLSearchParams(e.search);if(!s.has("hpuris"))return null;const n=(s.get("hpuris")||"").split(",").map((e=>`spotify:section:${e}`));return{name:s.get("hpname")??"Shared",uris:n}}}}]);
//# sourceMappingURL=home-subfeed.js.map