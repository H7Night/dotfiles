"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[7219],{31328:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Zt});var i=s(30758),n=s(97500),r=s.n(n),a=s(75044),o=s(15147),d=s(25270),c=s(17640),l=s(88312);const u={standardHeader:"OnnbOInFe49hYMQmhwUC",fixedHeader:"XZaBo7y3JfnBbjVV9TZo",verticalVideoHeader:"UP1rH6cQZiAZCdkPnDOg"};var v=s(86070);const m=({item:e,variant:t="bodyMediumBold",semanticColor:s="textBase",experience:i="standard"})=>{const n=u[`${i}Header`],r=e.isPodcastAd?c.Ru.get("ad-formats.npv.header.podcast-context"):c.Ru.get("ad-formats.npv.header.music-context");return(0,v.jsx)("div",{className:n,children:(0,v.jsx)(l.r,{children:(0,v.jsx)(d.E,{variant:t,semanticColor:s,children:r})},r)})};var x=s(62411),p=s(57195);const y="SEeVinRsd8ZYEQY4h1bX",g=({url:e})=>(0,v.jsx)("div",{className:y,"data-testid":"canvas-image-container",children:(0,v.jsx)(p._,{testid:"cover-art-image",loading:"lazy",src:e})});var h=s(29584);const f=({item:e})=>{const{capturePlaybackError:t}=(0,i.useContext)(h.O),s=e.metadata?.["ad.canvas.url"];return(0,i.useEffect)((()=>{s||t()}),[s,t]),s?(0,v.jsx)(g,{url:s}):null};var j=s(88308),_=s(97564),E=s(4056),A=s(73035),I=s(54799);const T="dSMBEH0cx3KxzZGHN3rL";const b=({canvasUri:e,canvasUrl:t,children:s,fileId:n,playerContainerClass:a})=>{const{capturePlaybackError:o}=(0,i.useContext)(h.O),d=(0,i.useRef)(null),c=(0,i.useMemo)((()=>({disallowProtectedTracks:!1,enableWithoutEME:!0,videoPlayerContainer:`.${a}`,audioPlayerContainer:`.${a}`})),[a]),l=(0,E.H)(c,void 0,void 0,void 0,void 0),{isPlaying:u}=(0,I.GK)();return(0,j.Ij)((()=>{const s=function(e,t,s){return(0,_.a2)({fileId:t,url:s,uri:e,mediaType:"video",format:{}.DEBUG_OVERTURE_WITHOUT_EME?"GENERIC_MEDIA":"MANIFEST_ID",options:{},logData:{playbackId:(0,A.E)()}})}(e,n,t);if(s)return l.playTracks([s],{paused:!u,muted:!0,loop:!0}),l.on(_.LW.TRACK_LOADED,(()=>{const e=document.getElementsByClassName(a),t=e[0]?.querySelector("video");t&&d.current&&(d.current.appendChild(t),t.autoplay=!0)})),l.on(_.LW.ERROR,(e=>{o()})),()=>{l.stop(),l.removeAllListeners()}}),[n,e]),(0,v.jsx)("div",{"data-testid":"canvas-ad-player",className:r()(a,T),ref:d,children:s})};const N=({item:e})=>{const{capturePlaybackError:t}=(0,i.useContext)(h.O),s=e.metadata?.["ad.canvas.url"],n=e.metadata?.["ad.canvas.file_id"],r=(a=s,a?.split("/").pop());var a;const o=n||r;return(0,i.useEffect)((()=>{o||t()}),[o,t]),o?(0,v.jsx)(b,{playerContainerClass:"canvasAdPlayerNpv",canvasUri:e.uri,fileId:o,canvasUrl:s}):null};var C=s(72532),k=s(53476),V=s(87751),M=s(24498);const q="pvAyLo3KN8QP7KxQtiub",w="r4EqB8Z5_aywMW_8I84P",Q="N6A5jVwfl6XHew58jDUw",S=e=>{const{item:t,canvasAdType:s}=e;return"video"===s?(0,v.jsx)(N,{item:t}):(0,v.jsx)(f,{item:t})},P=e=>{const t=(0,x.wA)(),{url:s}=(0,C.b)(e.item);return(0,v.jsxs)("div",{className:q,"data-testid":"canvas-ad-container",children:[(0,v.jsx)("div",{className:w}),(0,v.jsx)("div",{className:Q,children:s?(0,v.jsx)(M.N,{to:s,onClick:()=>{t((0,V.q5)(k.c.VIDEO_PLAYER,k.V.AD_NPV))},children:(0,v.jsx)(S,{...e})}):(0,v.jsx)(S,{...e})})]})};var O=s(91817),U=s(1340),R=s(84904);const D="iDW7b6oChePRpgfDFY3U",F=({item:e})=>(0,v.jsxs)("div",{className:D,children:[(0,v.jsx)(R.T,{item:e}),(0,v.jsx)(U.t,{item:e})]});var B=s(38511),Z=s(19099),L=s(11957);const W="Iu4RfEr8Jgc0y47TVaAA";function z(e,t){return!(!e||!t)&&e.maxSecondsRemaining===t.maxSecondsRemaining}function H({item:e,variant:t="marginal",semanticColor:s="textSubdued"}){const n=(0,L.o)((e=>e?.adBreakContext??null),z),[r]=(0,Z.S)(1e3,(t=>t.item?.uri===e?.uri)),a=(0,i.useMemo)((()=>{if(!n)return 0;const e=Math.round(r/1e3);return n.maxSecondsRemaining-e}),[n,r]);return a<=0?null:(0,v.jsx)(d.E,{as:"span",variant:t,semanticColor:s,className:W,children:B.Q.getAdBreakCountdownText(a)})}var Y=s(98273),G=s(10927),$=s(55405);const K="JiMklw0itqYJ1aE76Vi8",J=({item:e})=>{const t=(0,a.NC)($.CeN);return(0,v.jsxs)("div",{className:K,children:[(0,v.jsx)(G.f,{item:e,surface:"AD_NPV"}),(0,v.jsx)(Y.L,{item:e,surface:"AD_NPV"}),t&&(0,v.jsx)(H,{item:e})]})};var X=s(68624),ee=s(7510),te=s(67843);function se(){const e=(0,te.vh)();return{linkUbiEvent:function({adId:t,ubiEventId:s,product:i,format:n,requestId:r}){e.send((0,ee.A)({ad_id:t,ad_request_id:r,ad_format:n,content_type:i,ubi_event_id:s}))}}}var ie=s(80090),ne=s(31592),re=s(63880),ae=s(96381),oe=s(42309),de=s(82232),ce=s(58089);const le=({item:e,spec:t,contextTrack:s})=>{const i=(0,x.wA)(),n=(0,ce.s)(),{linkUbiEvent:r}=se(),a=`${B.Q.getAdFormat(s)}_${B.Q.getAdProduct(s)}`;return(0,v.jsx)(ne.D,{role:"menuitem",testid:"about-this-ad-context-menu-item",leadingIcon:(0,v.jsx)(re.p,{size:"small"}),"aria-label":c.Ru.get("ad-formats.dsa.aboutThisAd"),onClick:()=>{i((0,oe.Oc)()),i((0,ae.b0)(e));const o=t.contextMenuFactory({identifier:e.metadata?.lineitem_id,reason:a}).triggerDsaFactory().hitUiNavigate({destination:"/context_menu"}),{interactionId:d}=n.logInteraction(o);r({adId:e.adId,requestId:e.requestId,ubiEventId:d,format:B.Q.getAdFormat(s),product:B.Q.getAdProduct(s)})},divider:"before",children:c.Ru.get("ad-formats.dsa.aboutThisAd")})},ue=(0,i.memo)((function(e){return(0,v.jsx)(de.pZ,{value:"about-this-ad",children:(0,v.jsx)(le,{...e})})})),ve=(0,i.memo)((function({item:e,spec:t,contextTrack:s}){const n=(0,ce.s)(),{linkUbiEvent:r}=se(),a=`${B.Q.getAdFormat(s)}_${B.Q.getAdProduct(s)}`;return(0,i.useEffect)((()=>{(()=>{const i=n.logImpression(t.contextMenuFactory({identifier:e.metadata?.lineitem_id,reason:a}).impression());r({adId:e.adId,requestId:e.requestId,format:B.Q.getAdFormat(s),product:B.Q.getAdProduct(s),ubiEventId:i})})()}),[]),(0,v.jsx)(de.pZ,{value:"ad",children:(0,v.jsxs)(ie.W,{children:[(0,v.jsx)(de.pZ,{value:"ad-title",children:(0,v.jsx)(ne.D,{role:"menuitem",testid:"ad-title-context-menu-item",divider:"after",disabled:!0,children:e.metadata.advertiser})}),(0,v.jsx)(ue,{item:e,spec:t,contextTrack:s})]})})})),me="NYcvpWpgvQYZploOD6rI",xe="OpXrpghZvv_w9ygosJFP",pe=({item:e,spec:t})=>{const s=(0,X.mr)(),i=(0,ce.s)(),{linkUbiEvent:n}=se(),r=`${B.Q.getAdFormat(e)}_${B.Q.getAdProduct(e)}`;return(0,v.jsxs)("div",{className:me,children:[(0,v.jsx)(J,{item:e}),(0,v.jsxs)("div",{className:xe,children:[(0,v.jsx)(F,{item:e}),s?.isDsaEligible&&(0,v.jsx)("div",{"data-testid":"PanelHeader_AdContextMenuButton",children:(0,v.jsx)(O.U,{menu:(0,v.jsx)(ve,{item:s,contextTrack:e,spec:t}),onClick:()=>{if(s){const a=t.infoContainerFactory().contextMenuButtonFactory({identifier:s.metadata?.lineitem_id,reason:r}).hitUiNavigate({destination:"/context_menu"}),{interactionId:o}=i.logInteraction(a);n({adId:s.adId,requestId:s.requestId,format:B.Q.getAdFormat(e),product:B.Q.getAdProduct(e),ubiEventId:o})}}})})]})]})};var ye=s(49526);const ge=({item:e,context:t,index:s})=>t?(0,v.jsx)(ye.h,{context:t,item:e,index:s}):null,he="tD84X2SD0IicMx3osK8a",fe=({item:e,spec:t,canvasAdType:s})=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(P,{item:e,canvasAdType:s}),(0,v.jsx)("div",{className:he,children:(0,v.jsx)(pe,{item:e,spec:t})})]}),je=({item:e,spec:t,context:s,index:i})=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ge,{item:e,context:s,index:i}),(0,v.jsx)(pe,{item:e,spec:t})]}),_e=e=>{const{item:t}=e,{state:s}=(0,i.useContext)(h.O),n=(0,a.NC)($.U5l,{loadingValue:!1}),r=t?.metadata?.["ad.canvas.type"];return n&&("image"===r||"video"===r)&&s!==h.j.Errored?(0,v.jsx)(fe,{...e,canvasAdType:r}):(0,v.jsx)(je,{...e})};var Ee=s(29529),Ae=s(44850),Ie=s(58837),Te=s(6306),be=s(35763);const Ne="mJucukPuB6OTWgaD4MZk",Ce="i3o8ABclZov7rz8zzKYP",ke=(0,i.lazy)((()=>Promise.resolve().then(s.bind(s,65621)))),Ve=({item:e,backgroundColor:t,className:s})=>{const n=(0,x.wA)(),{url:a,buttonMessage:o,tagline:d}=(0,C.b)(e),l=o||c.Ru.get("ad-formats.learnMore");if(!a)return null;const u=r()(Ne,s),m=(0,be.H)(a);return(0,v.jsx)(M.N,{to:m,"data-testid":"ad-companion-card",className:u,onClick:()=>{n((0,V.q5)(k.c.COMPANION_CARD,k.V.AD_NPV))},children:(0,v.jsx)(Ee.v,{style:{backgroundColor:t},className:Ce,onClickHint:c.Ru.get("ad-formats.learnMore"),variant:"tinted",horizontalGap:(0,Ae.po)("looser"),id:e.uri,title:(0,v.jsx)(Ie.d,{variant:"mestoBold","data-testid":"ad-companion-card-tagline",children:d||l}),trailing:(0,v.jsx)(i.Suspense,{fallback:(0,v.jsx)(Te.V,{}),children:d?(0,v.jsx)(ke,{text:l,clickUrl:m,onClick:()=>{n((0,V.q5)(k.c.CTA_BUTTON,k.V.AD_NPV))}}):(0,v.jsx)(Te.V,{semanticColor:"textBase"})})})})};var Me=s(73718),qe=s(23800);const we="_9mvd0bTv9vUHyKGzvBNV",Qe="hQjIgVttFxVwEZ52g6Rg",Se=({isPodcastAd:e,noticeType:t,primaryText:s})=>{(0,i.useEffect)((()=>{const e=document.getElementById("connected-box");if(e){const t=e.offsetWidth;e.style.height=`${t}px`}}),[]);const n=e?c.Ru.get("ad-formats.survey-podcast-content"):c.Ru.get("ad-formats.survey-music-content");return(0,v.jsx)("div",{className:Qe,id:"connected-box",children:(0,v.jsxs)(v.Fragment,{children:["success"===t?(0,v.jsx)(Me.T,{size:"xxlarge",spacing:"small",semanticColor:"textBase","data-testid":"survey-notice-check"}):(0,v.jsx)(qe.b,{size:"xxlarge",spacing:"small",semanticColor:"textBase","data-testid":"survey-notice-exclamation"}),(0,v.jsx)(d.E,{as:"h1",variant:"titleSmall",paddingBottom:"tighter-2",className:we,semanticColor:"textBase",children:s}),(0,v.jsx)(d.E,{children:n})]})})},Pe=({isPodcastAd:e,logger:t})=>((0,i.useEffect)((()=>{t.logSurveyAdEventWithoutAd({event:"event_survey_on_connect",eventReason:"secondary_device"})}),[]),(0,v.jsx)(Se,{isPodcastAd:e,noticeType:"alert",primaryText:c.Ru.get("ad-formats.survey-connected-note")})),Oe=({isPodcastAd:e,validationResult:t,logger:s})=>((0,i.useEffect)((()=>{s.logAdEvent({event:"errored",reason:"survey_malformed"}),s.logAdError({errorType:"survey_malformed",errorMessage:t.errorMessage})}),[]),(0,v.jsx)(Se,{isPodcastAd:e,noticeType:"alert",primaryText:c.Ru.get("error-dialog.generic.header")}));var Ue=s(23317),Re=s(92713),De=s(51231),Fe=s(92276),Be=s(83866);const Ze=()=>{const{logger:e}=(0,X.yU)();return e},Le="zr0dLusU4AgiRoEVZVx_",We="FQKI6EvRALxogOFyociA",ze=({data:e,selected:t,handleOptionClick:s,className:i,ad:n})=>{const a=Ze(),o=(i,r)=>{const o={id:i.id,"aria-label":`Select ${i.primaryText}`};return e.surveyQuestionType===Re.xV.MULTI_SELECT?(0,v.jsx)(De.c,{...o,checked:t.has(i.id),onChange:()=>{s({optionId:i.id,isExclusive:i.isExclusive,questionType:e.surveyQuestionType,position:r}),a.logSurveyAdEventWithAd({optionId:i.id,questionId:e.id,event:t.has(i.id)?"event_option_deselected":"event_option_selected",position:r,ad:n})}}):(0,v.jsx)(Fe.M,{...o,checked:t.has(i.id),onChange:()=>{s({optionId:i.id,isExclusive:i.isExclusive,questionType:e.surveyQuestionType,position:r}),a.logSurveyAdEventWithAd({optionId:i.id,questionId:e.id,event:"event_option_selected",position:r,ad:n})}})};return(0,v.jsx)(Be.g,{labelFor:e.id,withFieldset:!0,className:r()(Le,i),children:(0,v.jsx)("div",{children:e.surveyQuestionOptions.map(((i,r)=>(0,v.jsx)(Ee.v,{"data-testid":"survey-option-ad",className:We,id:i.id,variant:"elevated",title:i.primaryText,leading:o(i,r),isSelected:t.has(i.id),onClick:()=>{s({optionId:i.id,isExclusive:i.isExclusive,questionType:e.surveyQuestionType,position:r}),a.logSurveyAdEventWithAd({optionId:i.id,questionId:e.id,event:t.has(i.id)?"event_option_deselected":"event_option_selected",position:r,ad:n})}},i.id)))})})};var He=s(57221);const Ye="o1cH6TNkpq2sTkq1EAZU",Ge="urYkLZy00wWdQH24F1Ja",$e="GneD3mdmK5FDZVz6bzhB",Ke="MTSvglGhr7gd3paX4exJ",Je=({selected:e,submitted:t,handleClick:s})=>(0,v.jsx)("div",{className:r()(Ye,Ge,{[$e]:t}),children:(0,v.jsx)(He.$,{disabled:0===e.size,size:"medium",fullWidth:!0,colorSet:"invertedLight",label:"Submit","data-testid":"survey-submit-button",onClick:s,id:Ke,children:c.Ru.get("ad-formats.survey-submit-button")})}),Xe="HgfSrPwFpIvBDXNMx0NO",et="FjDNaretUQGhB3YYHUaZ",tt="MDmTCQhrCnUXjUhyWx_A",st=({showThankYou:e,ad:t,questionId:s})=>{const n=Ze();return(0,i.useEffect)((()=>{e&&n.logSurveyAdEventWithAd({questionId:s,event:"event_thank_you_displayed",ad:t})}),[s,e]),(0,v.jsxs)("div",{className:r()(et,{[tt]:e}),"data-testid":"survey-ad-thank-you",children:[(0,v.jsx)(Me.T,{size:"xxlarge",spacing:"small"}),(0,v.jsx)(d.E,{as:"h1",variant:"titleSmall",paddingBottom:"tighter-2",className:Xe,"data-testid":"survey-ad-thank-you",children:c.Ru.get("ad-formats.survey-thankyou")})]})};function it(){const[e,t]=(0,i.useState)(new Map),[s,n]=(0,i.useState)(!1);return{selected:e,handleOptionClick:({optionId:s,isExclusive:i,questionType:n,position:r})=>{let a=new Map(e);n===Re.xV.MULTI_SELECT?a=function({optionId:e,selected:t,isExclusive:s,position:i}){let n;t.has(e)?(n=new Map(t),n.delete(e)):n=function({optionId:e,selected:t,isExclusive:s,position:i}){const n=new Map(t);s&&n.clear();return t.forEach((({isExclusive:e},t)=>{e&&n.delete(t)})),n.set(e,{isExclusive:s,position:i}),n}({optionId:e,isExclusive:s,selected:t,position:i});return n}({optionId:s,isExclusive:i,selected:e,position:r}):n===Re.xV.SINGLE_SELECT&&(a=function({optionId:e,selected:t,position:s}){let i=new Map(t);t.has(e)||(i=function({optionId:e,selected:t,position:s}){const i=new Map(t);return i.clear(),i.set(e,{isExclusive:!0,position:s}),i}({optionId:e,selected:t,position:s}));return i}({optionId:s,selected:e,position:r})),t(a)},setSurveyIsSubmitted:n,submitted:s}}class nt{constructor(e){this.isValid=e.isValid,this.errorMessage=e.errorMessage}}var rt=s(65946),at=s(64638);const ot=({ad:e,eventSender:t,logger:s,questionId:i,selected:n})=>{const r=[];n.forEach(((e,t)=>{const s=(({id:e,selectedOption:t})=>at.$y.create({selectedSurveyQuestionOptionId:e,optionPositionIndex:t.position.toString()}))({id:t,selectedOption:e});r.push(s)}));const a=at.Tl.create({surveyQuestionId:i,selectedSurveyOptions:r}),o=at.BN.create({surveyQuestionAnswers:[a]}),d=at.A7.create({survey:o});s.logAdEvent({event:"survey_submitted",payload:d}),s.logAdEvent({event:"ended"}),t.send((0,rt.i)({ad_id:e.adId,event:"event_survey_submitted",format:(0,Re.gh)(e.format).toLowerCase(),in_focus:!0,lineitem_id:e.metadata?.lineitem_id,product_name:"brand_survey",question_id:i,request_id:e.requestId,response:JSON.stringify(d),slot:e.slot}))};const dt=function(e,t=2e3){const s=(0,X.dY)();(0,i.useEffect)((()=>{if(!e)return;const i=setTimeout((()=>s.skipToNext()),t);return()=>clearTimeout(i)}),[t,e,s])},ct="QcjxDZqAGwQOqerAjHdc",lt="GZDC018jhUZA8opoHkpM",ut="xNk9rFVlHRml2zumyfQI",vt="rA7_f0w9lodVUT7ad3RC",mt="FfcoZWtdfcG0Ihbesrub",xt="q1uiO23dnmvrVxxEOq9l",pt="KRI6OoYy611XXayRUTyE",yt=({question:e,ad:t})=>{const s=Ze(),n=(0,te.vh)(),a=(0,X.dY)();(0,i.useEffect)((()=>{s.logSurveyAdEventWithAd({questionId:e.id,event:"event_companion_viewed",ad:t})}),[e.id]);const{selected:o,handleOptionClick:c,submitted:l,setSurveyIsSubmitted:u}=it();(0,i.useEffect)((()=>{e.surveyQuestionType in Re.xV||(s.logAdEvent({event:"errored",reason:"survey_malformed"}),a.skipToNext())})),dt(l,2e3);return(0,v.jsxs)(Ue.a,{className:r()(ct,vt),padding:"looser",children:[(0,v.jsxs)("div",{className:r()(lt,{[xt]:l}),children:[(0,v.jsxs)("div",{className:pt,children:[(0,v.jsx)(d.E,{as:"h1",variant:"titleSmall",paddingBottom:"tighter-2",children:e.primaryText}),(0,v.jsx)(d.E,{as:"p",semanticColor:"textSubdued",variant:"bodySmall",children:e.secondaryText})]}),(0,v.jsx)(ze,{className:r()(ut,mt),ad:t,selected:o,handleOptionClick:c,data:e})]}),(0,v.jsx)(Je,{handleClick:()=>{u(!0),ot({eventSender:n,ad:t,selected:o,logger:s,questionId:e.id})},submitted:l,selected:o}),(0,v.jsx)(st,{showThankYou:l,ad:t,questionId:e.id})]})},gt=({survey:e,ad:t})=>e?(0,v.jsx)(yt,{question:e?.surveyQuestions[0],ad:t}):null,ht=e=>{return t=e,t.survey?.surveyQuestions?.length?(e=>!e.survey?.surveyTransparencyContent||0===Object.keys(e.survey.surveyTransparencyContent).length)(e)?new nt({isValid:!1,errorMessage:"survey.survey_transparency_content : missing"}):new nt({isValid:!0}):new nt({isValid:!1,errorMessage:"survey.survey_questions : missing"});var t},ft=e=>{const t=e?.[0];if(s=t,!s?.id||s.id.length<1)return new nt({isValid:!1,errorMessage:"survey.survey_questions[0].id : missing"});var s;if((e=>(0,Re.BM)(e?.surveyQuestionType)<=0)(t))return new nt({isValid:!1,errorMessage:"survey.survey_questions[0].survey_question_type : invalid type"});if((e=>!e?.primaryText||e?.primaryText?.length<1)(t))return new nt({isValid:!1,errorMessage:"survey.survey_questions[0].primary_text : missing"});if((e=>!e?.surveyQuestionOptions?.length)(t))return new nt({isValid:!1,errorMessage:"survey.survey_questions[0].survey_question_options : missing"});const i=t?.surveyQuestionOptions.find((e=>(e=>!e.id||e?.id?.length<1)(e)));if(i)return new nt({isValid:!1,errorMessage:`survey.survey_questions[0].survey_question_options[${t?.surveyQuestionOptions.indexOf(i)}].id : missing`});const n=t?.surveyQuestionOptions.find((e=>(e=>!e.primaryText||e.primaryText.length<1)(e)));return new nt(n?{isValid:!1,errorMessage:`survey.survey_questions[0].survey_question_options[${t?.surveyQuestionOptions.indexOf(n)}].primary_text : missing`}:{isValid:!0})},jt=e=>{if(!e)return new nt({isValid:!1,errorMessage:"no ad"});const t=(e=>e?.companions.find((e=>e.survey)))(e);if(!t)return new nt({isValid:!1,errorMessage:"companions.survey : missing"});const s=ht(t);if(s&&!s.isValid)return s;const i=t?.survey?.surveyQuestions,n=ft(i);if(n&&!n.isValid)return n;const r=t?.survey?.surveyTransparencyContent,a=(o=r)&&(e=>!e?.transparencyLabel||e?.transparencyLabel.length<1)(o)?new nt({isValid:!1,errorMessage:"survey.survey_transparency_content.transparency_label : missing"}):o&&(e=>!e?.transparencyUrl||e?.transparencyUrl.length<1)(o)?new nt({isValid:!1,errorMessage:"survey.survey_transparency_content.transparency_url : missing"}):new nt({isValid:!0});var o;return a||new nt({isValid:!0})},_t=(0,i.memo)((function({displayText:e,url:t,ad:s,questionId:n}){const r=Ze();return(0,i.useEffect)((()=>{r.logSurveyAdEventWithAd({questionId:n,event:"event_context_menu",ad:s})}),[n]),(0,v.jsx)(ie.W,{children:(0,v.jsx)(ne.D,{role:"menuitem",leadingIcon:(0,v.jsx)(re.p,{size:"small"}),"aria-label":`${e}, link`,to:t,children:e})})}));var Et=s(43601);const At="iFWtvDR8p3PNwLx46nWu",It="wj4kWjE4PuHVGqEf0ohK",Tt=({item:e})=>{const t=(0,X.mr)(),s=jt(t),n=Ze(),r=(0,i.useMemo)((()=>t?.companions.find((e=>e.survey))?.survey),[t]),a=r?.surveyTransparencyContent,{currentDevice:o}=(0,Et.l)(),{isLocal:d}=o;return(0,v.jsxs)("div",{"data-testid":"survey-ad",className:It,children:[d?t&&s.isValid?(0,v.jsx)(gt,{survey:r,ad:t}):(0,v.jsx)(Oe,{isPodcastAd:e?.isPodcastAd,validationResult:s,logger:n}):(0,v.jsx)(Pe,{isPodcastAd:e?.isPodcastAd,logger:n}),(0,v.jsxs)("div",{className:At,children:[(0,v.jsx)(J,{item:e}),a&&t&&(0,v.jsx)(O.U,{"aria-label":"More options, button",menu:(0,v.jsx)(_t,{questionId:r?.surveyQuestions[0]?.id,ad:t,displayText:a.transparencyLabel,url:a.transparencyUrl})})]})]})},bt=e=>{const t=(0,x.d4)((e=>e.ads?.vto));return"audio"===e?.mediaType||!t?.isMinimized};var Nt=s(6705);const Ct="M7UVXKPsARIM71fmtSUG",kt="HKhLNVB5OsH5osqax9lk",Vt="i_7T75rV7Rj7AyykwrCf",Mt="na5oNvZD9KtuYIUiIUZg",qt="_7QFCuyjgT6BwUe1JJVL",wt="g1fyNwi0G98CTbv9v4We",Qt=({item:e,context:t,index:s,spec:i})=>{const n=bt(e),a="portrait"===e.videoOrientation,o=a&&!n?Ct:"",d=r()(qt,{[wt]:a}),c=r()({[Mt]:a});return(0,v.jsxs)("div",{className:d,children:[n?(0,v.jsx)(ge,{item:e,context:t,index:s}):(0,v.jsxs)("div",{className:Vt,children:[a&&(0,v.jsx)("div",{className:kt}),(0,v.jsx)("div",{className:c,children:(0,v.jsx)(Nt.F,{})})]}),(0,v.jsx)("div",{className:o,children:(0,v.jsx)(pe,{item:e,spec:i})})]})};var St=s(26423),Pt=s(88036);var Ot=s(5141);const Ut="nONhpa6k5EMxHTR1RXhM",Rt="SDP4__0ksgTwERvZfjE8",Dt="cp7_8T7Q27pZ5zYXUFOW",Ft="IVGg8Hz4Py4BaPEyJz0T",Bt="tUurYuAJ2ZftcyLRFJ9z",Zt=({item:e,context:t,index:s})=>{const n=bt(e),{state:d}=(0,i.useContext)(h.O),c=(0,a.NC)($.U5l),{spec:l,UBIFragment:u}=(0,Ot.r)(o.m,{}),x=(e=>{const{logoImage:t}=(0,C.b)(e),s=e?.images[0]?.url;return B.Q.isVideoAd(e)?t||s:s||t})(e),p=((e=null,t=0,s=St.CpN)=>{const[n,r]=(0,i.useState)(s),a=(0,Pt.z)(e,s,"colorDark");return(0,i.useEffect)((()=>{setTimeout((()=>{r(a)}),t)}),[t,a]),n})(x,600),y=(0,i.useMemo)((()=>B.Q.isVerticalVideoAd(e)&&!n),[e,n]),g=(0,i.useMemo)((()=>y?"verticalVideo":c&&B.Q.isCanvasAd(e)&&d!==h.j.Errored?"fixed":"standard"),[d,c,e,y]),f=(e=>{const t=(0,X.mr)(),s=t?.requestId,n=Ze(),r=(0,a.NC)($.o4S,{loadingValue:!1});return(0,i.useEffect)((()=>{s&&B.Q.isSurveyAd(e)&&!r&&n.logAdError({errorType:"survey_ad_feature_disabled",errorMessage:"survey feature flag is disabled"})}),[]),B.Q.isSurveyAd(e)&&r?"survey":B.Q.isVideoAd(e)?"video":"audio"})(e),j="survey"===f;return(0,v.jsx)("div",{className:r()(Ut,{[Rt]:j}),children:(0,v.jsx)(u,{spec:l,children:(0,v.jsxs)("div",{className:Dt,children:[(0,v.jsxs)("div",{className:r()(Ft,{[Rt]:j}),children:[(0,v.jsx)(m,{item:e,experience:g}),(()=>{switch(f){case"video":return(0,v.jsx)(Qt,{item:e,spec:l,index:s,context:t});case"survey":return(0,v.jsx)(Tt,{item:e});default:return(0,v.jsx)(_e,{item:e,context:t,index:s,spec:l})}})()]}),j?null:(0,v.jsx)(Ve,{item:e,className:Bt,backgroundColor:p})]})})})}},91817:(e,t,s)=>{s.d(t,{U:()=>o});var i=s(17640),n=s(2565),r=s(52110),a=s(86070);const o=({menu:e,onClick:t,"aria-label":s})=>(0,a.jsx)(r.b,{menu:e,children:(0,a.jsx)(n.e,{size:n.M.xs,label:i.Ru.get("more"),ariaLabel:s,onClick:t})})}}]);
//# sourceMappingURL=7219.js.map